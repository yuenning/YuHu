/*! For license information please see main.f19dd89e.js.LICENSE.txt */
!function(){var e={1694:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var o=a.apply(null,n);o&&e.push(o)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},6674:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},a=function(e,t,n){var a,i=r[e];return a="string"===typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};function i(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}var o={date:i({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:i({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:i({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},s={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},u=function(e,t,n,r){return s[e]};function c(e){return function(t,n){var r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){var a=e.defaultFormattingWidth||e.defaultWidth,i=null!==n&&void 0!==n&&n.width?String(n.width):a;r=e.formattingValues[i]||e.formattingValues[a]}else{var o=e.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[o]}return r[e.argumentCallback?e.argumentCallback(t):t]}}var l={ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:c({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:c({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:c({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:c({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:c({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function h(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;var o,s=i[0],u=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(u)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return}(u,(function(e){return e.test(s)})):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n;return}(u,(function(e){return e.test(s)}));return o=e.valueCallback?e.valueCallback(c):c,{value:o=n.valueCallback?n.valueCallback(o):o,rest:t.slice(s.length)}}}var f,d={ordinalNumber:(f={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(f.matchPattern);if(!n)return null;var r=n[0],a=e.match(f.parsePattern);if(!a)return null;var i=f.valueCallback?f.valueCallback(a[0]):a[0];return{value:i=t.valueCallback?t.valueCallback(i):i,rest:e.slice(r.length)}}),era:h({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:h({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:h({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:h({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:h({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},p={code:"en-US",formatDistance:a,formatLong:o,formatRelative:u,localize:l,match:d,options:{weekStartsOn:0,firstWeekContainsDate:1}}},4408:function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var r={};function a(){return r}},3462:function(e,t){"use strict";var n=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},r=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},a={p:r,P:function(e,t){var a,i=e.match(/(P+)(p+)?/)||[],o=i[1],s=i[2];if(!s)return n(e,t);switch(o){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;default:a=t.dateTime({width:"full"})}return a.replace("{{date}}",n(o,t)).replace("{{time}}",r(s,t))}};t.Z=a},4697:function(e,t,n){"use strict";function r(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}n.d(t,{Z:function(){return r}})},5611:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(8527),a=n(4522),i=n(9853);function o(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=t.getUTCFullYear(),o=new Date(0);o.setUTCFullYear(n+1,0,4),o.setUTCHours(0,0,0,0);var s=(0,i.Z)(o),u=new Date(0);u.setUTCFullYear(n,0,4),u.setUTCHours(0,0,0,0);var c=(0,i.Z)(u);return t.getTime()>=s.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}},9153:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(8527),a=n(9853),i=n(5611),o=n(4522);var s=6048e5;function u(e){(0,o.Z)(1,arguments);var t=(0,r.default)(e),n=(0,a.Z)(t).getTime()-function(e){(0,o.Z)(1,arguments);var t=(0,i.Z)(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),(0,a.Z)(n)}(t).getTime();return Math.round(n/s)+1}},9726:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(8527),a=n(4522),i=n(1230),o=n(9297),s=n(4408);function u(e,t){var n,u,c,l,h,f,d,p;(0,a.Z)(1,arguments);var v=(0,r.default)(e),g=v.getUTCFullYear(),m=(0,s.j)(),y=(0,o.Z)(null!==(n=null!==(u=null!==(c=null!==(l=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==l?l:null===t||void 0===t||null===(h=t.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==c?c:m.firstWeekContainsDate)&&void 0!==u?u:null===(d=m.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==n?n:1);if(!(y>=1&&y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var b=new Date(0);b.setUTCFullYear(g+1,0,y),b.setUTCHours(0,0,0,0);var k=(0,i.Z)(b,t),x=new Date(0);x.setUTCFullYear(g,0,y),x.setUTCHours(0,0,0,0);var w=(0,i.Z)(x,t);return v.getTime()>=k.getTime()?g+1:v.getTime()>=w.getTime()?g:g-1}},9934:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(8527),a=n(1230),i=n(9726),o=n(4522),s=n(9297),u=n(4408);var c=6048e5;function l(e,t){(0,o.Z)(1,arguments);var n=(0,r.default)(e),l=(0,a.Z)(n,t).getTime()-function(e,t){var n,r,c,l,h,f,d,p;(0,o.Z)(1,arguments);var v=(0,u.j)(),g=(0,s.Z)(null!==(n=null!==(r=null!==(c=null!==(l=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==l?l:null===t||void 0===t||null===(h=t.locale)||void 0===h||null===(f=h.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==c?c:v.firstWeekContainsDate)&&void 0!==r?r:null===(d=v.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==n?n:1),m=(0,i.Z)(e,t),y=new Date(0);return y.setUTCFullYear(m,0,g),y.setUTCHours(0,0,0,0),(0,a.Z)(y,t)}(n,t).getTime();return Math.round(l/c)+1}},8552:function(e,t,n){"use strict";n.d(t,{Do:function(){return o},Iu:function(){return i},qp:function(){return s}});var r=["D","DD"],a=["YY","YYYY"];function i(e){return-1!==r.indexOf(e)}function o(e){return-1!==a.indexOf(e)}function s(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}},4522:function(e,t,n){"use strict";function r(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return r}})},9853:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=t.getUTCDay(),i=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-i),t.setUTCHours(0,0,0,0),t}},1230:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(8527),a=n(4522),i=n(9297),o=n(4408);function s(e,t){var n,s,u,c,l,h,f,d;(0,a.Z)(1,arguments);var p=(0,o.j)(),v=(0,i.Z)(null!==(n=null!==(s=null!==(u=null!==(c=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==c?c:null===t||void 0===t||null===(l=t.locale)||void 0===l||null===(h=l.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==u?u:p.weekStartsOn)&&void 0!==s?s:null===(f=p.locale)||void 0===f||null===(d=f.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==n?n:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=(0,r.default)(e),m=g.getUTCDay(),y=(m<v?7:0)+m-v;return g.setUTCDate(g.getUTCDate()-y),g.setUTCHours(0,0,0,0),g}},9297:function(e,t,n){"use strict";function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:function(){return r}})},9040:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);return isNaN(o)?new Date(NaN):o?(n.setDate(n.getDate()+o),n):n}},2074:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(9297),a=n(4377),i=n(4522),o=36e5;function s(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.Z)(e,n*o)}},4377:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e).getTime(),o=(0,r.Z)(t);return new Date(n+o)}},1518:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(9297),a=n(4377),i=n(4522),o=6e4;function s(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.Z)(e,n*o)}},1104:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);if(isNaN(o))return new Date(NaN);if(!o)return n;var s=n.getDate(),u=new Date(n.getTime());return u.setMonth(n.getMonth()+o+1,0),s>=u.getDate()?u:(n.setFullYear(u.getFullYear(),u.getMonth(),s),n)}},6689:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(1104),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=3*(0,r.Z)(t);return(0,a.default)(e,n)}},20:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(9040),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=7*(0,r.Z)(t);return(0,a.default)(e,n)}},5105:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(1104),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.default)(e,12*n)}},2729:function(e,t,n){"use strict";n.d(t,{qk:function(){return i},vh:function(){return a},yJ:function(){return r}});Math.pow(10,8);var r=6e4,a=36e5,i=1e3},9759:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(4697),a=n(8347),i=n(4522),o=864e5;function s(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),s=(0,a.default)(t),u=n.getTime()-(0,r.Z)(n),c=s.getTime()-(0,r.Z)(s);return Math.round((u-c)/o)}},5951:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}},7415:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getFullYear()-i.getFullYear()}},786:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e);return t.setHours(23,59,59,999),t}},4888:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}},4565:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(4408),a=n(8527),i=n(9297),o=n(4522);function s(e,t){var n,s,u,c,l,h,f,d;(0,o.Z)(1,arguments);var p=(0,r.j)(),v=(0,i.Z)(null!==(n=null!==(s=null!==(u=null!==(c=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==c?c:null===t||void 0===t||null===(l=t.locale)||void 0===l||null===(h=l.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==u?u:p.weekStartsOn)&&void 0!==s?s:null===(f=p.locale)||void 0===f||null===(d=f.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==n?n:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=(0,a.default)(e),m=g.getDay(),y=6+(m<v?-7:0)-(m-v);return g.setDate(g.getDate()+y),g.setHours(23,59,59,999),g}},4675:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}},1951:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return F}});var r=n(9314),a=n(1633),i=n(8527),o=n(4522);var s=n(9153),u=n(5611),c=n(9934),l=n(9726);function h(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var f={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return h("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):h(n+1,2)},d:function(e,t){return h(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return h(e.getUTCHours()%12||12,t.length)},H:function(e,t){return h(e.getUTCHours(),t.length)},m:function(e,t){return h(e.getUTCMinutes(),t.length)},s:function(e,t){return h(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return h(Math.floor(r*Math.pow(10,n-3)),t.length)}},d="midnight",p="noon",v="morning",g="afternoon",m="evening",y="night",b={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return f.y(e,t)},Y:function(e,t,n,r){var a=(0,l.Z)(e,r),i=a>0?a:1-a;return"YY"===t?h(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):h(i,t.length)},R:function(e,t){return h((0,u.Z)(e),t.length)},u:function(e,t){return h(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return h(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return h(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return f.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return h(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var a=(0,c.Z)(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):h(a,t.length)},I:function(e,t,n){var r=(0,s.Z)(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):h(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):f.d(e,t)},D:function(e,t,n){var r=function(e){(0,o.Z)(1,arguments);var t=(0,i.default)(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):h(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var a=e.getUTCDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return h(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var a=e.getUTCDay(),i=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return h(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return h(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,a=e.getUTCHours();switch(r=12===a?p:0===a?d:a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,a=e.getUTCHours();switch(r=a>=17?m:a>=12?g:a>=4?v:y,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return f.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):f.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):h(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):h(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):f.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):f.s(e,t)},S:function(e,t){return f.S(e,t)},X:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return x(a);case"XXXX":case"XX":return w(a);default:return w(a,":")}},x:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return x(a);case"xxxx":case"xx":return w(a);default:return w(a,":")}},O:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+k(a,":");default:return"GMT"+w(a,":")}},z:function(e,t,n,r){var a=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+k(a,":");default:return"GMT"+w(a,":")}},t:function(e,t,n,r){var a=r._originalDate||e;return h(Math.floor(a.getTime()/1e3),t.length)},T:function(e,t,n,r){return h((r._originalDate||e).getTime(),t.length)}};function k(e,t){var n=e>0?"-":"+",r=Math.abs(e),a=Math.floor(r/60),i=r%60;if(0===i)return n+String(a);var o=t||"";return n+String(a)+o+h(i,2)}function x(e,t){return e%60===0?(e>0?"-":"+")+h(Math.abs(e)/60,2):w(e,t)}function w(e,t){var n=t||"",r=e>0?"-":"+",a=Math.abs(e);return r+h(Math.floor(a/60),2)+n+h(a%60,2)}var I=b,S=n(3462),C=n(4697),_=n(8552),T=n(9297),E=n(4408),N=n(6674),D=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,A=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,R=/^'([^]*?)'?$/,M=/''/g,O=/[a-zA-Z]/;function F(e,t,n){var s,u,c,l,h,f,d,p,v,g,m,y,b,k,x,w,F,P;(0,o.Z)(2,arguments);var L=String(t),Z=(0,E.j)(),z=null!==(s=null!==(u=null===n||void 0===n?void 0:n.locale)&&void 0!==u?u:Z.locale)&&void 0!==s?s:N.Z,B=(0,T.Z)(null!==(c=null!==(l=null!==(h=null!==(f=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==f?f:null===n||void 0===n||null===(d=n.locale)||void 0===d||null===(p=d.options)||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==h?h:Z.firstWeekContainsDate)&&void 0!==l?l:null===(v=Z.locale)||void 0===v||null===(g=v.options)||void 0===g?void 0:g.firstWeekContainsDate)&&void 0!==c?c:1);if(!(B>=1&&B<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var U=(0,T.Z)(null!==(m=null!==(y=null!==(b=null!==(k=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==k?k:null===n||void 0===n||null===(x=n.locale)||void 0===x||null===(w=x.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==b?b:Z.weekStartsOn)&&void 0!==y?y:null===(F=Z.locale)||void 0===F||null===(P=F.options)||void 0===P?void 0:P.weekStartsOn)&&void 0!==m?m:0);if(!(U>=0&&U<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!z.localize)throw new RangeError("locale must contain localize property");if(!z.formatLong)throw new RangeError("locale must contain formatLong property");var V=(0,i.default)(e);if(!(0,r.default)(V))throw new RangeError("Invalid time value");var j=(0,C.Z)(V),W=(0,a.Z)(V,j),H={firstWeekContainsDate:B,weekStartsOn:U,locale:z,_originalDate:V};return L.match(A).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,S.Z[t])(e,z.formatLong):e})).join("").match(D).map((function(r){if("''"===r)return"'";var a=r[0];if("'"===a)return function(e){var t=e.match(R);if(!t)return e;return t[1].replace(M,"'")}(r);var i=I[a];if(i)return null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!(0,_.Do)(r)||(0,_.qp)(r,t,String(e)),null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!(0,_.Iu)(r)||(0,_.qp)(r,t,String(e)),i(W,r,z.localize,H);if(a.match(O))throw new RangeError("Format string contains an unescaped latin alphabet character `"+a+"`");return r})).join("")}},6114:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getDate()}},467:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getDay()}},1537:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getHours()}},6975:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(8527),a=n(3629),i=n(4522);function o(e){return(0,i.Z)(1,arguments),(0,a.default)(e,{weekStartsOn:1})}function s(e){(0,i.Z)(1,arguments);var t=function(e){(0,i.Z)(1,arguments);var t=(0,r.default)(e),n=t.getFullYear(),a=new Date(0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);var s=o(a),u=new Date(0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);var c=o(u);return t.getTime()>=s.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),o(n)}var u=6048e5;function c(e){(0,i.Z)(1,arguments);var t=(0,r.default)(e),n=o(t).getTime()-s(t).getTime();return Math.round(n/u)+1}},4424:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getMinutes()}},3747:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getMonth()}},639:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e);return Math.floor(t.getMonth()/3)+1}},2295:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getSeconds()}},4460:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getTime()}},2599:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){return(0,a.Z)(1,arguments),(0,r.default)(e).getFullYear()}},9420:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getTime()>i.getTime()}},9579:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getTime()<i.getTime()}},6971:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(1002),a=n(4522);function i(e){return(0,a.Z)(1,arguments),e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===Object.prototype.toString.call(e)}},7508:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getTime()===i.getTime()}},4690:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8347),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getTime()===i.getTime()}},5375:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}},4845:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(3006),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getTime()===i.getTime()}},1750:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e),i=(0,r.default)(t);return n.getFullYear()===i.getFullYear()}},9314:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(6971),a=n(8527),i=n(4522);function o(e){if((0,i.Z)(1,arguments),!(0,r.default)(e)&&"number"!==typeof e)return!1;var t=(0,a.default)(e);return!isNaN(Number(t))}},7262:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e,t){(0,a.Z)(2,arguments);var n=(0,r.default)(e).getTime(),i=(0,r.default)(t.start).getTime(),o=(0,r.default)(t.end).getTime();if(!(i<=o))throw new RangeError("Invalid interval");return n>=i&&n<=o}},9333:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(1002),a=n(8527),i=n(4522);function o(e){var t,n;if((0,i.Z)(1,arguments),e&&"function"===typeof e.forEach)t=e;else{if("object"!==(0,r.Z)(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=(0,a.default)(e);(void 0===n||n<t||isNaN(Number(t)))&&(n=t)})),n||new Date(NaN)}},1056:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(1002),a=n(8527),i=n(4522);function o(e){var t,n;if((0,i.Z)(1,arguments),e&&"function"===typeof e.forEach)t=e;else{if("object"!==(0,r.Z)(e)||null===e)return new Date(NaN);t=Array.prototype.slice.call(e)}return t.forEach((function(e){var t=(0,a.default)(e);(void 0===n||n>t||isNaN(t.getDate()))&&(n=t)})),n||new Date(NaN)}},9831:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(2729),a=n(4522),i=n(9297);function o(e,t){var n;(0,a.Z)(1,arguments);var o=(0,i.Z)(null!==(n=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==n?n:2);if(2!==o&&1!==o&&0!==o)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var v,g=function(e){var t,n={},r=e.split(s.dateTimeDelimiter);if(r.length>2)return n;/:/.test(r[0])?t=r[0]:(n.date=r[0],t=r[1],s.timeZoneDelimiter.test(n.date)&&(n.date=e.split(s.timeZoneDelimiter)[0],t=e.substr(n.date.length,e.length)));if(t){var a=s.timezone.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e);if(g.date){var m=function(e,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};var a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:null===i?a:100*i,restDateString:e.slice((r[1]||r[2]).length)}}(g.date,o);v=function(e,t){if(null===t)return new Date(NaN);var n=e.match(u);if(!n)return new Date(NaN);var r=!!n[4],a=h(n[1]),i=h(n[2])-1,o=h(n[3]),s=h(n[4]),c=h(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,s,c)?function(e,t,n){var r=new Date(0);r.setUTCFullYear(e,0,4);var a=r.getUTCDay()||7,i=7*(t-1)+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}(t,s,c):new Date(NaN);var l=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(d[t]||(p(e)?29:28))}(t,i,o)&&function(e,t){return t>=1&&t<=(p(e)?366:365)}(t,a)?(l.setUTCFullYear(t,i,Math.max(a,o)),l):new Date(NaN)}(m.restDateString,m.year)}if(!v||isNaN(v.getTime()))return new Date(NaN);var y,b=v.getTime(),k=0;if(g.time&&(k=function(e){var t=e.match(c);if(!t)return NaN;var n=f(t[1]),a=f(t[2]),i=f(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,a,i))return NaN;return n*r.vh+a*r.yJ+1e3*i}(g.time),isNaN(k)))return new Date(NaN);if(!g.timezone){var x=new Date(b+k),w=new Date(0);return w.setFullYear(x.getUTCFullYear(),x.getUTCMonth(),x.getUTCDate()),w.setHours(x.getUTCHours(),x.getUTCMinutes(),x.getUTCSeconds(),x.getUTCMilliseconds()),w}return y=function(e){if("Z"===e)return 0;var t=e.match(l);if(!t)return 0;var n="+"===t[1]?-1:1,a=parseInt(t[2]),i=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,i))return NaN;return n*(a*r.vh+i*r.yJ)}(g.timezone),isNaN(y)?new Date(NaN):new Date(b+k+y)}var s={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},u=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,c=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,l=/^([+-])(\d{2})(?::?(\d{2}))?$/;function h(e){return e?parseInt(e):1}function f(e){return e&&parseFloat(e.replace(",","."))||0}var d=[31,null,31,30,31,30,31,31,30,31,30,31];function p(e){return e%400===0||e%4===0&&e%100!==0}},3216:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Qe}});var r=n(1002),a=n(7762),i=n(6674),o=n(1633),s=n(8527);function u(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var c=n(3462),l=n(4697),h=n(8552),f=n(9297),d=n(4522),p=n(7326),v=n(136),g=n(7277),m=n(5671),y=n(3144),b=n(4942),k=function(){function e(){(0,m.Z)(this,e),(0,b.Z)(this,"priority",void 0),(0,b.Z)(this,"subPriority",0)}return(0,y.Z)(e,[{key:"validate",value:function(e,t){return!0}}]),e}(),x=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i,o){var s;return(0,m.Z)(this,n),(s=t.call(this)).value=e,s.validateValue=r,s.setValue=a,s.priority=i,o&&(s.subPriority=o),s}return(0,y.Z)(n,[{key:"validate",value:function(e,t){return this.validateValue(e,this.value,t)}},{key:"set",value:function(e,t,n){return this.setValue(e,t,this.value,n)}}]),n}(k),w=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",10),(0,b.Z)((0,p.Z)(e),"subPriority",-1),e}return(0,y.Z)(n,[{key:"set",value:function(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}}]),n}(k),I=function(){function e(){(0,m.Z)(this,e),(0,b.Z)(this,"incompatibleTokens",void 0),(0,b.Z)(this,"priority",void 0),(0,b.Z)(this,"subPriority",void 0)}return(0,y.Z)(e,[{key:"run",value:function(e,t,n,r){var a=this.parse(e,t,n,r);return a?{setter:new x(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}},{key:"validate",value:function(e,t,n){return!0}}]),e}(),S=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",140),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["R","u","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}},{key:"set",value:function(e,t,n){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(I),C=n(2729),_=/^(1[0-2]|0?\d)/,T=/^(3[0-1]|[0-2]?\d)/,E=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,N=/^(5[0-3]|[0-4]?\d)/,D=/^(2[0-3]|[0-1]?\d)/,A=/^(2[0-4]|[0-1]?\d)/,R=/^(1[0-1]|0?\d)/,M=/^(1[0-2]|0?\d)/,O=/^[0-5]?\d/,F=/^[0-5]?\d/,P=/^\d/,L=/^\d{1,2}/,Z=/^\d{1,3}/,z=/^\d{1,4}/,B=/^-?\d+/,U=/^-?\d/,V=/^-?\d{1,2}/,j=/^-?\d{1,3}/,W=/^-?\d{1,4}/,H=/^([+-])(\d{2})(\d{2})?|Z/,G=/^([+-])(\d{2})(\d{2})|Z/,q=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,K=/^([+-])(\d{2}):(\d{2})|Z/,Y=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function X(e,t){return e?{value:t(e.value),rest:e.rest}:e}function Q(e,t){var n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function J(e,t){var n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};var r="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:r*(a*C.vh+i*C.yJ+o*C.qk),rest:t.slice(n[0].length)}}function $(e){return Q(B,e)}function ee(e,t){switch(e){case 1:return Q(P,t);case 2:return Q(L,t);case 3:return Q(Z,t);case 4:return Q(z,t);default:return Q(new RegExp("^\\d{1,"+e+"}"),t)}}function te(e,t){switch(e){case 1:return Q(U,t);case 2:return Q(V,t);case 3:return Q(j,t);case 4:return Q(W,t);default:return Q(new RegExp("^-?\\d{1,"+e+"}"),t)}}function ne(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function re(e,t){var n,r=t>0,a=r?t:1-t;if(a<=50)n=e||100;else{var i=a+50;n=e+100*Math.floor(i/100)-(e>=i%100?100:0)}return r?n:1-n}function ae(e){return e%400===0||e%4===0&&e%100!==0}var ie=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",130),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return X(ee(4,e),r);case"yo":return X(n.ordinalNumber(e,{unit:"year"}),r);default:return X(ee(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n){var r=e.getUTCFullYear();if(n.isTwoDigitYear){var a=re(n.year,r);return e.setUTCFullYear(a,0,1),e.setUTCHours(0,0,0,0),e}var i="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(i,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(I),oe=n(9726),se=n(1230),ue=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",130),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return X(ee(4,e),r);case"Yo":return X(n.ordinalNumber(e,{unit:"year"}),r);default:return X(ee(t.length,e),r)}}},{key:"validate",value:function(e,t){return t.isTwoDigitYear||t.year>0}},{key:"set",value:function(e,t,n,r){var a=(0,oe.Z)(e,r);if(n.isTwoDigitYear){var i=re(n.year,a);return e.setUTCFullYear(i,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),(0,se.Z)(e,r)}var o="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(o,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),(0,se.Z)(e,r)}}]),n}(I),ce=n(9853),le=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",130),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t){return te("R"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){var r=new Date(0);return r.setUTCFullYear(n,0,4),r.setUTCHours(0,0,0,0),(0,ce.Z)(r)}}]),n}(I),he=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",130),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t){return te("u"===t?4:t.length,e)}},{key:"set",value:function(e,t,n){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e}}]),n}(I),fe=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",120),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"Q":case"QQ":return ee(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(I),de=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",120),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"q":case"qq":return ee(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=1&&t<=4}},{key:"set",value:function(e,t,n){return e.setUTCMonth(3*(n-1),1),e.setUTCHours(0,0,0,0),e}}]),n}(I),pe=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),(0,b.Z)((0,p.Z)(e),"priority",110),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"M":return X(Q(_,e),r);case"MM":return X(ee(2,e),r);case"Mo":return X(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(I),ve=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",110),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return e-1};switch(t){case"L":return X(Q(_,e),r);case"LL":return X(ee(2,e),r);case"Lo":return X(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e}}]),n}(I),ge=n(9934);var me=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",100),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"w":return Q(N,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n,r){return(0,se.Z)(function(e,t,n){(0,d.Z)(2,arguments);var r=(0,s.default)(e),a=(0,f.Z)(t),i=(0,ge.Z)(r,n)-a;return r.setUTCDate(r.getUTCDate()-7*i),r}(e,n,r),r)}}]),n}(I),ye=n(9153);var be=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",100),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"I":return Q(N,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=53}},{key:"set",value:function(e,t,n){return(0,ce.Z)(function(e,t){(0,d.Z)(2,arguments);var n=(0,s.default)(e),r=(0,f.Z)(t),a=(0,ye.Z)(n)-r;return n.setUTCDate(n.getUTCDate()-7*a),n}(e,n))}}]),n}(I),ke=[31,28,31,30,31,30,31,31,30,31,30,31],xe=[31,29,31,30,31,30,31,31,30,31,30,31],we=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"subPriority",1),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"d":return Q(T,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){var n=ae(e.getUTCFullYear()),r=e.getUTCMonth();return n?t>=1&&t<=xe[r]:t>=1&&t<=ke[r]}},{key:"set",value:function(e,t,n){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e}}]),n}(I),Ie=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"subpriority",1),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"D":case"DD":return Q(E,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return ae(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365}},{key:"set",value:function(e,t,n){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e}}]),n}(I),Se=n(4408);function Ce(e,t,n){var r,a,i,o,u,c,l,h;(0,d.Z)(2,arguments);var p=(0,Se.j)(),v=(0,f.Z)(null!==(r=null!==(a=null!==(i=null!==(o=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==o?o:null===n||void 0===n||null===(u=n.locale)||void 0===u||null===(c=u.options)||void 0===c?void 0:c.weekStartsOn)&&void 0!==i?i:p.weekStartsOn)&&void 0!==a?a:null===(l=p.locale)||void 0===l||null===(h=l.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==r?r:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=(0,s.default)(e),m=(0,f.Z)(t),y=((m%7+7)%7<v?7:0)+m-g.getUTCDay();return g.setUTCDate(g.getUTCDate()+y),g}var _e=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["D","i","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(I),Te=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n,r){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return X(ee(t.length,e),a);case"eo":return X(n.ordinalNumber(e,{unit:"day"}),a);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(I),Ee=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n,r){var a=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return X(ee(t.length,e),a);case"co":return X(n.ordinalNumber(e,{unit:"day"}),a);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(e,t){return t>=0&&t<=6}},{key:"set",value:function(e,t,n,r){return(e=Ce(e,n,r)).setUTCHours(0,0,0,0),e}}]),n}(I);var Ne=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",90),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){var r=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return ee(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return X(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return X(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return X(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return X(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}},{key:"validate",value:function(e,t){return t>=1&&t<=7}},{key:"set",value:function(e,t,n){return e=function(e,t){(0,d.Z)(2,arguments);var n=(0,f.Z)(t);n%7===0&&(n-=7);var r=(0,s.default)(e),a=((n%7+7)%7<1?7:0)+n-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+a),r}(e,n),e.setUTCHours(0,0,0,0),e}}]),n}(I),De=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",80),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["b","B","H","k","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(ne(n),0,0,0),e}}]),n}(I),Ae=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",80),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["a","B","H","k","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(ne(n),0,0,0),e}}]),n}(I),Re=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",80),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["a","b","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(e,t,n){return e.setUTCHours(ne(n),0,0,0),e}}]),n}(I),Me=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",70),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["H","K","k","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"h":return Q(M,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=12}},{key:"set",value:function(e,t,n){var r=e.getUTCHours()>=12;return r&&n<12?e.setUTCHours(n+12,0,0,0):r||12!==n?e.setUTCHours(n,0,0,0):e.setUTCHours(0,0,0,0),e}}]),n}(I),Oe=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",70),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["a","b","h","K","k","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"H":return Q(D,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=23}},{key:"set",value:function(e,t,n){return e.setUTCHours(n,0,0,0),e}}]),n}(I),Fe=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",70),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["h","H","k","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"K":return Q(R,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=11}},{key:"set",value:function(e,t,n){return e.getUTCHours()>=12&&n<12?e.setUTCHours(n+12,0,0,0):e.setUTCHours(n,0,0,0),e}}]),n}(I),Pe=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",70),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["a","b","h","H","K","t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"k":return Q(A,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=1&&t<=24}},{key:"set",value:function(e,t,n){var r=n<=24?n%24:n;return e.setUTCHours(r,0,0,0),e}}]),n}(I),Le=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",60),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"m":return Q(O,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCMinutes(n,0,0),e}}]),n}(I),Ze=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",50),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t,n){switch(t){case"s":return Q(F,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return ee(t.length,e)}}},{key:"validate",value:function(e,t){return t>=0&&t<=59}},{key:"set",value:function(e,t,n){return e.setUTCSeconds(n,0),e}}]),n}(I),ze=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",30),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["t","T"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t){return X(ee(t.length,e),(function(e){return Math.floor(e*Math.pow(10,3-t.length))}))}},{key:"set",value:function(e,t,n){return e.setUTCMilliseconds(n),e}}]),n}(I),Be=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",10),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["t","T","x"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t){switch(t){case"X":return J(H,e);case"XX":return J(G,e);case"XXXX":return J(q,e);case"XXXXX":return J(Y,e);default:return J(K,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(I),Ue=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",10),(0,b.Z)((0,p.Z)(e),"incompatibleTokens",["t","T","X"]),e}return(0,y.Z)(n,[{key:"parse",value:function(e,t){switch(t){case"x":return J(H,e);case"xx":return J(G,e);case"xxxx":return J(q,e);case"xxxxx":return J(Y,e);default:return J(K,e)}}},{key:"set",value:function(e,t,n){return t.timestampIsSet?e:new Date(e.getTime()-n)}}]),n}(I),Ve=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",40),(0,b.Z)((0,p.Z)(e),"incompatibleTokens","*"),e}return(0,y.Z)(n,[{key:"parse",value:function(e){return $(e)}},{key:"set",value:function(e,t,n){return[new Date(1e3*n),{timestampIsSet:!0}]}}]),n}(I),je=function(e){(0,v.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),(0,b.Z)((0,p.Z)(e),"priority",20),(0,b.Z)((0,p.Z)(e),"incompatibleTokens","*"),e}return(0,y.Z)(n,[{key:"parse",value:function(e){return $(e)}},{key:"set",value:function(e,t,n){return[new Date(n),{timestampIsSet:!0}]}}]),n}(I),We={G:new S,y:new ie,Y:new ue,R:new le,u:new he,Q:new fe,q:new de,M:new pe,L:new ve,w:new me,I:new be,d:new we,D:new Ie,E:new _e,e:new Te,c:new Ee,i:new Ne,a:new De,b:new Ae,B:new Re,h:new Me,H:new Oe,K:new Fe,k:new Pe,m:new Le,s:new Ze,S:new ze,X:new Be,x:new Ue,t:new Ve,T:new je},He=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ge=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qe=/^'([^]*?)'?$/,Ke=/''/g,Ye=/\S/,Xe=/[a-zA-Z]/;function Qe(e,t,n,p){var v,g,m,y,b,k,x,I,S,C,_,T,E,N,D,A,R,M;(0,d.Z)(3,arguments);var O=String(e),F=String(t),P=(0,Se.j)(),L=null!==(v=null!==(g=null===p||void 0===p?void 0:p.locale)&&void 0!==g?g:P.locale)&&void 0!==v?v:i.Z;if(!L.match)throw new RangeError("locale must contain match property");var Z=(0,f.Z)(null!==(m=null!==(y=null!==(b=null!==(k=null===p||void 0===p?void 0:p.firstWeekContainsDate)&&void 0!==k?k:null===p||void 0===p||null===(x=p.locale)||void 0===x||null===(I=x.options)||void 0===I?void 0:I.firstWeekContainsDate)&&void 0!==b?b:P.firstWeekContainsDate)&&void 0!==y?y:null===(S=P.locale)||void 0===S||null===(C=S.options)||void 0===C?void 0:C.firstWeekContainsDate)&&void 0!==m?m:1);if(!(Z>=1&&Z<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var z=(0,f.Z)(null!==(_=null!==(T=null!==(E=null!==(N=null===p||void 0===p?void 0:p.weekStartsOn)&&void 0!==N?N:null===p||void 0===p||null===(D=p.locale)||void 0===D||null===(A=D.options)||void 0===A?void 0:A.weekStartsOn)&&void 0!==E?E:P.weekStartsOn)&&void 0!==T?T:null===(R=P.locale)||void 0===R||null===(M=R.options)||void 0===M?void 0:M.weekStartsOn)&&void 0!==_?_:0);if(!(z>=0&&z<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===F)return""===O?(0,s.default)(n):new Date(NaN);var B,U={firstWeekContainsDate:Z,weekStartsOn:z,locale:L},V=[new w],j=F.match(Ge).map((function(e){var t=e[0];return t in c.Z?(0,c.Z[t])(e,L.formatLong):e})).join("").match(He),W=[],H=(0,a.Z)(j);try{var G=function(){var t=B.value;null!==p&&void 0!==p&&p.useAdditionalWeekYearTokens||!(0,h.Do)(t)||(0,h.qp)(t,F,e),null!==p&&void 0!==p&&p.useAdditionalDayOfYearTokens||!(0,h.Iu)(t)||(0,h.qp)(t,F,e);var n=t[0],r=We[n];if(r){var a=r.incompatibleTokens;if(Array.isArray(a)){var i=W.find((function(e){return a.includes(e.token)||e.token===n}));if(i)throw new RangeError("The format string mustn't contain `".concat(i.fullToken,"` and `").concat(t,"` at the same time"))}else if("*"===r.incompatibleTokens&&W.length>0)throw new RangeError("The format string mustn't contain `".concat(t,"` and any other token at the same time"));W.push({token:n,fullToken:t});var o=r.run(O,t,L.match,U);if(!o)return{v:new Date(NaN)};V.push(o.setter),O=o.rest}else{if(n.match(Xe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===t?t="'":"'"===n&&(t=t.match(qe)[1].replace(Ke,"'")),0!==O.indexOf(t))return{v:new Date(NaN)};O=O.slice(t.length)}};for(H.s();!(B=H.n()).done;){var q=G();if("object"===(0,r.Z)(q))return q.v}}catch(ne){H.e(ne)}finally{H.f()}if(O.length>0&&Ye.test(O))return new Date(NaN);var K=V.map((function(e){return e.priority})).sort((function(e,t){return t-e})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return V.filter((function(t){return t.priority===e})).sort((function(e,t){return t.subPriority-e.subPriority}))})).map((function(e){return e[0]})),Y=(0,s.default)(n);if(isNaN(Y.getTime()))return new Date(NaN);var X,Q=(0,o.Z)(Y,(0,l.Z)(Y)),J={},$=(0,a.Z)(K);try{for($.s();!(X=$.n()).done;){var ee=X.value;if(!ee.validate(Q,U))return new Date(NaN);var te=ee.set(Q,J,U);Array.isArray(te)?(Q=te[0],u(J,te[1])):Q=te}}catch(ne){$.e(ne)}finally{$.f()}return Q}},2618:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);return n.setHours(o),n}},7227:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);return n.setMinutes(o),n}},2363:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t),s=n.getFullYear(),u=n.getDate(),c=new Date(0);c.setFullYear(s,o,15),c.setHours(0,0,0,0);var l=function(e){(0,i.Z)(1,arguments);var t=(0,a.default)(e),n=t.getFullYear(),r=t.getMonth(),o=new Date(0);return o.setFullYear(n,r+1,0),o.setHours(0,0,0,0),o.getDate()}(c);return n.setMonth(o,Math.min(u,l)),n}},5765:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(9297),a=n(8527),i=n(2363),o=n(4522);function s(e,t){(0,o.Z)(2,arguments);var n=(0,a.default)(e),s=(0,r.Z)(t)-(Math.floor(n.getMonth()/3)+1);return(0,i.default)(n,n.getMonth()+3*s)}},9292:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);return n.setSeconds(o),n}},5617:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(8527),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,a.default)(e),o=(0,r.Z)(t);return isNaN(n.getTime())?new Date(NaN):(n.setFullYear(o),n)}},7152:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var r=n(1002),a=n(8527),i=n(2363),o=n(9297),s=n(4522);function u(e,t){if((0,s.Z)(2,arguments),"object"!==(0,r.Z)(t)||null===t)throw new RangeError("values parameter must be an object");var n=(0,a.default)(e);return isNaN(n.getTime())?new Date(NaN):(null!=t.year&&n.setFullYear(t.year),null!=t.month&&(n=(0,i.default)(n,t.month)),null!=t.date&&n.setDate((0,o.Z)(t.date)),null!=t.hours&&n.setHours((0,o.Z)(t.hours)),null!=t.minutes&&n.setMinutes((0,o.Z)(t.minutes)),null!=t.seconds&&n.setSeconds((0,o.Z)(t.seconds)),null!=t.milliseconds&&n.setMilliseconds((0,o.Z)(t.milliseconds)),n)}},8347:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e);return t.setHours(0,0,0,0),t}},5719:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e);return t.setDate(1),t.setHours(0,0,0,0),t}},3006:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=t.getMonth(),i=n-n%3;return t.setMonth(i,1),t.setHours(0,0,0,0),t}},3629:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(8527),a=n(9297),i=n(4522),o=n(4408);function s(e,t){var n,s,u,c,l,h,f,d;(0,i.Z)(1,arguments);var p=(0,o.j)(),v=(0,a.Z)(null!==(n=null!==(s=null!==(u=null!==(c=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==c?c:null===t||void 0===t||null===(l=t.locale)||void 0===l||null===(h=l.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==u?u:p.weekStartsOn)&&void 0!==s?s:null===(f=p.locale)||void 0===f||null===(d=f.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==n?n:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=(0,r.default)(e),m=g.getDay(),y=(m<v?7:0)+m-v;return g.setDate(g.getDate()-y),g.setHours(0,0,0,0),g}},7235:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(8527),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=(0,r.default)(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},6753:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9040),a=n(4522),i=n(9297);function o(e,t){(0,a.Z)(2,arguments);var n=(0,i.Z)(t);return(0,r.default)(e,-n)}},1633:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(4377),a=n(4522),i=n(9297);function o(e,t){(0,a.Z)(2,arguments);var n=(0,i.Z)(t);return(0,r.Z)(e,-n)}},8030:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(1104),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.default)(e,-n)}},6794:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(6689),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.default)(e,-n)}},7503:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(20),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.default)(e,-n)}},7602:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(9297),a=n(5105),i=n(4522);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(t);return(0,a.default)(e,-n)}},8527:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(1002),a=n(4522);function i(e){(0,a.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"===typeof e||"[object Number]"===t?new Date(e):("string"!==typeof e&&"[object String]"!==t||"undefined"===typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},8987:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function s(e,t){if(isNaN(e))return t?m:g;if(t){if(e<0)return m;if(e>=d)return w}else{if(e<=-p)return I;if(e+1>=p)return x}return e<0?s(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=s(c(n,8)),i=g,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),h=parseInt(e.substring(o,o+u),n);if(u<8){var f=s(c(n,u));i=i.mul(f).add(s(h))}else i=(i=i.mul(a)).add(s(h))}return i.unsigned=t,i}function h(e,t){return"number"===typeof e?s(e,t):"string"===typeof e?l(e,t):u(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=h;var f=4294967296,d=f*f,p=d/2,v=o(1<<24),g=o(0);n.ZERO=g;var m=o(0,!0);n.UZERO=m;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var k=o(-1);n.NEG_ONE=k;var x=u(-1,2147483647,!1);n.MAX_VALUE=x;var w=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var I=u(0,-2147483648,!1);n.MIN_VALUE=I;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=s(c(e,6),this.unsigned),i=this,o="";;){var u=i.div(a),l=(i.sub(u.mul(a)).toInt()>>>0).toString(e);if((i=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(e){return r(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(y)},S.neg=S.negate,S.add=function(e){r(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,l=0,f=0,d=0,p=0;return d+=(p+=i+(65535&e.low))>>>16,f+=(d+=a+c)>>>16,l+=(f+=n+s)>>>16,l+=t+o,u((d&=65535)<<16|(p&=65535),(l&=65535)<<16|(f&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=h(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=h(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(I))return e.isOdd()?I:g;if(e.eq(I))return this.isOdd()?I:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,f=e.low>>>16,d=65535&e.low,p=0,m=0,y=0,b=0;return y+=(b+=o*d)>>>16,m+=(y+=i*d)>>>16,y&=65535,m+=(y+=o*f)>>>16,p+=(m+=a*d)>>>16,m&=65535,p+=(m+=i*f)>>>16,m&=65535,p+=(m+=o*l)>>>16,p+=n*d+a*f+i*l+o*c,u((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(m&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=h(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return b;i=m}else{if(this.eq(I))return e.eq(y)||e.eq(k)?I:e.eq(I)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:k:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(I))return this.unsigned?m:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),f=s(n),d=f.mul(e);d.isNegative()||d.gt(a);)d=(f=s(n-=l,this.unsigned)).mul(e);f.isZero()&&(f=y),i=i.add(f),a=a.sub(d)}return i},S.div=S.divide,S.modulo=function(e){return r(e)||(e=h(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return u(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},9513:function(e,t,n){!function(e,t,n,r,a,i,o,s,u,c,l,h,f,d,p,v,g,m,y,b,k,x,w,I,S,C,_,T,E,N,D,A,R,M,O,F,P,L,Z,z,B,U,V,j,W,H,G,q,K,Y,X,Q,J,$,ee,te,ne,re,ae,ie,oe,se,ue,ce){"use strict";function le(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var he=le(t),fe=le(r),de=le(a),pe=le(i),ve=le(o),ge=le(s),me=le(u),ye=le(c),be=le(l),ke=le(h),xe=le(f),we=le(d),Ie=le(p),Se=le(v),Ce=le(g),_e=le(m),Te=le(y),Ee=le(b),Ne=le(k),De=le(x),Ae=le(w),Re=le(I),Me=le(S),Oe=le(C),Fe=le(_),Pe=le(T),Le=le(E),Ze=le(N),ze=le(D),Be=le(A),Ue=le(R),Ve=le(M),je=le(O),We=le(F),He=le(P),Ge=le(L),qe=le(Z),Ke=le(z),Ye=le(B),Xe=le(U),Qe=le(V),Je=le(j),$e=le(W),et=le(H),tt=le(q),nt=le(K),rt=le(Y),at=le(X),it=le(Q),ot=le(J),st=le($),ut=le(ee),ct=le(te),lt=le(ne),ht=le(re),ft=le(ae),dt=le(ie),pt=le(oe),vt=le(se),gt=le(ce);function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){It(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rt(r.key),r)}}function wt(e,t,n){return t&&xt(e.prototype,t),n&&xt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function It(e,t,n){return(t=Rt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function St(){return St=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},St.apply(this,arguments)}function Ct(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tt(e,t)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}function Tt(e,t){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tt(e,t)}function Et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_t(e);if(t){var a=_t(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Et(e)}(this,n)}}function Dt(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rt(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var Mt=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Ot=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Ft={p:Ot,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],a=r[1],i=r[2];if(!i)return Mt(e,t);switch(a){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",Mt(a,t)).replace("{{time}}",Ot(i,t))}},Pt=12,Lt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;function Zt(e){var t=e?"string"==typeof e||e instanceof String?dt.default(e):ht.default(e):new Date;return zt(t)?t:null}function zt(e,t){return t=t||new Date("1/1/1000"),pe.default(e)&&!ct.default(e,t)}function Bt(e,t,n){if("en"===n)return ve.default(e,t,{awareOfUnicodeTokens:!0});var r=tn(n);return n&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),!r&&en()&&tn(en())&&(r=tn(en())),ve.default(e,t,{locale:r||null,awareOfUnicodeTokens:!0})}function Ut(e,t){var n=t.dateFormat,r=t.locale;return e&&Bt(e,Array.isArray(n)?n[0]:n,r)||""}function Vt(e,t){var n=t.hour,r=void 0===n?0:n,a=t.minute,i=void 0===a?0:a,o=t.second,s=void 0===o?0:o;return Be.default(ze.default(Ze.default(e,s),i),r)}function jt(e,t,n){var r=tn(t||en());return Xe.default(e,{locale:r,weekStartsOn:n})}function Wt(e){return Qe.default(e)}function Ht(e){return $e.default(e)}function Gt(e){return Je.default(e)}function qt(){return Ye.default(Zt())}function Kt(e,t){return e&&t?ot.default(e,t):!e&&!t}function Yt(e,t){return e&&t?it.default(e,t):!e&&!t}function Xt(e,t){return e&&t?st.default(e,t):!e&&!t}function Qt(e,t){return e&&t?at.default(e,t):!e&&!t}function Jt(e,t){return e&&t?rt.default(e,t):!e&&!t}function $t(e,t,n){var r,a=Ye.default(t),i=et.default(n);try{r=lt.default(e,{start:a,end:i})}catch(e){r=!1}return r}function en(){return("undefined"!=typeof window?window:globalThis).__localeId__}function tn(e){if("string"==typeof e){var t="undefined"!=typeof window?window:globalThis;return t.__localeData__?t.__localeData__[e]:null}return e}function nn(e,t){return Bt(Ue.default(Zt(),e),"LLLL",t)}function rn(e,t){return Bt(Ue.default(Zt(),e),"LLL",t)}function an(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,a=t.excludeDates,i=t.excludeDateIntervals,o=t.includeDates,s=t.includeDateIntervals,u=t.filterDate;return dn(e,{minDate:n,maxDate:r})||a&&a.some((function(t){return Qt(e,t)}))||i&&i.some((function(t){var n=t.start,r=t.end;return lt.default(e,{start:n,end:r})}))||o&&!o.some((function(t){return Qt(e,t)}))||s&&!s.some((function(t){var n=t.start,r=t.end;return lt.default(e,{start:n,end:r})}))||u&&!u(Zt(e))||!1}function on(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excludeDates,r=t.excludeDateIntervals;return r&&r.length>0?r.some((function(t){var n=t.start,r=t.end;return lt.default(e,{start:n,end:r})})):n&&n.some((function(t){return Qt(e,t)}))||!1}function sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,a=t.excludeDates,i=t.includeDates,o=t.filterDate;return dn(e,{minDate:Qe.default(n),maxDate:tt.default(r)})||a&&a.some((function(t){return Yt(e,t)}))||i&&!i.some((function(t){return Yt(e,t)}))||o&&!o(Zt(e))||!1}function un(e,t,n,r){var a=Pe.default(e),i=Oe.default(e),o=Pe.default(t),s=Oe.default(t),u=Pe.default(r);return a===o&&a===u?i<=n&&n<=s:a<o?u===a&&i<=n||u===o&&s>=n||u<o&&u>a:void 0}function cn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,a=t.excludeDates,i=t.includeDates,o=t.filterDate;return dn(e,{minDate:n,maxDate:r})||a&&a.some((function(t){return Xt(e,t)}))||i&&!i.some((function(t){return Xt(e,t)}))||o&&!o(Zt(e))||!1}function ln(e,t,n){if(!pe.default(t)||!pe.default(n))return!1;var r=Pe.default(t),a=Pe.default(n);return r<=e&&a>=e}function hn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate,a=t.excludeDates,i=t.includeDates,o=t.filterDate,s=new Date(e,0,1);return dn(s,{minDate:$e.default(n),maxDate:nt.default(r)})||a&&a.some((function(e){return Kt(s,e)}))||i&&!i.some((function(e){return Kt(s,e)}))||o&&!o(Zt(s))||!1}function fn(e,t,n,r){var a=Pe.default(e),i=Fe.default(e),o=Pe.default(t),s=Fe.default(t),u=Pe.default(r);return a===o&&a===u?i<=n&&n<=s:a<o?u===a&&i<=n||u===o&&s>=n||u<o&&u>a:void 0}function dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.maxDate;return n&&Ge.default(e,n)<0||r&&Ge.default(e,r)>0}function pn(e,t){return t.some((function(t){return De.default(t)===De.default(e)&&Ne.default(t)===Ne.default(e)}))}function vn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.excludeTimes,r=t.includeTimes,a=t.filterTime;return n&&pn(e,n)||r&&!pn(e,r)||a&&!a(e)||!1}function gn(e,t){var n=t.minTime,r=t.maxTime;if(!n||!r)throw new Error("Both minTime and maxTime props required");var a,i=Zt(),o=Be.default(ze.default(i,Ne.default(e)),De.default(e)),s=Be.default(ze.default(i,Ne.default(n)),De.default(n)),u=Be.default(ze.default(i,Ne.default(r)),De.default(r));try{a=!lt.default(o,{start:s,end:u})}catch(e){a=!1}return a}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.includeDates,a=Ce.default(e,1);return n&&qe.default(n,a)>0||r&&r.every((function(e){return qe.default(e,a)>0}))||!1}function yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.includeDates,a=ke.default(e,1);return n&&qe.default(a,n)>0||r&&r.every((function(e){return qe.default(a,e)>0}))||!1}function bn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.includeDates,a=Te.default(e,1);return n&&Ke.default(n,a)>0||r&&r.every((function(e){return Ke.default(e,a)>0}))||!1}function kn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.includeDates,a=we.default(e,1);return n&&Ke.default(a,n)>0||r&&r.every((function(e){return Ke.default(a,e)>0}))||!1}function xn(e){var t=e.minDate,n=e.includeDates;if(n&&t){var r=n.filter((function(e){return Ge.default(e,t)>=0}));return We.default(r)}return n?We.default(n):t}function wn(e){var t=e.maxDate,n=e.includeDates;if(n&&t){var r=n.filter((function(e){return Ge.default(e,t)<=0}));return He.default(r)}return n?He.default(n):t}function In(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"react-datepicker__day--highlighted",n=new Map,r=0,a=e.length;r<a;r++){var i=e[r];if(de.default(i)){var o=Bt(i,"MM.dd.yyyy"),s=n.get(o)||[];s.includes(t)||(s.push(t),n.set(o,s))}else if("object"===bt(i)){var u=Object.keys(i),c=u[0],l=i[u[0]];if("string"==typeof c&&l.constructor===Array)for(var h=0,f=l.length;h<f;h++){var d=Bt(l[h],"MM.dd.yyyy"),p=n.get(d)||[];p.includes(c)||(p.push(c),n.set(d,p))}}}return n}function Sn(e,t,n,r,a){for(var i=a.length,o=[],s=0;s<i;s++){var u=ge.default(me.default(e,De.default(a[s])),Ne.default(a[s])),c=ge.default(e,(n+1)*r);ut.default(u,t)&&ct.default(u,c)&&o.push(a[s])}return o}function Cn(e){return e<10?"0".concat(e):"".concat(e)}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt,n=Math.ceil(Pe.default(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function Tn(e,t,n,r){for(var a=[],i=0;i<2*t+1;i++){var o=e+t-i,s=!0;n&&(s=Pe.default(n)<=o),r&&s&&(s=Pe.default(r)>=o),s&&a.push(o)}return a}var En=function(e){Ct(r,e);var n=Nt(r);function r(e){var a;kt(this,r),It(Et(a=n.call(this,e)),"renderOptions",(function(){var e=a.props.year,t=a.state.yearsList.map((function(t){return he.default.createElement("div",{className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:a.onChange.bind(Et(a),t),"aria-selected":e===t?"true":void 0},e===t?he.default.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",t)})),n=a.props.minDate?Pe.default(a.props.minDate):null,r=a.props.maxDate?Pe.default(a.props.maxDate):null;return r&&a.state.yearsList.find((function(e){return e===r}))||t.unshift(he.default.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:a.incrementYears},he.default.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),n&&a.state.yearsList.find((function(e){return e===n}))||t.push(he.default.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:a.decrementYears},he.default.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t})),It(Et(a),"onChange",(function(e){a.props.onChange(e)})),It(Et(a),"handleClickOutside",(function(){a.props.onCancel()})),It(Et(a),"shiftYears",(function(e){var t=a.state.yearsList.map((function(t){return t+e}));a.setState({yearsList:t})})),It(Et(a),"incrementYears",(function(){return a.shiftYears(1)})),It(Et(a),"decrementYears",(function(){return a.shiftYears(-1)}));var i=e.yearDropdownItemNumber,o=e.scrollableYearDropdown,s=i||(o?10:5);return a.state={yearsList:Tn(a.props.year,s,a.props.minDate,a.props.maxDate)},a.dropdownRef=t.createRef(),a}return wt(r,[{key:"componentDidMount",value:function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find((function(e){return e.ariaSelected})):null;e.scrollTop=n?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}}},{key:"render",value:function(){var e=fe.default({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return he.default.createElement("div",{className:e,ref:this.dropdownRef},this.renderOptions())}}]),r}(he.default.Component),Nn=pt.default(En),Dn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"state",{dropdownVisible:!1}),It(Et(e),"renderSelectOptions",(function(){for(var t=e.props.minDate?Pe.default(e.props.minDate):1900,n=e.props.maxDate?Pe.default(e.props.maxDate):2100,r=[],a=t;a<=n;a++)r.push(he.default.createElement("option",{key:a,value:a},a));return r})),It(Et(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),It(Et(e),"renderSelectMode",(function(){return he.default.createElement("select",{value:e.props.year,className:"react-datepicker__year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),It(Et(e),"renderReadView",(function(t){return he.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(t){return e.toggleDropdown(t)}},he.default.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),he.default.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},e.props.year))})),It(Et(e),"renderDropdown",(function(){return he.default.createElement(Nn,{key:"dropdown",year:e.props.year,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableYearDropdown:e.props.scrollableYearDropdown,yearDropdownItemNumber:e.props.yearDropdownItemNumber})})),It(Et(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n})),It(Et(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.year&&e.props.onChange(t)})),It(Et(e),"toggleDropdown",(function(t){e.setState({dropdownVisible:!e.state.dropdownVisible},(function(){e.props.adjustDateOnChange&&e.handleYearChange(e.props.date,t)}))})),It(Et(e),"handleYearChange",(function(t,n){e.onSelect(t,n),e.setOpen()})),It(Et(e),"onSelect",(function(t,n){e.props.onSelect&&e.props.onSelect(t,n)})),It(Et(e),"setOpen",(function(){e.props.setOpen&&e.props.setOpen(!0)})),e}return wt(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return he.default.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(he.default.Component),An=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"isSelectedMonth",(function(t){return e.props.month===t})),It(Et(e),"renderOptions",(function(){return e.props.monthNames.map((function(t,n){return he.default.createElement("div",{className:e.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:t,onClick:e.onChange.bind(Et(e),n),"aria-selected":e.isSelectedMonth(n)?"true":void 0},e.isSelectedMonth(n)?he.default.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",t)}))})),It(Et(e),"onChange",(function(t){return e.props.onChange(t)})),It(Et(e),"handleClickOutside",(function(){return e.props.onCancel()})),e}return wt(n,[{key:"render",value:function(){return he.default.createElement("div",{className:"react-datepicker__month-dropdown"},this.renderOptions())}}]),n}(he.default.Component),Rn=pt.default(An),Mn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"state",{dropdownVisible:!1}),It(Et(e),"renderSelectOptions",(function(e){return e.map((function(e,t){return he.default.createElement("option",{key:t,value:t},e)}))})),It(Et(e),"renderSelectMode",(function(t){return he.default.createElement("select",{value:e.props.month,className:"react-datepicker__month-select",onChange:function(t){return e.onChange(t.target.value)}},e.renderSelectOptions(t))})),It(Et(e),"renderReadView",(function(t,n){return he.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:e.toggleDropdown},he.default.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),he.default.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[e.props.month]))})),It(Et(e),"renderDropdown",(function(t){return he.default.createElement(Rn,{key:"dropdown",month:e.props.month,monthNames:t,onChange:e.onChange,onCancel:e.toggleDropdown})})),It(Et(e),"renderScrollMode",(function(t){var n=e.state.dropdownVisible,r=[e.renderReadView(!n,t)];return n&&r.unshift(e.renderDropdown(t)),r})),It(Et(e),"onChange",(function(t){e.toggleDropdown(),t!==e.props.month&&e.props.onChange(t)})),It(Et(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return wt(n,[{key:"render",value:function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return rn(e,t.props.locale)}:function(e){return nn(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return he.default.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(he.default.Component);function On(e,t){for(var n=[],r=Wt(e),a=Wt(t);!ut.default(r,a);)n.push(Zt(r)),r=ke.default(r,1);return n}var Fn,Pn=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"renderOptions",(function(){return r.state.monthYearsList.map((function(e){var t=Le.default(e),n=Kt(r.props.date,e)&&Yt(r.props.date,e);return he.default.createElement("div",{className:n?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:t,onClick:r.onChange.bind(Et(r),t),"aria-selected":n?"true":void 0},n?he.default.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",Bt(e,r.props.dateFormat,r.props.locale))}))})),It(Et(r),"onChange",(function(e){return r.props.onChange(e)})),It(Et(r),"handleClickOutside",(function(){r.props.onCancel()})),r.state={monthYearsList:On(r.props.minDate,r.props.maxDate)},r}return wt(n,[{key:"render",value:function(){var e=fe.default({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return he.default.createElement("div",{className:e},this.renderOptions())}}]),n}(he.default.Component),Ln=pt.default(Pn),Zn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"state",{dropdownVisible:!1}),It(Et(e),"renderSelectOptions",(function(){for(var t=Wt(e.props.minDate),n=Wt(e.props.maxDate),r=[];!ut.default(t,n);){var a=Le.default(t);r.push(he.default.createElement("option",{key:a,value:a},Bt(t,e.props.dateFormat,e.props.locale))),t=ke.default(t,1)}return r})),It(Et(e),"onSelectChange",(function(t){e.onChange(t.target.value)})),It(Et(e),"renderSelectMode",(function(){return he.default.createElement("select",{value:Le.default(Wt(e.props.date)),className:"react-datepicker__month-year-select",onChange:e.onSelectChange},e.renderSelectOptions())})),It(Et(e),"renderReadView",(function(t){var n=Bt(e.props.date,e.props.dateFormat,e.props.locale);return he.default.createElement("div",{key:"read",style:{visibility:t?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:function(t){return e.toggleDropdown(t)}},he.default.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),he.default.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))})),It(Et(e),"renderDropdown",(function(){return he.default.createElement(Ln,{key:"dropdown",date:e.props.date,dateFormat:e.props.dateFormat,onChange:e.onChange,onCancel:e.toggleDropdown,minDate:e.props.minDate,maxDate:e.props.maxDate,scrollableMonthYearDropdown:e.props.scrollableMonthYearDropdown,locale:e.props.locale})})),It(Et(e),"renderScrollMode",(function(){var t=e.state.dropdownVisible,n=[e.renderReadView(!t)];return t&&n.unshift(e.renderDropdown()),n})),It(Et(e),"onChange",(function(t){e.toggleDropdown();var n=Zt(parseInt(t));Kt(e.props.date,n)&&Yt(e.props.date,n)||e.props.onChange(n)})),It(Et(e),"toggleDropdown",(function(){return e.setState({dropdownVisible:!e.state.dropdownVisible})})),e}return wt(n,[{key:"render",value:function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return he.default.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)}}]),n}(he.default.Component),zn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"dayEl",he.default.createRef()),It(Et(e),"handleClick",(function(t){!e.isDisabled()&&e.props.onClick&&e.props.onClick(t)})),It(Et(e),"handleMouseEnter",(function(t){!e.isDisabled()&&e.props.onMouseEnter&&e.props.onMouseEnter(t)})),It(Et(e),"handleOnKeyDown",(function(t){" "===t.key&&(t.preventDefault(),t.key="Enter"),e.props.handleOnKeyDown(t)})),It(Et(e),"isSameDay",(function(t){return Qt(e.props.day,t)})),It(Et(e),"isKeyboardSelected",(function(){return!e.props.disabledKeyboardNavigation&&!e.isSameDay(e.props.selected)&&e.isSameDay(e.props.preSelection)})),It(Et(e),"isDisabled",(function(){return an(e.props.day,e.props)})),It(Et(e),"isExcluded",(function(){return on(e.props.day,e.props)})),It(Et(e),"getHighLightedClass",(function(){var t=e.props,n=t.day,r=t.highlightDates;if(!r)return!1;var a=Bt(n,"MM.dd.yyyy");return r.get(a)})),It(Et(e),"isInRange",(function(){var t=e.props,n=t.day,r=t.startDate,a=t.endDate;return!(!r||!a)&&$t(n,r,a)})),It(Et(e),"isInSelectingRange",(function(){var t,n=e.props,r=n.day,a=n.selectsStart,i=n.selectsEnd,o=n.selectsRange,s=n.selectsDisabledDaysInRange,u=n.startDate,c=n.endDate,l=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return!(!(a||i||o)||!l||!s&&e.isDisabled())&&(a&&c&&(ct.default(l,c)||Jt(l,c))?$t(r,l,c):(i&&u&&(ut.default(l,u)||Jt(l,u))||!(!o||!u||c||!ut.default(l,u)&&!Jt(l,u)))&&$t(r,u,l))})),It(Et(e),"isSelectingRangeStart",(function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,r=n.day,a=n.startDate,i=n.selectsStart,o=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return Qt(r,i?o:a)})),It(Et(e),"isSelectingRangeEnd",(function(){var t;if(!e.isInSelectingRange())return!1;var n=e.props,r=n.day,a=n.endDate,i=n.selectsEnd,o=n.selectsRange,s=null!==(t=e.props.selectingDate)&&void 0!==t?t:e.props.preSelection;return Qt(r,i||o?s:a)})),It(Et(e),"isRangeStart",(function(){var t=e.props,n=t.day,r=t.startDate,a=t.endDate;return!(!r||!a)&&Qt(r,n)})),It(Et(e),"isRangeEnd",(function(){var t=e.props,n=t.day,r=t.startDate,a=t.endDate;return!(!r||!a)&&Qt(a,n)})),It(Et(e),"isWeekend",(function(){var t=Ae.default(e.props.day);return 0===t||6===t})),It(Et(e),"isAfterMonth",(function(){return void 0!==e.props.month&&(e.props.month+1)%12===Oe.default(e.props.day)})),It(Et(e),"isBeforeMonth",(function(){return void 0!==e.props.month&&(Oe.default(e.props.day)+1)%12===e.props.month})),It(Et(e),"isCurrentDay",(function(){return e.isSameDay(Zt())})),It(Et(e),"isSelected",(function(){return e.isSameDay(e.props.selected)})),It(Et(e),"getClassNames",(function(t){var n,r=e.props.dayClassName?e.props.dayClassName(t):void 0;return fe.default("react-datepicker__day",r,"react-datepicker__day--"+Bt(e.props.day,"ddd",n),{"react-datepicker__day--disabled":e.isDisabled(),"react-datepicker__day--excluded":e.isExcluded(),"react-datepicker__day--selected":e.isSelected(),"react-datepicker__day--keyboard-selected":e.isKeyboardSelected(),"react-datepicker__day--range-start":e.isRangeStart(),"react-datepicker__day--range-end":e.isRangeEnd(),"react-datepicker__day--in-range":e.isInRange(),"react-datepicker__day--in-selecting-range":e.isInSelectingRange(),"react-datepicker__day--selecting-range-start":e.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":e.isSelectingRangeEnd(),"react-datepicker__day--today":e.isCurrentDay(),"react-datepicker__day--weekend":e.isWeekend(),"react-datepicker__day--outside-month":e.isAfterMonth()||e.isBeforeMonth()},e.getHighLightedClass("react-datepicker__day--highlighted"))})),It(Et(e),"getAriaLabel",(function(){var t=e.props,n=t.day,r=t.ariaLabelPrefixWhenEnabled,a=void 0===r?"Choose":r,i=t.ariaLabelPrefixWhenDisabled,o=void 0===i?"Not available":i,s=e.isDisabled()||e.isExcluded()?o:a;return"".concat(s," ").concat(Bt(n,"PPPP",e.props.locale))})),It(Et(e),"getTabIndex",(function(t,n){var r=t||e.props.selected,a=n||e.props.preSelection;return e.isKeyboardSelected()||e.isSameDay(r)&&Qt(a,r)?0:-1})),It(Et(e),"handleFocusDay",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!1;0===e.getTabIndex()&&!t.isInputFocused&&e.isSameDay(e.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),e.props.inline&&!e.props.shouldFocusDayInline&&(n=!1),e.props.containerRef&&e.props.containerRef.current&&e.props.containerRef.current.contains(document.activeElement)&&document.activeElement.classList.contains("react-datepicker__day")&&(n=!0),e.props.monthShowsDuplicateDaysEnd&&e.isAfterMonth()&&(n=!1),e.props.monthShowsDuplicateDaysStart&&e.isBeforeMonth()&&(n=!1)),n&&e.dayEl.current.focus({preventScroll:!0})})),It(Et(e),"renderDayContents",(function(){return e.props.monthShowsDuplicateDaysEnd&&e.isAfterMonth()||e.props.monthShowsDuplicateDaysStart&&e.isBeforeMonth()?null:e.props.renderDayContents?e.props.renderDayContents(Re.default(e.props.day),e.props.day):Re.default(e.props.day)})),It(Et(e),"render",(function(){return he.default.createElement("div",{ref:e.dayEl,className:e.getClassNames(e.props.day),onKeyDown:e.handleOnKeyDown,onClick:e.handleClick,onMouseEnter:e.handleMouseEnter,tabIndex:e.getTabIndex(),"aria-label":e.getAriaLabel(),role:"option","aria-disabled":e.isDisabled(),"aria-current":e.isCurrentDay()?"date":void 0,"aria-selected":e.isSelected()||e.isInRange()},e.renderDayContents())})),e}return wt(n,[{key:"componentDidMount",value:function(){this.handleFocusDay()}},{key:"componentDidUpdate",value:function(e){this.handleFocusDay(e)}}]),n}(he.default.Component),Bn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"handleClick",(function(t){e.props.onClick&&e.props.onClick(t)})),e}return wt(n,[{key:"render",value:function(){var e=this.props,t=e.weekNumber,n=e.ariaLabelPrefix,r=void 0===n?"week ":n,a={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!e.onClick};return he.default.createElement("div",{className:fe.default(a),"aria-label":"".concat(r," ").concat(this.props.weekNumber),onClick:this.handleClick},t)}}],[{key:"defaultProps",get:function(){return{ariaLabelPrefix:"week "}}}]),n}(he.default.Component),Un=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"handleDayClick",(function(t,n){e.props.onDayClick&&e.props.onDayClick(t,n)})),It(Et(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),It(Et(e),"handleWeekClick",(function(t,n,r){"function"==typeof e.props.onWeekSelect&&e.props.onWeekSelect(t,n,r),e.props.shouldCloseOnSelect&&e.props.setOpen(!1)})),It(Et(e),"formatWeekNumber",(function(t){return e.props.formatWeekNumber?e.props.formatWeekNumber(t):function(e,t){var n=t&&tn(t)||en()&&tn(en());return Me.default(e,n?{locale:n}:null)}(t)})),It(Et(e),"renderDays",(function(){var t=jt(e.props.day,e.props.locale,e.props.calendarStartDay),n=[],r=e.formatWeekNumber(t);if(e.props.showWeekNumber){var a=e.props.onWeekSelect?e.handleWeekClick.bind(Et(e),t,r):void 0;n.push(he.default.createElement(Bn,{key:"W",weekNumber:r,onClick:a,ariaLabelPrefix:e.props.ariaLabelPrefix}))}return n.concat([0,1,2,3,4,5,6].map((function(n){var r=ye.default(t,n);return he.default.createElement(zn,{ariaLabelPrefixWhenEnabled:e.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:e.props.disabledDayAriaLabelPrefix,key:r.valueOf(),day:r,month:e.props.month,onClick:e.handleDayClick.bind(Et(e),r),onMouseEnter:e.handleDayMouseEnter.bind(Et(e),r),minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDates:e.props.includeDates,includeDateIntervals:e.props.includeDateIntervals,highlightDates:e.props.highlightDates,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,selectsRange:e.props.selectsRange,selectsDisabledDaysInRange:e.props.selectsDisabledDaysInRange,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,renderDayContents:e.props.renderDayContents,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef,inline:e.props.inline,shouldFocusDayInline:e.props.shouldFocusDayInline,monthShowsDuplicateDaysEnd:e.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:e.props.monthShowsDuplicateDaysStart,locale:e.props.locale})})))})),e}return wt(n,[{key:"render",value:function(){return he.default.createElement("div",{className:"react-datepicker__week"},this.renderDays())}}],[{key:"defaultProps",get:function(){return{shouldCloseOnSelect:!0}}}]),n}(he.default.Component),Vn="two_columns",jn="three_columns",Wn="four_columns",Hn=(It(Fn={},Vn,{grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2}),It(Fn,jn,{grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3}),It(Fn,Wn,{grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4}),Fn);function Gn(e,t){return e?Wn:t?Vn:jn}var qn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"MONTH_REFS",Dt(Array(12)).map((function(){return he.default.createRef()}))),It(Et(e),"QUARTER_REFS",Dt(Array(4)).map((function(){return he.default.createRef()}))),It(Et(e),"isDisabled",(function(t){return an(t,e.props)})),It(Et(e),"isExcluded",(function(t){return on(t,e.props)})),It(Et(e),"handleDayClick",(function(t,n){e.props.onDayClick&&e.props.onDayClick(t,n,e.props.orderInDisplay)})),It(Et(e),"handleDayMouseEnter",(function(t){e.props.onDayMouseEnter&&e.props.onDayMouseEnter(t)})),It(Et(e),"handleMouseLeave",(function(){e.props.onMouseLeave&&e.props.onMouseLeave()})),It(Et(e),"isRangeStartMonth",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&Yt(Ue.default(r,t),a)})),It(Et(e),"isRangeStartQuarter",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&Xt(Ve.default(r,t),a)})),It(Et(e),"isRangeEndMonth",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&Yt(Ue.default(r,t),i)})),It(Et(e),"isRangeEndQuarter",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate;return!(!a||!i)&&Xt(Ve.default(r,t),i)})),It(Et(e),"isInSelectingRangeMonth",(function(t){var n,r=e.props,a=r.day,i=r.selectsStart,o=r.selectsEnd,s=r.selectsRange,u=r.startDate,c=r.endDate,l=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(i||o||s)||!l)&&(i&&c?un(l,c,t,a):(o&&u||!(!s||!u||c))&&un(u,l,t,a))})),It(Et(e),"isSelectingMonthRangeStart",(function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var r=e.props,a=r.day,i=r.startDate,o=r.selectsStart,s=Ue.default(a,t),u=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return Yt(s,o?u:i)})),It(Et(e),"isSelectingMonthRangeEnd",(function(t){var n;if(!e.isInSelectingRangeMonth(t))return!1;var r=e.props,a=r.day,i=r.endDate,o=r.selectsEnd,s=r.selectsRange,u=Ue.default(a,t),c=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return Yt(u,o||s?c:i)})),It(Et(e),"isInSelectingRangeQuarter",(function(t){var n,r=e.props,a=r.day,i=r.selectsStart,o=r.selectsEnd,s=r.selectsRange,u=r.startDate,c=r.endDate,l=null!==(n=e.props.selectingDate)&&void 0!==n?n:e.props.preSelection;return!(!(i||o||s)||!l)&&(i&&c?fn(l,c,t,a):(o&&u||!(!s||!u||c))&&fn(u,l,t,a))})),It(Et(e),"isWeekInMonth",(function(t){var n=e.props.day,r=ye.default(t,6);return Yt(t,n)||Yt(r,n)})),It(Et(e),"isCurrentMonth",(function(e,t){return Pe.default(e)===Pe.default(Zt())&&t===Oe.default(Zt())})),It(Et(e),"isCurrentQuarter",(function(e,t){return Pe.default(e)===Pe.default(Zt())&&t===Fe.default(Zt())})),It(Et(e),"isSelectedMonth",(function(e,t,n){return Oe.default(n)===t&&Pe.default(e)===Pe.default(n)})),It(Et(e),"isSelectedQuarter",(function(e,t,n){return Fe.default(e)===t&&Pe.default(e)===Pe.default(n)})),It(Et(e),"renderWeeks",(function(){for(var t=[],n=e.props.fixedHeight,r=0,a=!1,i=jt(Wt(e.props.day),e.props.locale,e.props.calendarStartDay);t.push(he.default.createElement(Un,{ariaLabelPrefix:e.props.weekAriaLabelPrefix,chooseDayAriaLabelPrefix:e.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:e.props.disabledDayAriaLabelPrefix,key:r,day:i,month:Oe.default(e.props.day),onDayClick:e.handleDayClick,onDayMouseEnter:e.handleDayMouseEnter,onWeekSelect:e.props.onWeekSelect,formatWeekNumber:e.props.formatWeekNumber,locale:e.props.locale,minDate:e.props.minDate,maxDate:e.props.maxDate,excludeDates:e.props.excludeDates,excludeDateIntervals:e.props.excludeDateIntervals,includeDates:e.props.includeDates,includeDateIntervals:e.props.includeDateIntervals,inline:e.props.inline,shouldFocusDayInline:e.props.shouldFocusDayInline,highlightDates:e.props.highlightDates,selectingDate:e.props.selectingDate,filterDate:e.props.filterDate,preSelection:e.props.preSelection,selected:e.props.selected,selectsStart:e.props.selectsStart,selectsEnd:e.props.selectsEnd,selectsRange:e.props.selectsRange,selectsDisabledDaysInRange:e.props.selectsDisabledDaysInRange,showWeekNumber:e.props.showWeekNumbers,startDate:e.props.startDate,endDate:e.props.endDate,dayClassName:e.props.dayClassName,setOpen:e.props.setOpen,shouldCloseOnSelect:e.props.shouldCloseOnSelect,disabledKeyboardNavigation:e.props.disabledKeyboardNavigation,renderDayContents:e.props.renderDayContents,handleOnKeyDown:e.props.handleOnKeyDown,isInputFocused:e.props.isInputFocused,containerRef:e.props.containerRef,calendarStartDay:e.props.calendarStartDay,monthShowsDuplicateDaysEnd:e.props.monthShowsDuplicateDaysEnd,monthShowsDuplicateDaysStart:e.props.monthShowsDuplicateDaysStart})),!a;){r++,i=be.default(i,1);var o=n&&r>=6,s=!n&&!e.isWeekInMonth(i);if(o||s){if(!e.props.peekNextMonth)break;a=!0}}return t})),It(Et(e),"onMonthClick",(function(t,n){e.handleDayClick(Wt(Ue.default(e.props.day,n)),t)})),It(Et(e),"onMonthMouseEnter",(function(t){e.handleDayMouseEnter(Wt(Ue.default(e.props.day,t)))})),It(Et(e),"handleMonthNavigation",(function(t,n){e.isDisabled(n)||e.isExcluded(n)||(e.props.setPreSelection(n),e.MONTH_REFS[t].current&&e.MONTH_REFS[t].current.focus())})),It(Et(e),"onMonthKeyDown",(function(t,n){var r=e.props,a=r.selected,i=r.preSelection,o=r.disabledKeyboardNavigation,s=r.showTwoColumnMonthYearPicker,u=r.showFourColumnMonthYearPicker,c=r.setPreSelection,l=t.key;if("Tab"!==l&&t.preventDefault(),!o){var h=Gn(u,s),f=Hn[h].verticalNavigationOffset,d=Hn[h].grid;switch(l){case"Enter":e.onMonthClick(t,n),c(a);break;case"ArrowRight":e.handleMonthNavigation(11===n?0:n+1,ke.default(i,1));break;case"ArrowLeft":e.handleMonthNavigation(0===n?11:n-1,Ce.default(i,1));break;case"ArrowUp":e.handleMonthNavigation(d[0].includes(n)?n+12-f:n-f,Ce.default(i,f));break;case"ArrowDown":e.handleMonthNavigation(d[d.length-1].includes(n)?n-12+f:n+f,ke.default(i,f))}}})),It(Et(e),"onQuarterClick",(function(t,n){e.handleDayClick(Gt(Ve.default(e.props.day,n)),t)})),It(Et(e),"onQuarterMouseEnter",(function(t){e.handleDayMouseEnter(Gt(Ve.default(e.props.day,t)))})),It(Et(e),"handleQuarterNavigation",(function(t,n){e.isDisabled(n)||e.isExcluded(n)||(e.props.setPreSelection(n),e.QUARTER_REFS[t-1].current&&e.QUARTER_REFS[t-1].current.focus())})),It(Et(e),"onQuarterKeyDown",(function(t,n){var r=t.key;if(!e.props.disabledKeyboardNavigation)switch(r){case"Enter":e.onQuarterClick(t,n),e.props.setPreSelection(e.props.selected);break;case"ArrowRight":e.handleQuarterNavigation(4===n?1:n+1,xe.default(e.props.preSelection,1));break;case"ArrowLeft":e.handleQuarterNavigation(1===n?4:n-1,_e.default(e.props.preSelection,1))}})),It(Et(e),"getMonthClassNames",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate,o=n.selected,s=n.minDate,u=n.maxDate,c=n.preSelection,l=n.monthClassName,h=n.excludeDates,f=n.includeDates,d=l?l(Ue.default(r,t)):void 0,p=Ue.default(r,t);return fe.default("react-datepicker__month-text","react-datepicker__month-".concat(t),d,{"react-datepicker__month-text--disabled":(s||u||h||f)&&sn(p,e.props),"react-datepicker__month-text--selected":e.isSelectedMonth(r,t,o),"react-datepicker__month-text--keyboard-selected":!e.props.disabledKeyboardNavigation&&Oe.default(c)===t,"react-datepicker__month-text--in-selecting-range":e.isInSelectingRangeMonth(t),"react-datepicker__month-text--in-range":un(a,i,t,r),"react-datepicker__month-text--range-start":e.isRangeStartMonth(t),"react-datepicker__month-text--range-end":e.isRangeEndMonth(t),"react-datepicker__month-text--selecting-range-start":e.isSelectingMonthRangeStart(t),"react-datepicker__month-text--selecting-range-end":e.isSelectingMonthRangeEnd(t),"react-datepicker__month-text--today":e.isCurrentMonth(r,t)})})),It(Et(e),"getTabIndex",(function(t){var n=Oe.default(e.props.preSelection);return e.props.disabledKeyboardNavigation||t!==n?"-1":"0"})),It(Et(e),"getQuarterTabIndex",(function(t){var n=Fe.default(e.props.preSelection);return e.props.disabledKeyboardNavigation||t!==n?"-1":"0"})),It(Et(e),"getAriaLabel",(function(t){var n=e.props,r=n.chooseDayAriaLabelPrefix,a=void 0===r?"Choose":r,i=n.disabledDayAriaLabelPrefix,o=void 0===i?"Not available":i,s=n.day,u=Ue.default(s,t),c=e.isDisabled(u)||e.isExcluded(u)?o:a;return"".concat(c," ").concat(Bt(u,"MMMM yyyy"))})),It(Et(e),"getQuarterClassNames",(function(t){var n=e.props,r=n.day,a=n.startDate,i=n.endDate,o=n.selected,s=n.minDate,u=n.maxDate,c=n.preSelection;return fe.default("react-datepicker__quarter-text","react-datepicker__quarter-".concat(t),{"react-datepicker__quarter-text--disabled":(s||u)&&cn(Ve.default(r,t),e.props),"react-datepicker__quarter-text--selected":e.isSelectedQuarter(r,t,o),"react-datepicker__quarter-text--keyboard-selected":Fe.default(c)===t,"react-datepicker__quarter-text--in-selecting-range":e.isInSelectingRangeQuarter(t),"react-datepicker__quarter-text--in-range":fn(a,i,t,r),"react-datepicker__quarter-text--range-start":e.isRangeStartQuarter(t),"react-datepicker__quarter-text--range-end":e.isRangeEndQuarter(t)})})),It(Et(e),"getMonthContent",(function(t){var n=e.props,r=n.showFullMonthYearPicker,a=n.renderMonthContent,i=n.locale,o=rn(t,i),s=nn(t,i);return a?a(t,o,s):r?s:o})),It(Et(e),"getQuarterContent",(function(t){var n=e.props,r=n.renderQuarterContent,a=function(e,t){return Bt(Ve.default(Zt(),e),"QQQ",t)}(t,n.locale);return r?r(t,a):a})),It(Et(e),"renderMonths",(function(){var t=e.props,n=t.showTwoColumnMonthYearPicker,r=t.showFourColumnMonthYearPicker,a=t.day,i=t.selected;return Hn[Gn(r,n)].grid.map((function(t,n){return he.default.createElement("div",{className:"react-datepicker__month-wrapper",key:n},t.map((function(t,n){return he.default.createElement("div",{ref:e.MONTH_REFS[t],key:n,onClick:function(n){e.onMonthClick(n,t)},onKeyDown:function(n){e.onMonthKeyDown(n,t)},onMouseEnter:function(){return e.onMonthMouseEnter(t)},tabIndex:e.getTabIndex(t),className:e.getMonthClassNames(t),role:"option","aria-label":e.getAriaLabel(t),"aria-current":e.isCurrentMonth(a,t)?"date":void 0,"aria-selected":e.isSelectedMonth(a,t,i)},e.getMonthContent(t))})))}))})),It(Et(e),"renderQuarters",(function(){var t=e.props,n=t.day,r=t.selected;return he.default.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map((function(t,a){return he.default.createElement("div",{key:a,ref:e.QUARTER_REFS[a],role:"option",onClick:function(n){e.onQuarterClick(n,t)},onKeyDown:function(n){e.onQuarterKeyDown(n,t)},onMouseEnter:function(){return e.onQuarterMouseEnter(t)},className:e.getQuarterClassNames(t),"aria-selected":e.isSelectedQuarter(n,t,r),tabIndex:e.getQuarterTabIndex(t),"aria-current":e.isCurrentQuarter(n,t)?"date":void 0},e.getQuarterContent(t))})))})),It(Et(e),"getClassNames",(function(){var t=e.props,n=t.selectingDate,r=t.selectsStart,a=t.selectsEnd,i=t.showMonthYearPicker,o=t.showQuarterYearPicker;return fe.default("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(r||a)},{"react-datepicker__monthPicker":i},{"react-datepicker__quarterPicker":o})})),e}return wt(n,[{key:"render",value:function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,r=e.day,a=e.ariaLabelPrefix,i=void 0===a?"month ":a;return he.default.createElement("div",{className:this.getClassNames(),onMouseLeave:this.handleMouseLeave,"aria-label":"".concat(i," ").concat(Bt(r,"yyyy-MM")),role:"listbox"},t?this.renderMonths():n?this.renderQuarters():this.renderWeeks())}}]),n}(he.default.Component),Kn=function(e){Ct(n,e);var t=Nt(n);function n(){var e;kt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return It(Et(e=t.call.apply(t,[this].concat(a))),"state",{height:null}),It(Et(e),"handleClick",(function(t){(e.props.minTime||e.props.maxTime)&&gn(t,e.props)||(e.props.excludeTimes||e.props.includeTimes||e.props.filterTime)&&vn(t,e.props)||e.props.onChange(t)})),It(Et(e),"isSelectedTime",(function(t,n,r){return e.props.selected&&n===De.default(t)&&r===Ne.default(t)})),It(Et(e),"liClasses",(function(t,n,r){var a=["react-datepicker__time-list-item",e.props.timeClassName?e.props.timeClassName(t,n,r):void 0];return e.isSelectedTime(t,n,r)&&a.push("react-datepicker__time-list-item--selected"),((e.props.minTime||e.props.maxTime)&&gn(t,e.props)||(e.props.excludeTimes||e.props.includeTimes||e.props.filterTime)&&vn(t,e.props))&&a.push("react-datepicker__time-list-item--disabled"),e.props.injectTimes&&(60*De.default(t)+Ne.default(t))%e.props.intervals!=0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")})),It(Et(e),"handleOnKeyDown",(function(t,n){" "===t.key&&(t.preventDefault(),t.key="Enter"),"Enter"===t.key&&e.handleClick(n),e.props.handleOnKeyDown(t)})),It(Et(e),"renderTimes",(function(){for(var t,n=[],r=e.props.format?e.props.format:"p",a=e.props.intervals,i=(t=Zt(e.props.selected),Ye.default(t)),o=1440/a,s=e.props.injectTimes&&e.props.injectTimes.sort((function(e,t){return e-t})),u=e.props.selected||e.props.openToDate||Zt(),c=De.default(u),l=Ne.default(u),h=Be.default(ze.default(i,l),c),f=0;f<o;f++){var d=ge.default(i,f*a);if(n.push(d),s){var p=Sn(i,d,f,a,s);n=n.concat(p)}}return n.map((function(t,n){return he.default.createElement("li",{key:n,onClick:e.handleClick.bind(Et(e),t),className:e.liClasses(t,c,l),ref:function(n){(ct.default(t,h)||Jt(t,h))&&(e.centerLi=n)},onKeyDown:function(n){e.handleOnKeyDown(n,t)},tabIndex:"0","aria-selected":e.isSelectedTime(t,c,l)?"true":void 0},Bt(t,r,e.props.locale))}))})),e}return wt(n,[{key:"componentDidMount",value:function(){this.list.scrollTop=this.centerLi&&n.calcCenterPosition(this.props.monthRef?this.props.monthRef.clientHeight-this.header.clientHeight:this.list.clientHeight,this.centerLi),this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})}},{key:"render",value:function(){var e=this,t=this.state.height;return he.default.createElement("div",{className:"react-datepicker__time-container ".concat(this.props.todayButton?"react-datepicker__time-container--with-today-button":"")},he.default.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(this.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(t){e.header=t}},he.default.createElement("div",{className:"react-datepicker-time__header"},this.props.timeCaption)),he.default.createElement("div",{className:"react-datepicker__time"},he.default.createElement("div",{className:"react-datepicker__time-box"},he.default.createElement("ul",{className:"react-datepicker__time-list",ref:function(t){e.list=t},style:t?{height:t}:{},tabIndex:"0"},this.renderTimes()))))}}],[{key:"defaultProps",get:function(){return{intervals:30,onTimeChange:function(){},todayButton:null,timeCaption:"Time"}}}]),n}(he.default.Component);It(Kn,"calcCenterPosition",(function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)}));var Yn=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"YEAR_REFS",Dt(Array(r.props.yearItemNumber)).map((function(){return he.default.createRef()}))),It(Et(r),"isDisabled",(function(e){return an(e,r.props)})),It(Et(r),"isExcluded",(function(e){return on(e,r.props)})),It(Et(r),"selectingDate",(function(){var e;return null!==(e=r.props.selectingDate)&&void 0!==e?e:r.props.preSelection})),It(Et(r),"updateFocusOnPaginate",(function(e){var t=function(){this.YEAR_REFS[e].current.focus()}.bind(Et(r));window.requestAnimationFrame(t)})),It(Et(r),"handleYearClick",(function(e,t){r.props.onDayClick&&r.props.onDayClick(e,t)})),It(Et(r),"handleYearNavigation",(function(e,t){var n=r.props,a=n.date,i=n.yearItemNumber,o=_n(a,i).startPeriod;r.isDisabled(t)||r.isExcluded(t)||(r.props.setPreSelection(t),e-o==-1?r.updateFocusOnPaginate(i-1):e-o===i?r.updateFocusOnPaginate(0):r.YEAR_REFS[e-o].current.focus())})),It(Et(r),"isSameDay",(function(e,t){return Qt(e,t)})),It(Et(r),"isCurrentYear",(function(e){return e===Pe.default(Zt())})),It(Et(r),"isRangeStart",(function(e){return r.props.startDate&&r.props.endDate&&Kt(je.default(Zt(),e),r.props.startDate)})),It(Et(r),"isRangeEnd",(function(e){return r.props.startDate&&r.props.endDate&&Kt(je.default(Zt(),e),r.props.endDate)})),It(Et(r),"isInRange",(function(e){return ln(e,r.props.startDate,r.props.endDate)})),It(Et(r),"isInSelectingRange",(function(e){var t=r.props,n=t.selectsStart,a=t.selectsEnd,i=t.selectsRange,o=t.startDate,s=t.endDate;return!(!(n||a||i)||!r.selectingDate())&&(n&&s?ln(e,r.selectingDate(),s):(a&&o||!(!i||!o||s))&&ln(e,o,r.selectingDate()))})),It(Et(r),"isSelectingRangeStart",(function(e){if(!r.isInSelectingRange(e))return!1;var t=r.props,n=t.startDate,a=t.selectsStart;return Kt(je.default(Zt(),e),a?r.selectingDate():n)})),It(Et(r),"isSelectingRangeEnd",(function(e){if(!r.isInSelectingRange(e))return!1;var t=r.props,n=t.endDate,a=t.selectsEnd,i=t.selectsRange;return Kt(je.default(Zt(),e),a||i?r.selectingDate():n)})),It(Et(r),"isKeyboardSelected",(function(e){var t=Ht(je.default(r.props.date,e));return!r.props.disabledKeyboardNavigation&&!r.props.inline&&!Qt(t,Ht(r.props.selected))&&Qt(t,Ht(r.props.preSelection))})),It(Et(r),"onYearClick",(function(e,t){var n=r.props.date;r.handleYearClick(Ht(je.default(n,t)),e)})),It(Et(r),"onYearKeyDown",(function(e,t){var n=e.key;if(!r.props.disabledKeyboardNavigation)switch(n){case"Enter":r.onYearClick(e,t),r.props.setPreSelection(r.props.selected);break;case"ArrowRight":r.handleYearNavigation(t+1,we.default(r.props.preSelection,1));break;case"ArrowLeft":r.handleYearNavigation(t-1,Te.default(r.props.preSelection,1))}})),It(Et(r),"getYearClassNames",(function(e){var t=r.props,n=t.minDate,a=t.maxDate,i=t.selected,o=t.excludeDates,s=t.includeDates,u=t.filterDate;return fe.default("react-datepicker__year-text",{"react-datepicker__year-text--selected":e===Pe.default(i),"react-datepicker__year-text--disabled":(n||a||o||s||u)&&hn(e,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(e),"react-datepicker__year-text--range-start":r.isRangeStart(e),"react-datepicker__year-text--range-end":r.isRangeEnd(e),"react-datepicker__year-text--in-range":r.isInRange(e),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(e),"react-datepicker__year-text--today":r.isCurrentYear(e)})})),It(Et(r),"getYearTabIndex",(function(e){return r.props.disabledKeyboardNavigation?"-1":e===Pe.default(r.props.preSelection)?"0":"-1"})),It(Et(r),"getYearContainerClassNames",(function(){var e=r.props,t=e.selectingDate,n=e.selectsStart,a=e.selectsEnd,i=e.selectsRange;return fe.default("react-datepicker__year",{"react-datepicker__year--selecting-range":t&&(n||a||i)})})),It(Et(r),"getYearContent",(function(e){return r.props.renderYearContent?r.props.renderYearContent(e):e})),r}return wt(n,[{key:"render",value:function(){for(var e=this,t=[],n=this.props,r=n.date,a=n.yearItemNumber,i=n.onYearMouseEnter,o=n.onYearMouseLeave,s=_n(r,a),u=s.startPeriod,c=s.endPeriod,l=function(n){t.push(he.default.createElement("div",{ref:e.YEAR_REFS[n-u],onClick:function(t){e.onYearClick(t,n)},onKeyDown:function(t){e.onYearKeyDown(t,n)},tabIndex:e.getYearTabIndex(n),className:e.getYearClassNames(n),onMouseEnter:function(e){return i(e,n)},onMouseLeave:function(e){return o(e,n)},key:n,"aria-current":e.isCurrentYear(n)?"date":void 0},e.getYearContent(n)))},h=u;h<=c;h++)l(h);return he.default.createElement("div",{className:this.getYearContainerClassNames()},he.default.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.clearSelectingDate},t))}}]),n}(he.default.Component),Xn=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"onTimeChange",(function(e){r.setState({time:e});var t=new Date;t.setHours(e.split(":")[0]),t.setMinutes(e.split(":")[1]),r.props.onChange(t)})),It(Et(r),"renderTimeInput",(function(){var e=r.state.time,t=r.props,n=t.date,a=t.timeString,i=t.customTimeInput;return i?he.default.cloneElement(i,{date:n,value:e,onChange:r.onTimeChange}):he.default.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",required:!0,value:e,onChange:function(e){r.onTimeChange(e.target.value||a)}})})),r.state={time:r.props.timeString},r}return wt(n,[{key:"render",value:function(){return he.default.createElement("div",{className:"react-datepicker__input-time-container"},he.default.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),he.default.createElement("div",{className:"react-datepicker-time__input-container"},he.default.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.timeString!==t.time?{time:e.timeString}:null}}]),n}(he.default.Component);function Qn(e){var t=e.className,n=e.children,r=e.showPopperArrow,a=e.arrowProps,i=void 0===a?{}:a;return he.default.createElement("div",{className:t},r&&he.default.createElement("div",St({className:"react-datepicker__triangle"},i)),n)}var Jn=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],$n=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"handleClickOutside",(function(e){r.props.onClickOutside(e)})),It(Et(r),"setClickOutsideRef",(function(){return r.containerRef.current})),It(Et(r),"handleDropdownFocus",(function(e){(function(){var e=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).className||"").split(/\s+/);return Jn.some((function(t){return e.indexOf(t)>=0}))})(e.target)&&r.props.onDropdownFocus()})),It(Et(r),"getDateInView",(function(){var e=r.props,t=e.preSelection,n=e.selected,a=e.openToDate,i=xn(r.props),o=wn(r.props),s=Zt();return a||n||t||(i&&ct.default(s,i)?i:o&&ut.default(s,o)?o:s)})),It(Et(r),"increaseMonth",(function(){r.setState((function(e){var t=e.date;return{date:ke.default(t,1)}}),(function(){return r.handleMonthChange(r.state.date)}))})),It(Et(r),"decreaseMonth",(function(){r.setState((function(e){var t=e.date;return{date:Ce.default(t,1)}}),(function(){return r.handleMonthChange(r.state.date)}))})),It(Et(r),"handleDayClick",(function(e,t,n){r.props.onSelect(e,t,n),r.props.setPreSelection&&r.props.setPreSelection(e)})),It(Et(r),"handleDayMouseEnter",(function(e){r.setState({selectingDate:e}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(e)})),It(Et(r),"handleMonthMouseLeave",(function(){r.setState({selectingDate:null}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()})),It(Et(r),"handleYearMouseEnter",(function(e,t){r.setState({selectingDate:je.default(Zt(),t)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(e,t)})),It(Et(r),"handleYearMouseLeave",(function(e,t){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(e,t)})),It(Et(r),"handleYearChange",(function(e){r.props.onYearChange&&(r.props.onYearChange(e),r.setState({isRenderAriaLiveMessage:!0})),r.props.adjustDateOnChange&&(r.props.onSelect&&r.props.onSelect(e),r.props.setOpen&&r.props.setOpen(!0)),r.props.setPreSelection&&r.props.setPreSelection(e)})),It(Et(r),"handleMonthChange",(function(e){r.handleCustomMonthChange(e),r.props.adjustDateOnChange&&(r.props.onSelect&&r.props.onSelect(e),r.props.setOpen&&r.props.setOpen(!0)),r.props.setPreSelection&&r.props.setPreSelection(e)})),It(Et(r),"handleCustomMonthChange",(function(e){r.props.onMonthChange&&(r.props.onMonthChange(e),r.setState({isRenderAriaLiveMessage:!0}))})),It(Et(r),"handleMonthYearChange",(function(e){r.handleYearChange(e),r.handleMonthChange(e)})),It(Et(r),"changeYear",(function(e){r.setState((function(t){var n=t.date;return{date:je.default(n,e)}}),(function(){return r.handleYearChange(r.state.date)}))})),It(Et(r),"changeMonth",(function(e){r.setState((function(t){var n=t.date;return{date:Ue.default(n,e)}}),(function(){return r.handleMonthChange(r.state.date)}))})),It(Et(r),"changeMonthYear",(function(e){r.setState((function(t){var n=t.date;return{date:je.default(Ue.default(n,Oe.default(e)),Pe.default(e))}}),(function(){return r.handleMonthYearChange(r.state.date)}))})),It(Et(r),"header",(function(){var e=jt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.state.date,r.props.locale,r.props.calendarStartDay),t=[];return r.props.showWeekNumbers&&t.push(he.default.createElement("div",{key:"W",className:"react-datepicker__day-name"},r.props.weekLabel||"#")),t.concat([0,1,2,3,4,5,6].map((function(t){var n=ye.default(e,t),a=r.formatWeekday(n,r.props.locale),i=r.props.weekDayClassName?r.props.weekDayClassName(n):void 0;return he.default.createElement("div",{key:t,className:fe.default("react-datepicker__day-name",i)},a)})))})),It(Et(r),"formatWeekday",(function(e,t){return r.props.formatWeekDay?function(e,t,n){return t(Bt(e,"EEEE",n))}(e,r.props.formatWeekDay,t):r.props.useWeekdaysShort?function(e,t){return Bt(e,"EEE",t)}(e,t):function(e,t){return Bt(e,"EEEEEE",t)}(e,t)})),It(Et(r),"decreaseYear",(function(){r.setState((function(e){var t=e.date;return{date:Te.default(t,r.props.showYearPicker?r.props.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))})),It(Et(r),"clearSelectingDate",(function(){r.setState({selectingDate:null})})),It(Et(r),"renderPreviousButton",(function(){if(!r.props.renderCustomHeader){var e;switch(!0){case r.props.showMonthYearPicker:e=bn(r.state.date,r.props);break;case r.props.showYearPicker:e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.minDate,r=t.yearItemNumber,a=void 0===r?Pt:r,i=_n(Ht(Te.default(e,a)),a).endPeriod,o=n&&Pe.default(n);return o&&o>i||!1}(r.state.date,r.props);break;default:e=mn(r.state.date,r.props)}if((r.props.forceShowMonthNavigation||r.props.showDisabledMonthNavigation||!e)&&!r.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--previous"],n=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(n=r.decreaseYear),e&&r.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--previous--disabled"),n=null);var a=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,i=r.props,o=i.previousMonthButtonLabel,s=i.previousYearButtonLabel,u=r.props,c=u.previousMonthAriaLabel,l=void 0===c?"string"==typeof o?o:"Previous Month":c,h=u.previousYearAriaLabel,f=void 0===h?"string"==typeof s?s:"Previous Year":h;return he.default.createElement("button",{type:"button",className:t.join(" "),onClick:n,onKeyDown:r.props.handleOnKeyDown,"aria-label":a?f:l},he.default.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},a?r.props.previousYearButtonLabel:r.props.previousMonthButtonLabel))}}})),It(Et(r),"increaseYear",(function(){r.setState((function(e){var t=e.date;return{date:we.default(t,r.props.showYearPicker?r.props.yearItemNumber:1)}}),(function(){return r.handleYearChange(r.state.date)}))})),It(Et(r),"renderNextButton",(function(){if(!r.props.renderCustomHeader){var e;switch(!0){case r.props.showMonthYearPicker:e=kn(r.state.date,r.props);break;case r.props.showYearPicker:e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.maxDate,r=t.yearItemNumber,a=void 0===r?Pt:r,i=_n(we.default(e,a),a).startPeriod,o=n&&Pe.default(n);return o&&o<i||!1}(r.state.date,r.props);break;default:e=yn(r.state.date,r.props)}if((r.props.forceShowMonthNavigation||r.props.showDisabledMonthNavigation||!e)&&!r.props.showTimeSelectOnly){var t=["react-datepicker__navigation","react-datepicker__navigation--next"];r.props.showTimeSelect&&t.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&t.push("react-datepicker__navigation--next--with-today-button");var n=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(n=r.increaseYear),e&&r.props.showDisabledMonthNavigation&&(t.push("react-datepicker__navigation--next--disabled"),n=null);var a=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,i=r.props,o=i.nextMonthButtonLabel,s=i.nextYearButtonLabel,u=r.props,c=u.nextMonthAriaLabel,l=void 0===c?"string"==typeof o?o:"Next Month":c,h=u.nextYearAriaLabel,f=void 0===h?"string"==typeof s?s:"Next Year":h;return he.default.createElement("button",{type:"button",className:t.join(" "),onClick:n,onKeyDown:r.props.handleOnKeyDown,"aria-label":a?f:l},he.default.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},a?r.props.nextYearButtonLabel:r.props.nextMonthButtonLabel))}}})),It(Et(r),"renderCurrentMonth",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.state.date,t=["react-datepicker__current-month"];return r.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),he.default.createElement("div",{className:t.join(" ")},Bt(e,r.props.dateFormat,r.props.locale))})),It(Et(r),"renderYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showYearDropdown&&!e)return he.default.createElement(Dn,{adjustDateOnChange:r.props.adjustDateOnChange,date:r.state.date,onSelect:r.props.onSelect,setOpen:r.props.setOpen,dropdownMode:r.props.dropdownMode,onChange:r.changeYear,minDate:r.props.minDate,maxDate:r.props.maxDate,year:Pe.default(r.state.date),scrollableYearDropdown:r.props.scrollableYearDropdown,yearDropdownItemNumber:r.props.yearDropdownItemNumber})})),It(Et(r),"renderMonthDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showMonthDropdown&&!e)return he.default.createElement(Mn,{dropdownMode:r.props.dropdownMode,locale:r.props.locale,onChange:r.changeMonth,month:Oe.default(r.state.date),useShortMonthInDropdown:r.props.useShortMonthInDropdown})})),It(Et(r),"renderMonthYearDropdown",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.props.showMonthYearDropdown&&!e)return he.default.createElement(Zn,{dropdownMode:r.props.dropdownMode,locale:r.props.locale,dateFormat:r.props.dateFormat,onChange:r.changeMonthYear,minDate:r.props.minDate,maxDate:r.props.maxDate,date:r.state.date,scrollableMonthYearDropdown:r.props.scrollableMonthYearDropdown})})),It(Et(r),"handleTodayButtonClick",(function(e){r.props.onSelect(qt(),e),r.props.setPreSelection&&r.props.setPreSelection(qt())})),It(Et(r),"renderTodayButton",(function(){if(r.props.todayButton&&!r.props.showTimeSelectOnly)return he.default.createElement("div",{className:"react-datepicker__today-button",onClick:function(e){return r.handleTodayButtonClick(e)}},r.props.todayButton)})),It(Et(r),"renderDefaultHeader",(function(e){var t=e.monthDate,n=e.i;return he.default.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(t),he.default.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(0!==n),r.renderMonthYearDropdown(0!==n),r.renderYearDropdown(0!==n)),he.default.createElement("div",{className:"react-datepicker__day-names"},r.header(t)))})),It(Et(r),"renderCustomHeader",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.monthDate,n=e.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var a=mn(r.state.date,r.props),i=yn(r.state.date,r.props),o=bn(r.state.date,r.props),s=kn(r.state.date,r.props),u=!r.props.showMonthYearPicker&&!r.props.showQuarterYearPicker&&!r.props.showYearPicker;return he.default.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},r.props.renderCustomHeader(yt(yt({},r.state),{},{customHeaderCount:n,monthDate:t,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:a,nextMonthButtonDisabled:i,prevYearButtonDisabled:o,nextYearButtonDisabled:s})),u&&he.default.createElement("div",{className:"react-datepicker__day-names"},r.header(t)))})),It(Et(r),"renderYearHeader",(function(){var e=r.state.date,t=r.props,n=t.showYearPicker,a=_n(e,t.yearItemNumber),i=a.startPeriod,o=a.endPeriod;return he.default.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},n?"".concat(i," - ").concat(o):Pe.default(e))})),It(Et(r),"renderHeader",(function(e){switch(!0){case void 0!==r.props.renderCustomHeader:return r.renderCustomHeader(e);case r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker:return r.renderYearHeader(e);default:return r.renderDefaultHeader(e)}})),It(Et(r),"renderMonths",(function(){if(!r.props.showTimeSelectOnly&&!r.props.showYearPicker){for(var e=[],t=r.props.showPreviousMonths?r.props.monthsShown-1:0,n=Ce.default(r.state.date,t),a=0;a<r.props.monthsShown;++a){var i=a-r.props.monthSelectedIn,o=ke.default(n,i),s="month-".concat(a),u=a<r.props.monthsShown-1,c=a>0;e.push(he.default.createElement("div",{key:s,ref:function(e){r.monthContainer=e},className:"react-datepicker__month-container"},r.renderHeader({monthDate:o,i:a}),he.default.createElement(qn,{chooseDayAriaLabelPrefix:r.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:r.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:r.props.weekAriaLabelPrefix,ariaLabelPrefix:r.props.monthAriaLabelPrefix,onChange:r.changeMonthYear,day:o,dayClassName:r.props.dayClassName,calendarStartDay:r.props.calendarStartDay,monthClassName:r.props.monthClassName,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,onWeekSelect:r.props.onWeekSelect,orderInDisplay:a,formatWeekNumber:r.props.formatWeekNumber,locale:r.props.locale,minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,highlightDates:r.props.highlightDates,selectingDate:r.state.selectingDate,includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,inline:r.props.inline,shouldFocusDayInline:r.props.shouldFocusDayInline,fixedHeight:r.props.fixedHeight,filterDate:r.props.filterDate,preSelection:r.props.preSelection,setPreSelection:r.props.setPreSelection,selected:r.props.selected,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,showWeekNumbers:r.props.showWeekNumbers,startDate:r.props.startDate,endDate:r.props.endDate,peekNextMonth:r.props.peekNextMonth,setOpen:r.props.setOpen,shouldCloseOnSelect:r.props.shouldCloseOnSelect,renderDayContents:r.props.renderDayContents,renderMonthContent:r.props.renderMonthContent,renderQuarterContent:r.props.renderQuarterContent,renderYearContent:r.props.renderYearContent,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,showMonthYearPicker:r.props.showMonthYearPicker,showFullMonthYearPicker:r.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:r.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:r.props.showFourColumnMonthYearPicker,showYearPicker:r.props.showYearPicker,showQuarterYearPicker:r.props.showQuarterYearPicker,isInputFocused:r.props.isInputFocused,containerRef:r.containerRef,monthShowsDuplicateDaysEnd:u,monthShowsDuplicateDaysStart:c})))}return e}})),It(Et(r),"renderYears",(function(){if(!r.props.showTimeSelectOnly)return r.props.showYearPicker?he.default.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader(),he.default.createElement(Yn,St({onDayClick:r.handleDayClick,selectingDate:r.state.selectingDate,clearSelectingDate:r.clearSelectingDate,date:r.state.date},r.props,{onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave}))):void 0})),It(Et(r),"renderTimeSection",(function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return he.default.createElement(Kn,{selected:r.props.selected,openToDate:r.props.openToDate,onChange:r.props.onTimeChange,timeClassName:r.props.timeClassName,format:r.props.timeFormat,includeTimes:r.props.includeTimes,intervals:r.props.timeIntervals,minTime:r.props.minTime,maxTime:r.props.maxTime,excludeTimes:r.props.excludeTimes,filterTime:r.props.filterTime,timeCaption:r.props.timeCaption,todayButton:r.props.todayButton,showMonthDropdown:r.props.showMonthDropdown,showMonthYearDropdown:r.props.showMonthYearDropdown,showYearDropdown:r.props.showYearDropdown,withPortal:r.props.withPortal,monthRef:r.state.monthContainer,injectTimes:r.props.injectTimes,locale:r.props.locale,handleOnKeyDown:r.props.handleOnKeyDown,showTimeSelectOnly:r.props.showTimeSelectOnly})})),It(Et(r),"renderInputTimeSection",(function(){var e=new Date(r.props.selected),t=zt(e)&&Boolean(r.props.selected)?"".concat(Cn(e.getHours()),":").concat(Cn(e.getMinutes())):"";if(r.props.showTimeInput)return he.default.createElement(Xn,{date:e,timeString:t,timeInputLabel:r.props.timeInputLabel,onChange:r.props.onTimeChange,customTimeInput:r.props.customTimeInput})})),It(Et(r),"renderAriaLiveRegion",(function(){var e,t=_n(r.state.date,r.props.yearItemNumber),n=t.startPeriod,a=t.endPeriod;return e=r.props.showYearPicker?"".concat(n," - ").concat(a):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Pe.default(r.state.date):"".concat(nn(Oe.default(r.state.date),r.props.locale)," ").concat(Pe.default(r.state.date)),he.default.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&e)})),It(Et(r),"renderChildren",(function(){if(r.props.children)return he.default.createElement("div",{className:"react-datepicker__children-container"},r.props.children)})),r.containerRef=he.default.createRef(),r.state={date:r.getDateInView(),selectingDate:null,monthContainer:null,isRenderAriaLiveMessage:!1},r}return wt(n,[{key:"componentDidMount",value:function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(!this.props.preSelection||Qt(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!Qt(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!Yt(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},(function(){return n&&t.handleCustomMonthChange(t.state.date)}))}}},{key:"render",value:function(){var e=this.props.container||Qn;return he.default.createElement("div",{ref:this.containerRef},he.default.createElement(e,{className:fe.default("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showPopperArrow:this.props.showPopperArrow,arrowProps:this.props.arrowProps},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren()))}}],[{key:"defaultProps",get:function(){return{onDropdownFocus:function(){},monthsShown:1,monthSelectedIn:0,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",customTimeInput:null,yearItemNumber:Pt}}}]),n}(he.default.Component),er=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),(r=t.call(this,e)).el=document.createElement("div"),r}return wt(n,[{key:"componentDidMount",value:function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){this.portalRoot.removeChild(this.el)}},{key:"render",value:function(){return vt.default.createPortal(this.props.children,this.el)}}]),n}(he.default.Component),tr=function(e){return!e.disabled&&-1!==e.tabIndex},nr=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"getTabChildren",(function(){return Array.prototype.slice.call(r.tabLoopRef.current.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(tr)})),It(Et(r),"handleFocusStart",(function(){var e=r.getTabChildren();e&&e.length>1&&e[e.length-1].focus()})),It(Et(r),"handleFocusEnd",(function(){var e=r.getTabChildren();e&&e.length>1&&e[0].focus()})),r.tabLoopRef=he.default.createRef(),r}return wt(n,[{key:"render",value:function(){return this.props.enableTabLoop?he.default.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},he.default.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:"0",onFocus:this.handleFocusStart}),this.props.children,he.default.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:"0",onFocus:this.handleFocusEnd})):this.props.children}}],[{key:"defaultProps",get:function(){return{enableTabLoop:!0}}}]),n}(he.default.Component),rr=function(e){Ct(n,e);var t=Nt(n);function n(){return kt(this,n),t.apply(this,arguments)}return wt(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.wrapperClassName,a=t.hidePopper,i=t.popperComponent,o=t.popperModifiers,s=t.popperPlacement,u=t.popperProps,c=t.targetComponent,l=t.enableTabLoop,h=t.popperOnKeyDown,f=t.portalId,d=t.portalHost;if(!a){var p=fe.default("react-datepicker-popper",n);e=he.default.createElement(ue.Popper,St({modifiers:o,placement:s},u),(function(e){var t=e.ref,n=e.style,r=e.placement,a=e.arrowProps;return he.default.createElement(nr,{enableTabLoop:l},he.default.createElement("div",{ref:t,style:n,className:p,"data-placement":r,onKeyDown:h},he.default.cloneElement(i,{arrowProps:a})))}))}this.props.popperContainer&&(e=he.default.createElement(this.props.popperContainer,{},e)),f&&!a&&(e=he.default.createElement(er,{portalId:f,portalHost:d},e));var v=fe.default("react-datepicker-wrapper",r);return he.default.createElement(ue.Manager,{className:"react-datepicker-manager"},he.default.createElement(ue.Reference,null,(function(e){var t=e.ref;return he.default.createElement("div",{ref:t,className:v},c)})),e)}}],[{key:"defaultProps",get:function(){return{hidePopper:!0,popperModifiers:[],popperProps:{},popperPlacement:"bottom-start"}}}]),n}(he.default.Component),ar="react-datepicker-ignore-onclickoutside",ir=pt.default($n),or="Date input not valid.",sr=function(e){Ct(n,e);var t=Nt(n);function n(e){var r;return kt(this,n),It(Et(r=t.call(this,e)),"getPreSelection",(function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:Zt()})),It(Et(r),"calcInitialState",(function(){var e,t=r.getPreSelection(),n=xn(r.props),a=wn(r.props),i=n&&ct.default(t,Ye.default(n))?n:a&&ut.default(t,et.default(a))?a:t;return{open:r.props.startOpen||!1,preventFocus:!1,preSelection:null!==(e=r.props.selectsRange?r.props.startDate:r.props.selected)&&void 0!==e?e:i,highlightDates:In(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1}})),It(Et(r),"clearPreventFocusTimeout",(function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)})),It(Et(r),"setFocus",(function(){r.input&&r.input.focus&&r.input.focus({preventScroll:!0})})),It(Et(r),"setBlur",(function(){r.input&&r.input.blur&&r.input.blur(),r.cancelFocusInput()})),It(Et(r),"setOpen",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.setState({open:e,preSelection:e&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:cr},(function(){e||r.setState((function(e){return{focused:!!t&&e.focused}}),(function(){!t&&r.setBlur(),r.setState({inputValue:null})}))}))})),It(Et(r),"inputOk",(function(){return de.default(r.state.preSelection)})),It(Et(r),"isCalendarOpen",(function(){return void 0===r.props.open?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open})),It(Et(r),"handleFocus",(function(e){r.state.preventFocus||(r.props.onFocus(e),r.props.preventOpenOnFocus||r.props.readOnly||r.setOpen(!0)),r.setState({focused:!0})})),It(Et(r),"cancelFocusInput",(function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=null})),It(Et(r),"deferFocusInput",(function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout((function(){return r.setFocus()}),1)})),It(Et(r),"handleDropdownFocus",(function(){r.cancelFocusInput()})),It(Et(r),"handleBlur",(function(e){(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&r.props.onBlur(e),r.setState({focused:!1})})),It(Et(r),"handleCalendarClickOutside",(function(e){r.props.inline||r.setOpen(!1),r.props.onClickOutside(e),r.props.withPortal&&e.preventDefault()})),It(Et(r),"handleChange",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t[0];if(!r.props.onChangeRaw||(r.props.onChangeRaw.apply(Et(r),t),"function"==typeof a.isDefaultPrevented&&!a.isDefaultPrevented())){r.setState({inputValue:a.target.value,lastPreSelectChange:ur});var i,o,s,u,c,l,h,f,d=(i=a.target.value,o=r.props.dateFormat,s=r.props.locale,u=r.props.strictParsing,c=r.props.minDate,l=null,h=tn(s)||tn(en()),f=!0,Array.isArray(o)?(o.forEach((function(e){var t=ft.default(i,e,new Date,{locale:h});u&&(f=zt(t,c)&&i===Bt(t,e,s)),zt(t,c)&&f&&(l=t)})),l):(l=ft.default(i,o,new Date,{locale:h}),u?f=zt(l)&&i===Bt(l,o,s):zt(l)||(o=o.match(Lt).map((function(e){var t=e[0];return"p"===t||"P"===t?h?(0,Ft[t])(e,h.formatLong):t:e})).join(""),i.length>0&&(l=ft.default(i,o.slice(0,i.length),new Date)),zt(l)||(l=new Date(i))),zt(l)&&f?l:null));r.props.showTimeSelectOnly&&r.props.selected&&!Qt(d,r.props.selected)&&(d=null==d?gt.default(r.props.selected,{hours:De.default(r.props.selected),minutes:Ne.default(r.props.selected),seconds:Ee.default(r.props.selected)}):gt.default(r.props.selected,{hours:De.default(d),minutes:Ne.default(d),seconds:Ee.default(d)})),!d&&a.target.value||r.setSelected(d,a,!0)}})),It(Et(r),"handleSelect",(function(e,t,n){if(r.setState({preventFocus:!0},(function(){return r.preventFocusTimeout=setTimeout((function(){return r.setState({preventFocus:!1})}),50),r.preventFocusTimeout})),r.props.onChangeRaw&&r.props.onChangeRaw(t),r.setSelected(e,t,!1,n),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect)r.setPreSelection(e);else if(!r.props.inline){r.props.selectsRange||r.setOpen(!1);var a=r.props,i=a.startDate,o=a.endDate;!i||o||ct.default(e,i)||r.setOpen(!1)}})),It(Et(r),"setSelected",(function(e,t,n,a){var i=e;if(r.props.showYearPicker){if(null!==i&&hn(Pe.default(i),r.props))return}else if(r.props.showMonthYearPicker){if(null!==i&&sn(i,r.props))return}else if(null!==i&&an(i,r.props))return;var o=r.props,s=o.onChange,u=o.selectsRange,c=o.startDate,l=o.endDate;if(!Jt(r.props.selected,i)||r.props.allowSameDay||u)if(null!==i&&(!r.props.selected||n&&(r.props.showTimeSelect||r.props.showTimeSelectOnly||r.props.showTimeInput)||(i=Vt(i,{hour:De.default(r.props.selected),minute:Ne.default(r.props.selected),second:Ee.default(r.props.selected)})),r.props.inline||r.setState({preSelection:i}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:a})),u){var h=c&&l;c||l?c&&!l&&(ct.default(i,c)?s([i,null],t):s([c,i],t)):s([i,null],t),h&&s([i,null],t)}else s(i,t);n||(r.props.onSelect(i,t),r.setState({inputValue:null}))})),It(Et(r),"setPreSelection",(function(e){var t=void 0!==r.props.minDate,n=void 0!==r.props.maxDate,a=!0;if(e){var i=Ye.default(e);if(t&&n)a=$t(e,r.props.minDate,r.props.maxDate);else if(t){var o=Ye.default(r.props.minDate);a=ut.default(e,o)||Jt(i,o)}else if(n){var s=et.default(r.props.maxDate);a=ct.default(e,s)||Jt(i,s)}}a&&r.setState({preSelection:e})})),It(Et(r),"handleTimeChange",(function(e){var t=Vt(r.props.selected?r.props.selected:r.getPreSelection(),{hour:De.default(e),minute:Ne.default(e)});r.setState({preSelection:t}),r.props.onChange(t),r.props.shouldCloseOnSelect&&r.setOpen(!1),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})})),It(Et(r),"onInputClick",(function(){r.props.disabled||r.props.readOnly||r.setOpen(!0),r.props.onInputClick()})),It(Et(r),"onInputKeyDown",(function(e){r.props.onKeyDown(e);var t=e.key;if(r.state.open||r.props.inline||r.props.preventOpenOnFocus){if(r.state.open){if("ArrowDown"===t||"ArrowUp"===t){e.preventDefault();var n=r.calendar.componentNode&&r.calendar.componentNode.querySelector('.react-datepicker__day[tabindex="0"]');return void(n&&n.focus({preventScroll:!0}))}var a=Zt(r.state.preSelection);"Enter"===t?(e.preventDefault(),r.inputOk()&&r.state.lastPreSelectChange===cr?(r.handleSelect(a,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(a)):r.setOpen(!1)):"Escape"===t?(e.preventDefault(),r.setOpen(!1)):"Tab"===t&&e.shiftKey&&r.setOpen(!1),r.inputOk()||r.props.onInputError({code:1,msg:or})}}else"ArrowDown"!==t&&"ArrowUp"!==t&&"Enter"!==t||r.onInputClick()})),It(Et(r),"onPortalKeyDown",(function(e){"Escape"===e.key&&(e.preventDefault(),r.setState({preventFocus:!0},(function(){r.setOpen(!1),setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))})))})),It(Et(r),"onDayKeyDown",(function(e){r.props.onKeyDown(e);var t=e.key,n=Zt(r.state.preSelection);if("Enter"===t)e.preventDefault(),r.handleSelect(n,e),!r.props.shouldCloseOnSelect&&r.setPreSelection(n);else if("Escape"===t)e.preventDefault(),r.setOpen(!1),r.inputOk()||r.props.onInputError({code:1,msg:or});else if(!r.props.disabledKeyboardNavigation){var a;switch(t){case"ArrowLeft":a=Ie.default(n,1);break;case"ArrowRight":a=ye.default(n,1);break;case"ArrowUp":a=Se.default(n,1);break;case"ArrowDown":a=be.default(n,1);break;case"PageUp":a=Ce.default(n,1);break;case"PageDown":a=ke.default(n,1);break;case"Home":a=Te.default(n,1);break;case"End":a=we.default(n,1)}if(!a)return void(r.props.onInputError&&r.props.onInputError({code:1,msg:or}));if(e.preventDefault(),r.setState({lastPreSelectChange:cr}),r.props.adjustDateOnChange&&r.setSelected(a),r.setPreSelection(a),r.props.inline){var i=Oe.default(n),o=Oe.default(a),s=Pe.default(n),u=Pe.default(a);i!==o||s!==u?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}})),It(Et(r),"onPopperKeyDown",(function(e){"Escape"===e.key&&(e.preventDefault(),r.setState({preventFocus:!0},(function(){r.setOpen(!1),setTimeout((function(){r.setFocus(),r.setState({preventFocus:!1})}))})))})),It(Et(r),"onClearClick",(function(e){e&&e.preventDefault&&e.preventDefault(),r.props.selectsRange?r.props.onChange([null,null],e):r.props.onChange(null,e),r.setState({inputValue:null})})),It(Et(r),"clear",(function(){r.onClearClick()})),It(Et(r),"onScroll",(function(e){"boolean"==typeof r.props.closeOnScroll&&r.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||r.setOpen(!1):"function"==typeof r.props.closeOnScroll&&r.props.closeOnScroll(e)&&r.setOpen(!1)})),It(Et(r),"renderCalendar",(function(){return r.props.inline||r.isCalendarOpen()?he.default.createElement(ir,{ref:function(e){r.calendar=e},locale:r.props.locale,calendarStartDay:r.props.calendarStartDay,chooseDayAriaLabelPrefix:r.props.chooseDayAriaLabelPrefix,disabledDayAriaLabelPrefix:r.props.disabledDayAriaLabelPrefix,weekAriaLabelPrefix:r.props.weekAriaLabelPrefix,monthAriaLabelPrefix:r.props.monthAriaLabelPrefix,adjustDateOnChange:r.props.adjustDateOnChange,setOpen:r.setOpen,shouldCloseOnSelect:r.props.shouldCloseOnSelect,dateFormat:r.props.dateFormatCalendar,useWeekdaysShort:r.props.useWeekdaysShort,formatWeekDay:r.props.formatWeekDay,dropdownMode:r.props.dropdownMode,selected:r.props.selected,preSelection:r.state.preSelection,onSelect:r.handleSelect,onWeekSelect:r.props.onWeekSelect,openToDate:r.props.openToDate,minDate:r.props.minDate,maxDate:r.props.maxDate,selectsStart:r.props.selectsStart,selectsEnd:r.props.selectsEnd,selectsRange:r.props.selectsRange,startDate:r.props.startDate,endDate:r.props.endDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,filterDate:r.props.filterDate,onClickOutside:r.handleCalendarClickOutside,formatWeekNumber:r.props.formatWeekNumber,highlightDates:r.state.highlightDates,includeDates:r.props.includeDates,includeDateIntervals:r.props.includeDateIntervals,includeTimes:r.props.includeTimes,injectTimes:r.props.injectTimes,inline:r.props.inline,shouldFocusDayInline:r.state.shouldFocusDayInline,peekNextMonth:r.props.peekNextMonth,showMonthDropdown:r.props.showMonthDropdown,showPreviousMonths:r.props.showPreviousMonths,useShortMonthInDropdown:r.props.useShortMonthInDropdown,showMonthYearDropdown:r.props.showMonthYearDropdown,showWeekNumbers:r.props.showWeekNumbers,showYearDropdown:r.props.showYearDropdown,withPortal:r.props.withPortal,forceShowMonthNavigation:r.props.forceShowMonthNavigation,showDisabledMonthNavigation:r.props.showDisabledMonthNavigation,scrollableYearDropdown:r.props.scrollableYearDropdown,scrollableMonthYearDropdown:r.props.scrollableMonthYearDropdown,todayButton:r.props.todayButton,weekLabel:r.props.weekLabel,outsideClickIgnoreClass:ar,fixedHeight:r.props.fixedHeight,monthsShown:r.props.monthsShown,monthSelectedIn:r.state.monthSelectedIn,onDropdownFocus:r.handleDropdownFocus,onMonthChange:r.props.onMonthChange,onYearChange:r.props.onYearChange,dayClassName:r.props.dayClassName,weekDayClassName:r.props.weekDayClassName,monthClassName:r.props.monthClassName,timeClassName:r.props.timeClassName,showDateSelect:r.props.showDateSelect,showTimeSelect:r.props.showTimeSelect,showTimeSelectOnly:r.props.showTimeSelectOnly,onTimeChange:r.handleTimeChange,timeFormat:r.props.timeFormat,timeIntervals:r.props.timeIntervals,minTime:r.props.minTime,maxTime:r.props.maxTime,excludeTimes:r.props.excludeTimes,filterTime:r.props.filterTime,timeCaption:r.props.timeCaption,className:r.props.calendarClassName,container:r.props.calendarContainer,yearItemNumber:r.props.yearItemNumber,yearDropdownItemNumber:r.props.yearDropdownItemNumber,previousMonthAriaLabel:r.props.previousMonthAriaLabel,previousMonthButtonLabel:r.props.previousMonthButtonLabel,nextMonthAriaLabel:r.props.nextMonthAriaLabel,nextMonthButtonLabel:r.props.nextMonthButtonLabel,previousYearAriaLabel:r.props.previousYearAriaLabel,previousYearButtonLabel:r.props.previousYearButtonLabel,nextYearAriaLabel:r.props.nextYearAriaLabel,nextYearButtonLabel:r.props.nextYearButtonLabel,timeInputLabel:r.props.timeInputLabel,disabledKeyboardNavigation:r.props.disabledKeyboardNavigation,renderCustomHeader:r.props.renderCustomHeader,popperProps:r.props.popperProps,renderDayContents:r.props.renderDayContents,renderMonthContent:r.props.renderMonthContent,renderQuarterContent:r.props.renderQuarterContent,renderYearContent:r.props.renderYearContent,onDayMouseEnter:r.props.onDayMouseEnter,onMonthMouseLeave:r.props.onMonthMouseLeave,onYearMouseEnter:r.props.onYearMouseEnter,onYearMouseLeave:r.props.onYearMouseLeave,selectsDisabledDaysInRange:r.props.selectsDisabledDaysInRange,showTimeInput:r.props.showTimeInput,showMonthYearPicker:r.props.showMonthYearPicker,showFullMonthYearPicker:r.props.showFullMonthYearPicker,showTwoColumnMonthYearPicker:r.props.showTwoColumnMonthYearPicker,showFourColumnMonthYearPicker:r.props.showFourColumnMonthYearPicker,showYearPicker:r.props.showYearPicker,showQuarterYearPicker:r.props.showQuarterYearPicker,showPopperArrow:r.props.showPopperArrow,excludeScrollbar:r.props.excludeScrollbar,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,isInputFocused:r.state.focused,customTimeInput:r.props.customTimeInput,setPreSelection:r.setPreSelection},r.props.children):null})),It(Et(r),"renderAriaLiveRegion",(function(){var e,t=r.props,n=t.dateFormat,a=t.locale,i=r.props.showTimeInput||r.props.showTimeSelect?"PPPPp":"PPPP";return e=r.props.selectsRange?"Selected start date: ".concat(Ut(r.props.startDate,{dateFormat:i,locale:a}),". ").concat(r.props.endDate?"End date: "+Ut(r.props.endDate,{dateFormat:i,locale:a}):""):r.props.showTimeSelectOnly?"Selected time: ".concat(Ut(r.props.selected,{dateFormat:n,locale:a})):r.props.showYearPicker?"Selected year: ".concat(Ut(r.props.selected,{dateFormat:"yyyy",locale:a})):r.props.showMonthYearPicker?"Selected month: ".concat(Ut(r.props.selected,{dateFormat:"MMMM yyyy",locale:a})):r.props.showQuarterYearPicker?"Selected quarter: ".concat(Ut(r.props.selected,{dateFormat:"yyyy, QQQ",locale:a})):"Selected date: ".concat(Ut(r.props.selected,{dateFormat:i,locale:a})),he.default.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},e)})),It(Et(r),"renderDateInput",(function(){var e,t=fe.default(r.props.className,It({},ar,r.state.open)),n=r.props.customInput||he.default.createElement("input",{type:"text"}),a=r.props.customInputRef||"ref",i="string"==typeof r.props.value?r.props.value:"string"==typeof r.state.inputValue?r.state.inputValue:r.props.selectsRange?function(e,t,n){if(!e)return"";var r=Ut(e,n),a=t?Ut(t,n):"";return"".concat(r," - ").concat(a)}(r.props.startDate,r.props.endDate,r.props):Ut(r.props.selected,r.props);return he.default.cloneElement(n,(It(e={},a,(function(e){r.input=e})),It(e,"value",i),It(e,"onBlur",r.handleBlur),It(e,"onChange",r.handleChange),It(e,"onClick",r.onInputClick),It(e,"onFocus",r.handleFocus),It(e,"onKeyDown",r.onInputKeyDown),It(e,"id",r.props.id),It(e,"name",r.props.name),It(e,"form",r.props.form),It(e,"autoFocus",r.props.autoFocus),It(e,"placeholder",r.props.placeholderText),It(e,"disabled",r.props.disabled),It(e,"autoComplete",r.props.autoComplete),It(e,"className",fe.default(n.props.className,t)),It(e,"title",r.props.title),It(e,"readOnly",r.props.readOnly),It(e,"required",r.props.required),It(e,"tabIndex",r.props.tabIndex),It(e,"aria-describedby",r.props.ariaDescribedBy),It(e,"aria-invalid",r.props.ariaInvalid),It(e,"aria-labelledby",r.props.ariaLabelledBy),It(e,"aria-required",r.props.ariaRequired),e))})),It(Et(r),"renderClearButton",(function(){var e=r.props,t=e.isClearable,n=e.selected,a=e.startDate,i=e.endDate,o=e.clearButtonTitle,s=e.clearButtonClassName,u=void 0===s?"":s,c=e.ariaLabelClose,l=void 0===c?"Close":c;return!t||null==n&&null==a&&null==i?null:he.default.createElement("button",{type:"button",className:"react-datepicker__close-icon ".concat(u).trim(),"aria-label":l,onClick:r.onClearClick,title:o,tabIndex:-1})})),r.state=r.calcInitialState(),r}return wt(n,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.onScroll,!0)}},{key:"componentDidUpdate",value:function(e,t){var n,r;e.inline&&(n=e.selected,r=this.props.selected,n&&r?Oe.default(n)!==Oe.default(r)||Pe.default(n)!==Pe.default(r):n!==r)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:In(this.props.highlightDates)}),t.focused||Jt(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&this.props.onCalendarOpen(),!0===t.open&&!1===this.state.open&&this.props.onCalendarClose())}},{key:"componentWillUnmount",value:function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0)}},{key:"renderInputContainer",value:function(){var e=this.props.showIcon;return he.default.createElement("div",{className:"react-datepicker__input-container".concat(e?" react-datepicker__view-calendar-icon":"")},e&&he.default.createElement("svg",{className:"react-datepicker__calendar-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},he.default.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"})),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())}},{key:"render",value:function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var t=this.state.open?he.default.createElement(nr,{enableTabLoop:this.props.enableTabLoop},he.default.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(t=he.default.createElement(er,{portalId:this.props.portalId,portalHost:this.props.portalHost},t)),he.default.createElement("div",null,this.renderInputContainer(),t)}return he.default.createElement(rr,{className:this.props.popperClassName,wrapperClassName:this.props.wrapperClassName,hidePopper:!this.isCalendarOpen(),portalId:this.props.portalId,portalHost:this.props.portalHost,popperModifiers:this.props.popperModifiers,targetComponent:this.renderInputContainer(),popperContainer:this.props.popperContainer,popperComponent:e,popperPlacement:this.props.popperPlacement,popperProps:this.props.popperProps,popperOnKeyDown:this.onPopperKeyDown,enableTabLoop:this.props.enableTabLoop})}}],[{key:"defaultProps",get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",onChange:function(){},disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",onFocus:function(){},onBlur:function(){},onKeyDown:function(){},onInputClick:function(){},onSelect:function(){},onClickOutside:function(){},onMonthChange:function(){},onCalendarOpen:function(){},onCalendarClose:function(){},preventOpenOnFocus:!1,onYearChange:function(){},onInputError:function(){},monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,strictParsing:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Pt,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0}}}]),n}(he.default.Component),ur="input",cr="navigate";e.CalendarContainer=Qn,e.default=sr,e.getDefaultLocale=en,e.registerLocale=function(e,t){var n="undefined"!=typeof window?window:globalThis;n.__localeData__||(n.__localeData__={}),n.__localeData__[e]=t},e.setDefaultLocale=function(e){("undefined"!=typeof window?window:globalThis).__localeId__=e},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2791),n(2007),n(1694),n(6971),n(9314),n(1951),n(1518),n(2074),n(9040),n(20),n(1104),n(6689),n(5105),n(6753),n(7503),n(8030),n(6794),n(7602),n(2295),n(4424),n(1537),n(467),n(6114),n(6975),n(3747),n(639),n(2599),n(4460),n(9292),n(7227),n(2618),n(2363),n(5765),n(5617),n(1056),n(9333),n(9759),n(5951),n(7415),n(8347),n(3629),n(5719),n(3006),n(7235),n(786),n(4565),n(4888),n(4675),n(7508),n(4690),n(5375),n(1750),n(4845),n(9420),n(9579),n(7262),n(8527),n(3216),n(9831),n(11),n(4164),n(2145),n(7152))},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var k=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var P,L=Object.assign;function Z(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Z(e):""}function U(e){switch(e.tag){case 5:return Z(e.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case I:return"Fragment";case w:return"Portal";case C:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case D:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ie=null,Se=null;function Ce(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=xa(t),we(e.stateNode,e.type,t))}}function _e(e){Ie?Se?Se.push(e):Se=[e]:Ie=e}function Te(){if(Ie){var e=Ie,t=Se;if(Se=Ie=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ee(e,t){return e(t)}function Ne(){}var De=!1;function Ae(e,t,n){if(De)return e(t,n);De=!0;try{return Ee(e,t,n)}finally{De=!1,(null!==Ie||null!==Se)&&(Ne(),Te())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Me=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){Me=!1}function Fe(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Pe=!1,Le=null,Ze=!1,ze=null,Be={onError:function(e){Pe=!0,Le=e}};function Ue(e,t,n,r,a,i,o,s,u){Pe=!1,Le=null,Fe.apply(Be,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return We(a),e;if(o===r)return We(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,Ke=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Xe=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,$e=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ht(s):0!==(i&=o)&&(r=ht(i))}else 0!==(o=n&~a)?r=ht(o):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function kt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,It,St,Ct,_t=!1,Tt=[],Et=null,Nt=null,Dt=null,At=new Map,Rt=new Map,Mt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Pt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void Ct(e.priority,(function(){It(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ke=r,n.target.dispatchEvent(r),ke=null,t.shift()}return!0}function zt(e,t,n){Zt(e)&&n.delete(t)}function Bt(){_t=!1,null!==Et&&Zt(Et)&&(Et=null),null!==Nt&&Zt(Nt)&&(Nt=null),null!==Dt&&Zt(Dt)&&(Dt=null),At.forEach(zt),Rt.forEach(zt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<Tt.length){Ut(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Ut(Et,e),null!==Nt&&Ut(Nt,e),null!==Dt&&Ut(Dt,e),At.forEach(t),Rt.forEach(t),n=0;n<Mt.length;n++)(r=Mt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Mt.shift()}var jt=k.ReactCurrentBatchConfig,Wt=!0;function Ht(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=1,qt(e,t,n,r)}finally{bt=a,jt.transition=i}}function Gt(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=4,qt(e,t,n,r)}finally{bt=a,jt.transition=i}}function qt(e,t,n,r){if(Wt){var a=Yt(e,t,n,r);if(null===a)Wr(e,t,r,Kt,n),Ft(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Et=Pt(Et,e,t,n,r,a),!0;case"dragenter":return Nt=Pt(Nt,e,t,n,r,a),!0;case"mouseover":return Dt=Pt(Dt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Pt(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rt.set(i,Pt(Rt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&xt(i),null===(i=Yt(e,t,n,r))&&Wr(e,t,r,Kt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Kt=null;function Yt(e,t,n,r){if(Kt=null,null!==(e=ya(e=xe(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return $t=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),hn=L({},cn,{view:0,detail:0}),fn=an(hn),dn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(dn),vn=an(L({},dn,{dataTransfer:0})),gn=an(L({},hn,{relatedTarget:0})),mn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),kn=an(L({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function Cn(){return Sn}var _n=L({},hn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(_n),En=an(L({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Dn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=L({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(An),Mn=[9,13,27,32],On=l&&"CompositionEvent"in window,Fn=null;l&&"documentMode"in document&&(Fn=document.documentMode);var Pn=l&&"TextEvent"in window&&!Fn,Ln=l&&(!On||Fn&&8<Fn&&11>=Fn),Zn=String.fromCharCode(32),zn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Hn(e,t,n,r){_e(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,qn=null;function Kn(e){Zr(e,0)}function Yn(e){if(q(ka(e)))return e}function Xn(e,t){if("change"===e)return t}var Qn=!1;if(l){var Jn;if(l){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),qn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(qn)){var t=[];Hn(t,qn,e,xe(e)),Ae(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(qn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,br=!1;function kr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==K(r)||("selectionStart"in(r=gr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Gr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Ir={},Sr={};function Cr(e){if(Ir[e])return Ir[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Ir[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var _r=Cr("animationend"),Tr=Cr("animationiteration"),Er=Cr("animationstart"),Nr=Cr("transitionend"),Dr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Dr.set(e,t),u(t,[e])}for(var Mr=0;Mr<Ar.length;Mr++){var Or=Ar[Mr];Rr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Rr(_r,"onAnimationEnd"),Rr(Tr,"onAnimationIteration"),Rr(Er,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(Ue.apply(this,arguments),Pe){if(!Pe)throw Error(i(198));var l=Le;Pe=!1,Le=null,Ze||(Ze=!0,ze=l)}}(r,t,void 0,e),e.currentTarget=null}function Zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}}}if(Ze)throw e=ze,Ze=!1,ze=null,e}function zr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Ur]){e[Ur]=!0,o.forEach((function(t){"selectionchange"!==t&&(Pr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Br("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Xt(t)){case 1:var a=Ht;break;case 4:a=Gt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=xe(n),o=[];e:{var s=Dr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Tn;break;case"focusin":c="focus",u=gn;break;case"focusout":c="blur",u=gn;break;case"beforeblur":case"afterblur":u=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Nn;break;case _r:case Tr:case Er:u=mn;break;case Nr:u=Dn;break;case"scroll":u=fn;break;case"wheel":u=Rn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=En}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==f&&(null!=(v=Re(p,f))&&l.push(Hr(p,v,d)))),h)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ke||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=En,v="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==u?s:ka(u),d=null==c?s:ka(c),(s=new l(v,p+"leave",u,n,a)).target=h,s.relatedTarget=d,v=null,ya(a)===r&&((l=new l(f,p+"enter",c,n,a)).target=d,l.relatedTarget=h,v=l),h=v,u&&c)e:{for(f=c,p=0,d=l=u;d;d=qr(d))p++;for(d=0,v=f;v;v=qr(v))d++;for(;0<p-d;)l=qr(l),p--;for(;0<d-p;)f=qr(f),d--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=qr(l),f=qr(f)}l=null}else l=null;null!==u&&Kr(o,s,u,l,!1),null!==c&&null!==h&&Kr(o,h,c,l,!0)}if("select"===(u=(s=r?ka(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Xn;else if(Wn(s))if(Qn)g=or;else{g=ar;var m=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ir);switch(g&&(g=g(e,r))?Hn(o,g,n,a):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ee(s,"number",s.value)),m=r?ka(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,kr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":kr(o,n,a)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=en()):(Jt="value"in(Qt=a)?Qt.value:Qt.textContent,Vn=!0)),0<(m=Gr(r,b)).length&&(b=new kn(b,e,null,n,a),o.push({event:b,listeners:m}),y?b.data=y:null!==(y=Un(n))&&(b.data=y))),(y=Pn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(zn=!0,Zn);case"textInput":return(e=t.data)===Zn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),$t=Jt=Qt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new kn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Zr(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Re(e,n))&&r.unshift(Hr(e,i,a)),null!=(i=Re(e,t))&&r.push(Hr(e,i,a))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Re(n,i))&&o.unshift(Hr(n,u,s)):a||null!=(u=Re(n,i))&&o.push(Hr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function $r(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),fa="__reactFiber$"+ha,da="__reactProps$"+ha,pa="__reactContainer$"+ha,va="__reactEvents$"+ha,ga="__reactListeners$"+ha,ma="__reactHandles$"+ha;function ya(e){var t=e[fa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[fa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[fa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[fa]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ka(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xa(e){return e[da]||null}var wa=[],Ia=-1;function Sa(e){return{current:e}}function Ca(e){0>Ia||(e.current=wa[Ia],wa[Ia]=null,Ia--)}function _a(e,t){Ia++,wa[Ia]=e.current,e.current=t}var Ta={},Ea=Sa(Ta),Na=Sa(!1),Da=Ta;function Aa(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Ca(Na),Ca(Ea)}function Oa(e,t,n){if(Ea.current!==Ta)throw Error(i(168));_a(Ea,t),_a(Na,n)}function Fa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,j(e)||"Unknown",a));return L({},n,r)}function Pa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Da=Ea.current,_a(Ea,e),_a(Na,Na.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fa(e,t,Da),r.__reactInternalMemoizedMergedChildContext=e,Ca(Na),Ca(Ea),_a(Ea,e)):Ca(Na),_a(Na,n)}var Za=null,za=!1,Ba=!1;function Ua(e){null===Za?Za=[e]:Za.push(e)}function Va(){if(!Ba&&null!==Za){Ba=!0;var e=0,t=bt;try{var n=Za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Za=null,za=!1}catch(a){throw null!==Za&&(Za=Za.slice(e+1)),qe($e,Va),a}finally{bt=t,Ba=!1}}return null}var ja=[],Wa=0,Ha=null,Ga=0,qa=[],Ka=0,Ya=null,Xa=1,Qa="";function Ja(e,t){ja[Wa++]=Ga,ja[Wa++]=Ha,Ha=e,Ga=t}function $a(e,t,n){qa[Ka++]=Xa,qa[Ka++]=Qa,qa[Ka++]=Ya,Ya=e;var r=Xa;e=Qa;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Xa=1<<32-ot(t)+a|n<<a|r,Qa=i+e}else Xa=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&(Ja(e,1),$a(e,1,0))}function ti(e){for(;e===Ha;)Ha=ja[--Wa],ja[Wa]=null,Ga=ja[--Wa],ja[Wa]=null;for(;e===Ya;)Ya=qa[--Ka],qa[Ka]=null,Qa=qa[--Ka],qa[Ka]=null,Xa=qa[--Ka],qa[Ka]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Xa,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function hi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw fi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ri;e;)e=ca(e.nextSibling)}function di(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var vi=k.ReactCurrentBatchConfig;function gi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var mi=Sa(null),yi=null,bi=null,ki=null;function xi(){ki=bi=yi=null}function wi(e){var t=mi.current;Ca(mi),e._currentValue=t}function Ii(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){yi=e,ki=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ks=!0),e.firstContext=null)}function Ci(e){var t=e._currentValue;if(ki!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var _i=null;function Ti(e){null===_i?_i=[e]:_i.push(e)}function Ei(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ti(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ni(e,r)}function Ni(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Di=!1;function Ai(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ni(e,n)}return null===(a=r.interleaved)?(t.next=t,Ti(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ni(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Pi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var a=e.updateQueue;Di=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var h=a.baseState;for(o=0,l=c=u=null,s=i;;){var f=s.lane,d=s.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(f=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=v.payload)?p.call(d,h,f):p)||void 0===f)break e;h=L({},h,f);break e;case 2:Di=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=a.effects)?a.effects=[s]:f.push(s))}else d={eventTime:d,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=h):l=l.next=d,o|=f;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(f=s).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===l&&(u=h),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Lu|=o,e.lanes=o,e.memoizedState=h}}function Zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var zi=(new r.Component).refs;function Bi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Mi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(rc(t,e,a,r),Fi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=Mi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(rc(t,e,a,r),Fi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Mi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Oi(e,a,r))&&(rc(t,e,r,n),Fi(t,e,r))}};function Vi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function ji(e,t,n){var r=!1,a=Ta,i=t.contextType;return"object"===typeof i&&null!==i?i=Ci(i):(a=Ra(t)?Da:Ea.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):Ta),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function Hi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=zi,Ai(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ci(i):(i=Ra(t)?Da:Ea.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Bi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Ui.enqueueReplaceState(a,a.state,null),Li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===zi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ki(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Zc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===I?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===R&&Ki(i)===t.type)?((r=a(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=Fc(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Pc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Zc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Fc(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case w:return(t=zc(t,e.mode,n)).return=e,t;case R:return f(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Pc(t,e.mode,n,null)).return=e,t;qi(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case R:return d(e,t,(a=n._init)(n._payload),r)}if(te(n)||F(n))return null!==a?null:h(e,t,n,r,null);qi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case R:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||F(r))return h(t,e=e.get(n)||null,r,a,null);qi(t,r)}return null}function v(a,i,s,u){for(var c=null,l=null,h=i,v=i=0,g=null;null!==h&&v<s.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var m=d(a,h,s[v],u);if(null===m){null===h&&(h=g);break}e&&h&&null===m.alternate&&t(a,h),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m,h=g}if(v===s.length)return n(a,h),ai&&Ja(a,v),c;if(null===h){for(;v<s.length;v++)null!==(h=f(a,s[v],u))&&(i=o(h,i,v),null===l?c=h:l.sibling=h,l=h);return ai&&Ja(a,v),c}for(h=r(a,h);v<s.length;v++)null!==(g=p(h,a,v,s[v],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?v:g.key),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g);return e&&h.forEach((function(e){return t(a,e)})),ai&&Ja(a,v),c}function g(a,s,u,c){var l=F(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var h=l=null,v=s,g=s=0,m=null,y=u.next();null!==v&&!y.done;g++,y=u.next()){v.index>g?(m=v,v=null):m=v.sibling;var b=d(a,v,y.value,c);if(null===b){null===v&&(v=m);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,g),null===h?l=b:h.sibling=b,h=b,v=m}if(y.done)return n(a,v),ai&&Ja(a,g),l;if(null===v){for(;!y.done;g++,y=u.next())null!==(y=f(a,y.value,c))&&(s=o(y,s,g),null===h?l=y:h.sibling=y,h=y);return ai&&Ja(a,g),l}for(v=r(a,v);!y.done;g++,y=u.next())null!==(y=p(v,a,g,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=o(y,s,g),null===h?l=y:h.sibling=y,h=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Ja(a,g),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===I&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===I){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&Ki(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Gi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===I?((i=Pc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Fc(o.type,o.key,o.props,null,r.mode,u)).ref=Gi(r,i,o),u.return=r,r=u)}return s(r);case w:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=zc(o,r.mode,u)).return=r,r=i}return s(r);case R:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(F(o))return g(r,i,o,u);qi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Zc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Xi=Yi(!0),Qi=Yi(!1),Ji={},$i=Sa(Ji),eo=Sa(Ji),to=Sa(Ji);function no(e){if(e===Ji)throw Error(i(174));return e}function ro(e,t){switch(_a(to,t),_a(eo,e),_a($i,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca($i),_a($i,t)}function ao(){Ca($i),Ca(eo),Ca(to)}function io(e){no(to.current);var t=no($i.current),n=ue(t,e.type);t!==n&&(_a(eo,e),_a($i,n))}function oo(e){eo.current===e&&(Ca($i),Ca(eo))}var so=Sa(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=k.ReactCurrentDispatcher,fo=k.ReactCurrentBatchConfig,po=0,vo=null,go=null,mo=null,yo=!1,bo=!1,ko=0,xo=0;function wo(){throw Error(i(321))}function Io(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function So(e,t,n,r,a,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,ko=0,25<=o)throw Error(i(301));o+=1,mo=go=null,t.updateQueue=null,ho.current=cs,e=n(r,a)}while(bo)}if(ho.current=os,t=null!==go&&null!==go.next,po=0,mo=go=vo=null,yo=!1,t)throw Error(i(300));return e}function Co(){var e=0!==ko;return ko=0,e}function _o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function To(){if(null===go){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=go.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,go=e;else{if(null===e)throw Error(i(310));e={memoizedState:(go=e).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function Eo(e,t){return"function"===typeof t?t(e):t}function No(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=go,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var h=l.lane;if((po&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=f,s=r):c=c.next=f,vo.lanes|=h,Lu|=h}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(ks=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Lu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Do(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(ks=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Ro(e,t){var n=vo,r=To(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,ks=!0),r=r.queue,Wo(Fo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,zo(9,Oo.bind(null,n,r,a,t),void 0,null),null===Du)throw Error(i(349));0!==(30&po)||Mo(n,t,a)}return a}function Mo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,r){t.value=n,t.getSnapshot=r,Po(t)&&Lo(e)}function Fo(e,t,n){return n((function(){Po(t)&&Lo(e)}))}function Po(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Lo(e){var t=Ni(e,1);null!==t&&rc(t,e,1,-1)}function Zo(e){var t=_o();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function zo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bo(){return To().memoizedState}function Uo(e,t,n,r){var a=_o();vo.flags|=e,a.memoizedState=zo(1|t,n,void 0,void 0===r?null:r)}function Vo(e,t,n,r){var a=To();r=void 0===r?null:r;var i=void 0;if(null!==go){var o=go.memoizedState;if(i=o.destroy,null!==r&&Io(r,o.deps))return void(a.memoizedState=zo(t,n,i,r))}vo.flags|=e,a.memoizedState=zo(1|t,n,i,r)}function jo(e,t){return Uo(8390656,8,e,t)}function Wo(e,t){return Vo(2048,8,e,t)}function Ho(e,t){return Vo(4,2,e,t)}function Go(e,t){return Vo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4,4,qo.bind(null,t,e),n)}function Yo(){}function Xo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Io(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Io(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,ks=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Lu|=n,e.baseState=!0),t)}function $o(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{bt=n,fo.transition=r}}function es(){return To().memoizedState}function ts(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ei(e,t,n,r))){rc(n,e,r,tc()),is(n,t,r)}}function ns(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,Ti(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ei(e,t,a,r))&&(rc(n,e,r,a=tc()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ci,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},ss={readContext:Ci,useCallback:function(e,t){return _o().memoizedState=[e,void 0===t?null:t],e},useContext:Ci,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uo(4,2,e,t)},useMemo:function(e,t){var n=_o();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_o();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_o().memoizedState=e},useState:Zo,useDebugValue:Yo,useDeferredValue:function(e){return _o().memoizedState=e},useTransition:function(){var e=Zo(!1),t=e[0];return e=$o.bind(null,e[1]),_o().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=_o();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Du)throw Error(i(349));0!==(30&po)||Mo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,jo(Fo.bind(null,r,o,e),[e]),r.flags|=2048,zo(9,Oo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=_o(),t=Du.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Xa&~(1<<32-ot(Xa)-1)).toString(32)+n),0<(n=ko++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=xo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ci,useCallback:Xo,useContext:Ci,useEffect:Wo,useImperativeHandle:Ko,useInsertionEffect:Ho,useLayoutEffect:Go,useMemo:Qo,useReducer:No,useRef:Bo,useState:function(){return No(Eo)},useDebugValue:Yo,useDeferredValue:function(e){return Jo(To(),go.memoizedState,e)},useTransition:function(){return[No(Eo)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Ro,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ci,useCallback:Xo,useContext:Ci,useEffect:Wo,useImperativeHandle:Ko,useInsertionEffect:Ho,useLayoutEffect:Go,useMemo:Qo,useReducer:Do,useRef:Bo,useState:function(){return Do(Eo)},useDebugValue:Yo,useDeferredValue:function(e){var t=To();return null===go?t.memoizedState=e:Jo(t,go.memoizedState,e)},useTransition:function(){return[Do(Eo)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Ro,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function hs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Mi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hu||(Hu=!0,Gu=r),fs(0,t)},n}function vs(e,t,n){(n=Mi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){fs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fs(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Mi(-1,1)).tag=2,Oi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=k.ReactCurrentOwner,ks=!1;function xs(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Xi(t,e.child,n,r)}function ws(e,t,n,r,a){n=n.render;var i=t.ref;return Si(t,a),r=So(e,t,n,r,i,a),n=Co(),null===e||ks?(ai&&n&&ei(t),t.flags|=1,xs(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Is(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Mc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Hs(e,t,a)}return t.flags|=1,(e=Oc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(ks=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Hs(e,t,a);0!==(131072&e.flags)&&(ks=!0)}}return Ts(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_a(Ou,Mu),Mu|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_a(Ou,Mu),Mu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,_a(Ou,Mu),Mu|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,_a(Ou,Mu),Mu|=r;return xs(e,t,a,n),t.child}function _s(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,r,a){var i=Ra(n)?Da:Ea.current;return i=Aa(t,i),Si(t,a),n=So(e,t,n,r,i,a),r=Co(),null===e||ks?(ai&&r&&ei(t),t.flags|=1,xs(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hs(e,t,a))}function Es(e,t,n,r,a){if(Ra(n)){var i=!0;Pa(t)}else i=!1;if(Si(t,a),null===t.stateNode)Ws(e,t),ji(t,n,r),Hi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ci(c):c=Aa(t,c=Ra(n)?Da:Ea.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Wi(t,o,r,c),Di=!1;var f=t.memoizedState;o.state=f,Li(t,r,o,a),u=t.memoizedState,s!==r||f!==u||Na.current||Di?("function"===typeof l&&(Bi(t,n,l,r),u=t.memoizedState),(s=Di||Vi(t,n,s,r,f,u,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ri(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:gi(t.type,s),o.props=c,h=t.pendingProps,f=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ci(u):u=Aa(t,u=Ra(n)?Da:Ea.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||f!==u)&&Wi(t,o,r,u),Di=!1,f=t.memoizedState,o.state=f,Li(t,r,o,a);var p=t.memoizedState;s!==h||f!==p||Na.current||Di?("function"===typeof d&&(Bi(t,n,d,r),p=t.memoizedState),(c=Di||Vi(t,n,c,r,f,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Ns(e,t,n,r,i,a)}function Ns(e,t,n,r,a,i){_s(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Hs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Xi(t,e.child,null,i),t.child=Xi(t,null,s,i)):xs(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Ds(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),ro(e,t.containerInfo)}function As(e,t,n,r,a){return di(),pi(a),t.flags|=256,xs(e,t,n,r),t.child}var Rs,Ms,Os,Fs,Ps={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Zs(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),_a(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Lc(u,a,0,null),e=Pc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ps,e):zs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,r=hs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(o=Pc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Xi(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ps,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Bs(e,t,s,r=hs(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),ks||u){if(null!==(r=Du)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ni(e,a),rc(r,e,a,-1))}return gc(),Bs(e,t,s,r=hs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(qa[Ka++]=Xa,qa[Ka++]=Qa,qa[Ka++]=Ya,Xa=e.id,Qa=e.overflow,Ya=t),t=zs(t,r.children),t.flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Oc(r,s):(s=Pc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?Ls(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Ps,a}return e=(s=e.child).sibling,a=Oc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function zs(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,n,r){return null!==r&&pi(r),Xi(t,e.child,null,n),(e=zs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ii(e.return,t,n)}function Vs(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function js(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,n,t);else if(19===e.tag)Us(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_a(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Vs(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Vs(t,!0,n,null,i);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Ra(t.type)&&Ma(),qs(t),null;case 3:return r=t.stateNode,ao(),Ca(Na),Ca(Ea),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sc(ii),ii=null))),Ms(e,t),qs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Os(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=no($i.current),hi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fa]=t,r[da]=o,e=0!==(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)zr(Fr[a],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":X(r,o),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},zr("invalid",r);break;case"textarea":ae(r,o),zr("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&zr("scroll",r)}switch(n){case"input":G(r),$(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[fa]=t,e[da]=r,Rs(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),a=r;break;case"iframe":case"object":case"embed":zr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)zr(Fr[a],e);a=r;break;case"source":zr("error",e),a=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),a=r;break;case"details":zr("toggle",e),a=r;break;case"input":X(e,r),a=Y(e,r),zr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),zr("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ge(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&zr("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":G(e),$(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Fs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no($i.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[fa]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fa]=t,t.stateNode=r}return qs(t),null;case 13:if(Ca(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))fi(),di(),t.flags|=98560,o=!1;else if(o=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[fa]=t}else di(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(sc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Fu&&(Fu=3):gc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ao(),Ms(e,t),null===e&&Vr(t.stateNode.containerInfo),qs(t),null;case 10:return wi(t.type._context),qs(t),null;case 19:if(Ca(so),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Gs(o,!1);else{if(0!==Fu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Gs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _a(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>ju&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return qs(t),null}else 2*Qe()-o.renderingStartTime>ju&&1073741824!==n&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=so.current,_a(so,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Mu)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ys(e,t){switch(ti(t),t.tag){case 1:return Ra(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Ca(Na),Ca(Ea),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ca(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));di()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(so),null;case 4:return ao(),null;case 10:return wi(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Rs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ms=function(){},Os=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no($i.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&zr("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Fs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xs=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function eu(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function tu(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var nu=!1;function ru(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tu(t,n,i)}a=a.next}while(a!==r)}}function au(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function iu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ou(e){var t=e.alternate;null!==t&&(e.alternate=null,ou(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fa],delete t[da],delete t[va],delete t[ga],delete t[ma])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}function lu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lu(e,t,n),e=e.sibling;null!==e;)lu(e,t,n),e=e.sibling}var hu=null,fu=!1;function du(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||eu(n,t);case 6:var r=hu,a=fu;hu=null,du(e,t,n),fu=a,null!==(hu=r)&&(fu?(e=hu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hu.removeChild(n.stateNode));break;case 18:null!==hu&&(fu?(e=hu,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Vt(e)):ua(hu,n.stateNode));break;case 4:r=hu,a=fu,hu=n.stateNode.containerInfo,fu=!0,du(e,t,n),hu=r,fu=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tu(n,t,o),a=a.next}while(a!==r)}du(e,t,n);break;case 1:if(!Qs&&(eu(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Cc(n,t,s)}du(e,t,n);break;case 21:du(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,du(e,t,n),Qs=r):du(e,t,n);break;default:du(e,t,n)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:hu=u.stateNode,fu=!1;break e;case 3:case 4:hu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===hu)throw Error(i(160));pu(o,s,a),hu=null,fu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Cc(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),yu(e),4&r){try{ru(3,e,e.return),au(3,e)}catch(g){Cc(e,e.return,g)}try{ru(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return);break;case 5:if(gu(t,e),yu(e),512&r&&null!==n&&eu(n,n.return),32&e.flags){var a=e.stateNode;try{fe(a,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Q(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var h=c[s],f=c[s+1];"style"===h?ge(a,f):"dangerouslySetInnerHTML"===h?he(a,f):"children"===h?fe(a,f):b(a,h,f,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[da]=o}catch(g){Cc(e,e.return,g)}}break;case 6:if(gu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){Cc(e,e.return,g)}}break;case 3:if(gu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:gu(t,e),yu(e);break;case 13:gu(t,e),yu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Vu=Qe())),4&r&&vu(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||h,gu(t,e),Qs=l):gu(t,e),yu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!h&&0!==(1&e.mode))for($s=e,h=e.child;null!==h;){for(f=$s=h;null!==$s;){switch(p=(d=$s).child,d.tag){case 0:case 11:case 14:case 15:ru(4,d,d.return);break;case 1:eu(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){r=d,n=d.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:eu(d,d.return);break;case 22:if(null!==d.memoizedState){wu(f);continue}}null!==p?(p.return=d,$s=p):wu(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{a=f.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(g){Cc(e,e.return,g)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gu(t,e),yu(e),4&r&&vu(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(su(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(fe(a,""),r.flags&=-33),lu(e,uu(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cu(e,uu(e),o);break;default:throw Error(i(161))}}catch(s){Cc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,n){$s=e,ku(e,t,n)}function ku(e,t,n){for(var r=0!==(1&e.mode);null!==$s;){var a=$s,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Xs;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Xs;var c=Qs;if(Xs=o,(Qs=u)&&!c)for($s=a;null!==$s;)u=(o=$s).child,22===o.tag&&null!==o.memoizedState?Iu(a):null!==u?(u.return=o,$s=u):Iu(a);for(;null!==i;)$s=i,ku(i,t,n),i=i.sibling;$s=a,Xs=s,Qs=c}xu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,$s=i):xu(e)}}function xu(e){for(;null!==$s;){var t=$s;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||au(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Zi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Zi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&Vt(f)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&iu(t)}catch(d){Cc(t,t.return,d)}}if(t===e){$s=null;break}if(null!==(n=t.sibling)){n.return=t.return,$s=n;break}$s=t.return}}function wu(e){for(;null!==$s;){var t=$s;if(t===e){$s=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$s=n;break}$s=t.return}}function Iu(e){for(;null!==$s;){var t=$s;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(u){Cc(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Cc(t,a,u)}}var i=t.return;try{iu(t)}catch(u){Cc(t,i,u)}break;case 5:var o=t.return;try{iu(t)}catch(u){Cc(t,o,u)}}}catch(u){Cc(t,t.return,u)}if(t===e){$s=null;break}var s=t.sibling;if(null!==s){s.return=t.return,$s=s;break}$s=t.return}}var Su,Cu=Math.ceil,_u=k.ReactCurrentDispatcher,Tu=k.ReactCurrentOwner,Eu=k.ReactCurrentBatchConfig,Nu=0,Du=null,Au=null,Ru=0,Mu=0,Ou=Sa(0),Fu=0,Pu=null,Lu=0,Zu=0,zu=0,Bu=null,Uu=null,Vu=0,ju=1/0,Wu=null,Hu=!1,Gu=null,qu=null,Ku=!1,Yu=null,Xu=0,Qu=0,Ju=null,$u=-1,ec=0;function tc(){return 0!==(6&Nu)?Qe():-1!==$u?$u:$u=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nu)&&0!==Ru?Ru&-Ru:null!==vi.transition?(0===ec&&(ec=vt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,n,r){if(50<Qu)throw Qu=0,Ju=null,Error(i(185));mt(e,n,r),0!==(2&Nu)&&e===Du||(e===Du&&(0===(2&Nu)&&(Zu|=n),4===Fu&&uc(e,Ru)),ac(e,r),1===n&&0===Nu&&0===(1&t.mode)&&(ju=Qe()+500,za&&Va()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=dt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ft(e,e===Du?Ru:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){za=!0,Ua(e)}(cc.bind(null,e)):Ua(cc.bind(null,e)),oa((function(){0===(6&Nu)&&Va()})),n=null;else{switch(kt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Dc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if($u=-1,ec=0,0!==(6&Nu))throw Error(i(327));var n=e.callbackNode;if(Ic()&&e.callbackNode!==n)return null;var r=ft(e,e===Du?Ru:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Nu;Nu|=2;var o=vc();for(Du===e&&Ru===t||(Wu=null,ju=Qe()+500,dc(e,t));;)try{bc();break}catch(u){pc(e,u)}xi(),_u.current=o,Nu=a,null!==Au?t=0:(Du=null,Ru=0,t=Fu)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t)throw n=Pu,dc(e,0),uc(e,r),ac(e,Qe()),n;if(6===t)uc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Pu,dc(e,0),uc(e,r),ac(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Uu,Wu);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=Vu+500-Qe())){if(0!==ft(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,Uu,Wu),t);break}wc(e,Uu,Wu);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cu(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,Uu,Wu),r);break}wc(e,Uu,Wu);break;default:throw Error(i(329))}}}return ac(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=Bu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Uu,Uu=n,null!==t&&sc(t)),e}function sc(e){null===Uu?Uu=e:Uu.push.apply(Uu,e)}function uc(e,t){for(t&=~zu,t&=~Zu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Nu))throw Error(i(327));Ic();var t=ft(e,0);if(0===(1&t))return ac(e,Qe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Pu,dc(e,0),uc(e,t),ac(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Uu,Wu),ac(e,Qe()),null}function lc(e,t){var n=Nu;Nu|=1;try{return e(t)}finally{0===(Nu=n)&&(ju=Qe()+500,za&&Va())}}function hc(e){null!==Yu&&0===Yu.tag&&0===(6&Nu)&&Ic();var t=Nu;Nu|=1;var n=Eu.transition,r=bt;try{if(Eu.transition=null,bt=1,e)return e()}finally{bt=r,Eu.transition=n,0===(6&(Nu=t))&&Va()}}function fc(){Mu=Ou.current,Ca(Ou)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Au)for(n=Au.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ma();break;case 3:ao(),Ca(Na),Ca(Ea),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ca(so);break;case 10:wi(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Du=e,Au=e=Oc(e.current,null),Ru=Mu=t,Fu=0,Pu=null,zu=Zu=Lu=0,Uu=Bu=null,null!==_i){for(t=0;t<_i.length;t++)if(null!==(r=(n=_i[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}_i=null}return e}function pc(e,t){for(;;){var n=Au;try{if(xi(),ho.current=os,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(po=0,mo=go=vo=null,bo=!1,ko=0,Tu.current=null,null===n||null===n.return){Fu=1,Pu=t,Au=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ru,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,ys(p,s,u,0,t),1&p.mode&&gs(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}if(0===(1&t)){gs(o,l,t),gc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var m=ms(s);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),ys(m,s,u,0,t),pi(ls(c,u));break e}}o=c=ls(c,u),4!==Fu&&(Fu=2),null===Bu?Bu=[o]:Bu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Pi(o,ps(0,c,t));break e;case 1:u=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Pi(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(k){t=k,Au===n&&null!==n&&(Au=n=n.return);continue}break}}function vc(){var e=_u.current;return _u.current=os,null===e?os:e}function gc(){0!==Fu&&3!==Fu&&2!==Fu||(Fu=4),null===Du||0===(268435455&Lu)&&0===(268435455&Zu)||uc(Du,Ru)}function mc(e,t){var n=Nu;Nu|=2;var r=vc();for(Du===e&&Ru===t||(Wu=null,dc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(xi(),Nu=n,_u.current=r,null!==Au)throw Error(i(261));return Du=null,Ru=0,Fu}function yc(){for(;null!==Au;)kc(Au)}function bc(){for(;null!==Au&&!Ye();)kc(Au)}function kc(e){var t=Su(e.alternate,e,Mu);e.memoizedProps=e.pendingProps,null===t?xc(e):Au=t,Tu.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Mu)))return void(Au=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Au=n);if(null===e)return Fu=6,void(Au=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Au=t);Au=t=e}while(null!==t);0===Fu&&(Fu=5)}function wc(e,t,n){var r=bt,a=Eu.transition;try{Eu.transition=null,bt=1,function(e,t,n,r){do{Ic()}while(null!==Yu);if(0!==(6&Nu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Du&&(Au=Du=null,Ru=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ku||(Ku=!0,Dc(tt,(function(){return Ic(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Eu.transition,Eu.transition=null;var s=bt;bt=1;var u=Nu;Nu|=4,Tu.current=null,function(e,t){if(ea=Wt,dr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var s=0,u=-1,c=-1,l=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==a&&3!==f.nodeType||(u=s+a),f!==o||0!==r&&3!==f.nodeType||(c=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++l===a&&(u=s),d===o&&++h===r&&(c=s),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,$s=t;null!==$s;)if(e=(t=$s).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$s=e;else for(;null!==$s;){t=$s;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:gi(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=t.stateNode.containerInfo;1===k.nodeType?k.textContent="":9===k.nodeType&&k.documentElement&&k.removeChild(k.documentElement);break;default:throw Error(i(163))}}catch(x){Cc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,$s=e;break}$s=t.return}v=nu,nu=!1}(e,n),mu(n,e),pr(ta),Wt=!!ea,ta=ea=null,e.current=n,bu(n,e,a),Xe(),Nu=u,bt=s,Eu.transition=o}else e.current=n;if(Ku&&(Ku=!1,Yu=e,Xu=a),o=e.pendingLanes,0===o&&(qu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hu)throw Hu=!1,e=Gu,Gu=null,e;0!==(1&Xu)&&0!==e.tag&&Ic(),o=e.pendingLanes,0!==(1&o)?e===Ju?Qu++:(Qu=0,Ju=e):Qu=0,Va()}(e,t,n,r)}finally{Eu.transition=a,bt=r}return null}function Ic(){if(null!==Yu){var e=kt(Xu),t=Eu.transition,n=bt;try{if(Eu.transition=null,bt=16>e?16:e,null===Yu)var r=!1;else{if(e=Yu,Yu=null,Xu=0,0!==(6&Nu))throw Error(i(331));var a=Nu;for(Nu|=4,$s=e.current;null!==$s;){var o=$s,s=o.child;if(0!==(16&$s.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for($s=l;null!==$s;){var h=$s;switch(h.tag){case 0:case 11:case 15:ru(8,h,o)}var f=h.child;if(null!==f)f.return=h,$s=f;else for(;null!==$s;){var d=(h=$s).sibling,p=h.return;if(ou(h),h===l){$s=null;break}if(null!==d){d.return=p,$s=d;break}$s=p}}}var v=o.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}$s=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,$s=s;else e:for(;null!==$s;){if(0!==(2048&(o=$s).flags))switch(o.tag){case 0:case 11:case 15:ru(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,$s=y;break e}$s=o.return}}var b=e.current;for($s=b;null!==$s;){var k=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==k)k.return=s,$s=k;else e:for(s=b;null!==$s;){if(0!==(2048&(u=$s).flags))try{switch(u.tag){case 0:case 11:case 15:au(9,u)}}catch(w){Cc(u,u.return,w)}if(u===s){$s=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,$s=x;break e}$s=u.return}}if(Nu=a,Va(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Eu.transition=t}}return!1}function Sc(e,t,n){e=Oi(e,t=ps(0,t=ls(n,t),1),1),t=tc(),null!==e&&(mt(e,1,t),ac(e,t))}function Cc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=Oi(t,e=vs(t,e=ls(n,e),1),1),e=tc(),null!==t&&(mt(t,1,e),ac(t,e));break}}t=t.return}}function _c(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Du===e&&(Ru&n)===n&&(4===Fu||3===Fu&&(130023424&Ru)===Ru&&500>Qe()-Vu?dc(e,0):zu|=n),ac(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Ni(e,t))&&(mt(e,t,n),ac(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Tc(e,n)}function Dc(e,t){return qe(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Ac(e,t,n,r)}function Mc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Mc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case I:return Pc(n.children,a,o,t);case S:s=8,a|=8;break;case C:return(e=Rc(12,n,t,2|a)).elementType=C,e.lanes=o,e;case N:return(e=Rc(13,n,t,a)).elementType=N,e.lanes=o,e;case D:return(e=Rc(19,n,t,a)).elementType=D,e.lanes=o,e;case M:return Lc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:s=10;break e;case T:s=9;break e;case E:s=11;break e;case A:s=14;break e;case R:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Rc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Pc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Zc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,n,r,a,i,o,s,u){return e=new Bc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Rc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ai(i),e}function Vc(e){if(!e)return Ta;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ra(n))return Fa(e,n,t)}return t}function jc(e,t,n,r,a,i,o,s,u){return(e=Uc(n,r,!0,e,0,i,0,s,u)).context=Vc(null),n=e.current,(i=Mi(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Oi(n,i,a),e.current.lanes=a,mt(e,a,r),ac(e,r),e}function Wc(e,t,n,r){var a=t.current,i=tc(),o=nc(a);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Mi(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oi(a,t,o))&&(rc(e,a,o,i),Fi(e,a,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Su=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)ks=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ks=!1,function(e,t,n){switch(t.tag){case 3:Ds(t),di();break;case 5:io(t);break;case 1:Ra(t.type)&&Pa(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;_a(mi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_a(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Zs(e,t,n):(_a(so,1&so.current),null!==(e=Hs(e,t,n))?e.sibling:null);_a(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return js(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),_a(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Hs(e,t,n)}(e,t,n);ks=0!==(131072&e.flags)}else ks=!1,ai&&0!==(1048576&t.flags)&&$a(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ws(e,t),e=t.pendingProps;var a=Aa(t,Ea.current);Si(t,n),a=So(null,t,r,e,a,n);var o=Co();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(r)?(o=!0,Pa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ai(t),a.updater=Ui,t.stateNode=a,a._reactInternals=t,Hi(t,r,e,n),t=Ns(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),xs(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Mc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===A)return 14}return 2}(r),e=gi(r,e),a){case 0:t=Ts(null,t,r,e,n);break e;case 1:t=Es(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Is(null,t,r,gi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Es(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 3:e:{if(Ds(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Ri(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(di(),r===a){t=Hs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),_s(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Zs(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Xi(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ws(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,_a(mi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Na.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Mi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ii(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ii(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}xs(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Si(t,n),r=r(a=Ci(a)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return a=gi(r=t.type,t.pendingProps),Is(e,t,r,a=gi(r.type,a),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gi(r,a),Ws(e,t),t.tag=1,Ra(r)?(e=!0,Pa(t)):e=!1,Si(t,n),ji(t,r,a),Hi(t,r,a,n),Ns(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Cs(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Hc(o);s.call(e)}}Wc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hc(o);i.call(e)}}var o=jc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[pa]=o.current,Vr(8===e.nodeType?e.parentNode:e),hc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(u);s.call(e)}}var u=Uc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=u,e[pa]=u.current,Vr(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,u,n,r)})),u}(n,t,e,a,r);return Hc(o)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wc(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[pa]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Lt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ac(t,Qe()),0===(6&Nu)&&(ju=Qe()+500,Va()))}break;case 13:hc((function(){var t=Ni(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),qc(e,1)}},wt=function(e){if(13===e.tag){var t=Ni(e,134217728);if(null!==t)rc(t,e,134217728,tc());qc(e,134217728)}},It=function(e){if(13===e.tag){var t=nc(e),n=Ni(e,t);if(null!==n)rc(n,e,t,tc());qc(e,t)}},St=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xa(r);if(!a)throw Error(i(90));q(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=lc,Ne=hc;var tl={usingClientEntryPoint:!1,Events:[ba,ka,xa,_e,Te,lc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,a,0,o,s),e[pa]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Xc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(hc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.s=r.createRoot,r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},77:function(e){var t="undefined"!==typeof Element,n="function"===typeof Map,r="function"===typeof Set,a="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function i(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var s,u,c,l;if(Array.isArray(e)){if((s=e.length)!=o.length)return!1;for(u=s;0!==u--;)if(!i(e[u],o[u]))return!1;return!0}if(n&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(l=e.entries();!(u=l.next()).done;)if(!o.has(u.value[0]))return!1;for(l=e.entries();!(u=l.next()).done;)if(!i(u.value[1],o.get(u.value[0])))return!1;return!0}if(r&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(l=e.entries();!(u=l.next()).done;)if(!o.has(u.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((s=e.length)!=o.length)return!1;for(u=s;0!==u--;)if(e[u]!==o[u])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"===typeof e.valueOf&&"function"===typeof o.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString&&"function"===typeof e.toString&&"function"===typeof o.toString)return e.toString()===o.toString();if((s=(c=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(u=s;0!==u--;)if(!Object.prototype.hasOwnProperty.call(o,c[u]))return!1;if(t&&e instanceof Element)return!1;for(u=s;0!==u--;)if(("_owner"!==c[u]&&"__v"!==c[u]&&"__o"!==c[u]||!e.$$typeof)&&!i(e[c[u]],o[c[u]]))return!1;return!0}return e!==e&&o!==o}e.exports=function(e,t){try{return i(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},11:function(e,t,n){"use strict";n.r(t),n.d(t,{IGNORE_CLASS_NAME:function(){return p}});var r=n(2791),a=n(4164);function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,n){return e===t||(e.correspondingElement?e.correspondingElement.classList.contains(n):e.classList.contains(n))}var u,c,l=(void 0===u&&(u=0),function(){return++u}),h={},f={},d=["touchstart","touchmove"],p="ignore-react-onclickoutside";function v(e,t){var n={};return-1!==d.indexOf(t)&&c&&(n.passive=!e.props.preventDefault),n}t.default=function(e,t){var n,u,d=e.displayName||e.name||"Component";return u=n=function(n){var u,p;function g(e){var r;return(r=n.call(this,e)||this).__outsideClickHandler=function(e){if("function"!==typeof r.__clickOutsideHandlerProp){var t=r.getInstance();if("function"!==typeof t.props.handleClickOutside){if("function"!==typeof t.handleClickOutside)throw new Error("WrappedComponent: "+d+" lacks a handleClickOutside(event) function for processing outside click events.");t.handleClickOutside(e)}else t.props.handleClickOutside(e)}else r.__clickOutsideHandlerProp(e)},r.__getComponentNode=function(){var e=r.getInstance();return t&&"function"===typeof t.setClickOutsideRef?t.setClickOutsideRef()(e):"function"===typeof e.setClickOutsideRef?e.setClickOutsideRef():(0,a.findDOMNode)(e)},r.enableOnClickOutside=function(){if("undefined"!==typeof document&&!f[r._uid]){"undefined"===typeof c&&(c=function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),n=function(){};return window.addEventListener("testPassiveEventSupport",n,t),window.removeEventListener("testPassiveEventSupport",n,t),e}}()),f[r._uid]=!0;var e=r.props.eventTypes;e.forEach||(e=[e]),h[r._uid]=function(e){var t;null!==r.componentNode&&(r.props.preventDefault&&e.preventDefault(),r.props.stopPropagation&&e.stopPropagation(),r.props.excludeScrollbar&&(t=e,document.documentElement.clientWidth<=t.clientX||document.documentElement.clientHeight<=t.clientY)||function(e,t,n){if(e===t)return!0;for(;e.parentNode||e.host;){if(e.parentNode&&s(e,t,n))return!0;e=e.parentNode||e.host}return e}(e.composed&&e.composedPath&&e.composedPath().shift()||e.target,r.componentNode,r.props.outsideClickIgnoreClass)===document&&r.__outsideClickHandler(e))},e.forEach((function(e){document.addEventListener(e,h[r._uid],v(o(r),e))}))}},r.disableOnClickOutside=function(){delete f[r._uid];var e=h[r._uid];if(e&&"undefined"!==typeof document){var t=r.props.eventTypes;t.forEach||(t=[t]),t.forEach((function(t){return document.removeEventListener(t,e,v(o(r),t))})),delete h[r._uid]}},r.getRef=function(e){return r.instanceRef=e},r._uid=l(),r}p=n,(u=g).prototype=Object.create(p.prototype),u.prototype.constructor=u,i(u,p);var m=g.prototype;return m.getInstance=function(){if(e.prototype&&!e.prototype.isReactComponent)return this;var t=this.instanceRef;return t.getInstance?t.getInstance():t},m.componentDidMount=function(){if("undefined"!==typeof document&&document.createElement){var e=this.getInstance();if(t&&"function"===typeof t.handleClickOutside&&(this.__clickOutsideHandlerProp=t.handleClickOutside(e),"function"!==typeof this.__clickOutsideHandlerProp))throw new Error("WrappedComponent: "+d+" lacks a function for processing outside click events specified by the handleClickOutside config option.");this.componentNode=this.__getComponentNode(),this.props.disableOnClickOutside||this.enableOnClickOutside()}},m.componentDidUpdate=function(){this.componentNode=this.__getComponentNode()},m.componentWillUnmount=function(){this.disableOnClickOutside()},m.render=function(){var t=this.props;t.excludeScrollbar;var n=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,["excludeScrollbar"]);return e.prototype&&e.prototype.isReactComponent?n.ref=this.getRef:n.wrappedRef=this.getRef,n.disableOnClickOutside=this.disableOnClickOutside,n.enableOnClickOutside=this.enableOnClickOutside,(0,r.createElement)(e,n)},g}(r.Component),n.displayName="OnClickOutside("+d+")",n.defaultProps={eventTypes:["mousedown","touchstart"],excludeScrollbar:t&&t.excludeScrollbar||!1,outsideClickIgnoreClass:p,preventDefault:!1,stopPropagation:!1},n.getClass=function(){return e.getClass?e.getClass():e},u}},2145:function(e,t,n){"use strict";n.r(t),n.d(t,{Manager:function(){return o},Popper:function(){return Fe},Reference:function(){return Ze},usePopper:function(){return Ae}});var r=n(2791),a=r.createContext(),i=r.createContext();function o(e){var t=e.children,n=r.useState(null),o=n[0],s=n[1],u=r.useRef(!1);r.useEffect((function(){return function(){u.current=!0}}),[]);var c=r.useCallback((function(e){u.current||s(e)}),[]);return r.createElement(a.Provider,{value:o},r.createElement(i.Provider,{value:c},t))}var s=function(e){return Array.isArray(e)?e[0]:e},u=function(e){if("function"===typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.apply(void 0,n)}},c=function(e,t){if("function"===typeof e)return u(e,t);null!=e&&(e.current=t)},l=function(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e}),{})},h="undefined"!==typeof window&&window.document&&window.document.createElement?r.useLayoutEffect:r.useEffect,f=n(4164);function d(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function p(e){return e instanceof d(e).Element||e instanceof Element}function v(e){return e instanceof d(e).HTMLElement||e instanceof HTMLElement}function g(e){return"undefined"!==typeof ShadowRoot&&(e instanceof d(e).ShadowRoot||e instanceof ShadowRoot)}var m=Math.max,y=Math.min,b=Math.round;function k(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function x(){return!/^((?!chrome|android).)*safari/i.test(k())}function w(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),a=1,i=1;t&&v(e)&&(a=e.offsetWidth>0&&b(r.width)/e.offsetWidth||1,i=e.offsetHeight>0&&b(r.height)/e.offsetHeight||1);var o=(p(e)?d(e):window).visualViewport,s=!x()&&n,u=(r.left+(s&&o?o.offsetLeft:0))/a,c=(r.top+(s&&o?o.offsetTop:0))/i,l=r.width/a,h=r.height/i;return{width:l,height:h,top:c,right:u+l,bottom:c+h,left:u,x:u,y:c}}function I(e){var t=d(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function S(e){return e?(e.nodeName||"").toLowerCase():null}function C(e){return((p(e)?e.ownerDocument:e.document)||window.document).documentElement}function _(e){return w(C(e)).left+I(e).scrollLeft}function T(e){return d(e).getComputedStyle(e)}function E(e){var t=T(e),n=t.overflow,r=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+a+r)}function N(e,t,n){void 0===n&&(n=!1);var r=v(t),a=v(t)&&function(e){var t=e.getBoundingClientRect(),n=b(t.width)/e.offsetWidth||1,r=b(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),i=C(t),o=w(e,a,n),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!n)&&(("body"!==S(t)||E(i))&&(s=function(e){return e!==d(e)&&v(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:I(e);var t}(t)),v(t)?((u=w(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):i&&(u.x=_(i))),{x:o.left+s.scrollLeft-u.x,y:o.top+s.scrollTop-u.y,width:o.width,height:o.height}}function D(e){var t=w(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function A(e){return"html"===S(e)?e:e.assignedSlot||e.parentNode||(g(e)?e.host:null)||C(e)}function R(e){return["html","body","#document"].indexOf(S(e))>=0?e.ownerDocument.body:v(e)&&E(e)?e:R(A(e))}function M(e,t){var n;void 0===t&&(t=[]);var r=R(e),a=r===(null==(n=e.ownerDocument)?void 0:n.body),i=d(r),o=a?[i].concat(i.visualViewport||[],E(r)?r:[]):r,s=t.concat(o);return a?s:s.concat(M(A(o)))}function O(e){return["table","td","th"].indexOf(S(e))>=0}function F(e){return v(e)&&"fixed"!==T(e).position?e.offsetParent:null}function P(e){for(var t=d(e),n=F(e);n&&O(n)&&"static"===T(n).position;)n=F(n);return n&&("html"===S(n)||"body"===S(n)&&"static"===T(n).position)?t:n||function(e){var t=/firefox/i.test(k());if(/Trident/i.test(k())&&v(e)&&"fixed"===T(e).position)return null;var n=A(e);for(g(n)&&(n=n.host);v(n)&&["html","body"].indexOf(S(n))<0;){var r=T(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var L="top",Z="bottom",z="right",B="left",U="auto",V=[L,Z,z,B],j="start",W="end",H="clippingParents",G="viewport",q="popper",K="reference",Y=V.reduce((function(e,t){return e.concat([t+"-"+j,t+"-"+W])}),[]),X=[].concat(V,[U]).reduce((function(e,t){return e.concat([t,t+"-"+j,t+"-"+W])}),[]),Q=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function J(e){var t=new Map,n=new Set,r=[];function a(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&a(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||a(e)})),r}function $(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var ee={placement:"bottom",modifiers:[],strategy:"absolute"};function te(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function ne(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,a=t.defaultOptions,i=void 0===a?ee:a;return function(e,t,n){void 0===n&&(n=i);var a={placement:"bottom",orderedModifiers:[],options:Object.assign({},ee,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],s=!1,u={state:a,setOptions:function(n){var s="function"===typeof n?n(a.options):n;c(),a.options=Object.assign({},i,a.options,s),a.scrollParents={reference:p(e)?M(e):e.contextElement?M(e.contextElement):[],popper:M(t)};var l=function(e){var t=J(e);return Q.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,a.options.modifiers)));return a.orderedModifiers=l.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,i=e.effect;if("function"===typeof i){var s=i({state:a,name:t,instance:u,options:r}),c=function(){};o.push(s||c)}})),u.update()},forceUpdate:function(){if(!s){var e=a.elements,t=e.reference,n=e.popper;if(te(t,n)){a.rects={reference:N(t,P(n),"fixed"===a.options.strategy),popper:D(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<a.orderedModifiers.length;r++)if(!0!==a.reset){var i=a.orderedModifiers[r],o=i.fn,c=i.options,l=void 0===c?{}:c,h=i.name;"function"===typeof o&&(a=o({state:a,options:l,name:h,instance:u})||a)}else a.reset=!1,r=-1}}},update:$((function(){return new Promise((function(e){u.forceUpdate(),e(a)}))})),destroy:function(){c(),s=!0}};if(!te(e,t))return u;function c(){o.forEach((function(e){return e()})),o=[]}return u.setOptions(n).then((function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var re={passive:!0};function ae(e){return e.split("-")[0]}function ie(e){return e.split("-")[1]}function oe(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function se(e){var t,n=e.reference,r=e.element,a=e.placement,i=a?ae(a):null,o=a?ie(a):null,s=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2;switch(i){case L:t={x:s,y:n.y-r.height};break;case Z:t={x:s,y:n.y+n.height};break;case z:t={x:n.x+n.width,y:u};break;case B:t={x:n.x-r.width,y:u};break;default:t={x:n.x,y:n.y}}var c=i?oe(i):null;if(null!=c){var l="y"===c?"height":"width";switch(o){case j:t[c]=t[c]-(n[l]/2-r[l]/2);break;case W:t[c]=t[c]+(n[l]/2-r[l]/2)}}return t}var ue={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ce(e){var t,n=e.popper,r=e.popperRect,a=e.placement,i=e.variation,o=e.offsets,s=e.position,u=e.gpuAcceleration,c=e.adaptive,l=e.roundOffsets,h=e.isFixed,f=o.x,p=void 0===f?0:f,v=o.y,g=void 0===v?0:v,m="function"===typeof l?l({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var y=o.hasOwnProperty("x"),k=o.hasOwnProperty("y"),x=B,w=L,I=window;if(c){var S=P(n),_="clientHeight",E="clientWidth";if(S===d(n)&&"static"!==T(S=C(n)).position&&"absolute"===s&&(_="scrollHeight",E="scrollWidth"),a===L||(a===B||a===z)&&i===W)w=Z,g-=(h&&S===I&&I.visualViewport?I.visualViewport.height:S[_])-r.height,g*=u?1:-1;if(a===B||(a===L||a===Z)&&i===W)x=z,p-=(h&&S===I&&I.visualViewport?I.visualViewport.width:S[E])-r.width,p*=u?1:-1}var N,D=Object.assign({position:s},c&&ue),A=!0===l?function(e,t){var n=e.x,r=e.y,a=t.devicePixelRatio||1;return{x:b(n*a)/a||0,y:b(r*a)/a||0}}({x:p,y:g},d(n)):{x:p,y:g};return p=A.x,g=A.y,u?Object.assign({},D,((N={})[w]=k?"0":"",N[x]=y?"0":"",N.transform=(I.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",N)):Object.assign({},D,((t={})[w]=k?g+"px":"",t[x]=y?p+"px":"",t.transform="",t))}var le={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,a=n.offset,i=void 0===a?[0,0]:a,o=X.reduce((function(e,n){return e[n]=function(e,t,n){var r=ae(e),a=[B,L].indexOf(r)>=0?-1:1,i="function"===typeof n?n(Object.assign({},t,{placement:e})):n,o=i[0],s=i[1];return o=o||0,s=(s||0)*a,[B,z].indexOf(r)>=0?{x:s,y:o}:{x:o,y:s}}(n,t.rects,i),e}),{}),s=o[t.placement],u=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=o}},he={left:"right",right:"left",bottom:"top",top:"bottom"};function fe(e){return e.replace(/left|right|bottom|top/g,(function(e){return he[e]}))}var de={start:"end",end:"start"};function pe(e){return e.replace(/start|end/g,(function(e){return de[e]}))}function ve(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&g(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function ge(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function me(e,t,n){return t===G?ge(function(e,t){var n=d(e),r=C(e),a=n.visualViewport,i=r.clientWidth,o=r.clientHeight,s=0,u=0;if(a){i=a.width,o=a.height;var c=x();(c||!c&&"fixed"===t)&&(s=a.offsetLeft,u=a.offsetTop)}return{width:i,height:o,x:s+_(e),y:u}}(e,n)):p(t)?function(e,t){var n=w(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):ge(function(e){var t,n=C(e),r=I(e),a=null==(t=e.ownerDocument)?void 0:t.body,i=m(n.scrollWidth,n.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=m(n.scrollHeight,n.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),s=-r.scrollLeft+_(e),u=-r.scrollTop;return"rtl"===T(a||n).direction&&(s+=m(n.clientWidth,a?a.clientWidth:0)-i),{width:i,height:o,x:s,y:u}}(C(e)))}function ye(e,t,n,r){var a="clippingParents"===t?function(e){var t=M(A(e)),n=["absolute","fixed"].indexOf(T(e).position)>=0&&v(e)?P(e):e;return p(n)?t.filter((function(e){return p(e)&&ve(e,n)&&"body"!==S(e)})):[]}(e):[].concat(t),i=[].concat(a,[n]),o=i[0],s=i.reduce((function(t,n){var a=me(e,n,r);return t.top=m(a.top,t.top),t.right=y(a.right,t.right),t.bottom=y(a.bottom,t.bottom),t.left=m(a.left,t.left),t}),me(e,o,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function be(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function ke(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function xe(e,t){void 0===t&&(t={});var n=t,r=n.placement,a=void 0===r?e.placement:r,i=n.strategy,o=void 0===i?e.strategy:i,s=n.boundary,u=void 0===s?H:s,c=n.rootBoundary,l=void 0===c?G:c,h=n.elementContext,f=void 0===h?q:h,d=n.altBoundary,v=void 0!==d&&d,g=n.padding,m=void 0===g?0:g,y=be("number"!==typeof m?m:ke(m,V)),b=f===q?K:q,k=e.rects.popper,x=e.elements[v?b:f],I=ye(p(x)?x:x.contextElement||C(e.elements.popper),u,l,o),S=w(e.elements.reference),_=se({reference:S,element:k,strategy:"absolute",placement:a}),T=ge(Object.assign({},k,_)),E=f===q?T:S,N={top:I.top-E.top+y.top,bottom:E.bottom-I.bottom+y.bottom,left:I.left-E.left+y.left,right:E.right-I.right+y.right},D=e.modifiersData.offset;if(f===q&&D){var A=D[a];Object.keys(N).forEach((function(e){var t=[z,Z].indexOf(e)>=0?1:-1,n=[L,Z].indexOf(e)>=0?"y":"x";N[e]+=A[n]*t}))}return N}function we(e,t,n){return m(e,y(t,n))}var Ie={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,a=n.mainAxis,i=void 0===a||a,o=n.altAxis,s=void 0!==o&&o,u=n.boundary,c=n.rootBoundary,l=n.altBoundary,h=n.padding,f=n.tether,d=void 0===f||f,p=n.tetherOffset,v=void 0===p?0:p,g=xe(t,{boundary:u,rootBoundary:c,padding:h,altBoundary:l}),b=ae(t.placement),k=ie(t.placement),x=!k,w=oe(b),I="x"===w?"y":"x",S=t.modifiersData.popperOffsets,C=t.rects.reference,_=t.rects.popper,T="function"===typeof v?v(Object.assign({},t.rects,{placement:t.placement})):v,E="number"===typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),N=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,A={x:0,y:0};if(S){if(i){var R,M="y"===w?L:B,O="y"===w?Z:z,F="y"===w?"height":"width",U=S[w],V=U+g[M],W=U-g[O],H=d?-_[F]/2:0,G=k===j?C[F]:_[F],q=k===j?-_[F]:-C[F],K=t.elements.arrow,Y=d&&K?D(K):{width:0,height:0},X=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Q=X[M],J=X[O],$=we(0,C[F],Y[F]),ee=x?C[F]/2-H-$-Q-E.mainAxis:G-$-Q-E.mainAxis,te=x?-C[F]/2+H+$+J+E.mainAxis:q+$+J+E.mainAxis,ne=t.elements.arrow&&P(t.elements.arrow),re=ne?"y"===w?ne.clientTop||0:ne.clientLeft||0:0,se=null!=(R=null==N?void 0:N[w])?R:0,ue=U+te-se,ce=we(d?y(V,U+ee-se-re):V,U,d?m(W,ue):W);S[w]=ce,A[w]=ce-U}if(s){var le,he="x"===w?L:B,fe="x"===w?Z:z,de=S[I],pe="y"===I?"height":"width",ve=de+g[he],ge=de-g[fe],me=-1!==[L,B].indexOf(b),ye=null!=(le=null==N?void 0:N[I])?le:0,be=me?ve:de-C[pe]-_[pe]-ye+E.altAxis,ke=me?de+C[pe]+_[pe]-ye-E.altAxis:ge,Ie=d&&me?function(e,t,n){var r=we(e,t,n);return r>n?n:r}(be,de,ke):we(d?be:ve,de,d?ke:ge);S[I]=Ie,A[I]=Ie-de}t.modifiersData[r]=A}},requiresIfExists:["offset"]};var Se={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,a=e.options,i=n.elements.arrow,o=n.modifiersData.popperOffsets,s=ae(n.placement),u=oe(s),c=[B,z].indexOf(s)>=0?"height":"width";if(i&&o){var l=function(e,t){return be("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:ke(e,V))}(a.padding,n),h=D(i),f="y"===u?L:B,d="y"===u?Z:z,p=n.rects.reference[c]+n.rects.reference[u]-o[u]-n.rects.popper[c],v=o[u]-n.rects.reference[u],g=P(i),m=g?"y"===u?g.clientHeight||0:g.clientWidth||0:0,y=p/2-v/2,b=l[f],k=m-h[c]-l[d],x=m/2-h[c]/2+y,w=we(b,x,k),I=u;n.modifiersData[r]=((t={})[I]=w,t.centerOffset=w-x,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&ve(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ce(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function _e(e){return[L,z,Z,B].some((function(t){return e[t]>=0}))}var Te=ne({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,a=r.scroll,i=void 0===a||a,o=r.resize,s=void 0===o||o,u=d(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&c.forEach((function(e){e.addEventListener("scroll",n.update,re)})),s&&u.addEventListener("resize",n.update,re),function(){i&&c.forEach((function(e){e.removeEventListener("scroll",n.update,re)})),s&&u.removeEventListener("resize",n.update,re)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=se({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,a=void 0===r||r,i=n.adaptive,o=void 0===i||i,s=n.roundOffsets,u=void 0===s||s,c={placement:ae(t.placement),variation:ie(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ce(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:u})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ce(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},a=t.elements[e];v(a)&&S(a)&&(Object.assign(a.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?a.removeAttribute(e):a.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],a=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});v(r)&&S(r)&&(Object.assign(r.style,i),Object.keys(a).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},le,{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var a=n.mainAxis,i=void 0===a||a,o=n.altAxis,s=void 0===o||o,u=n.fallbackPlacements,c=n.padding,l=n.boundary,h=n.rootBoundary,f=n.altBoundary,d=n.flipVariations,p=void 0===d||d,v=n.allowedAutoPlacements,g=t.options.placement,m=ae(g),y=u||(m===g||!p?[fe(g)]:function(e){if(ae(e)===U)return[];var t=fe(e);return[pe(e),t,pe(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(ae(n)===U?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,a=n.boundary,i=n.rootBoundary,o=n.padding,s=n.flipVariations,u=n.allowedAutoPlacements,c=void 0===u?X:u,l=ie(r),h=l?s?Y:Y.filter((function(e){return ie(e)===l})):V,f=h.filter((function(e){return c.indexOf(e)>=0}));0===f.length&&(f=h);var d=f.reduce((function(t,n){return t[n]=xe(e,{placement:n,boundary:a,rootBoundary:i,padding:o})[ae(n)],t}),{});return Object.keys(d).sort((function(e,t){return d[e]-d[t]}))}(t,{placement:n,boundary:l,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:v}):n)}),[]),k=t.rects.reference,x=t.rects.popper,w=new Map,I=!0,S=b[0],C=0;C<b.length;C++){var _=b[C],T=ae(_),E=ie(_)===j,N=[L,Z].indexOf(T)>=0,D=N?"width":"height",A=xe(t,{placement:_,boundary:l,rootBoundary:h,altBoundary:f,padding:c}),R=N?E?z:B:E?Z:L;k[D]>x[D]&&(R=fe(R));var M=fe(R),O=[];if(i&&O.push(A[T]<=0),s&&O.push(A[R]<=0,A[M]<=0),O.every((function(e){return e}))){S=_,I=!1;break}w.set(_,O)}if(I)for(var F=function(e){var t=b.find((function(t){var n=w.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return S=t,"break"},P=p?3:1;P>0;P--){if("break"===F(P))break}t.placement!==S&&(t.modifiersData[r]._skip=!0,t.placement=S,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},Ie,Se,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,a=t.rects.popper,i=t.modifiersData.preventOverflow,o=xe(t,{elementContext:"reference"}),s=xe(t,{altBoundary:!0}),u=Ce(o,r),c=Ce(s,a,i),l=_e(u),h=_e(c);t.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:c,isReferenceHidden:l,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":h})}}]}),Ee=n(77),Ne=n.n(Ee),De=[],Ae=function(e,t,n){void 0===n&&(n={});var a=r.useRef(null),i={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||De},o=r.useState({styles:{popper:{position:i.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),s=o[0],u=o[1],c=r.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,n=Object.keys(t.elements);f.flushSync((function(){u({styles:l(n.map((function(e){return[e,t.styles[e]||{}]}))),attributes:l(n.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),d=r.useMemo((function(){var e={onFirstUpdate:i.onFirstUpdate,placement:i.placement,strategy:i.strategy,modifiers:[].concat(i.modifiers,[c,{name:"applyStyles",enabled:!1}])};return Ne()(a.current,e)?a.current||e:(a.current=e,e)}),[i.onFirstUpdate,i.placement,i.strategy,i.modifiers,c]),p=r.useRef();return h((function(){p.current&&p.current.setOptions(d)}),[d]),h((function(){if(null!=e&&null!=t){var r=(n.createPopper||Te)(e,t,d);return p.current=r,function(){r.destroy(),p.current=null}}}),[e,t,n.createPopper]),{state:p.current?p.current.state:null,styles:s.styles,attributes:s.attributes,update:p.current?p.current.update:null,forceUpdate:p.current?p.current.forceUpdate:null}},Re=function(){},Me=function(){return Promise.resolve(null)},Oe=[];function Fe(e){var t=e.placement,n=void 0===t?"bottom":t,i=e.strategy,o=void 0===i?"absolute":i,u=e.modifiers,l=void 0===u?Oe:u,h=e.referenceElement,f=e.onFirstUpdate,d=e.innerRef,p=e.children,v=r.useContext(a),g=r.useState(null),m=g[0],y=g[1],b=r.useState(null),k=b[0],x=b[1];r.useEffect((function(){c(d,m)}),[d,m]);var w=r.useMemo((function(){return{placement:n,strategy:o,onFirstUpdate:f,modifiers:[].concat(l,[{name:"arrow",enabled:null!=k,options:{element:k}}])}}),[n,o,f,l,k]),I=Ae(h||v,m,w),S=I.state,C=I.styles,_=I.forceUpdate,T=I.update,E=r.useMemo((function(){return{ref:y,style:C.popper,placement:S?S.placement:n,hasPopperEscaped:S&&S.modifiersData.hide?S.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:S&&S.modifiersData.hide?S.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:C.arrow,ref:x},forceUpdate:_||Re,update:T||Me}}),[y,x,n,S,C,T,_]);return s(p)(E)}var Pe=n(2391),Le=n.n(Pe);function Ze(e){var t=e.children,n=e.innerRef,a=r.useContext(i),o=r.useCallback((function(e){c(n,e),u(a,e)}),[n,a]);return r.useEffect((function(){return function(){return c(n,null)}}),[]),r.useEffect((function(){Le()(Boolean(a),"`Reference` should not be used outside of a `Manager` component.")}),[a]),s(t)({ref:o})}},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var k=b.prototype=new y;k.constructor=b,v(k,m.prototype),k.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,I={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:I.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+E(u,0):i,x(o)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),N(o,t,a,"",(function(e){return e}))):null!=o&&(_(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",x(e))for(var c=0;c<e.length;c++){var l=i+E(s=e[c],c);u+=N(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=N(s=s.value,t,a,l=i+E(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function D(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},M={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:M,ReactCurrentOwner:I};t.Children={map:D,forEach:function(e,t,n){D(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return D(e,(function(){t++})),t},toArray:function(e){return D(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=I.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],h=1,f=null,d=3,p=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function x(e){if(g=!1,k(e),!v)if(null!==r(c))v=!0,M(w);else{var t=r(l);null!==t&&O(x,t.startTime-e)}}function w(e,n){v=!1,g&&(g=!1,y(_),_=-1),p=!0;var i=d;try{for(k(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!N());){var o=f.callback;if("function"===typeof o){f.callback=null,d=f.priorityLevel;var s=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(c)&&a(c),k(n)}else a(c);f=r(c)}if(null!==f)var u=!0;else{var h=r(l);null!==h&&O(x,h.startTime-n),u=!1}return u}finally{f=null,d=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var I,S=!1,C=null,_=-1,T=5,E=-1;function N(){return!(t.unstable_now()-E<T)}function D(){if(null!==C){var e=t.unstable_now();E=e;var n=!0;try{n=C(!0,e)}finally{n?I():(S=!1,C=null)}}else S=!1}if("function"===typeof b)I=function(){b(D)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=D,I=function(){R.postMessage(null)}}else I=function(){m(D,0)};function M(e){C=e,S||(S=!0,I())}function O(e,n){_=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,M(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(g?(y(_),_=-1):g=!0,O(x,i-o))):(e.sortIndex=s,n(c,e),v||p||(v=!0,M(w))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i,o){var s,u=256,c=o.pow(u,6),l=o.pow(2,52),h=2*l,f=u-1;function d(e,t,n){var r=[],f=m(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(i)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(u):(e=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,y(i)]}}():e,3),r),d=new p(r),b=function(){for(var e=d.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=d.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|d.g(4)},b.quick=function(){return d.g(4)/4294967296},b.double=b,m(y(d.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,d),e.state=function(){return v(d,{})}),n?(o.random=e,t):e})(b,f,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(g(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function m(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(m(o.random(),i),e.exports){e.exports=d;try{s=n(5042)}catch(b){}}else void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2391:function(e){"use strict";var t=function(){};e.exports=t},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9142);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,r.Z)(a.key),a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}},7277:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),a=n(8814),i=n(1002),o=n(7326);function s(e){var t=(0,a.Z)();return function(){var n,a=(0,r.Z)(e);if(t){var s=(0,r.Z)(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===(0,i.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}(this,n)}}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function a(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9611);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==(0,r.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/",function(){"use strict";var e={};n.r(e),n.d(e,{FirebaseError:function(){return vt},SDK_VERSION:function(){return En},_DEFAULT_ENTRY_NAME:function(){return vn},_addComponent:function(){return bn},_addOrOverwriteComponent:function(){return kn},_apps:function(){return mn},_clearComponents:function(){return Sn},_components:function(){return yn},_getProvider:function(){return wn},_registerComponent:function(){return xn},_removeServiceInstance:function(){return In},deleteApp:function(){return Rn},getApp:function(){return Dn},getApps:function(){return An},initializeApp:function(){return Nn},onLog:function(){return Fn},registerVersion:function(){return On},setLogLevel:function(){return Pn}});var t={};n.r(t),n.d(t,{CompositeArrayBuffer:function(){return SV},browserFiles:function(){return wW},browserHTTPRequest:function(){return OW},concatenateArrayBuffers:function(){return OV},copyModel:function(){return Sj},decodeWeights:function(){return EV},encodeWeights:function(){return _V},fromMemory:function(){return ZW},fromMemorySync:function(){return zW},getLoadHandlers:function(){return qV},getModelArtifactsForJSON:function(){return ZV},getModelArtifactsForJSONSync:function(){return LV},getModelArtifactsInfoForJSON:function(){return BV},getSaveHandlers:function(){return GV},getWeightSpecs:function(){return UV},http:function(){return MW},isHTTPScheme:function(){return AW},listModels:function(){return kj},loadWeights:function(){return _W},moveModel:function(){return _j},registerLoadRouter:function(){return HV},registerSaveRouter:function(){return WV},removeModel:function(){return wj},weightsLoaderFactory:function(){return EW},withSaveHandler:function(){return BW},withSaveHandlerSync:function(){return UW}});var r=n(2791),a=n.t(r,2),i=n(1250),o="App_App__2s0+r";function s(e){if(Array.isArray(e))return e}var u=n(181);function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){return s(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,a=l}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return s}}(e,t)||(0,u.Z)(e,t)||c()}var h=n(907);function f(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){return function(e){if(Array.isArray(e))return(0,h.Z)(e)}(e)||f(e)||(0,u.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=n(5671),v=n(3144),g=n(136),m=n(7277),y=n(1120),b=n(9611);var k=n(8814);function x(e,t,n){return x=(0,k.Z)()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&(0,b.Z)(a,n.prototype),a},x.apply(null,arguments)}function w(e){var t="function"===typeof Map?new Map:void 0;return w=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return x(e,arguments,(0,y.Z)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,b.Z)(n,e)},w(e)}function I(e){return s(e)||f(e)||(0,u.Z)(e)||c()}var S,C=n(7762);function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(S||(S={}));var T,E="popstate";function N(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function D(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function A(e,t){return{usr:e.state,key:e.key,idx:t}}function R(e,t,n,r){return void 0===n&&(n=null),_({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?O(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function M(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function O(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function F(e,t,n,r){void 0===r&&(r={});var a=r,i=a.window,o=void 0===i?document.defaultView:i,s=a.v5Compat,u=void 0!==s&&s,c=o.history,l=S.Pop,h=null,f=d();function d(){return(c.state||{idx:null}).idx}function p(){l=S.Pop;var e=d(),t=null==e?null:e-f;f=e,h&&h({action:l,location:g.location,delta:t})}function v(e){var t="null"!==o.location.origin?o.location.origin:o.location.href,n="string"===typeof e?e:M(e);return N(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==f&&(f=0,c.replaceState(_({},c.state,{idx:f}),""));var g={get action(){return l},get location(){return e(o,c)},listen:function(e){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(E,p),h=e,function(){o.removeEventListener(E,p),h=null}},createHref:function(e){return t(o,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=S.Push;var r=R(g.location,e,t);n&&n(r,e);var a=A(r,f=d()+1),i=g.createHref(r);try{c.pushState(a,"",i)}catch(s){if(s instanceof DOMException&&"DataCloneError"===s.name)throw s;o.location.assign(i)}u&&h&&h({action:l,location:g.location,delta:1})},replace:function(e,t){l=S.Replace;var r=R(g.location,e,t);n&&n(r,e);var a=A(r,f=d()),i=g.createHref(r);c.replaceState(a,"",i),u&&h&&h({action:l,location:g.location,delta:0})},go:function(e){return c.go(e)}};return g}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(T||(T={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function P(e,t,n){void 0===n&&(n="/");var r=X(("string"===typeof t?O(t):t).pathname||"/",n);if(null==r)return null;var a=L(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=q(a[o],Y(r));return i}function L(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var a=function(e,a,i){var o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(N(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var s=ee([r,o.relativePath]),u=n.concat(o);e.children&&e.children.length>0&&(N(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),L(e.children,t,u,s)),(null!=e.path||e.index)&&t.push({path:s,score:G(s,e.index),routesMeta:u})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,i=(0,C.Z)(Z(e.path));try{for(i.s();!(r=i.n()).done;){var o=r.value;a(e,t,o)}}catch(s){i.e(s)}finally{i.f()}}else a(e,t)})),t}function Z(e){var t=e.split("/");if(0===t.length)return[];var n=I(t),r=n[0],a=n.slice(1),i=r.endsWith("?"),o=r.replace(/\?$/,"");if(0===a.length)return i?[o,""]:[o];var s=Z(a.join("/")),u=[];return u.push.apply(u,d(s.map((function(e){return""===e?o:[o,e].join("/")})))),i&&u.push.apply(u,d(s)),u.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}var z=/^:\w+$/,B=3,U=2,V=1,j=10,W=-2,H=function(e){return"*"===e};function G(e,t){var n=e.split("/"),r=n.length;return n.some(H)&&(r+=W),t&&(r+=U),n.filter((function(e){return!H(e)})).reduce((function(e,t){return e+(z.test(t)?B:""===t?V:j)}),r)}function q(e,t){for(var n=e.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var s=n[o],u=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",l=K({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var h=s.route;i.push({params:r,pathname:ee([a,l.pathname]),pathnameBase:te(ee([a,l.pathnameBase])),route:h}),"/"!==l.pathnameBase&&(a=ee([a,l.pathnameBase]))}return i}function K(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);D("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");var i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),r=l(n,2),a=r[0],i=r[1],o=t.match(a);if(!o)return null;var s=o[0],u=s.replace(/(.)\/+$/,"$1"),c=o.slice(1),h=i.reduce((function(e,t,n){if("*"===t){var r=c[n]||"";u=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return D(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(c[n]||"",t),e}),{});return{params:h,pathname:s,pathnameBase:u,pattern:e}}function Y(e){try{return decodeURI(e)}catch(t){return D(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function X(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function Q(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function J(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function $(e,t,n,r){var a;void 0===r&&(r=!1),"string"===typeof e?a=O(e):(N(!(a=_({},e)).pathname||!a.pathname.includes("?"),Q("?","pathname","search",a)),N(!a.pathname||!a.pathname.includes("#"),Q("#","pathname","hash",a)),N(!a.search||!a.search.includes("#"),Q("#","search","hash",a)));var i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(r||null==s)i=n;else{var u=t.length-1;if(s.startsWith("..")){for(var c=s.split("/");".."===c[0];)c.shift(),u-=1;a.pathname=c.join("/")}i=u>=0?t[u]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?O(e):e,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,s=void 0===o?"":o,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:ne(i),hash:re(s)}}(a,i),h=s&&"/"!==s&&s.endsWith("/"),f=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!h&&!f||(l.pathname+="/"),l}var ee=function(e){return e.join("/").replace(/\/\/+/g,"/")},te=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},ne=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},re=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},ae=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(w(Error));function ie(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var oe=["post","put","patch","delete"],se=(new Set(oe),["get"].concat(oe));new Set(se),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(this,arguments)}var ce=a.startTransition,le=r.createContext(null);var he=r.createContext(null);var fe=r.createContext(null);var de=r.createContext(null);var pe=r.createContext(null);var ve=r.createContext({outlet:null,matches:[],isDataRoute:!1});var ge=r.createContext(null);function me(){return null!=r.useContext(pe)}function ye(){return me()||N(!1),r.useContext(pe).location}function be(e){r.useContext(de).static||r.useLayoutEffect(e)}function ke(){return r.useContext(ve).isDataRoute?function(){var e=De(Se.UseNavigateStable).router,t=Re(Ce.UseNavigateStable),n=r.useRef(!1);be((function(){n.current=!0}));var a=r.useCallback((function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,ue({fromRouteId:t},a)))}),[e,t]);return a}():function(){me()||N(!1);var e=r.useContext(le),t=r.useContext(de),n=t.basename,a=t.navigator,i=r.useContext(ve).matches,o=ye().pathname,s=JSON.stringify(J(i).map((function(e){return e.pathnameBase}))),u=r.useRef(!1);be((function(){u.current=!0}));var c=r.useCallback((function(t,r){if(void 0===r&&(r={}),u.current)if("number"!==typeof t){var i=$(t,JSON.parse(s),o,"path"===r.relative);null==e&&"/"!==n&&(i.pathname="/"===i.pathname?n:ee([n,i.pathname])),(r.replace?a.replace:a.push)(i,r.state,r)}else a.go(t)}),[n,a,s,o,e]);return c}()}function xe(e,t){var n=(void 0===t?{}:t).relative,a=r.useContext(ve).matches,i=ye().pathname,o=JSON.stringify(J(a).map((function(e){return e.pathnameBase})));return r.useMemo((function(){return $(e,JSON.parse(o),i,"path"===n)}),[e,o,i,n])}function we(e,t,n){me()||N(!1);var a,i=r.useContext(de).navigator,o=r.useContext(ve).matches,s=o[o.length-1],u=s?s.params:{},c=(s&&s.pathname,s?s.pathnameBase:"/"),l=(s&&s.route,ye());if(t){var h,f="string"===typeof t?O(t):t;"/"===c||(null==(h=f.pathname)?void 0:h.startsWith(c))||N(!1),a=f}else a=l;var d=a.pathname||"/",p=P(e,{pathname:"/"===c?d:d.slice(c.length)||"/"});var v=Ne(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},u,e.params),pathname:ee([c,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:ee([c,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),o,n);return t&&v?r.createElement(pe.Provider,{value:{location:ue({pathname:"/",search:"",hash:"",state:null,key:"default"},a),navigationType:S.Pop}},v):v}function Ie(){var e=function(){var e,t=r.useContext(ge),n=Ae(Ce.UseRouteError),a=Re(Ce.UseRouteError);if(t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=ie(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:i},n):null,null)}var Se,Ce,_e=r.createElement(Ie,null),Te=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},r}return(0,v.Z)(n,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?r.createElement(ve.Provider,{value:this.props.routeContext},r.createElement(ge.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}}]),n}(r.Component);function Ee(e){var t=e.routeContext,n=e.match,a=e.children,i=r.useContext(le);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(ve.Provider,{value:t},a)}function Ne(e,t,n){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),null==e){var i;if(null==(i=n)||!i.errors)return null;e=n.matches}var o=e,s=null==(a=n)?void 0:a.errors;if(null!=s){var u=o.findIndex((function(e){return e.route.id&&(null==s?void 0:s[e.route.id])}));u>=0||N(!1),o=o.slice(0,Math.min(o.length,u+1))}return o.reduceRight((function(e,a,i){var u=a.route.id?null==s?void 0:s[a.route.id]:null,c=null;n&&(c=a.route.errorElement||_e);var l=t.concat(o.slice(0,i+1)),h=function(){var t;return t=u?c:a.route.Component?r.createElement(a.route.Component,null):a.route.element?a.route.element:e,r.createElement(Ee,{match:a,routeContext:{outlet:e,matches:l,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===i)?r.createElement(Te,{location:n.location,revalidation:n.revalidation,component:c,error:u,children:h(),routeContext:{outlet:null,matches:l,isDataRoute:!0}}):h()}),null)}function De(e){var t=r.useContext(le);return t||N(!1),t}function Ae(e){var t=r.useContext(he);return t||N(!1),t}function Re(e){var t=function(e){var t=r.useContext(ve);return t||N(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||N(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"}(Se||(Se={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"}(Ce||(Ce={}));var Me;function Oe(e){var t=e.to,n=e.replace,a=e.state,i=e.relative;me()||N(!1);var o=r.useContext(ve).matches,s=ye().pathname,u=ke(),c=$(t,J(o).map((function(e){return e.pathnameBase})),s,"path"===i),l=JSON.stringify(c);return r.useEffect((function(){return u(JSON.parse(l),{replace:n,state:a,relative:i})}),[u,l,i,n,a]),null}function Fe(e){N(!1)}function Pe(e){var t=e.basename,n=void 0===t?"/":t,a=e.children,i=void 0===a?null:a,o=e.location,s=e.navigationType,u=void 0===s?S.Pop:s,c=e.navigator,l=e.static,h=void 0!==l&&l;me()&&N(!1);var f=n.replace(/^\/*/,"/"),d=r.useMemo((function(){return{basename:f,navigator:c,static:h}}),[f,c,h]);"string"===typeof o&&(o=O(o));var p=o,v=p.pathname,g=void 0===v?"/":v,m=p.search,y=void 0===m?"":m,b=p.hash,k=void 0===b?"":b,x=p.state,w=void 0===x?null:x,I=p.key,C=void 0===I?"default":I,_=r.useMemo((function(){var e=X(g,f);return null==e?null:{location:{pathname:e,search:y,hash:k,state:w,key:C},navigationType:u}}),[f,g,y,k,w,C,u]);return null==_?null:r.createElement(de.Provider,{value:d},r.createElement(pe.Provider,{children:i,value:_}))}function Le(e){var t=e.children,n=e.location;return we(ze(t),n)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(Me||(Me={}));var Ze=new Promise((function(){}));r.Component;function ze(e,t){void 0===t&&(t=[]);var n=[];return r.Children.forEach(e,(function(e,a){if(r.isValidElement(e)){var i=[].concat(d(t),[a]);if(e.type!==r.Fragment){e.type!==Fe&&N(!1),e.props.index&&e.props.children&&N(!1);var o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=ze(e.props.children,i)),n.push(o)}else n.push.apply(n,ze(e.props.children,i))}})),n}function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Be.apply(this,arguments)}function Ue(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}var Ve=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function je(e){var t,n=e.basename,a=e.children,i=e.future,o=e.window,s=r.useRef();null==s.current&&(s.current=(void 0===(t={window:o,v5Compat:!0})&&(t={}),F((function(e,t){var n=e.location;return R("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:M(t)}),null,t)));var u=s.current,c=l(r.useState({action:u.action,location:u.location}),2),h=c[0],f=c[1],d=(i||{}).v7_startTransition,p=r.useCallback((function(e){d&&ce?ce((function(){return f(e)})):f(e)}),[f,d]);return r.useLayoutEffect((function(){return u.listen(p)}),[u,p]),r.createElement(Pe,{basename:n,children:a,location:h.location,navigationType:h.action,navigator:u})}var We="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,He=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ge=r.forwardRef((function(e,t){var n,a=e.onClick,i=e.relative,o=e.reloadDocument,s=e.replace,u=e.state,c=e.target,l=e.to,h=e.preventScrollReset,f=Ue(e,Ve),d=r.useContext(de).basename,p=!1;if("string"===typeof l&&He.test(l)&&(n=l,We))try{var v=new URL(window.location.href),g=l.startsWith("//")?new URL(v.protocol+l):new URL(l),m=X(g.pathname,d);g.origin===v.origin&&null!=m?l=m+g.search+g.hash:p=!0}catch(k){}var y=function(e,t){var n=(void 0===t?{}:t).relative;me()||N(!1);var a=r.useContext(de),i=a.basename,o=a.navigator,s=xe(e,{relative:n}),u=s.hash,c=s.pathname,l=s.search,h=c;return"/"!==i&&(h="/"===c?i:ee([i,c])),o.createHref({pathname:h,search:l,hash:u})}(l,{relative:i}),b=function(e,t){var n=void 0===t?{}:t,a=n.target,i=n.replace,o=n.state,s=n.preventScrollReset,u=n.relative,c=ke(),l=ye(),h=xe(e,{relative:u});return r.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();var n=void 0!==i?i:M(l)===M(h);c(e,{replace:n,state:o,preventScrollReset:s,relative:u})}}),[l,c,h,i,o,a,e,s,u])}(l,{replace:s,state:u,target:c,preventScrollReset:h,relative:i});return r.createElement("a",Be({},f,{href:n||y,onClick:p||o?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:t,target:c}))}));var qe,Ke;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(qe||(qe={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ke||(Ke={}));var Ye=n(4942);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){(0,Ye.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Je=n(7326),$e=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},et={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],a=0;a<e.length;a+=3){var i=e[a],o=a+1<e.length,s=o?e[a+1]:0,u=a+2<e.length,c=u?e[a+2]:0,l=i>>2,h=(3&i)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray($e(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){var o=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],a=0;a<e.length;){var i=n[e.charAt(a++)],o=a<e.length?n[e.charAt(a)]:0,s=++a<e.length?n[e.charAt(a)]:64,u=++a<e.length?n[e.charAt(a)]:64;if(++a,null==i||null==o||null==s||null==u)throw new tt;var c=i<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},tt=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return(0,v.Z)(n)}(w(Error)),nt=function(e){return function(e){var t=$e(e);return et.encodeByteArray(t,!0)}(e).replace(/\./g,"")},rt=function(e){try{return et.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function at(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=at(e[n],t[n]));return e}var it=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},ot=function(){try{return it()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}var t=e&&rt(e[1]);return t&&JSON.parse(t)}}()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},st=function(){var e;return null===(e=ot())||void 0===e?void 0:e.config},ut=function(){function e(){var t=this;(0,p.Z)(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return(0,v.Z)(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function ct(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function lt(){var e,t=null===(e=ot())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function ht(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function ft(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function dt(){var e=ct();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function pt(){try{return"object"===typeof indexedDB}catch(e){return!1}}var vt=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this,r)).code=e,i.customData=a,i.name="FirebaseError",Object.setPrototypeOf((0,Je.Z)(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace((0,Je.Z)(i),gt.prototype.create),i}return(0,v.Z)(n)}(w(Error)),gt=function(){function e(t,n,r){(0,p.Z)(this,e),this.service=t,this.serviceName=n,this.errors=r}return(0,v.Z)(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(mt,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new vt(n,i,t)}}]),e}();var mt=/\{\$([^}]+)}/g;function yt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function bt(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function kt(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(xt(s)&&xt(u)){if(!kt(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function xt(e){return null!==e&&"object"===typeof e}function wt(e){for(var t=[],n=function(){var e=l(a[r],2),n=e[0],i=e[1];Array.isArray(i)?i.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))},r=0,a=Object.entries(e);r<a.length;r++)n();return t.length?"&"+t.join("&"):""}function It(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=l(e.split("="),2),r=n[0],a=n[1];t[decodeURIComponent(r)]=decodeURIComponent(a)}})),t}function St(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function Ct(e,t){var n=new _t(e,t);return n.subscribe.bind(n)}var _t=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return(0,v.Z)(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,a=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=(0,C.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a in e&&"function"===typeof e[a])return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Tt),void 0===r.error&&(r.error=Tt),void 0===r.complete&&(r.complete=Tt);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{a.finalError?r.error(a.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function Tt(){}function Et(e){return e&&e._delegate?e._delegate:e}var Nt=n(1002);function Dt(){Dt=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(E){u=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),s=new C(a||[]);return r(o,"_invoke",{value:x(e,n,s)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(E){return{type:"throw",arg:E}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(_([])));m&&m!==t&&n.call(m,i)&&(v=m);var y=p.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function a(r,i,o,s){var u=l(e[r],e,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==(0,Nt.Z)(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return a("throw",e,o,s)}))}s(u.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=l(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function _(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=p,r(y,"constructor",{value:p,configurable:!0}),r(p,"constructor",{value:d,configurable:!0}),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(k.prototype),u(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new k(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(y),u(y,s,"Generator"),u(y,i,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=_,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function At(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function Rt(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){At(i,r,a,o,s,"next",e)}function s(e){At(i,r,a,o,s,"throw",e)}o(void 0)}))}}var Mt=function(){function e(t,n,r){(0,p.Z)(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return(0,v.Z)(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Ot="[DEFAULT]",Ft=function(){function e(t,n){(0,p.Z)(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return(0,v.Z)(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new ut;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(a){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(r)return null;throw a}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ot})}catch(u){}var t,n=(0,C.Z)(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=l(t.value,2),a=r[0],i=r[1],o=this.normalizeInstanceIdentifier(a);try{var s=this.getOrInitializeService({instanceIdentifier:o});i.resolve(s)}catch(u){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(d(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),d(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a,i=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=(0,C.Z)(this.instancesDeferred.entries());try{for(o.s();!(a=o.n()).done;){var s=l(a.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(i)}}catch(h){o.e(h)}finally{o.f()}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);var i=this.instances.get(r);return i&&e(i,r),function(){a.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i(e,t)}catch(zm){}}}catch(o){a.e(o)}finally{a.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,a=void 0===r?{}:r,i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ot?void 0:t),options:a}),this.instances.set(n,i),this.instancesOptions.set(n,a),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch(zm){}return i||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot;return this.component?this.component.multipleInstances?e:Ot:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var Pt,Lt,Zt=function(){function e(t){(0,p.Z)(this,e),this.name=t,this.providers=new Map}return(0,v.Z)(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Ft(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),zt=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Lt||(Lt={}));var Bt={debug:Lt.DEBUG,verbose:Lt.VERBOSE,info:Lt.INFO,warn:Lt.WARN,error:Lt.ERROR,silent:Lt.SILENT},Ut=Lt.INFO,Vt=(Pt={},(0,Ye.Z)(Pt,Lt.DEBUG,"log"),(0,Ye.Z)(Pt,Lt.VERBOSE,"log"),(0,Ye.Z)(Pt,Lt.INFO,"info"),(0,Ye.Z)(Pt,Lt.WARN,"warn"),(0,Ye.Z)(Pt,Lt.ERROR,"error"),Pt),jt=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Vt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];(a=console)[r].apply(a,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},Wt=function(){function e(t){(0,p.Z)(this,e),this.name=t,this._logLevel=Ut,this._logHandler=jt,this._userLogHandler=null,zt.push(this)}return(0,v.Z)(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Lt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Bt[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Lt.DEBUG].concat(t)),this._logHandler.apply(this,[this,Lt.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Lt.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Lt.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Lt.INFO].concat(t)),this._logHandler.apply(this,[this,Lt.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Lt.WARN].concat(t)),this._logHandler.apply(this,[this,Lt.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Lt.ERROR].concat(t)),this._logHandler.apply(this,[this,Lt.ERROR].concat(t))}}]),e}();var Ht,Gt,qt=function(e,t){return t.some((function(t){return e instanceof t}))};var Kt=new WeakMap,Yt=new WeakMap,Xt=new WeakMap,Qt=new WeakMap,Jt=new WeakMap;var $t={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Yt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Xt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return nn(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function en(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Gt||(Gt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(rn(this),n),nn(Kt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return nn(e.apply(rn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.call.apply(e,[rn(this),t].concat(r));return Xt.set(i,t.sort?t.sort():[t]),nn(i)}}function tn(e){return"function"===typeof e?en(e):(e instanceof IDBTransaction&&function(e){if(!Yt.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));Yt.set(e,t)}}(e),qt(e,Ht||(Ht=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,$t):e)}function nn(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",a),e.removeEventListener("error",i)},a=function(){t(nn(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&Kt.set(t,e)})).catch((function(){})),Jt.set(t,e),t}(e);if(Qt.has(e))return Qt.get(e);var t=tn(e);return t!==e&&(Qt.set(e,t),Jt.set(t,e)),t}var rn=function(e){return Jt.get(e)};var an,on,sn=["get","getKey","getAll","getAllKeys","count"],un=["put","add","delete","clear"],cn=new Map;function ln(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(cn.get(t))return cn.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,a=un.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(a||sn.includes(n))){var i=function(){var e=Rt(Dt().mark((function e(t){var i,o,s,u,c,l,h=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,a?"readwrite":"readonly"),s=o.store,u=h.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=h[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,c),a&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return cn.set(t,i),i}}}!function(e){$t=e($t)}((function(e){return Qe(Qe({},e),{},{get:function(t,n,r){return ln(t,n)||e.get(t,n,r)},has:function(t,n){return!!ln(t,n)||e.has(t,n)}})}));var hn=function(){function e(t){(0,p.Z)(this,e),this.container=t}return(0,v.Z)(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var fn="@firebase/app",dn="0.9.12",pn=new Wt("@firebase/app"),vn="[DEFAULT]",gn=(an={},(0,Ye.Z)(an,fn,"fire-core"),(0,Ye.Z)(an,"@firebase/app-compat","fire-core-compat"),(0,Ye.Z)(an,"@firebase/analytics","fire-analytics"),(0,Ye.Z)(an,"@firebase/analytics-compat","fire-analytics-compat"),(0,Ye.Z)(an,"@firebase/app-check","fire-app-check"),(0,Ye.Z)(an,"@firebase/app-check-compat","fire-app-check-compat"),(0,Ye.Z)(an,"@firebase/auth","fire-auth"),(0,Ye.Z)(an,"@firebase/auth-compat","fire-auth-compat"),(0,Ye.Z)(an,"@firebase/database","fire-rtdb"),(0,Ye.Z)(an,"@firebase/database-compat","fire-rtdb-compat"),(0,Ye.Z)(an,"@firebase/functions","fire-fn"),(0,Ye.Z)(an,"@firebase/functions-compat","fire-fn-compat"),(0,Ye.Z)(an,"@firebase/installations","fire-iid"),(0,Ye.Z)(an,"@firebase/installations-compat","fire-iid-compat"),(0,Ye.Z)(an,"@firebase/messaging","fire-fcm"),(0,Ye.Z)(an,"@firebase/messaging-compat","fire-fcm-compat"),(0,Ye.Z)(an,"@firebase/performance","fire-perf"),(0,Ye.Z)(an,"@firebase/performance-compat","fire-perf-compat"),(0,Ye.Z)(an,"@firebase/remote-config","fire-rc"),(0,Ye.Z)(an,"@firebase/remote-config-compat","fire-rc-compat"),(0,Ye.Z)(an,"@firebase/storage","fire-gcs"),(0,Ye.Z)(an,"@firebase/storage-compat","fire-gcs-compat"),(0,Ye.Z)(an,"@firebase/firestore","fire-fst"),(0,Ye.Z)(an,"@firebase/firestore-compat","fire-fst-compat"),(0,Ye.Z)(an,"fire-js","fire-js"),(0,Ye.Z)(an,"firebase","fire-js-all"),an),mn=new Map,yn=new Map;function bn(e,t){try{e.container.addComponent(t)}catch(n){pn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function kn(e,t){e.container.addOrOverwriteComponent(t)}function xn(e){var t=e.name;if(yn.has(t))return pn.debug("There were multiple attempts to register component ".concat(t,".")),!1;yn.set(t,e);var n,r=(0,C.Z)(mn.values());try{for(r.s();!(n=r.n()).done;){bn(n.value,e)}}catch(a){r.e(a)}finally{r.f()}return!0}function wn(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function In(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vn;wn(e,t).clearInstance(n)}function Sn(){yn.clear()}var Cn=(on={},(0,Ye.Z)(on,"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),(0,Ye.Z)(on,"bad-app-name","Illegal App name: '{$appName}"),(0,Ye.Z)(on,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),(0,Ye.Z)(on,"app-deleted","Firebase App named '{$appName}' already deleted"),(0,Ye.Z)(on,"no-options","Need to provide options, when not being deployed to hosting via source."),(0,Ye.Z)(on,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),(0,Ye.Z)(on,"invalid-log-argument","First argument to `onLog` must be null or a function."),(0,Ye.Z)(on,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),(0,Ye.Z)(on,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),(0,Ye.Z)(on,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),(0,Ye.Z)(on,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),on),_n=new gt("app","Firebase",Cn),Tn=function(){function e(t,n,r){var a=this;(0,p.Z)(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Mt("app",(function(){return a}),"PUBLIC"))}return(0,v.Z)(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw _n.create("app-deleted",{appName:this._name})}}]),e}(),En="9.22.2";function Nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:vn,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw _n.create("bad-app-name",{appName:String(a)});if(n||(n=st()),!n)throw _n.create("no-options");var i=mn.get(a);if(i){if(kt(n,i.options)&&kt(r,i.config))return i;throw _n.create("duplicate-app",{appName:a})}var o,s=new Zt(a),u=(0,C.Z)(yn.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s.addComponent(c)}}catch(h){u.e(h)}finally{u.f()}var l=new Tn(n,r,s);return mn.set(a,l),l}function Dn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn,t=mn.get(e);if(!t&&e===vn&&st())return Nn();if(!t)throw _n.create("no-app",{appName:e});return t}function An(){return Array.from(mn.values())}function Rn(e){return Mn.apply(this,arguments)}function Mn(){return(Mn=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!mn.has(n)){e.next=6;break}return mn.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function On(e,t,n){var r,a=null!==(r=gn[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));var i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){var s=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void pn.warn(s.join(" "))}xn(new Mt("".concat(a,"-version"),(function(){return{library:a,version:t}}),"VERSION"))}function Fn(e,t){if(null!==e&&"function"!==typeof e)throw _n.create("invalid-log-argument");!function(e,t){var n,r=(0,C.Z)(zt);try{var a=function(){var r=n.value,a=null;t&&t.level&&(a=Bt[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var s=i.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==a&&void 0!==a?a:t.logLevel)&&e({level:Lt[n].toLowerCase(),message:s,args:i,type:t.name})}};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}}(e,t)}function Pn(e){var t;t=e,zt.forEach((function(e){e.setLogLevel(t)}))}var Ln="firebase-heartbeat-database",Zn=1,zn="firebase-heartbeat-store",Bn=null;function Un(){return Bn||(Bn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,a=n.upgrade,i=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=nn(s);return a&&s.addEventListener("upgradeneeded",(function(e){a(nn(s.result),e.oldVersion,e.newVersion,nn(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),i&&e.addEventListener("versionchange",(function(e){return i(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}(Ln,Zn,{upgrade:function(e,t){if(0===t)e.createObjectStore(zn)}}).catch((function(e){throw _n.create("idb-open",{originalErrorMessage:e.message})}))),Bn}function Vn(e){return jn.apply(this,arguments)}function jn(){return jn=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Un();case 3:return n=e.sent,e.next=6,n.transaction(zn).objectStore(zn).get(Gn(t));case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof vt?pn.warn(e.t0.message):(a=_n.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),pn.warn(a.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),jn.apply(this,arguments)}function Wn(e,t){return Hn.apply(this,arguments)}function Hn(){return Hn=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Un();case 3:return r=e.sent,a=r.transaction(zn,"readwrite"),i=a.objectStore(zn),e.next=8,i.put(n,Gn(t));case 8:return e.next=10,a.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof vt?pn.warn(e.t0.message):(o=_n.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),pn.warn(o.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),Hn.apply(this,arguments)}function Gn(e){return"".concat(e.name,"!").concat(e.options.appId)}var qn=function(){function e(t){var n=this;(0,p.Z)(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Jn(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return(0,v.Z)(e,[{key:"triggerHeartbeat",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=Kn(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=Kn(),n=Yn(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,a=n.unsentEntries,i=nt(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(a.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=a,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Kn(){return(new Date).toISOString().substring(0,10)}function Yn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],a=e.slice(),i=(0,C.Z)(e);try{var o=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),$n(r)>n)return i.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),$n(r)>n)return r.pop(),"break";a=a.slice(1)};for(i.s();!(t=i.n()).done;){if("break"===o())break}}catch(s){i.e(s)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:a}}var Xn,Qn,Jn=function(){function e(t){(0,p.Z)(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return(0,v.Z)(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pt()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=function(){a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=function(){n=!1},a.onerror=function(){var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Vn(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Wn(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Wn(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(d(r.heartbeats),d(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function $n(e){return nt(JSON.stringify({version:2,heartbeats:e})).length}Xn="",xn(new Mt("platform-logger",(function(e){return new hn(e)}),"PRIVATE")),xn(new Mt("heartbeat",(function(e){return new qn(e)}),"PRIVATE")),On(fn,dn,Xn),On(fn,dn,"esm2017"),On("fire-js","");var er=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this._delegate=t,this.firebase=n,bn(t,new Mt("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return(0,v.Z)(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),Rn(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){bn(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){kn(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),tr=(Qn={},(0,Ye.Z)(Qn,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),(0,Ye.Z)(Qn,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Qn),nr=new gt("app-compat","Firebase",tr);var rr=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var a=Nn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(yt(n,a.name))return n[a.name];var i=new t(a,r);return n[a.name]=i,i},app:a,registerVersion:On,setLogLevel:Pn,onLog:Fn,apps:null,SDK_VERSION:En,INTERNAL:{registerComponent:function(e){var n=e.name,i=n.replace("-compat","");if(xn(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a();if("function"!==typeof e[i])throw nr.create("invalid-app-argument",{appName:n});return e[i]()};void 0!==e.serviceProps&&at(o,e.serviceProps),r[i]=o,t.prototype[i]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t.apply(this,e.multipleInstances?a:[])}}return"PUBLIC"===e.type?r[i]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function a(e){if(!yt(n,e=e||vn))throw nr.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),a.App=t,r}(er);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){at(n,e)},createSubscribe:Ct,ErrorFactory:gt,deepExtend:at}),n}(),ar=new Wt("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){ar.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var ir=self.firebase.SDK_VERSION;ir&&ir.indexOf("LITE")>=0&&ar.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var or=rr;!function(e){On("@firebase/app-compat","0.2.12",e)}();function sr(){return sr="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,y.Z)(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},sr.apply(this,arguments)}or.registerVersion("firebase","9.22.2","app-compat");var ur,cr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},lr={},hr=hr||{},fr=cr||self;function dr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function pr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var vr="closure_uid_"+(1e9*Math.random()>>>0),gr=0;function mr(e,t,n){return e.call.apply(e.bind,arguments)}function yr(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function br(e,t,n){return(br=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mr:yr).apply(null,arguments)}function kr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function xr(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function wr(){this.s=this.s,this.o=this.o}wr.prototype.s=!1,wr.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,vr)&&e[vr]||(e[vr]=++gr))},wr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ir=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Sr(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Cr(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(dr(r)){var a=e.length||0,i=r.length||0;e.length=a+i;for(var o=0;o<i;o++)e[a+o]=r[o]}else e.push(r)}}function _r(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}_r.prototype.h=function(){this.defaultPrevented=!0};var Tr=function(){if(!fr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{fr.addEventListener("test",(function(){}),t),fr.removeEventListener("test",(function(){}),t)}catch(n){}return e}();function Er(e){return/^[\s\xa0]*$/.test(e)}function Nr(){var e=fr.navigator;return e&&(e=e.userAgent)?e:""}function Dr(e){return-1!=Nr().indexOf(e)}function Ar(e){return Ar[" "](e),e}Ar[" "]=function(){};var Rr,Mr,Or=Dr("Opera"),Fr=Dr("Trident")||Dr("MSIE"),Pr=Dr("Edge"),Lr=Pr||Fr,Zr=Dr("Gecko")&&!(-1!=Nr().toLowerCase().indexOf("webkit")&&!Dr("Edge"))&&!(Dr("Trident")||Dr("MSIE"))&&!Dr("Edge"),zr=-1!=Nr().toLowerCase().indexOf("webkit")&&!Dr("Edge");function Br(){var e=fr.document;return e?e.documentMode:void 0}e:{var Ur="",Vr=function(){var e=Nr();return Zr?/rv:([^\);]+)(\)|;)/.exec(e):Pr?/Edge\/([\d\.]+)/.exec(e):Fr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):zr?/WebKit\/(\S+)/.exec(e):Or?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Vr&&(Ur=Vr?Vr[1]:""),Fr){var jr=Br();if(null!=jr&&jr>parseFloat(Ur)){Rr=String(jr);break e}}Rr=Ur}if(fr.document&&Fr){var Wr=Br();Mr=Wr||(parseInt(Rr,10)||void 0)}else Mr=void 0;var Hr=Mr;function Gr(e,t){if(_r.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Zr){e:{try{Ar(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:qr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Gr.$.h.call(this)}}xr(Gr,_r);var qr={2:"touch",3:"pen",4:"mouse"};Gr.prototype.h=function(){Gr.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Kr="closure_listenable_"+(1e6*Math.random()|0),Yr=0;function Xr(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=a,this.key=++Yr,this.fa=this.ia=!1}function Qr(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Jr(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function $r(e){var t={};for(var n in e)t[n]=e[n];return t}var ea="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ta(e,t){for(var n,r,a=1;a<arguments.length;a++){for(n in r=arguments[a])e[n]=r[n];for(var i=0;i<ea.length;i++)n=ea[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function na(e){this.src=e,this.g={},this.h=0}function ra(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Ir(a,t);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(Qr(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function aa(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.fa&&i.listener==t&&i.capture==!!n&&i.la==r)return a}return-1}na.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=aa(e,t,r,a);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new Xr(t,this.src,i,!!r,a)).ia=n,e.push(t)),t};var ia="closure_lm_"+(1e6*Math.random()|0),oa={};function sa(e,t,n,r,a){if(r&&r.once)return ca(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)sa(e,t[i],n,r,a);return null}return n=ga(n),e&&e[Kr]?e.O(t,n,pr(r)?!!r.capture:!!r,a):ua(e,t,n,!1,r,a)}function ua(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=pr(a)?!!a.capture:!!a,s=pa(e);if(s||(e[ia]=s=new na(e)),(n=s.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=da;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Tr||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(fa(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ca(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)ca(e,t[i],n,r,a);return null}return n=ga(n),e&&e[Kr]?e.P(t,n,pr(r)?!!r.capture:!!r,a):ua(e,t,n,!0,r,a)}function la(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)la(e,t[i],n,r,a);else r=pr(r)?!!r.capture:!!r,n=ga(n),e&&e[Kr]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=aa(i=e.g[t],n,r,a))&&(Qr(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=pa(e))&&(t=e.g[t.toString()],e=-1,t&&(e=aa(t,n,r,a)),(n=-1<e?t[e]:null)&&ha(n))}function ha(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Kr])ra(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(fa(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=pa(t))?(ra(n,e),0==n.h&&(n.src=null,t[ia]=null)):Qr(e)}}}function fa(e){return e in oa?oa[e]:oa[e]="on"+e}function da(e,t){if(e.fa)e=!0;else{t=new Gr(t,this);var n=e.listener,r=e.la||e.src;e.ia&&ha(e),e=n.call(r,t)}return e}function pa(e){return(e=e[ia])instanceof na?e:null}var va="__closure_events_fn_"+(1e9*Math.random()>>>0);function ga(e){return"function"===typeof e?e:(e[va]||(e[va]=function(t){return e.handleEvent(t)}),e[va])}function ma(){wr.call(this),this.i=new na(this),this.S=this,this.J=null}function ya(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new _r(t,e);else if(t instanceof _r)t.target=t.target||e;else{var a=t;ta(t=new _r(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];a=ba(o,r,!0,t)&&a}if(a=ba(o=t.g=e,r,!0,t)&&a,a=ba(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=ba(o=t.g=n[i],r,!1,t)&&a}function ba(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.fa&&o.capture==n){var s=o.listener,u=o.la||o.src;o.ia&&ra(e.i,o),a=!1!==s.call(u,r)&&a}}return a&&!r.defaultPrevented}xr(ma,wr),ma.prototype[Kr]=!0,ma.prototype.removeEventListener=function(e,t,n,r){la(this,e,t,n,r)},ma.prototype.N=function(){if(ma.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Qr(n[r]);delete t.g[e],t.h--}}this.J=null},ma.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ma.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var ka=fr.JSON.stringify,xa=function(){function e(t,n){(0,p.Z)(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return(0,v.Z)(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}();function wa(){var e=Da,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ia=function(){function e(){(0,p.Z)(this,e),this.h=this.g=null}return(0,v.Z)(e,[{key:"add",value:function(e,t){var n=Sa.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Sa=new xa((function(){return new Ca}),(function(e){return e.reset()})),Ca=function(){function e(){(0,p.Z)(this,e),this.next=this.g=this.h=null}return(0,v.Z)(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function _a(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ta(e){fr.setTimeout((function(){throw e}),0)}var Ea,Na=!1,Da=new Ia,Aa=function(){var e=fr.Promise.resolve(void 0);Ea=function(){e.then(Ra)}},Ra=function(){for(var e;e=wa();){try{e.h.call(e.g)}catch(n){Ta(n)}var t=Sa;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Na=!1};function Ma(e,t){ma.call(this),this.h=e||1,this.g=t||fr,this.j=br(this.qb,this),this.l=Date.now()}function Oa(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Fa(e,t,n){if("function"===typeof e)n&&(e=br(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=br(e.handleEvent,e)}return 2147483647<Number(t)?-1:fr.setTimeout(e,t||0)}function Pa(e){e.g=Fa((function(){e.g=null,e.i&&(e.i=!1,Pa(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}xr(Ma,ma),(ur=Ma.prototype).ga=!1,ur.T=null,ur.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ya(this,"tick"),this.ga&&(Oa(this),this.start()))}},ur.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ur.N=function(){Ma.$.N.call(this),Oa(this),delete this.g};var La=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).m=e,a.j=r,a.h=null,a.i=!1,a.g=null,a}return(0,v.Z)(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Pa(this)}},{key:"N",value:function(){sr((0,y.Z)(n.prototype),"N",this).call(this),this.g&&(fr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(wr);function Za(e){wr.call(this),this.h=e,this.g={}}xr(Za,wr);var za=[];function Ba(e,t,n,r){Array.isArray(n)||(n&&(za[0]=n.toString()),n=za);for(var a=0;a<n.length;a++){var i=sa(t,n[a],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function Ua(e){Jr(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ha(e)}),e),e.g={}}function Va(){this.g=!0}function ja(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return ka(n)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}Za.prototype.N=function(){Za.$.N.call(this),Ua(this)},Za.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Va.prototype.Ea=function(){this.g=!1},Va.prototype.info=function(){};var Wa={},Ha=null;function Ga(){return Ha=Ha||new ma}function qa(e){_r.call(this,Wa.Ta,e)}function Ka(e){var t=Ga();ya(t,new qa(t))}function Ya(e,t){_r.call(this,Wa.STAT_EVENT,e),this.stat=t}function Xa(e){var t=Ga();ya(t,new Ya(t,e))}function Qa(e,t){_r.call(this,Wa.Ua,e),this.size=t}function Ja(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return fr.setTimeout((function(){e()}),t)}Wa.Ta="serverreachability",xr(qa,_r),Wa.STAT_EVENT="statevent",xr(Ya,_r),Wa.Ua="timingevent",xr(Qa,_r);var $a={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ei={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ti(){}function ni(e){return e.h||(e.h=e.i())}function ri(){}ti.prototype.h=null;var ai,ii={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oi(){_r.call(this,"d")}function si(){_r.call(this,"c")}function ui(){}function ci(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Za(this),this.P=hi,e=Lr?125:void 0,this.V=new Ma(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new li}function li(){this.i=null,this.g="",this.h=!1}xr(oi,_r),xr(si,_r),xr(ui,ti),ui.prototype.g=function(){return new XMLHttpRequest},ui.prototype.i=function(){return{}},ai=new ui;var hi=45e3,fi={},di={};function pi(e,t,n){e.L=1,e.v=Mi(Ei(t)),e.s=n,e.S=!0,vi(e,null)}function vi(e,t){e.G=Date.now(),bi(e),e.A=Ei(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Gi(n.i,"t",r),e.C=0,n=e.l.J,e.h=new li,e.g=Ko(e.l,n?t:null,!e.s),0<e.O&&(e.M=new La(br(e.Pa,e,e.g),e.O)),Ba(e.U,e.g,"readystatechange",e.nb),t=e.I?$r(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Ka(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var o="",s=i.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function gi(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function mi(e,t,n){for(var r,a=!0;!e.J&&e.C<n.length;){if((r=yi(e,n))==di){4==t&&(e.o=4,Xa(14),a=!1),ja(e.j,e.m,null,"[Incomplete Response]");break}if(r==fi){e.o=4,Xa(15),ja(e.j,e.m,n,"[Invalid Chunk]"),a=!1;break}ja(e.j,e.m,r,null),Si(e,r)}gi(e)&&r!=di&&r!=fi&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Xa(16),a=!1),e.i=e.i&&a,a?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bo(t),t.M=!0,Xa(11))):(ja(e.j,e.m,n,"[Invalid Chunked Response]"),Ii(e),wi(e))}function yi(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?di:(n=Number(t.substring(n,r)),isNaN(n)?fi:(r+=1)+n>t.length?di:(t=t.slice(r,r+n),e.C=r+n,t))}function bi(e){e.Y=Date.now()+e.P,ki(e,e.P)}function ki(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ja(br(e.lb,e),t)}function xi(e){e.B&&(fr.clearTimeout(e.B),e.B=null)}function wi(e){0==e.l.H||e.J||jo(e.l,e)}function Ii(e){xi(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Oa(e.V),Ua(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Si(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||$i(n.i,e)))if(!e.K&&$i(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Vo(n),Ro(n)}zo(n),Xa(18)}}else n.Fa=a[1],0<n.Fa-n.V&&37500>a[2]&&n.G&&0==n.A&&!n.v&&(n.v=Ja(br(n.ib,n),6e3));if(1>=Ji(n.i)&&n.oa){try{n.oa()}catch(i){}n.oa=void 0}}else Ho(n,11)}else if((e.K||n.g==e)&&Vo(n),!Er(t))for(a=n.Ja.g.parse(t),t=0;t<a.length;t++){var i=a[t];if(n.V=i[0],i=i[1],2==n.H)if("c"==i[0]){n.K=i[1],n.pa=i[2];var o=i[3];null!=o&&(n.ra=o,n.l.info("VER="+n.ra));var s=i[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));var u=i[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(eo(h,h.h),h.h=null))}if(r.F){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.Da=f,Ri(r.I,r.F,f))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var d=e;if((r=n).wa=qo(r,r.J?r.pa:null,r.Y),d.K){to(r.i,d);var p=d,v=r.L;v&&p.setTimeout(v),p.B&&(xi(p),bi(p)),r.g=d}else Zo(r);0<n.j.length&&Oo(n)}else"stop"!=i[0]&&"close"!=i[0]||Ho(n,7);else 3==n.H&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Ho(n,7):Ao(n):"noop"!=i[0]&&n.h&&n.h.Aa(i),n.A=0)}Ka()}catch(i){}}function Ci(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(dr(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(dr(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(dr(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,i=0;i<a;i++)t.call(void 0,r[i],n&&n[i],e)}(ur=ci.prototype).setTimeout=function(e){this.P=e},ur.nb=function(e){e=e.target;var t=this.M;t&&3==Co(e)?t.l():this.Pa(e)},ur.Pa=function(e){try{if(e==this.g)e:{var t=Co(this.g),n=this.g.Ia();this.g.da();if(!(3>t)&&(3!=t||Lr||this.g&&(this.h.h||this.g.ja()||_o(this.g)))){this.J||4!=t||7==n||Ka(),xi(this);var r=this.g.da();this.ca=r;t:if(gi(this)){var a=_o(this.g);e="";var i=a.length,o=4==Co(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ii(this),wi(this);var s="";break t}this.h.i=new fr.TextDecoder}for(n=0;n<i;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:o&&n==i-1});a.splice(0,i),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==r,function(e,t,n,r,a,i,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.j,this.u,this.A,this.m,this.W,t,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Er(u)){var l=u;break t}}l=null}if(!(r=l)){this.i=!1,this.o=3,Xa(12),Ii(this),wi(this);break e}ja(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Si(this,r)}this.S?(mi(this,t,s),Lr&&this.i&&3==t&&(Ba(this.U,this.V,"tick",this.mb),this.V.start())):(ja(this.j,this.m,s,null),Si(this,s)),4==t&&Ii(this),this.i&&!this.J&&(4==t?jo(this.l,this):(this.i=!1,bi(this)))}else(function(e){var t={};e=(e.g&&2<=Co(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!Er(e[n])){var r=_a(e[n]),a=r[0];if("string"===typeof(r=r[1])){r=r.trim();var i=t[a]||[];t[a]=i,i.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<s.indexOf("Unknown SID")?(this.o=3,Xa(12)):(this.o=0,Xa(13)),Ii(this),wi(this)}}}catch(t){}},ur.mb=function(){if(this.g){var e=Co(this.g),t=this.g.ja();this.C<t.length&&(xi(this),mi(this,e,t),this.i&&4!=e&&bi(this))}},ur.cancel=function(){this.J=!0,Ii(this)},ur.lb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(Ka(),Xa(17)),Ii(this),this.o=2,wi(this)):ki(this,this.Y-e)};var _i=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ti(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Ti){this.h=e.h,Ni(this,e.j),this.s=e.s,this.g=e.g,Di(this,e.m),this.l=e.l;var t=e.i,n=new Vi;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ai(this,n),this.o=e.o}else e&&(t=String(e).match(_i))?(this.h=!1,Ni(this,t[1]||"",!0),this.s=Oi(t[2]||""),this.g=Oi(t[3]||"",!0),Di(this,t[4]),this.l=Oi(t[5]||"",!0),Ai(this,t[6]||"",!0),this.o=Oi(t[7]||"")):(this.h=!1,this.i=new Vi(null,this.h))}function Ei(e){return new Ti(e)}function Ni(e,t,n){e.j=n?Oi(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Di(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ai(e,t,n){t instanceof Vi?(e.i=t,function(e,t){t&&!e.j&&(ji(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Wi(this,t),Gi(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Fi(t,Bi)),e.i=new Vi(t,e.h))}function Ri(e,t,n){e.i.set(t,n)}function Mi(e){return Ri(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Oi(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Fi(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Pi),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Pi(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ti.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Fi(t,Li,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Fi(t,Li,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Fi(n,"/"==n.charAt(0)?zi:Zi,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Fi(n,Ui)),e.join("")};var Li=/[#\/\?@]/g,Zi=/[#\?:]/g,zi=/[#\?]/g,Bi=/[#\?@]/g,Ui=/#/g;function Vi(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ji(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Wi(e,t){ji(e),t=qi(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Hi(e,t){return ji(e),t=qi(e,t),e.g.has(t)}function Gi(e,t,n){Wi(e,t),0<n.length&&(e.i=null,e.g.set(qi(e,t),Sr(n)),e.h+=n.length)}function qi(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(ur=Vi.prototype).add=function(e,t){ji(this),this.i=null,e=qi(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ur.forEach=function(e,t){ji(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},ur.ta=function(){ji(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var a=e[r],i=0;i<a.length;i++)n.push(t[r]);return n},ur.Z=function(e){ji(this);var t=[];if("string"===typeof e)Hi(this,e)&&(t=t.concat(this.g.get(qi(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},ur.set=function(e,t){return ji(this),this.i=null,Hi(this,e=qi(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ur.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},ur.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],a=encodeURIComponent(String(r)),i=this.Z(r);for(r=0;r<i.length;r++){var o=a;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),e.push(o)}}return this.i=e.join("&")};var Ki=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.g=t,this.map=n}));function Yi(e){this.l=e||Xi,fr.PerformanceNavigationTiming?e=0<(e=fr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(fr.g&&fr.g.Ka&&fr.g.Ka()&&fr.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Xi=10;function Qi(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ji(e){return e.h?1:e.g?e.g.size:0}function $i(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function eo(e,t){e.g?e.g.add(t):e.h=t}function to(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function no(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=(0,C.Z)(e.g.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;n=n.concat(a.F)}}catch(i){r.e(i)}finally{r.f()}return n}return Sr(e.i)}Yi.prototype.cancel=function(){if(this.i=no(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=(0,C.Z)(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}};var ro,ao=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"stringify",value:function(e){return fr.JSON.stringify(e,void 0)}},{key:"parse",value:function(e){return fr.JSON.parse(e,void 0)}}]),e}();function io(){this.g=new ao}function oo(e,t,n){var r=n||"";try{Ci(e,(function(e,n){var a=e;pr(e)&&(a=ka(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(a){throw t.push(r+"type="+encodeURIComponent("_badmap")),a}}function so(e,t,n,r,a){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,a(r)}catch(i){}}function uo(e){this.l=e.fc||null,this.j=e.ob||!1}function co(e,t){ma.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=lo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}xr(uo,ti),uo.prototype.g=function(){return new co(this.l,this.j)},uo.prototype.i=(ro={},function(){return ro}),xr(co,ma);var lo=0;function ho(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function fo(e){e.readyState=4,e.l=null,e.j=null,e.A=null,po(e)}function po(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ur=co.prototype).open=function(e,t){if(this.readyState!=lo)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,po(this)},ur.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||fr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},ur.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fo(this)),this.readyState=lo},ur.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,po(this)),this.g&&(this.readyState=3,po(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof fr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ho(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},ur.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?fo(this):po(this),3==this.readyState&&ho(this)}},ur.Za=function(e){this.g&&(this.response=this.responseText=e,fo(this))},ur.Ya=function(e){this.g&&(this.response=e,fo(this))},ur.ka=function(){this.g&&fo(this)},ur.setRequestHeader=function(e,t){this.v.append(e,t)},ur.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ur.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(co.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var vo=fr.JSON.parse;function go(e){ma.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=mo,this.L=this.M=!1}xr(go,ma);var mo="",yo=/^https?$/i,bo=["POST","PUT"];function ko(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,xo(e),Io(e)}function xo(e){e.F||(e.F=!0,ya(e,"complete"),ya(e,"error"))}function wo(e){if(e.h&&"undefined"!=typeof hr&&(!e.C[1]||4!=Co(e)||2!=e.da()))if(e.v&&4==Co(e))Fa(e.La,0,e);else if(ya(e,"readystatechange"),4==Co(e)){e.h=!1;try{var t,n=e.da();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var a;if(a=0===n){var i=String(e.I).match(_i)[1]||null;!i&&fr.self&&fr.self.location&&(i=fr.self.location.protocol.slice(0,-1)),a=!yo.test(i?i.toLowerCase():"")}t=a}if(t)ya(e,"complete"),ya(e,"success");else{e.m=6;try{var o=2<Co(e)?e.g.statusText:""}catch(s){o=""}e.j=o+" ["+e.da()+"]",xo(e)}}finally{Io(e)}}}function Io(e,t){if(e.g){So(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||ya(e,"ready");try{n.onreadystatechange=r}catch(a){}}}function So(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(fr.clearTimeout(e.A),e.A=null)}function Co(e){return e.g?e.g.readyState:0}function _o(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case mo:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(As){return null}}function To(e){var t="";return Jr(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Eo(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=To(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Ri(e,t,n))}function No(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Do(e){this.Ga=0,this.j=[],this.l=new Va,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=No("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=No("baseRetryDelayMs",5e3,e),this.hb=No("retryDelaySeedMs",1e4,e),this.eb=No("forwardChannelMaxRetries",2,e),this.xa=No("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Yi(e&&e.concurrentRequestLimit),this.Ja=new io,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ao(e){if(Mo(e),3==e.H){var t=e.W++,n=Ei(e.I);if(Ri(n,"SID",e.K),Ri(n,"RID",t),Ri(n,"TYPE","terminate"),Po(e,n),(t=new ci(e,e.l,t)).L=2,t.v=Mi(Ei(n)),n=!1,fr.navigator&&fr.navigator.sendBeacon)try{n=fr.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&fr.Image&&((new Image).src=t.v,n=!0),n||(t.g=Ko(t.l,null),t.g.ha(t.v)),t.G=Date.now(),bi(t)}Go(e)}function Ro(e){e.g&&(Bo(e),e.g.cancel(),e.g=null)}function Mo(e){Ro(e),e.u&&(fr.clearTimeout(e.u),e.u=null),Vo(e),e.i.cancel(),e.m&&("number"===typeof e.m&&fr.clearTimeout(e.m),e.m=null)}function Oo(e){if(!Qi(e.i)&&!e.m){e.m=!0;var t=e.Na;Ea||Aa(),Na||(Ea(),Na=!0),Da.add(t,e),e.C=0}}function Fo(e,t){var n;n=t?t.m:e.W++;var r=Ei(e.I);Ri(r,"SID",e.K),Ri(r,"RID",n),Ri(r,"AID",e.V),Po(e,r),e.o&&e.s&&Eo(r,e.o,e.s),n=new ci(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Lo(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),eo(e.i,n),pi(n,r,t)}function Po(e,t){e.na&&Jr(e.na,(function(e,n){Ri(t,n,e)})),e.h&&Ci({},(function(e,n){Ri(t,n,e)}))}function Lo(e,t,n){n=Math.min(e.j.length,n);var r=e.h?br(e.h.Va,e.h,e):null;e:for(var a=e.j,i=-1;;){var o=["count="+n];-1==i?0<n?(i=a[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);for(var s=!0,u=0;u<n;u++){var c=a[u].g,l=a[u].map;if(0>(c-=i))i=Math.max(0,a[u].g-100),s=!1;else try{oo(l,o,"req"+c+"_")}catch(Vs){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.j.splice(0,n),t.F=e,r}function Zo(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Ea||Aa(),Na||(Ea(),Na=!0),Da.add(t,e),e.A=0}}function zo(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Ja(br(e.Ma,e),Wo(e,e.A)),e.A++,!0)}function Bo(e){null!=e.B&&(fr.clearTimeout(e.B),e.B=null)}function Uo(e){e.g=new ci(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ei(e.wa);Ri(t,"RID","rpc"),Ri(t,"SID",e.K),Ri(t,"AID",e.V),Ri(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ri(t,"TO",e.qa),Ri(t,"TYPE","xmlhttp"),Po(e,t),e.o&&e.s&&Eo(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Mi(Ei(t)),n.s=null,n.S=!0,vi(n,e)}function Vo(e){null!=e.v&&(fr.clearTimeout(e.v),e.v=null)}function jo(e,t){var n=null;if(e.g==t){Vo(e),Bo(e),e.g=null;var r=2}else{if(!$i(e.i,t))return;n=t.F,to(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var a=e.C;ya(r=Ga(),new Qa(r,n)),Oo(e)}else Zo(e);else if(3==(a=t.o)||0==a&&0<t.ca||!(1==r&&function(e,t){return!(Ji(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Ja(br(e.Na,e,t),Wo(e,e.C)),e.C++,!0))}(e,t)||2==r&&zo(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),a){case 1:Ho(e,5);break;case 4:Ho(e,10);break;case 3:Ho(e,6);break;default:Ho(e,2)}}function Wo(e,t){var n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Ho(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=br(e.pb,e);n||(n=new Ti("//www.google.com/images/cleardot.gif"),fr.location&&"http"==fr.location.protocol||Ni(n,"https"),Mi(n)),function(e,t){var n=new Va;if(fr.Image){var r=new Image;r.onload=kr(so,n,r,"TestLoadImage: loaded",!0,t),r.onerror=kr(so,n,r,"TestLoadImage: error",!1,t),r.onabort=kr(so,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=kr(so,n,r,"TestLoadImage: timeout",!1,t),fr.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Xa(2);e.H=0,e.h&&e.h.za(t),Go(e),Mo(e)}function Go(e){if(e.H=0,e.ma=[],e.h){var t=no(e.i);0==t.length&&0==e.j.length||(Cr(e.ma,t),Cr(e.ma,e.j),e.i.i.length=0,Sr(e.j),e.j.length=0),e.h.ya()}}function qo(e,t,n){var r=n instanceof Ti?Ei(n):new Ti(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Di(r,r.m);else{var a=fr.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var i=new Ti(null);r&&Ni(i,r),t&&(i.g=t),a&&Di(i,a),n&&(i.l=n),r=i}return n=e.F,t=e.Da,n&&t&&Ri(r,n,t),Ri(r,"VER",e.ra),Po(e,r),r}function Ko(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new go(new uo({ob:!0})):new go(e.va)).Oa(e.J),t}function Yo(){}function Xo(){if(Fr&&!(10<=Number(Hr)))throw Error("Environmental error: no available transport.")}function Qo(e,t){ma.call(this),this.g=new Do(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Er(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Er(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new es(this)}function Jo(e){oi.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function $o(){si.call(this),this.status=1}function es(e){this.g=e}function ts(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ns(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],o=t+(i^n&(a^i))+r[0]+3614090360&4294967295;o=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(o<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=n+((o=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((a=i+((o=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function rs(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}(ur=go.prototype).Oa=function(e){this.M=e},ur.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ai.g(),this.C=this.u?ni(this.u):ni(ai),this.g.onreadystatechange=br(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void ko(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));var i,o=(0,C.Z)(r.keys());try{for(o.s();!(i=o.n()).done;){var s=i.value;n.set(s,r.get(s))}}catch(p){o.e(p)}finally{o.f()}}r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),a=fr.FormData&&e instanceof fr.FormData,!(0<=Ir(bo,t))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var u,c=(0,C.Z)(n);try{for(c.s();!(u=c.n()).done;){var h=l(u.value,2),f=h[0],d=h[1];this.g.setRequestHeader(f,d)}}catch(p){c.e(p)}finally{c.f()}this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{So(this),0<this.B&&((this.L=function(e){return Fr&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=br(this.ua,this)):this.A=Fa(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){ko(this,s)}},ur.ua=function(){"undefined"!=typeof hr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ya(this,"timeout"),this.abort(8))},ur.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ya(this,"complete"),ya(this,"abort"),Io(this))},ur.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Io(this,!0)),go.$.N.call(this)},ur.La=function(){this.s||(this.G||this.v||this.l?wo(this):this.kb())},ur.kb=function(){wo(this)},ur.isActive=function(){return!!this.g},ur.da=function(){try{return 2<Co(this)?this.g.status:-1}catch(ro){return-1}},ur.ja=function(){try{return this.g?this.g.responseText:""}catch(ro){return""}},ur.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),vo(t)}},ur.Ia=function(){return this.m},ur.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(ur=Do.prototype).ra=8,ur.H=1,ur.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new ci(this,this.l,e),n=this.s;if(this.U&&(n?ta(n=$r(n),this.U):n=this.U),null!==this.o||this.O||(t.I=n,n=null),this.P)e:{for(var r=0,a=0;a<this.j.length;a++){var i=this.j[a];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(r+=i)){r=a;break e}if(4096===r||a===this.j.length-1){r=a+1;break e}}r=1e3}else r=1e3;r=Lo(this,t,r),Ri(a=Ei(this.I),"RID",e),Ri(a,"CVER",22),this.F&&Ri(a,"X-HTTP-Session-Id",this.F),Po(this,a),n&&(this.O?r="headers="+encodeURIComponent(String(To(n)))+"&"+r:this.o&&Eo(a,this.o,n)),eo(this.i,t),this.bb&&Ri(a,"TYPE","init"),this.P?(Ri(a,"$req",r),Ri(a,"SID","null"),t.aa=!0,pi(t,a,null)):pi(t,a,r),this.H=2}}else 3==this.H&&(e?Fo(this,e):0==this.j.length||Qi(this.i)||Fo(this))},ur.Ma=function(){if(this.u=null,Uo(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Ja(br(this.jb,this),e)}},ur.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Xa(10),Ro(this),Uo(this))},ur.ib=function(){null!=this.v&&(this.v=null,Ro(this),zo(this),Xa(19))},ur.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Xa(2)):(this.l.info("Failed to ping google.com"),Xa(1))},ur.isActive=function(){return!!this.h&&this.h.isActive(this)},(ur=Yo.prototype).Ba=function(){},ur.Aa=function(){},ur.za=function(){},ur.ya=function(){},ur.isActive=function(){return!0},ur.Va=function(){},Xo.prototype.g=function(e,t){return new Qo(e,t)},xr(Qo,ma),Qo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Xa(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=qo(e,null,e.Y),Oo(e)},Qo.prototype.close=function(){Ao(this.g)},Qo.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ka(e),e=n);t.j.push(new Ki(t.fb++,e)),3==t.H&&Oo(t)},Qo.prototype.N=function(){this.g.h=null,delete this.j,Ao(this.g),delete this.g,Qo.$.N.call(this)},xr(Jo,oi),xr($o,si),xr(es,Yo),es.prototype.Ba=function(){ya(this.g,"a")},es.prototype.Aa=function(e){ya(this.g,new Jo(e))},es.prototype.za=function(e){ya(this.g,new $o)},es.prototype.ya=function(){ya(this.g,"b")},xr(ts,(function(){this.blockSize=-1})),ts.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},ts.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,a=this.h,i=0;i<t;){if(0==a)for(;i<=n;)ns(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(r[a++]=e.charCodeAt(i++),a==this.blockSize){ns(this,r),a=0;break}}else for(;i<t;)if(r[a++]=e[i++],a==this.blockSize){ns(this,r),a=0;break}}this.h=a,this.i+=t},ts.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var as={};function is(e){return-128<=e&&128>e?function(e,t){var n=as;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new rs([0|e],0>e?-1:0)})):new rs([0|e],0>e?-1:0)}function os(e){if(isNaN(e)||!isFinite(e))return us;if(0>e)return ds(os(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=ss;return new rs(t,0)}var ss=4294967296,us=is(0),cs=is(1),ls=is(16777216);function hs(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function fs(e){return-1==e.h}function ds(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new rs(n,~e.h).add(cs)}function ps(e,t){return e.add(ds(t))}function vs(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function gs(e,t){this.g=e,this.h=t}function ms(e,t){if(hs(t))throw Error("division by zero");if(hs(e))return new gs(us,us);if(fs(e))return t=ms(ds(e),t),new gs(ds(t.g),ds(t.h));if(fs(t))return t=ms(e,ds(t)),new gs(ds(t.g),t.h);if(30<e.g.length){if(fs(e)||fs(t))throw Error("slowDivide_ only works with positive integers.");for(var n=cs,r=t;0>=r.X(e);)n=ys(n),r=ys(r);var a=bs(n,1),i=bs(r,1);for(r=bs(r,2),n=bs(n,2);!hs(r);){var o=i.add(r);0>=o.X(e)&&(a=a.add(n),i=o),r=bs(r,1),n=bs(n,1)}return t=ps(e,a.R(t)),new gs(a,t)}for(a=us;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(i=os(n)).R(t);fs(o)||0<o.X(e);)o=(i=os(n-=r)).R(t);hs(i)&&(i=cs),a=a.add(i),e=ps(e,o)}return new gs(a,e)}function ys(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new rs(n,e.h)}function bs(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],i=0;i<r;i++)a[i]=0<t?e.D(i+n)>>>t|e.D(i+n+1)<<32-t:e.D(i+n);return new rs(a,e.h)}(ur=rs.prototype).ea=function(){if(fs(this))return-ds(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:ss+r)*t,t*=ss}return e},ur.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(hs(this))return"0";if(fs(this))return"-"+ds(this).toString(e);for(var t=os(Math.pow(e,6)),n=this,r="";;){var a=ms(n,t).g,i=((0<(n=ps(n,a.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(hs(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},ur.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},ur.X=function(e){return fs(e=ps(this,e))?-1:hs(e)?0:1},ur.abs=function(){return fs(this)?ds(this):this},ur.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var i=r+(65535&this.D(a))+(65535&e.D(a)),o=(i>>>16)+(this.D(a)>>>16)+(e.D(a)>>>16);r=o>>>16,i&=65535,o&=65535,n[a]=o<<16|i}return new rs(n,-2147483648&n[n.length-1]?-1:0)},ur.R=function(e){if(hs(this)||hs(e))return us;if(fs(this))return fs(e)?ds(this).R(ds(e)):ds(ds(this).R(e));if(fs(e))return ds(this.R(ds(e)));if(0>this.X(ls)&&0>e.X(ls))return os(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var i=this.D(r)>>>16,o=65535&this.D(r),s=e.D(a)>>>16,u=65535&e.D(a);n[2*r+2*a]+=o*u,vs(n,2*r+2*a),n[2*r+2*a+1]+=i*u,vs(n,2*r+2*a+1),n[2*r+2*a+1]+=o*s,vs(n,2*r+2*a+1),n[2*r+2*a+2]+=i*s,vs(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new rs(n,0)},ur.gb=function(e){return ms(this,e).h},ur.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new rs(n,this.h&e.h)},ur.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new rs(n,this.h|e.h)},ur.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new rs(n,this.h^e.h)},Xo.prototype.createWebChannel=Xo.prototype.g,Qo.prototype.send=Qo.prototype.u,Qo.prototype.open=Qo.prototype.m,Qo.prototype.close=Qo.prototype.close,$a.NO_ERROR=0,$a.TIMEOUT=8,$a.HTTP_ERROR=6,ei.COMPLETE="complete",ri.EventType=ii,ii.OPEN="a",ii.CLOSE="b",ii.ERROR="c",ii.MESSAGE="d",ma.prototype.listen=ma.prototype.O,go.prototype.listenOnce=go.prototype.P,go.prototype.getLastError=go.prototype.Sa,go.prototype.getLastErrorCode=go.prototype.Ia,go.prototype.getStatus=go.prototype.da,go.prototype.getResponseJson=go.prototype.Wa,go.prototype.getResponseText=go.prototype.ja,go.prototype.send=go.prototype.ha,go.prototype.setWithCredentials=go.prototype.Oa,ts.prototype.digest=ts.prototype.l,ts.prototype.reset=ts.prototype.reset,ts.prototype.update=ts.prototype.j,rs.prototype.add=rs.prototype.add,rs.prototype.multiply=rs.prototype.R,rs.prototype.modulo=rs.prototype.gb,rs.prototype.compare=rs.prototype.X,rs.prototype.toNumber=rs.prototype.ea,rs.prototype.toString=rs.prototype.toString,rs.prototype.getBits=rs.prototype.D,rs.fromNumber=os,rs.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return ds(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=os(Math.pow(n,8)),a=us,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),s=parseInt(t.substring(i,i+o),n);8>o?(o=os(Math.pow(n,o)),a=a.R(o).add(os(s))):a=(a=a.R(r)).add(os(s))}return a};var ks=lr.createWebChannelTransport=function(){return new Xo},xs=lr.getStatEventTarget=function(){return Ga()},ws=lr.ErrorCode=$a,Is=lr.EventType=ei,Ss=lr.Event=Wa,Cs=lr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},_s=lr.FetchXmlHttpFactory=uo,Ts=lr.WebChannel=ri,Es=lr.XhrIo=go,Ns=lr.Md5=ts,Ds=lr.Integer=rs,As="@firebase/firestore",Rs=function(){function e(t){(0,p.Z)(this,e),this.uid=t}return(0,v.Z)(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();Rs.UNAUTHENTICATED=new Rs(null),Rs.GOOGLE_CREDENTIALS=new Rs("google-credentials-uid"),Rs.FIRST_PARTY=new Rs("first-party-uid"),Rs.MOCK_USER=new Rs("mock-user");var Ms="9.22.2",Os=new Wt("@firebase/firestore");function Fs(){return Os.logLevel}function Ps(e){if(Os.logLevel<=Lt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(zs);Os.debug.apply(Os,["Firestore (".concat(Ms,"): ").concat(e)].concat(d(a)))}}function Ls(e){if(Os.logLevel<=Lt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(zs);Os.error.apply(Os,["Firestore (".concat(Ms,"): ").concat(e)].concat(d(a)))}}function Zs(e){if(Os.logLevel<=Lt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(zs);Os.warn.apply(Os,["Firestore (".concat(Ms,"): ").concat(e)].concat(d(a)))}}function zs(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Bs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Ms,") INTERNAL ASSERTION FAILED: ")+e;throw Ls(t),new Error(t)}function Us(e,t){e||Bs()}function Vs(e,t){return e}var js={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ws=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r)).code=e,a.message=r,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},a}return(0,v.Z)(n)}(vt),Hs=(0,v.Z)((function e(){var t=this;(0,p.Z)(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Gs=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),qs=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Rs.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Ks=function(){function e(t){(0,p.Z)(this,e),this.token=t,this.changeListener=null}return(0,v.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),Ys=function(){function e(t){(0,p.Z)(this,e),this.t=t,this.currentUser=Rs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return(0,v.Z)(e,[{key:"start",value:function(e,t){var n=this,r=this.i,a=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},i=new Hs;this.o=function(){n.i++,n.currentUser=n.u(),i.resolve(),i=new Hs,e.enqueueRetryable((function(){return a(n.currentUser)}))};var o=function(){var t=i;e.enqueueRetryable(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},s=function(e){Ps("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?s(e):(Ps("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Hs)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Ps("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Us("string"==typeof n.accessToken),new Gs(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Us(null===e||"string"==typeof e),new Rs(e)}}]),e}(),Xs=function(){function e(t,n,r){(0,p.Z)(this,e),this.h=t,this.l=n,this.m=r,this.type="FirstParty",this.user=Rs.FIRST_PARTY,this.g=new Map}return(0,v.Z)(e,[{key:"p",value:function(){return this.m?this.m():null}},{key:"headers",get:function(){this.g.set("X-Goog-AuthUser",this.h);var e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}]),e}(),Qs=function(){function e(t,n,r){(0,p.Z)(this,e),this.h=t,this.l=n,this.m=r}return(0,v.Z)(e,[{key:"getToken",value:function(){return Promise.resolve(new Xs(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Rs.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Js=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),$s=function(){function e(t){(0,p.Z)(this,e),this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}return(0,v.Z)(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Ps("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.T;return n.T=e.token,Ps("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var a=function(e){Ps("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.I.onInit((function(e){return a(e)})),setTimeout((function(){if(!n.appCheck){var e=n.I.getImmediate({optional:!0});e?a(e):Ps("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Us("string"==typeof t.token),e.T=t.token,new Js(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function eu(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var tu=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62),n="";n.length<20;)for(var r=eu(40),a=0;a<r.length;++a)n.length<20&&r[a]<t&&(n+=e.charAt(r[a]%62));return n}}]),e}();function nu(e,t){return e<t?-1:e>t?1:0}function ru(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function au(e){return e+"\0"}var iu=function(){function e(t,n){if((0,p.Z)(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Ws(js.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ws(js.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Ws(js.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ws(js.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return(0,v.Z)(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?nu(this.nanoseconds,e.nanoseconds):nu(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),ou=function(){function e(t){(0,p.Z)(this,e),this.timestamp=t}return(0,v.Z)(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new iu(0,0))}},{key:"max",value:function(){return new e(new iu(253402300799,999999999))}}]),e}(),su=function(){function e(t,n,r){(0,p.Z)(this,e),void 0===n?n=0:n>t.length&&Bs(),void 0===r?r=t.length-n:r>t.length-n&&Bs(),this.segments=t,this.offset=n,this.len=r}return(0,v.Z)(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var a=e.get(r),i=t.get(r);if(a<i)return-1;if(a>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),uu=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Ws(js.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,d(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(su),cu=/^[_a-zA-Z][_a-zA-Z0-9]*$/,lu=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return cu.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",a=0,i=function(){if(0===r.length)throw new Ws(js.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;a<e.length;){var s=e[a];if("\\"===s){if(a+1===e.length)throw new Ws(js.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[a+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ws(js.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else"`"===s?(o=!o,a++):"."!==s||o?(r+=s,a++):(i(),a++)}if(i(),o)throw new Ws(js.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(su),hu=function(){function e(t){(0,p.Z)(this,e),this.path=t}return(0,v.Z)(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===uu.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(uu.fromString(t))}},{key:"fromName",value:function(t){return new e(uu.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(uu.emptyPath())}},{key:"comparator",value:function(e,t){return uu.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new uu(t.slice()))}}]),e}(),fu=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=a}));function du(e){return e.fields.find((function(e){return 2===e.kind}))}function pu(e){return e.fields.filter((function(e){return 2!==e.kind}))}fu.UNKNOWN_ID=-1;var vu=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.fieldPath=t,this.kind=n}));var gu=function(){function e(t,n){(0,p.Z)(this,e),this.sequenceNumber=t,this.offset=n}return(0,v.Z)(e,null,[{key:"empty",value:function(){return new e(0,bu.min())}}]),e}();function mu(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=ou.fromTimestamp(1e9===r?new iu(n+1,0):new iu(n,r));return new bu(a,hu.empty(),t)}function yu(e){return new bu(e.readTime,e.key,-1)}var bu=function(){function e(t,n,r){(0,p.Z)(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return(0,v.Z)(e,null,[{key:"min",value:function(){return new e(ou.min(),hu.empty(),-1)}},{key:"max",value:function(){return new e(ou.max(),hu.empty(),-1)}}]),e}();function ku(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=hu.comparator(e.documentKey,t.documentKey))?n:nu(e.largestBatchId,t.largestBatchId)}var xu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",wu=function(){function e(){(0,p.Z)(this,e),this.onCommittedListeners=[]}return(0,v.Z)(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function Iu(e){return Su.apply(this,arguments)}function Su(){return(Su=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===js.FAILED_PRECONDITION&&t.message===xu){e.next=2;break}throw t;case 2:Ps("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Cu=function(){function e(t){var n=this;(0,p.Z)(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return(0,v.Z)(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Bs(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,a){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,a)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,a)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,a=0,i=!1;t.forEach((function(t){++r,t.next((function(){++a,i&&a===r&&e()}),(function(e){return n(e)}))})),i=!0,a===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),a=(0,C.Z)(t);try{var i=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,a){r.push(t.call(n,e,a))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var a=t.length,i=new Array(a),o=0,s=function(){var s=u;n(t[s]).next((function(t){i[s]=t,++o===a&&e(i)}),(function(e){return r(e)}))},u=0;u<a;u++)s()}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function a(){!0===t()?n().next((function(){a()}),r):e()}()}))}}]),e}(),_u=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.v=new Hs,this.transaction.oncomplete=function(){r.v.resolve()},this.transaction.onabort=function(){n.error?r.v.reject(new Nu(t,n.error)):r.v.resolve()},this.transaction.onerror=function(e){var n=Ou(e.target.error);r.v.reject(new Nu(t,n))}}return(0,v.Z)(e,[{key:"R",get:function(){return this.v.promise}},{key:"abort",value:function(e){e&&this.v.reject(e),this.aborted||(Ps("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"P",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Au(t)}}],[{key:"open",value:function(t,n,r,a){try{return new e(n,t.transaction(a,r))}catch(t){throw new Nu(n,t)}}}]),e}(),Tu=function(){function e(t,n,r){(0,p.Z)(this,e),this.name=t,this.version=n,this.V=r,12.2===e.S(ct())&&Ls("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return(0,v.Z)(e,[{key:"$",value:function(){var e=Rt(Dt().mark((function e(t){var n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Ps("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var a=indexedDB.open(n.name,n.version);a.onsuccess=function(t){var n=t.target.result;e(n)},a.onblocked=function(){r(new Nu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ws(js.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new Ws(js.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Nu(t,n))},a.onupgradeneeded=function(e){Ps("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.V.O(t,a.transaction,e.oldVersion,n.version).next((function(){Ps("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.F&&(this.db.onversionchange=function(e){return n.F(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"B",value:function(e){this.F=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){var i,o,s,u,c=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="readonly"===n,o=0,s=Dt().mark((function e(){var n,s,u,l;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++o,e.prev=1,e.next=4,c.$(t);case 4:return c.db=e.sent,n=_u.open(c.db,t,i?"readonly":"readwrite",r),s=a(n).next((function(e){return n.P(),e})).catch((function(e){return n.abort(e),Cu.reject(e)})).toPromise(),s.catch((function(){})),e.next=9,n.R;case 9:return e.t0=s,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),u=e.t1,l="FirebaseError"!==u.name&&o<3,Ps("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),c.close(),l){e.next=18;break}return e.abrupt("return",{v:Promise.reject(u)});case 18:case"end":return e.stop()}}),e,null,[[1,13]])}));case 3:return e.delegateYield(s(),"t0",4);case 4:if("object"!==typeof(u=e.t0)){e.next=7;break}return e.abrupt("return",u.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Ps("SimpleDb","Removing database:",e),Ru(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"D",value:function(){if(!pt())return!1;if(e.C())return!0;var t=ct(),n=e.S(t),r=0<n&&n<10,a=e.N(t),i=0<a&&a<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||i)}},{key:"C",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.k)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"S",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"N",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),Eu=function(){function e(t){(0,p.Z)(this,e),this.L=t,this.q=!1,this.U=null}return(0,v.Z)(e,[{key:"isDone",get:function(){return this.q}},{key:"K",get:function(){return this.U}},{key:"cursor",set:function(e){this.L=e}},{key:"done",value:function(){this.q=!0}},{key:"G",value:function(e){this.U=e}},{key:"delete",value:function(){return Ru(this.L.delete())}}]),e}(),Nu=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,js.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",a}return(0,v.Z)(n)}(Ws);function Du(e){return"IndexedDbTransactionError"===e.name}var Au=function(){function e(t){(0,p.Z)(this,e),this.store=t}return(0,v.Z)(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Ps("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Ps("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ru(n)}},{key:"add",value:function(e){return Ps("SimpleDb","ADD",this.store.name,e,e),Ru(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Ru(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Ps("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Ps("SimpleDb","DELETE",this.store.name,e),Ru(this.store.delete(e))}},{key:"count",value:function(){return Ps("SimpleDb","COUNT",this.store.name),Ru(this.store.count())}},{key:"j",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),a=[];return this.W(r,(function(e,t){a.push(t)})).next((function(){return a}))}var i=this.store.getAll(n.range);return new Cu((function(e,t){i.onerror=function(e){t(e.target.error)},i.onsuccess=function(t){e(t.target.result)}}))}},{key:"H",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Cu((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){Ps("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Y=!1;var r=this.cursor(n);return this.W(r,(function(e,t,n){return n.delete()}))}},{key:"X",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.W(r,t)}},{key:"Z",value:function(e){var t=this.cursor({});return new Cu((function(n,r){t.onerror=function(e){var t=Ou(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"W",value:function(e,t){var n=[];return new Cu((function(r,a){e.onerror=function(e){a(e.target.error)},e.onsuccess=function(e){var a=e.target.result;if(a){var i=new Eu(a),o=t(a.primaryKey,a.value,i);if(o instanceof Cu){var s=o.catch((function(e){return i.done(),Cu.reject(e)}));n.push(s)}i.isDone?r():null===i.K?a.continue():a.continue(i.K)}else r()}})).next((function(){return Cu.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Ru(e){return new Cu((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Ou(e.target.error);n(t)}}))}var Mu=!1;function Ou(e){var t=Tu.S(ct());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new Ws("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Mu||(Mu=!0,setTimeout((function(){throw r}),0)),r}}return e}var Fu=function(){function e(t,n){(0,p.Z)(this,e),this.asyncQueue=t,this.tt=n,this.task=null}return(0,v.Z)(e,[{key:"start",value:function(){this.et(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"et",value:function(e){var t=this;Ps("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Ps,e.t1="Documents written: ",e.next=6,t.tt.nt();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!Du(e.t4)){e.next=17;break}Ps("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Iu(e.t4);case 19:return e.next=21,t.et(6e4);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),Pu=function(){function e(t,n){(0,p.Z)(this,e),this.localStore=t,this.persistence=n}return(0,v.Z)(e,[{key:"nt",value:function(){var e=Rt(Dt().mark((function e(){var t,n=this,r=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.st(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"st",value:function(e,t){var n=this,r=new Set,a=t,i=!0;return Cu.doWhile((function(){return!0===i&&a>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Ps("IndexBackiller","Processing collection: ".concat(t)),n.it(e,t,a).next((function(e){a-=e,r.add(t)}));i=!1}))})).next((function(){return t-a}))}},{key:"it",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(a){return r.localStore.localDocuments.getNextDocuments(e,t,a,n).next((function(n){var i=n.changes;return r.localStore.indexManager.updateIndexEntries(e,i).next((function(){return r.rt(a,n)})).next((function(n){return Ps("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return i.size}))}))}))}},{key:"rt",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=yu(t);ku(r,n)>0&&(n=r)})),new bu(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),Lu=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ot(e)},this.ut=function(e){return n.writeSequenceNumber(e)})}return(0,v.Z)(e,[{key:"ot",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ut&&this.ut(e),e}}]),e}();function Zu(e){return null==e}function zu(e){return 0===e&&1/e==-1/0}function Bu(e){return"number"==typeof e&&Number.isInteger(e)&&!zu(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Uu(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=ju(t)),t=Vu(e.get(n),t);return ju(t)}function Vu(e,t){for(var n=t,r=e.length,a=0;a<r;a++){var i=e.charAt(a);switch(i){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=i}}return n}function ju(e){return e+"\x01\x01"}function Wu(e){var t=e.length;if(Us(t>=2),2===t)return Us("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),uu.emptyPath();for(var n=t-2,r=[],a="",i=0;i<t;){var o=e.indexOf("\x01",i);switch((o<0||o>n)&&Bs(),e.charAt(o+1)){case"\x01":var s=e.substring(i,o),u=void 0;0===a.length?u=s:(u=a+=s,a=""),r.push(u);break;case"\x10":a+=e.substring(i,o),a+="\0";break;case"\x11":a+=e.substring(i,o+1);break;default:Bs()}i=o+2}return new uu(r)}Lu.ct=-1;var Hu=["userId","batchId"];function Gu(e,t){return[e,Uu(t)]}function qu(e,t,n){return[e,Uu(t),n]}var Ku={},Yu=["prefixPath","collectionGroup","readTime","documentId"],Xu=["prefixPath","collectionGroup","documentId"],Qu=["collectionGroup","readTime","prefixPath","documentId"],Ju=["canonicalId","targetId"],$u=["targetId","path"],ec=["path","targetId"],tc=["collectionId","parent"],nc=["indexId","uid"],rc=["uid","sequenceNumber"],ac=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ic=["indexId","uid","orderedDocumentKey"],oc=["userId","collectionPath","documentId"],sc=["userId","collectionPath","largestBatchId"],uc=["userId","collectionGroup","largestBatchId"],cc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),lc=[].concat(d(cc),["documentOverlays"]),hc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fc=hc,dc=[].concat(fc,["indexConfiguration","indexState","indexEntries"]),pc=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).ht=e,a.currentSequenceNumber=r,a}return(0,v.Z)(n)}(wu);function vc(e,t){var n=Vs(e);return Tu.M(n.ht,t)}function gc(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function mc(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function yc(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var bc=function(){function e(t,n){(0,p.Z)(this,e),this.comparator=t,this.root=n||xc.EMPTY}return(0,v.Z)(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,xc.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,xc.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new kc(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new kc(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new kc(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new kc(this.root,e,this.comparator,!0)}}]),e}(),kc=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.isReverse=a,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&a&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return(0,v.Z)(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),xc=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=i?i:e.EMPTY,this.size=this.left.size+1+this.right.size}return(0,v.Z)(e,[{key:"copy",value:function(t,n,r,a,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=i?i:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,a=n(e,r.key);return(r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,a=this;if(n(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===n(t,a.key)){if(a.right.isEmpty())return e.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,n))}return a.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Bs();if(this.right.isRed())throw Bs();var e=this.left.check();if(e!==this.right.check())throw Bs();return e+(this.isRed()?0:1)}}]),e}();xc.EMPTY=null,xc.RED=!0,xc.BLACK=!1,xc.EMPTY=new(function(){function e(){(0,p.Z)(this,e),this.size=0}return(0,v.Z)(e,[{key:"key",get:function(){throw Bs()}},{key:"value",get:function(){throw Bs()}},{key:"color",get:function(){throw Bs()}},{key:"left",get:function(){throw Bs()}},{key:"right",get:function(){throw Bs()}},{key:"copy",value:function(e,t,n,r,a){return this}},{key:"insert",value:function(e,t,n){return new xc(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var wc=function(){function e(t){(0,p.Z)(this,e),this.comparator=t,this.data=new bc(this.comparator)}return(0,v.Z)(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Ic(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Ic(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(0!==this.comparator(a,i))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Ic=function(){function e(t){(0,p.Z)(this,e),this.iter=t}return(0,v.Z)(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function Sc(e){return e.hasNext()?e.getNext():void 0}var Cc=function(){function e(t){(0,p.Z)(this,e),this.fields=t,t.sort(lu.comparator)}return(0,v.Z)(e,[{key:"unionWith",value:function(t){var n,r=new wc(lu.comparator),a=(0,C.Z)(this.fields);try{for(a.s();!(n=a.n()).done;){var i=n.value;r=r.add(i)}}catch(c){a.e(c)}finally{a.f()}var o,s=(0,C.Z)(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=(0,C.Z)(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return ru(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}(),_c=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).name="Base64DecodeError",e}return(0,v.Z)(n)}(w(Error));var Tc=function(e){function t(e){(0,p.Z)(this,t),this.binaryString=e}return(0,v.Z)(t,[{key:e,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return nu(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){var n=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new _c("Invalid base64 string: "+e):e}}(e);return new t(n)}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}(Symbol.iterator);Tc.EMPTY_BYTE_STRING=new Tc("");var Ec=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nc(e){if(Us(!!e),"string"==typeof e){var t=0,n=Ec.exec(e);if(Us(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:Dc(e.seconds),nanos:Dc(e.nanos)}}function Dc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ac(e){return"string"==typeof e?Tc.fromBase64String(e):Tc.fromUint8Array(e)}function Rc(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Mc(e){var t=e.mapValue.fields.__previous_value__;return Rc(t)?Mc(t):t}function Oc(e){var t=Nc(e.mapValue.fields.__local_write_time__.timestampValue);return new iu(t.seconds,t.nanos)}var Fc=(0,v.Z)((function e(t,n,r,a,i,o,s,u,c){(0,p.Z)(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=u,this.useFetchStreams=c})),Pc=function(){function e(t,n){(0,p.Z)(this,e),this.projectId=t,this.database=n||"(default)"}return(0,v.Z)(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}(),Lc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Zc={nullValue:"NULL_VALUE"};function zc(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Rc(e)?4:$c(e)?9007199254740991:10:Bs()}function Bc(e,t){if(e===t)return!0;var n=zc(e);if(n!==zc(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Oc(e).isEqual(Oc(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Nc(e.timestampValue),r=Nc(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ac(e.bytesValue).isEqual(Ac(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Dc(e.geoPointValue.latitude)===Dc(t.geoPointValue.latitude)&&Dc(e.geoPointValue.longitude)===Dc(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Dc(e.integerValue)===Dc(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Dc(e.doubleValue),r=Dc(t.doubleValue);return n===r?zu(n)===zu(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ru(e.arrayValue.values||[],t.arrayValue.values||[],Bc);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(gc(n)!==gc(r))return!1;for(var a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Bc(n[a],r[a])))return!1;return!0}(e,t);default:return Bs()}}function Uc(e,t){return void 0!==(e.values||[]).find((function(e){return Bc(e,t)}))}function Vc(e,t){if(e===t)return 0;var n=zc(e),r=zc(t);if(n!==r)return nu(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return nu(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Dc(e.integerValue||e.doubleValue),r=Dc(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return jc(e.timestampValue,t.timestampValue);case 4:return jc(Oc(e),Oc(t));case 5:return nu(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Ac(e),r=Ac(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0;a<n.length&&a<r.length;a++){var i=nu(n[a],r[a]);if(0!==i)return i}return nu(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=nu(Dc(e.latitude),Dc(t.latitude));return 0!==n?n:nu(Dc(e.longitude),Dc(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],a=0;a<n.length&&a<r.length;++a){var i=Vc(n[a],r[a]);if(i)return i}return nu(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Lc.mapValue&&t===Lc.mapValue)return 0;if(e===Lc.mapValue)return 1;if(t===Lc.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(var o=0;o<r.length&&o<i.length;++o){var s=nu(r[o],i[o]);if(0!==s)return s;var u=Vc(n[r[o]],a[i[o]]);if(0!==u)return u}return nu(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Bs()}}function jc(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return nu(e,t);var n=Nc(e),r=Nc(t),a=nu(n.seconds,r.seconds);return 0!==a?a:nu(n.nanos,r.nanos)}function Wc(e){return Hc(e)}function Hc(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Nc(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ac(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,hu.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,a=(0,C.Z)(e.values||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+=Hc(i)}}catch(o){a.e(o)}finally{a.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n=Object.keys(e.fields||{}).sort(),r="{",a=!0,i=(0,C.Z)(n);try{for(i.s();!(t=i.n()).done;){var o=t.value;a?a=!1:r+=",",r+="".concat(o,":").concat(Hc(e.fields[o]))}}catch(s){i.e(s)}finally{i.f()}return r+"}"}(e.mapValue):Bs();var t,n}function Gc(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function qc(e){return!!e&&"integerValue"in e}function Kc(e){return!!e&&"arrayValue"in e}function Yc(e){return!!e&&"nullValue"in e}function Xc(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Qc(e){return!!e&&"mapValue"in e}function Jc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return mc(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Jc(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Jc(e.arrayValue.values[r]);return n}return Object.assign({},e)}function $c(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function el(e){return"nullValue"in e?Zc:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Gc(Pc.empty(),hu.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Bs()}function tl(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Gc(Pc.empty(),hu.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?Lc:Bs()}function nl(e,t){var n=Vc(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function rl(e,t){var n=Vc(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var al=function(){function e(t){(0,p.Z)(this,e),this.value=t}return(0,v.Z)(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Qc(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jc(t)}},{key:"setAll",value:function(e){var t=this,n=lu.emptyPath(),r={},a=[];e.forEach((function(e,i){if(!n.isImmediateParentOf(i)){var o=t.getFieldsMap(n);t.applyChanges(o,r,a),r={},a=[],n=i.popLast()}e?r[i.lastSegment()]=Jc(e):a.push(i.lastSegment())}));var i=this.getFieldsMap(n);this.applyChanges(i,r,a)}},{key:"delete",value:function(e){var t=this.field(e.popLast());Qc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Bc(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Qc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){mc(t,(function(t,n){return e[t]=n}));var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;delete e[i]}}catch(o){a.e(o)}finally{a.f()}}},{key:"clone",value:function(){return new e(Jc(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function il(e){var t=[];return mc(e.fields,(function(e,n){var r=new lu([e]);if(Qc(n)){var a=il(n.mapValue).fields;if(0===a.length)t.push(r);else{var i,o=(0,C.Z)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)})),new Cc(t)}var ol=function(){function e(t,n,r,a,i,o,s){(0,p.Z)(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.createTime=i,this.data=o,this.documentState=s}return(0,v.Z)(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(ou.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=al.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=al.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=ou.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,ou.min(),ou.min(),ou.min(),al.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,a){return new e(t,1,n,ou.min(),r,a,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,ou.min(),ou.min(),al.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,ou.min(),ou.min(),al.empty(),2)}}]),e}(),sl=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.position=t,this.inclusive=n}));function ul(e,t,n){for(var r=0,a=0;a<e.position.length;a++){var i=t[a],o=e.position[a];if(r=i.field.isKeyField()?hu.comparator(hu.fromName(o.referenceValue),n.key):Vc(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function cl(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Bc(e.position[n],t.position[n]))return!1;return!0}var ll=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";(0,p.Z)(this,e),this.field=t,this.dir=n}));function hl(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var fl=(0,v.Z)((function e(){(0,p.Z)(this,e)})),dl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this)).field=e,i.op=r,i.value=a,i}return(0,v.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Vc(t,this.value)):null!==t&&zc(this.value)===zc(t)&&this.matchesComparison(Vc(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Bs()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Il(e,t,r):"array-contains"===t?new Tl(e,r):"in"===t?new El(e,r):"not-in"===t?new Nl(e,r):"array-contains-any"===t?new Dl(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new Sl(e,n):new Cl(e,n)}}]),n}(fl),pl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).filters=e,a.op=r,a.lt=null,a}return(0,v.Z)(n,[{key:"matches",value:function(e){return vl(this)?void 0===this.filters.find((function(t){return!t.matches(e)})):void 0!==this.filters.find((function(t){return t.matches(e)}))}},{key:"getFlattenedFilters",value:function(){return null!==this.lt||(this.lt=this.filters.reduce((function(e,t){return e.concat(t.getFlattenedFilters())}),[])),this.lt}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.ft((function(e){return e.isInequality()}));return null!==e?e.field:null}},{key:"ft",value:function(e){var t,n=(0,C.Z)(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(a){n.e(a)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(fl);function vl(e){return"and"===e.op}function gl(e){return"or"===e.op}function ml(e){return yl(e)&&vl(e)}function yl(e){var t,n=(0,C.Z)(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof pl)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function bl(e){if(e instanceof dl)return e.field.canonicalString()+e.op.toString()+Wc(e.value);if(ml(e))return e.filters.map((function(e){return bl(e)})).join(",");var t=e.filters.map((function(e){return bl(e)})).join(",");return"".concat(e.op,"(").concat(t,")")}function kl(e,t){return e instanceof dl?function(e,t){return t instanceof dl&&e.op===t.op&&e.field.isEqual(t.field)&&Bc(e.value,t.value)}(e,t):e instanceof pl?function(e,t){return t instanceof pl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((function(e,n,r){return e&&kl(n,t.filters[r])}),!0)}(e,t):void Bs()}function xl(e,t){var n=e.filters.concat(t);return pl.create(n,e.op)}function wl(e){return e instanceof dl?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Wc(e.value))}(e):e instanceof pl?function(e){return e.op.toString()+" {"+e.getFilters().map(wl).join(" ,")+"}"}(e):"Filter"}var Il=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this,e,r,a)).key=hu.fromName(a.referenceValue),i}return(0,v.Z)(n,[{key:"matches",value:function(e){var t=hu.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(dl),Sl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,"in",r)).keys=_l("in",r),a}return(0,v.Z)(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(dl),Cl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,"not-in",r)).keys=_l("not-in",r),a}return(0,v.Z)(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(dl);function _l(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return hu.fromName(e.referenceValue)}))}var Tl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"array-contains",r)}return(0,v.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return Kc(t)&&Uc(t.arrayValue,this.value)}}]),n}(dl),El=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"in",r)}return(0,v.Z)(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Uc(this.value.arrayValue,t)}}]),n}(dl),Nl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"not-in",r)}return(0,v.Z)(n,[{key:"matches",value:function(e){if(Uc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Uc(this.value.arrayValue,t)}}]),n}(dl),Dl=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"array-contains-any",r)}return(0,v.Z)(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!Kc(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Uc(t.value.arrayValue,e)}))}}]),n}(dl),Al=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;(0,p.Z)(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=s,this.dt=null}));function Rl(e){return new Al(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Ml(e){var t=Vs(e);if(null===t.dt){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return bl(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Zu(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Wc(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Wc(e)})).join(",")),t.dt=n}return t.dt}function Ol(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!hl(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!kl(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cl(e.startAt,t.startAt)&&cl(e.endAt,t.endAt)}function Fl(e){return hu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Pl(e,t){return e.filters.filter((function(e){return e instanceof dl&&e.field.isEqual(t)}))}function Ll(e,t,n){var r,a=Zc,i=!0,o=(0,C.Z)(Pl(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,u=Zc,c=!0;switch(s.op){case"<":case"<=":u=el(s.value);break;case"==":case"in":case">=":u=s.value;break;case">":u=s.value,c=!1;break;case"!=":case"not-in":u=Zc}nl({value:a,inclusive:i},{value:u,inclusive:c})<0&&(a=u,i=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];nl({value:a,inclusive:i},{value:h,inclusive:n.inclusive})<0&&(a=h,i=n.inclusive);break}return{value:a,inclusive:i}}function Zl(e,t,n){var r,a=Lc,i=!0,o=(0,C.Z)(Pl(e,t));try{for(o.s();!(r=o.n()).done;){var s=r.value,u=Lc,c=!0;switch(s.op){case">=":case">":u=tl(s.value),c=!1;break;case"==":case"in":case"<=":u=s.value;break;case"<":u=s.value,c=!1;break;case"!=":case"not-in":u=Lc}rl({value:a,inclusive:i},{value:u,inclusive:c})>0&&(a=u,i=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];rl({value:a,inclusive:i},{value:h,inclusive:n.inclusive})>0&&(a=h,i=n.inclusive);break}return{value:a,inclusive:i}}var zl=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;(0,p.Z)(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.wt=null,this._t=null,this.startAt,this.endAt}));function Bl(e,t,n,r,a,i,o,s){return new zl(e,t,n,r,a,i,o,s)}function Ul(e){return new zl(e)}function Vl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function jl(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Wl(e){var t,n=(0,C.Z)(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(a){n.e(a)}finally{n.f()}return null}function Hl(e){return null!==e.collectionGroup}function Gl(e){var t=Vs(e);if(null===t.wt){t.wt=[];var n=Wl(t),r=jl(t);if(null!==n&&null===r)n.isKeyField()||t.wt.push(new ll(n)),t.wt.push(new ll(lu.keyField(),"asc"));else{var a,i=!1,o=(0,C.Z)(t.explicitOrderBy);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.wt.push(s),s.field.isKeyField()&&(i=!0)}}catch(c){o.e(c)}finally{o.f()}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new ll(lu.keyField(),u))}}}return t.wt}function ql(e){var t=Vs(e);if(!t._t)if("F"===t.limitType)t._t=Rl(t.path,t.collectionGroup,Gl(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],a=(0,C.Z)(Gl(t));try{for(a.s();!(n=a.n()).done;){var i=n.value,o="desc"===i.dir?"asc":"desc";r.push(new ll(i.field,o))}}catch(c){a.e(c)}finally{a.f()}var s=t.endAt?new sl(t.endAt.position,t.endAt.inclusive):null,u=t.startAt?new sl(t.startAt.position,t.startAt.inclusive):null;t._t=Rl(t.path,t.collectionGroup,r,t.filters,t.limit,s,u)}return t._t}function Kl(e,t){t.getFirstInequalityField(),Wl(e);var n=e.filters.concat([t]);return new zl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Yl(e,t,n){return new zl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Xl(e,t){return Ol(ql(e),ql(t))&&e.limitType===t.limitType}function Ql(e){return"".concat(Ml(ql(e)),"|lt:").concat(e.limitType)}function Jl(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return wl(e)})).join(", "),"]")),Zu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return Wc(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return Wc(e)})).join(",")),"Target(".concat(t,")")}(ql(e)),"; limitType=").concat(e.limitType,")")}function $l(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):hu.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=(0,C.Z)(Gl(e));try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!a.field.isKeyField()&&null===t.data.field(a.field))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=(0,C.Z)(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=ul(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Gl(e),t))&&!(e.endAt&&!function(e,t,n){var r=ul(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Gl(e),t))}(e,t)}function eh(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function th(e){return function(t,n){var r,a=!1,i=(0,C.Z)(Gl(e));try{for(i.s();!(r=i.n()).done;){var o=r.value,s=nh(o,t,n);if(0!==s)return s;a=a||o.field.isKeyField()}}catch(u){i.e(u)}finally{i.f()}return 0}}function nh(e,t,n){var r=e.field.isKeyField()?hu.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Vc(r,a):Bs()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Bs()}}var rh=function(){function e(t,n){(0,p.Z)(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return(0,v.Z)(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=l(r.value,2),o=i[0],s=i[1];if(this.equalsFn(o,e))return s}}catch(u){a.e(u)}finally{a.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){mc(this.inner,(function(t,n){var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=l(r.value,2),o=i[0],s=i[1];e(o,s)}}catch(u){a.e(u)}finally{a.f()}}))}},{key:"isEmpty",value:function(){return yc(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),ah=new bc(hu.comparator);function ih(){return ah}var oh=new bc(hu.comparator);function sh(){for(var e=oh,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.insert(o.key,o)}return e}function uh(e){var t=oh;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function ch(){return hh()}function lh(){return hh()}function hh(){return new rh((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var fh=new bc(hu.comparator),dh=new wc(hu.comparator);function ph(){for(var e=dh,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.add(o)}return e}var vh=new wc(nu);function gh(){return vh}function mh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zu(t)?"-0":t}}function yh(e){return{integerValue:""+e}}function bh(e,t){return Bu(t)?yh(t):mh(e,t)}var kh=(0,v.Z)((function e(){(0,p.Z)(this,e),this._=void 0}));function xh(e,t,n){return e instanceof Sh?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Rc(t)&&(t=Mc(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ch?_h(e,t):e instanceof Th?Eh(e,t):function(e,t){var n=Ih(e,t),r=Dh(n)+Dh(e.gt);return qc(n)&&qc(e.gt)?yh(r):mh(e.serializer,r)}(e,t)}function wh(e,t,n){return e instanceof Ch?_h(e,t):e instanceof Th?Eh(e,t):n}function Ih(e,t){return e instanceof Nh?qc(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Sh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(kh),Ch=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).elements=e,r}return(0,v.Z)(n)}(kh);function _h(e,t){var n,r=Ah(t),a=(0,C.Z)(e.elements);try{var i=function(){var e=n.value;r.some((function(t){return Bc(t,e)}))||r.push(e)};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var Th=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).elements=e,r}return(0,v.Z)(n)}(kh);function Eh(e,t){var n,r=Ah(t),a=(0,C.Z)(e.elements);try{var i=function(){var e=n.value;r=r.filter((function(t){return!Bc(t,e)}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var Nh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).serializer=e,a.gt=r,a}return(0,v.Z)(n)}(kh);function Dh(e){return Dc(e.integerValue||e.doubleValue)}function Ah(e){return Kc(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Rh=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.field=t,this.transform=n}));var Mh=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.version=t,this.transformResults=n})),Oh=function(){function e(t,n){(0,p.Z)(this,e),this.updateTime=t,this.exists=n}return(0,v.Z)(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Fh(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Ph=(0,v.Z)((function e(){(0,p.Z)(this,e)}));function Lh(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yh(e.key,Oh.none()):new Vh(e.key,e.data,Oh.none());var n,r=e.data,a=al.empty(),i=new wc(lu.comparator),o=(0,C.Z)(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!i.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?a.delete(s):a.set(s,u),i=i.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new jh(e.key,a,new Cc(i.toArray()),Oh.none())}function Zh(e,t,n){e instanceof Vh?function(e,t,n){var r=e.value.clone(),a=Hh(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof jh?function(e,t,n){if(Fh(e.precondition,t)){var r=Hh(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Wh(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function zh(e,t,n,r){return e instanceof Vh?function(e,t,n,r){if(!Fh(e.precondition,t))return n;var a=e.value.clone(),i=Gh(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof jh?function(e,t,n,r){if(!Fh(e.precondition,t))return n;var a=Gh(e.fieldTransforms,r,t),i=t.data;return i.setAll(Wh(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Fh(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Bh(e,t){var n,r=null,a=(0,C.Z)(e.fieldTransforms);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=t.data.field(i.field),s=Ih(i.transform,o||null);null!=s&&(null===r&&(r=al.empty()),r.set(i.field,s))}}catch(u){a.e(u)}finally{a.f()}return r||null}function Uh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ru(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ch&&t instanceof Ch||e instanceof Th&&t instanceof Th?ru(e.elements,t.elements,Bc):e instanceof Nh&&t instanceof Nh?Bc(e.gt,t.gt):e instanceof Sh&&t instanceof Sh}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Vh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return(0,p.Z)(this,n),(i=t.call(this)).key=e,i.value=r,i.precondition=a,i.fieldTransforms=o,i.type=0,i}return(0,v.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ph),jh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(0,p.Z)(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=a,o.precondition=i,o.fieldTransforms=s,o.type=1,o}return(0,v.Z)(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Ph);function Wh(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Hh(e,t,n){var r=new Map;Us(e.length===n.length);for(var a=0;a<n.length;a++){var i=e[a],o=i.transform,s=t.data.field(i.field);r.set(i.field,wh(o,s,n[a]))}return r}function Gh(e,t,n){var r,a=new Map,i=(0,C.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);a.set(o.field,xh(s,u,t))}}catch(c){i.e(c)}finally{i.f()}return a}var qh,Kh,Yh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=2,a.fieldTransforms=[],a}return(0,v.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ph),Xh=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=3,a.fieldTransforms=[],a}return(0,v.Z)(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ph),Qh=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}return(0,v.Z)(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var a=this.mutations[r];a.key.isEqual(e.key)&&Zh(a,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=(0,C.Z)(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.key.isEqual(e.key)&&(t=zh(a,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var i,o=(0,C.Z)(this.mutations);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.key.isEqual(e.key)&&(t=zh(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=lh();return this.mutations.forEach((function(a){var i=e.get(a.key),o=i.overlayedDocument,s=n.applyToLocalView(o,i.mutatedFields),u=Lh(o,s=t.has(a.key)?null:s);null!==u&&r.set(a.key,u),o.isValidDocument()||o.convertToNoDocument(ou.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),ph())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&ru(this.mutations,e.mutations,(function(e,t){return Uh(e,t)}))&&ru(this.baseMutations,e.baseMutations,(function(e,t){return Uh(e,t)}))}}]),e}(),Jh=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}return(0,v.Z)(e,null,[{key:"from",value:function(t,n,r){Us(t.mutations.length===r.length);for(var a=fh,i=t.mutations,o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new e(t,n,r,a)}}]),e}(),$h=function(){function e(t,n){(0,p.Z)(this,e),this.largestBatchId=t,this.mutation=n}return(0,v.Z)(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),ef=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.count=t,this.unchangedNames=n}));function tf(e){switch(e){default:return Bs();case js.CANCELLED:case js.UNKNOWN:case js.DEADLINE_EXCEEDED:case js.RESOURCE_EXHAUSTED:case js.INTERNAL:case js.UNAVAILABLE:case js.UNAUTHENTICATED:return!1;case js.INVALID_ARGUMENT:case js.NOT_FOUND:case js.ALREADY_EXISTS:case js.PERMISSION_DENIED:case js.FAILED_PRECONDITION:case js.ABORTED:case js.OUT_OF_RANGE:case js.UNIMPLEMENTED:case js.DATA_LOSS:return!0}}function nf(e){if(void 0===e)return Ls("GRPC error has no .code"),js.UNKNOWN;switch(e){case qh.OK:return js.OK;case qh.CANCELLED:return js.CANCELLED;case qh.UNKNOWN:return js.UNKNOWN;case qh.DEADLINE_EXCEEDED:return js.DEADLINE_EXCEEDED;case qh.RESOURCE_EXHAUSTED:return js.RESOURCE_EXHAUSTED;case qh.INTERNAL:return js.INTERNAL;case qh.UNAVAILABLE:return js.UNAVAILABLE;case qh.UNAUTHENTICATED:return js.UNAUTHENTICATED;case qh.INVALID_ARGUMENT:return js.INVALID_ARGUMENT;case qh.NOT_FOUND:return js.NOT_FOUND;case qh.ALREADY_EXISTS:return js.ALREADY_EXISTS;case qh.PERMISSION_DENIED:return js.PERMISSION_DENIED;case qh.FAILED_PRECONDITION:return js.FAILED_PRECONDITION;case qh.ABORTED:return js.ABORTED;case qh.OUT_OF_RANGE:return js.OUT_OF_RANGE;case qh.UNIMPLEMENTED:return js.UNIMPLEMENTED;case qh.DATA_LOSS:return js.DATA_LOSS;default:return Bs()}}(Kh=qh||(qh={}))[Kh.OK=0]="OK",Kh[Kh.CANCELLED=1]="CANCELLED",Kh[Kh.UNKNOWN=2]="UNKNOWN",Kh[Kh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kh[Kh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kh[Kh.NOT_FOUND=5]="NOT_FOUND",Kh[Kh.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kh[Kh.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kh[Kh.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kh[Kh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kh[Kh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kh[Kh.ABORTED=10]="ABORTED",Kh[Kh.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kh[Kh.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kh[Kh.INTERNAL=13]="INTERNAL",Kh[Kh.UNAVAILABLE=14]="UNAVAILABLE",Kh[Kh.DATA_LOSS=15]="DATA_LOSS";var rf=function(){function e(){(0,p.Z)(this,e),this.onExistenceFilterMismatchCallbacks=new Map}return(0,v.Z)(e,[{key:"onExistenceFilterMismatch",value:function(e){var t=this,n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),function(){return t.onExistenceFilterMismatchCallbacks.delete(n)}}},{key:"notifyOnExistenceFilterMismatch",value:function(e){this.onExistenceFilterMismatchCallbacks.forEach((function(t){return t(e)}))}}],[{key:"instance",get:function(){return af}},{key:"getOrCreateInstance",value:function(){return null===af&&(af=new e),af}}]),e}(),af=null;function of(){return new TextEncoder}var sf=new Ds([4294967295,4294967295],0);function uf(e){var t=of().encode(e),n=new Ns;return n.update(t),new Uint8Array(n.digest())}function cf(e){var t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Ds([n,r],0),new Ds([a,i],0)]}var lf=function(){function e(t,n,r){if((0,p.Z)(this,e),this.bitmap=t,this.padding=n,this.hashCount=r,n<0||n>=8)throw new hf("Invalid padding: ".concat(n));if(r<0)throw new hf("Invalid hash count: ".concat(r));if(t.length>0&&0===this.hashCount)throw new hf("Invalid hash count: ".concat(r));if(0===t.length&&0!==n)throw new hf("Invalid padding when bitmap length is 0: ".concat(n));this.It=8*t.length-n,this.Tt=Ds.fromNumber(this.It)}return(0,v.Z)(e,[{key:"Et",value:function(e,t,n){var r=e.add(t.multiply(Ds.fromNumber(n)));return 1===r.compare(sf)&&(r=new Ds([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}},{key:"At",value:function(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}},{key:"vt",value:function(e){if(0===this.It)return!1;for(var t=l(cf(uf(e)),2),n=t[0],r=t[1],a=0;a<this.hashCount;a++){var i=this.Et(n,r,a);if(!this.At(i))return!1}return!0}},{key:"insert",value:function(e){if(0!==this.It)for(var t=l(cf(uf(e)),2),n=t[0],r=t[1],a=0;a<this.hashCount;a++){var i=this.Et(n,r,a);this.Rt(i)}}},{key:"Rt",value:function(e){var t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}],[{key:"create",value:function(t,n,r){var a=t%8==0?0:8-t%8,i=new e(new Uint8Array(Math.ceil(t/8)),a,n);return r.forEach((function(e){return i.insert(e)})),i}}]),e}(),hf=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).name="BloomFilterError",e}return(0,v.Z)(n)}(w(Error)),ff=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}return(0,v.Z)(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var a=new Map;return a.set(t,df.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(ou.min(),a,new bc(nu),ih(),ph())}}]),e}(),df=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}return(0,v.Z)(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,ph(),ph(),ph())}}]),e}(),pf=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.Pt=t,this.removedTargetIds=n,this.key=r,this.bt=a})),vf=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.targetId=t,this.Vt=n})),gf=(0,v.Z)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tc.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,p.Z)(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a})),mf=function(){function e(){(0,p.Z)(this,e),this.St=0,this.Dt=kf(),this.Ct=Tc.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}return(0,v.Z)(e,[{key:"current",get:function(){return this.xt}},{key:"resumeToken",get:function(){return this.Ct}},{key:"kt",get:function(){return 0!==this.St}},{key:"Mt",get:function(){return this.Nt}},{key:"$t",value:function(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}},{key:"Ot",value:function(){var e=ph(),t=ph(),n=ph();return this.Dt.forEach((function(r,a){switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Bs()}})),new df(this.Ct,this.xt,e,t,n)}},{key:"Ft",value:function(){this.Nt=!1,this.Dt=kf()}},{key:"Bt",value:function(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}},{key:"Lt",value:function(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}},{key:"qt",value:function(){this.St+=1}},{key:"Ut",value:function(){this.St-=1}},{key:"Kt",value:function(){this.Nt=!0,this.xt=!0}}]),e}(),yf=function(){function e(t){(0,p.Z)(this,e),this.Gt=t,this.Qt=new Map,this.jt=ih(),this.zt=bf(),this.Wt=new bc(nu)}return(0,v.Z)(e,[{key:"Ht",value:function(e){var t,n=(0,C.Z)(e.Pt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.bt&&e.bt.isFoundDocument()?this.Jt(r,e.bt):this.Yt(r,e.key,e.bt)}}catch(s){n.e(s)}finally{n.f()}var a,i=(0,C.Z)(e.removedTargetIds);try{for(i.s();!(a=i.n()).done;){var o=a.value;this.Yt(o,e.key,e.bt)}}catch(s){i.e(s)}finally{i.f()}}},{key:"Xt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Zt(n);switch(e.state){case 0:t.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||t.removeTarget(n);break;case 3:t.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:t.te(n)&&(t.ee(n),r.$t(e.resumeToken));break;default:Bs()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((function(e,r){n.te(r)&&t(r)}))}},{key:"ne",value:function(e){var t,n=e.targetId,r=e.Vt.count,a=this.se(n);if(a){var i=a.target;if(Fl(i))if(0===r){var o=new hu(i.path);this.Yt(n,o,ol.newNoDocument(o,ou.min()))}else Us(1===r);else{var s=this.ie(n);if(s!==r){var u=this.re(e,s);if(0!==u){this.ee(n);var c=2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,c)}null===(t=rf.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,a,i,o,s,u,c={localCacheCount:t,existenceFilterCount:n.count},l=n.unchangedNames;return l&&(c.bloomFilter={applied:0===e,hashCount:null!==(r=null==l?void 0:l.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(i=null===(a=null==l?void 0:l.bits)||void 0===a?void 0:a.bitmap)||void 0===i?void 0:i.length)&&void 0!==o?o:0,padding:null!==(u=null===(s=null==l?void 0:l.bits)||void 0===s?void 0:s.padding)&&void 0!==u?u:0}),c}(u,s,e.Vt))}}}}},{key:"re",value:function(e,t){var n=e.Vt,r=n.unchangedNames,a=n.count;if(!r||!r.bits)return 1;var i,o,s=r.bits,u=s.bitmap,c=void 0===u?"":u,l=s.padding,h=void 0===l?0:l,f=r.hashCount,d=void 0===f?0:f;try{i=Ac(c).toUint8Array()}catch(e){if(e instanceof _c)return Zs("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{o=new lf(i,h,d)}catch(e){return Zs(e instanceof hf?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===o.It?1:a!==t-this.oe(e.targetId,o)?2:0}},{key:"oe",value:function(e,t){var n=this,r=this.Gt.getRemoteKeysForTarget(e),a=0;return r.forEach((function(r){var i=n.Gt.ue(),o="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(r.path.canonicalString());t.vt(o)||(n.Yt(e,r,null),a++)})),a}},{key:"ce",value:function(e){var t=this,n=new Map;this.Qt.forEach((function(r,a){var i=t.se(a);if(i){if(r.current&&Fl(i.target)){var o=new hu(i.target.path);null!==t.jt.get(o)||t.ae(a,o)||t.Yt(a,o,ol.newNoDocument(o,e))}r.Mt&&(n.set(a,r.Ot()),r.Ft())}}));var r=ph();this.zt.forEach((function(e,n){var a=!0;n.forEachWhile((function(e){var n=t.se(e);return!n||"TargetPurposeLimboResolution"===n.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.jt.forEach((function(t,n){return n.setReadTime(e)}));var a=new ff(e,n,this.Wt,this.jt,r);return this.jt=ih(),this.zt=bf(),this.Wt=new bc(nu),a}},{key:"Jt",value:function(e,t){if(this.te(e)){var n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}}},{key:"Yt",value:function(e,t,n){if(this.te(e)){var r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Qt.delete(e)}},{key:"ie",value:function(e){var t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"qt",value:function(e){this.Zt(e).qt()}},{key:"Zt",value:function(e){var t=this.Qt.get(e);return t||(t=new mf,this.Qt.set(e,t)),t}},{key:"he",value:function(e){var t=this.zt.get(e);return t||(t=new wc(nu),this.zt=this.zt.insert(e,t)),t}},{key:"te",value:function(e){var t=null!==this.se(e);return t||Ps("WatchChangeAggregator","Detected inactive target",e),t}},{key:"se",value:function(e){var t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}},{key:"ee",value:function(e){var t=this;this.Qt.set(e,new mf),this.Gt.getRemoteKeysForTarget(e).forEach((function(n){t.Yt(e,n,null)}))}},{key:"ae",value:function(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}]),e}();function bf(){return new bc(hu.comparator)}function kf(){return new bc(hu.comparator)}var xf={asc:"ASCENDING",desc:"DESCENDING"},wf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},If={and:"AND",or:"OR"},Sf=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.databaseId=t,this.useProto3Json=n}));function Cf(e,t){return e.useProto3Json||Zu(t)?t:{value:t}}function _f(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Tf(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ef(e,t){return _f(e,t.toTimestamp())}function Nf(e){return Us(!!e),ou.fromTimestamp(function(e){var t=Nc(e);return new iu(t.seconds,t.nanos)}(e))}function Df(e,t){return function(e){return new uu(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Af(e){var t=uu.fromString(e);return Us(ed(t)),t}function Rf(e,t){return Df(e.databaseId,t.path)}function Mf(e,t){var n=Af(t);if(n.get(1)!==e.databaseId.projectId)throw new Ws(js.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ws(js.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new hu(Lf(n))}function Of(e,t){return Df(e.databaseId,t)}function Ff(e){var t=Af(e);return 4===t.length?uu.emptyPath():Lf(t)}function Pf(e){return new uu(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Lf(e){return Us(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Zf(e,t,n){return{name:Rf(e,t),fields:n.value.mapValue.fields}}function zf(e,t,n){var r=Mf(e,t.name),a=Nf(t.updateTime),i=t.createTime?Nf(t.createTime):ou.min(),o=new al({mapValue:{fields:t.fields}}),s=ol.newFoundDocument(r,a,i,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Bf(e,t){return"found"in t?function(e,t){Us(!!t.found),t.found.name,t.found.updateTime;var n=Mf(e,t.found.name),r=Nf(t.found.updateTime),a=t.found.createTime?Nf(t.found.createTime):ou.min(),i=new al({mapValue:{fields:t.found.fields}});return ol.newFoundDocument(n,r,a,i)}(e,t):"missing"in t?function(e,t){Us(!!t.missing),Us(!!t.readTime);var n=Mf(e,t.missing),r=Nf(t.readTime);return ol.newNoDocument(n,r)}(e,t):Bs()}function Uf(e,t){var n;if(t instanceof Vh)n={update:Zf(e,t.key,t.value)};else if(t instanceof Yh)n={delete:Rf(e,t.key)};else if(t instanceof jh)n={update:Zf(e,t.key,t.data),updateMask:$f(t.fieldMask)};else{if(!(t instanceof Xh))return Bs();n={verify:Rf(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Sh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ch)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Th)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Nh)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw Bs()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ef(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Bs()}(e,t.precondition)),n}function Vf(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Oh.updateTime(Nf(e.updateTime)):void 0!==e.exists?Oh.exists(e.exists):Oh.none()}(t.currentDocument):Oh.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)Us("REQUEST_TIME"===t.setToServerValue),n=new Sh;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Ch(r)}else if("removeAllFromArray"in t){var a=t.removeAllFromArray.values||[];n=new Th(a)}else"increment"in t?n=new Nh(e,t.increment):Bs();var i=lu.fromServerFormat(t.fieldPath);return new Rh(i,n)}(e,t)})):[];if(t.update){t.update.name;var a=Mf(e,t.update.name),i=new al({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Cc(t.map((function(e){return lu.fromServerFormat(e)})))}(t.updateMask);return new jh(a,i,o,n,r)}return new Vh(a,i,n,r)}if(t.delete){var s=Mf(e,t.delete);return new Yh(s,n)}if(t.verify){var u=Mf(e,t.verify);return new Xh(u,n)}return Bs()}function jf(e,t){return{documents:[Of(e,t.path)]}}function Wf(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Of(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Of(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var a=function(e){if(0!==e.length)return Jf(pl.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);var i=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:Xf(e.field),direction:qf(e.dir)}}(e)}))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);var o,s=Cf(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Hf(e){var t=Ff(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,a=null;if(r>0){Us(1===r);var i=n.from[0];i.allDescendants?a=i.collectionId:t=t.child(i.collectionId)}var o=[];n.where&&(o=function(e){var t=Gf(e);return t instanceof pl&&ml(t)?t.getFilters():[t]}(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new ll(Qf(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var u=null;n.limit&&(u=function(e){var t;return Zu(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new sl(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new sl(n,t)}(n.endAt)),Bl(t,a,s,o,u,"F",c,l)}function Gf(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Qf(e.unaryFilter.field);return dl.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Qf(e.unaryFilter.field);return dl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qf(e.unaryFilter.field);return dl.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var a=Qf(e.unaryFilter.field);return dl.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Bs()}}(e):void 0!==e.fieldFilter?function(e){return dl.create(Qf(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Bs()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return pl.create(e.compositeFilter.filters.map((function(e){return Gf(e)})),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Bs()}}(e.compositeFilter.op))}(e):Bs()}function qf(e){return xf[e]}function Kf(e){return wf[e]}function Yf(e){return If[e]}function Xf(e){return{fieldPath:e.canonicalString()}}function Qf(e){return lu.fromServerFormat(e.fieldPath)}function Jf(e){return e instanceof dl?function(e){if("=="===e.op){if(Xc(e.value))return{unaryFilter:{field:Xf(e.field),op:"IS_NAN"}};if(Yc(e.value))return{unaryFilter:{field:Xf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Xc(e.value))return{unaryFilter:{field:Xf(e.field),op:"IS_NOT_NAN"}};if(Yc(e.value))return{unaryFilter:{field:Xf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xf(e.field),op:Kf(e.op),value:e.value}}}(e):e instanceof pl?function(e){var t=e.getFilters().map((function(e){return Jf(e)}));return 1===t.length?t[0]:{compositeFilter:{op:Yf(e.op),filters:t}}}(e):Bs()}function $f(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function ed(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var td=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ou.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ou.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Tc.EMPTY_BYTE_STRING,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;(0,p.Z)(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=u}return(0,v.Z)(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}},{key:"withExpectedCount",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}]),e}(),nd=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.fe=t}));function rd(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ad(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Rf(e,t.key),fields:t.data.value.mapValue.fields,updateTime:_f(e,t.version.toTimestamp()),createTime:_f(e,t.createTime.toTimestamp())}}(e.fe,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:id(t.version)};else{if(!t.isUnknownDocument())return Bs();r.unknownDocument={path:n.path.toArray(),version:id(t.version)}}return r}function ad(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function id(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function od(e){var t=new iu(e.seconds,e.nanoseconds);return ou.fromTimestamp(t)}function sd(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Vf(e.fe,t)})),r=0;r<t.mutations.length-1;++r){var a=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var i=t.mutations[r+1];a.updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Vf(e.fe,t)})),s=iu.fromMillis(t.localWriteTimeMs);return new Qh(t.batchId,s,n,o)}function ud(e){var t,n,r=od(e.readTime),a=void 0!==e.lastLimboFreeSnapshotVersion?od(e.lastLimboFreeSnapshotVersion):ou.min();return void 0!==e.query.documents?(Us(1===(n=e.query).documents.length),t=ql(Ul(Ff(n.documents[0])))):t=function(e){return ql(Hf(e))}(e.query),new td(t,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,a,Tc.fromBase64String(e.resumeToken))}function cd(e,t){var n,r=id(t.snapshotVersion),a=id(t.lastLimboFreeSnapshotVersion);n=Fl(t.target)?jf(e.fe,t.target):Wf(e.fe,t.target);var i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ml(t.target),readTime:r,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:a,query:n}}function ld(e){var t=Hf({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Yl(t,t.limit,"L"):t}function hd(e,t){return new $h(t.largestBatchId,Vf(e.fe,t.overlayMutation))}function fd(e,t){var n=t.path.lastSegment();return[e,Uu(t.path.popLast()),n]}function dd(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:id(r.readTime),documentKey:Uu(r.documentKey.path),largestBatchId:r.largestBatchId}}var pd=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"getBundleMetadata",value:function(e,t){return vd(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:od(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return vd(e).put({bundleId:(n=t).id,createTime:id(Nf(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return gd(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:ld(t.bundledQuery),readTime:od(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return gd(e).put(function(e){return{name:e.name,readTime:id(Nf(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function vd(e){return vc(e,"bundles")}function gd(e){return vc(e,"namedQueries")}var md=function(){function e(t,n){(0,p.Z)(this,e),this.serializer=t,this.userId=n}return(0,v.Z)(e,[{key:"getOverlay",value:function(e,t){var n=this;return yd(e).get(fd(this.userId,t)).next((function(e){return e?hd(n.serializer,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=ch();return Cu.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,a=[];return n.forEach((function(n,i){var o=new $h(t,i);a.push(r.we(e,o))})),Cu.waitFor(a)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,a=new Set;t.forEach((function(e){return a.add(Uu(e.getCollectionPath()))}));var i=[];return a.forEach((function(t){var a=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);i.push(yd(e).J("collectionPathOverlayIndex",a))})),Cu.waitFor(i)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,a=ch(),i=Uu(t),o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return yd(e).j("collectionPathOverlayIndex",o).next((function(e){var t,n=(0,C.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=hd(r.serializer,i);a.set(o.getKey(),o)}}catch(s){n.e(s)}finally{n.f()}return a}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var a,i=this,o=ch(),s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return yd(e).X({index:"collectionGroupOverlayIndex",range:s},(function(e,t,n){var s=hd(i.serializer,t);o.size()<r||s.largestBatchId===a?(o.set(s.getKey(),s),a=s.largestBatchId):n.done()})).next((function(){return o}))}},{key:"we",value:function(e,t){return yd(e).put(function(e,t,n){var r=l(fd(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Uf(e.fe,n.mutation)}}(this.serializer,this.userId,t))}}],[{key:"de",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function yd(e){return vc(e,"documentOverlays")}var bd=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"_e",value:function(e,t){this.me(e,t),t.ge()}},{key:"me",value:function(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Dc(e.integerValue));else if("doubleValue"in e){var n=Dc(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),zu(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie("".concat(r.seconds||"")),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Ac(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){var a=e.geoPointValue;this.ye(t,45),t.pe(a.latitude||0),t.pe(a.longitude||0)}else"mapValue"in e?$c(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Bs()}},{key:"Te",value:function(e,t){this.ye(t,25),this.be(e,t)}},{key:"be",value:function(e,t){t.Ie(e)}},{key:"Re",value:function(e,t){var n=e.fields||{};this.ye(t,55);for(var r=0,a=Object.keys(n);r<a.length;r++){var i=a[r];this.Te(i,t),this.me(n[i],t)}}},{key:"Pe",value:function(e,t){var n=e.values||[];this.ye(t,50);var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.me(i,t)}}catch(o){a.e(o)}finally{a.f()}}},{key:"ve",value:function(e,t){var n=this;this.ye(t,37),hu.fromName(e).path.forEach((function(e){n.ye(t,60),n.be(e,t)}))}},{key:"ye",value:function(e,t){e.pe(t)}},{key:"Ee",value:function(e){e.pe(2)}}]),e}();function kd(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function xd(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=kd(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}bd.Ve=new bd;var wd=function(){function e(){(0,p.Z)(this,e),this.buffer=new Uint8Array(1024),this.position=0}return(0,v.Z)(e,[{key:"Se",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.De(n.value),n=t.next();this.Ce()}},{key:"xe",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ne(n.value),n=t.next();this.ke()}},{key:"Me",value:function(e){var t,n=(0,C.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.charCodeAt(0);if(a<128)this.De(a);else if(a<2048)this.De(960|a>>>6),this.De(128|63&a);else if(r<"\ud800"||"\udbff"<r)this.De(480|a>>>12),this.De(128|63&a>>>6),this.De(128|63&a);else{var i=r.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}}catch(o){n.e(o)}finally{n.f()}this.Ce()}},{key:"$e",value:function(e){var t,n=(0,C.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.charCodeAt(0);if(a<128)this.Ne(a);else if(a<2048)this.Ne(960|a>>>6),this.Ne(128|63&a);else if(r<"\ud800"||"\udbff"<r)this.Ne(480|a>>>12),this.Ne(128|63&a>>>6),this.Ne(128|63&a);else{var i=r.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}}catch(o){n.e(o)}finally{n.f()}this.ke()}},{key:"Oe",value:function(e){var t=this.Fe(e),n=xd(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"Le",value:function(e){var t=this.Fe(e),n=xd(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"qe",value:function(){this.Ue(255),this.Ue(255)}},{key:"Ke",value:function(){this.Ge(255),this.Ge(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Qe",value:function(){return this.buffer.slice(0,this.position)}},{key:"Fe",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"De",value:function(e){var t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}},{key:"Ne",value:function(e){var t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}},{key:"Ce",value:function(){this.Ue(0),this.Ue(1)}},{key:"ke",value:function(){this.Ge(0),this.Ge(1)}},{key:"Ue",value:function(e){this.Be(1),this.buffer[this.position++]=e}},{key:"Ge",value:function(e){this.Be(1),this.buffer[this.position++]=~e}},{key:"Be",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),Id=function(){function e(t){(0,p.Z)(this,e),this.je=t}return(0,v.Z)(e,[{key:"Ae",value:function(e){this.je.Se(e)}},{key:"Ie",value:function(e){this.je.Me(e)}},{key:"pe",value:function(e){this.je.Oe(e)}},{key:"ge",value:function(){this.je.qe()}}]),e}(),Sd=function(){function e(t){(0,p.Z)(this,e),this.je=t}return(0,v.Z)(e,[{key:"Ae",value:function(e){this.je.xe(e)}},{key:"Ie",value:function(e){this.je.$e(e)}},{key:"pe",value:function(e){this.je.Le(e)}},{key:"ge",value:function(){this.je.Ke()}}]),e}(),Cd=function(){function e(){(0,p.Z)(this,e),this.je=new wd,this.ze=new Id(this.je),this.We=new Sd(this.je)}return(0,v.Z)(e,[{key:"seed",value:function(e){this.je.seed(e)}},{key:"He",value:function(e){return 0===e?this.ze:this.We}},{key:"Qe",value:function(){return this.je.Qe()}},{key:"reset",value:function(){this.je.reset()}}]),e}(),_d=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=a}return(0,v.Z)(e,[{key:"Je",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function Td(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=Ed(e.arrayValue,t.arrayValue))?n:0!==(n=Ed(e.directionalValue,t.directionalValue))?n:hu.comparator(e.documentKey,t.documentKey)}function Ed(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var Nd=function(){function e(t){(0,p.Z)(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ye=t.orderBy,this.Xe=[];var n,r=(0,C.Z)(t.filters);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.isInequality()?this.Ze=a:this.Xe.push(a)}}catch(i){r.e(i)}finally{r.f()}}return(0,v.Z)(e,[{key:"tn",value:function(e){Us(e.collectionGroup===this.collectionId);var t=du(e);if(void 0!==t&&!this.en(t))return!1;for(var n=pu(e),r=new Set,a=0,i=0;a<n.length&&this.en(n[a]);++a)r=r.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){var o=n[a];if(!this.nn(this.Ze,o)||!this.sn(this.Ye[i++],o))return!1}++a}for(;a<n.length;++a){var s=n[a];if(i>=this.Ye.length||!this.sn(this.Ye[i++],s))return!1}return!0}},{key:"en",value:function(e){var t,n=(0,C.Z)(this.Xe);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.nn(r,e))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}},{key:"nn",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"sn",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function Dd(e){var t,n;if(Us(e instanceof dl||e instanceof pl),e instanceof dl){if(e instanceof El){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((function(t){return dl.create(e.field,"==",t)})))||[];return pl.create(r,"or")}return e}var a=e.filters.map((function(e){return Dd(e)}));return pl.create(a,e.op)}function Ad(e){if(0===e.getFilters().length)return[];var t=Fd(Dd(e));return Us(Od(t)),Rd(t)||Md(t)?[t]:t.getFilters()}function Rd(e){return e instanceof dl}function Md(e){return e instanceof pl&&ml(e)}function Od(e){return Rd(e)||Md(e)||function(e){if(e instanceof pl&&gl(e)){var t,n=(0,C.Z)(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!Rd(r)&&!Md(r))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1}(e)}function Fd(e){if(Us(e instanceof dl||e instanceof pl),e instanceof dl)return e;if(1===e.filters.length)return Fd(e.filters[0]);var t=e.filters.map((function(e){return Fd(e)})),n=pl.create(t,e.op);return Od(n=Zd(n))?n:(Us(n instanceof pl),Us(vl(n)),Us(n.filters.length>1),n.filters.reduce((function(e,t){return Pd(e,t)})))}function Pd(e,t){var n;return Us(e instanceof dl||e instanceof pl),Us(t instanceof dl||t instanceof pl),n=e instanceof dl?t instanceof dl?function(e,t){return pl.create([e,t],"and")}(e,t):Ld(e,t):t instanceof dl?Ld(t,e):function(e,t){if(Us(e.filters.length>0&&t.filters.length>0),vl(e)&&vl(t))return xl(e,t.getFilters());var n=gl(e)?e:t,r=gl(e)?t:e,a=n.filters.map((function(e){return Pd(e,r)}));return pl.create(a,"or")}(e,t),Zd(n)}function Ld(e,t){if(vl(t))return xl(t,e.getFilters());var n=t.filters.map((function(t){return Pd(e,t)}));return pl.create(n,"or")}function Zd(e){if(Us(e instanceof dl||e instanceof pl),e instanceof dl)return e;var t=e.getFilters();if(1===t.length)return Zd(t[0]);if(yl(e))return e;var n=t.map((function(e){return Zd(e)})),r=[];return n.forEach((function(t){t instanceof dl?r.push(t):t instanceof pl&&(t.op===e.op?r.push.apply(r,d(t.filters)):r.push(t))})),1===r.length?r[0]:pl.create(r,e.op)}var zd=function(){function e(){(0,p.Z)(this,e),this.rn=new Bd}return(0,v.Z)(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.rn.add(t),Cu.resolve()}},{key:"getCollectionParents",value:function(e,t){return Cu.resolve(this.rn.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Cu.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Cu.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Cu.resolve(null)}},{key:"getIndexType",value:function(e,t){return Cu.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Cu.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Cu.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Cu.resolve(bu.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Cu.resolve(bu.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Cu.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Cu.resolve()}}]),e}(),Bd=function(){function e(){(0,p.Z)(this,e),this.index={}}return(0,v.Z)(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new wc(uu.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new wc(uu.comparator)).toArray()}}]),e}(),Ud=new Uint8Array(0),Vd=function(){function e(t,n){(0,p.Z)(this,e),this.user=t,this.databaseId=n,this.on=new Bd,this.un=new rh((function(e){return Ml(e)}),(function(e,t){return Ol(e,t)})),this.uid=t.uid||""}return(0,v.Z)(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.on.has(t)){var r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((function(){n.on.add(t)}));var i={collectionId:r,parent:Uu(a)};return jd(e).put(i)}return Cu.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[au(t),""],!1,!0);return jd(e).j(r).next((function(e){var r,a=(0,C.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i.collectionId!==t)break;n.push(Wu(i.parent))}}catch(o){a.e(o)}finally{a.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=Hd(e),a=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete a.indexId;var i=r.add(a);if(t.indexState){var o=Gd(e);return i.next((function(e){o.put(dd(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=Hd(e),r=Gd(e),a=Wd(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=Wd(e),a=!0,i=new Map;return Cu.forEach(this.cn(t),(function(t){return n.an(e,t).next((function(e){a&&(a=!!e),i.set(t,e)}))})).next((function(){if(a){var e=ph(),o=[];return Cu.forEach(i,(function(a,i){var s;Ps("IndexedDbIndexManager","Using index ".concat((s=a,"id=".concat(s.indexId,"|cg=").concat(s.collectionGroup,"|f=").concat(s.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(Ml(t)));var u=function(e,t){var n=du(t);if(void 0===n)return null;var r,a=(0,C.Z)(Pl(e,n.fieldPath));try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}}}catch(o){a.e(o)}finally{a.f()}return null}(i,a),c=function(e,t){var n,r=new Map,a=(0,C.Z)(pu(t));try{for(a.s();!(n=a.n()).done;){var i,o=n.value,s=(0,C.Z)(Pl(e,o.fieldPath));try{for(s.s();!(i=s.n()).done;){var u=i.value;switch(u.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),u.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),u.value),Array.from(r.values())}}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}return null}(i,a),l=function(e,t){var n,r=[],a=!0,i=(0,C.Z)(pu(t));try{for(i.s();!(n=i.n()).done;){var o=n.value,s=0===o.kind?Ll(e,o.fieldPath,e.startAt):Zl(e,o.fieldPath,e.startAt);r.push(s.value),a&&(a=s.inclusive)}}catch(u){i.e(u)}finally{i.f()}return new sl(r,a)}(i,a),h=function(e,t){var n,r=[],a=!0,i=(0,C.Z)(pu(t));try{for(i.s();!(n=i.n()).done;){var o=n.value,s=0===o.kind?Zl(e,o.fieldPath,e.endAt):Ll(e,o.fieldPath,e.endAt);r.push(s.value),a&&(a=s.inclusive)}}catch(u){i.e(u)}finally{i.f()}return new sl(r,a)}(i,a),f=n.hn(a,i,l),d=n.hn(a,i,h),p=n.ln(a,i,c),v=n.fn(a.indexId,u,f,l.inclusive,d,h.inclusive,p);return Cu.forEach(v,(function(n){return r.H(n,t.limit).next((function(t){t.forEach((function(t){var n=hu.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return Cu.resolve(null)}))}},{key:"cn",value:function(e){var t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Ad(pl.create(e.filters,"and")).map((function(t){return Rl(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)})),this.un.set(e,t),t)}},{key:"fn",value:function(e,t,n,r,a,i,o){for(var s=this,u=(null!=t?t.length:1)*Math.max(n.length,a.length),c=u/(null!=t?t.length:1),l=[],h=function(){var u=t?s.dn(t[f/c]):Ud,h=s.wn(e,u,n[f%c],r),p=s._n(e,u,a[f%c],i),v=o.map((function(t){return s.wn(e,u,t,!0)}));l.push.apply(l,d(s.createRange(h,p,v)))},f=0;f<u;++f)h();return l}},{key:"wn",value:function(e,t,n,r){var a=new _d(e,hu.empty(),t,n);return r?a:a.Je()}},{key:"_n",value:function(e,t,n,r){var a=new _d(e,hu.empty(),t,n);return r?a.Je():a}},{key:"an",value:function(e,t){var n=new Nd(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,a=(0,C.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n.tn(i)&&(!r||i.fields.length>r.fields.length)&&(r=i)}}catch(o){a.e(o)}finally{a.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2,a=this.cn(t);return Cu.forEach(a,(function(t){return n.an(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new wc(lu.comparator),r=!1,a=(0,C.Z)(e.filters);try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s=(0,C.Z)(o.getFlattenedFilters());try{for(s.s();!(i=s.n()).done;){var u=i.value;u.field.isKeyField()||("array-contains"===u.op||"array-contains-any"===u.op?r=!0:n=n.add(u.field))}}catch(f){s.e(f)}finally{s.f()}}}catch(f){a.e(f)}finally{a.f()}var c,l=(0,C.Z)(e.orderBy);try{for(l.s();!(c=l.n()).done;){var h=c.value;h.field.isKeyField()||(n=n.add(h.field))}}catch(f){l.e(f)}finally{l.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return function(e){return null!==e.limit}(t)&&a.length>1&&2===r?1:r}))}},{key:"mn",value:function(e,t){var n,r=new Cd,a=(0,C.Z)(pu(e));try{for(a.s();!(n=a.n()).done;){var i=n.value,o=t.data.field(i.fieldPath);if(null==o)return null;var s=r.He(i.kind);bd.Ve._e(o,s)}}catch(u){a.e(u)}finally{a.f()}return r.Qe()}},{key:"dn",value:function(e){var t=new Cd;return bd.Ve._e(e,t.He(0)),t.Qe()}},{key:"gn",value:function(e,t){var n=new Cd;return bd.Ve._e(Gc(this.databaseId,t),n.He(function(e){var t=pu(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Qe()}},{key:"ln",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new Cd);var a,i=0,o=(0,C.Z)(pu(e));try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=n[i++],l=(0,C.Z)(r);try{for(l.s();!(s=l.n()).done;){var h=s.value;if(this.yn(t,u.fieldPath)&&Kc(c))r=this.pn(r,u,c);else{var f=h.He(u.kind);bd.Ve._e(c,f)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.In(r)}},{key:"hn",value:function(e,t,n){return this.ln(e,t,n.position)}},{key:"In",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Qe();return t}},{key:"pn",value:function(e,t,n){var r,a=d(e),i=[],o=(0,C.Z)(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=(0,C.Z)(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=new Cd;h.seed(l.Qe()),bd.Ve._e(u,h.He(t.kind)),i.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return i}},{key:"yn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof dl&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=Hd(e),a=Gd(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next((function(e){var t=[];return Cu.forEach(e,(function(e){return a.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new gu(t.sequenceNumber,new bu(od(t.readTime),new hu(Wu(t.documentKey)),t.largestBatchId)):gu.empty(),r=e.fields.map((function(e){var t=l(e,2),n=t[0],r=t[1];return new vu(lu.fromServerFormat(n),r)}));return new fu(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:nu(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,a=Hd(e),i=Gd(e);return this.Tn(e).next((function(e){return a.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Cu.forEach(t,(function(t){return i.put(dd(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Cu.forEach(t,(function(t,a){var i=r.get(t.collectionGroup);return(i?Cu.resolve(i):n.getFieldIndexes(e,t.collectionGroup)).next((function(i){return r.set(t.collectionGroup,i),Cu.forEach(i,(function(r){return n.En(e,t,r).next((function(t){var i=n.An(a,r);return t.isEqual(i)?Cu.resolve():n.vn(e,a,r,t,i)}))}))}))}))}},{key:"Rn",value:function(e,t,n,r){return Wd(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}},{key:"Pn",value:function(e,t,n,r){return Wd(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}},{key:"En",value:function(e,t,n){var r=Wd(e),a=new wc(Td);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(function(e,r){a=a.add(new _d(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return a}))}},{key:"An",value:function(e,t){var n=new wc(Td),r=this.mn(t,e);if(null==r)return n;var a=du(t);if(null!=a){var i=e.data.field(a.fieldPath);if(Kc(i)){var o,s=(0,C.Z)(i.arrayValue.values||[]);try{for(s.s();!(o=s.n()).done;){var u=o.value;n=n.add(new _d(t.indexId,e.key,this.dn(u),r))}}catch(c){s.e(c)}finally{s.f()}}}else n=n.add(new _d(t.indexId,e.key,Ud,r));return n}},{key:"vn",value:function(e,t,n,r,a){var i=this;Ps("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,a){for(var i=e.getIterator(),o=t.getIterator(),s=Sc(i),u=Sc(o);s||u;){var c=!1,l=!1;if(s&&u){var h=n(s,u);h<0?l=!0:h>0&&(c=!0)}else null!=s?l=!0:c=!0;c?(r(u),u=Sc(o)):l?(a(s),s=Sc(i)):(s=Sc(i),u=Sc(o))}}(r,a,Td,(function(r){o.push(i.Rn(e,t,n,r))}),(function(r){o.push(i.Pn(e,t,n,r))})),Cu.waitFor(o)}},{key:"Tn",value:function(e){var t=1;return Gd(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return Td(e,t)})).filter((function(e,t,n){return!t||0!==Td(e,n[t-1])}));var r=[];r.push(e);var a,i=(0,C.Z)(n);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=Td(o,e),u=Td(o,t);if(0===s)r[0]=e.Je();else if(s>0&&u<0)r.push(o),r.push(o.Je());else if(u>0)break}}catch(d){i.e(d)}finally{i.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.bn(r[l],r[l+1]))return[];var h=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,Ud,[]],f=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,Ud,[]];c.push(IDBKeyRange.bound(h,f))}return c}},{key:"bn",value:function(e,t){return Td(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(qd)}},{key:"getMinOffset",value:function(e,t){var n=this;return Cu.mapArray(this.cn(t),(function(t){return n.an(e,t).next((function(e){return e||Bs()}))})).next(qd)}}]),e}();function jd(e){return vc(e,"collectionParents")}function Wd(e){return vc(e,"indexEntries")}function Hd(e){return vc(e,"indexConfiguration")}function Gd(e){return vc(e,"indexState")}function qd(e){Us(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var a=e[r].indexState.offset;ku(a,t)<0&&(t=a),n<a.largestBatchId&&(n=a.largestBatchId)}return new bu(t.readTime,t.documentKey,n)}var Kd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Yd=function(){function e(t,n,r){(0,p.Z)(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return(0,v.Z)(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function Xd(e,t,n){var r=e.store("mutations"),a=e.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId),s=0,u=r.X({range:o},(function(e,t,n){return s++,n.delete()}));i.push(u.next((function(){Us(1===s)})));var c,l=[],h=(0,C.Z)(n.mutations);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=qu(t,f.key.path,n.batchId);i.push(a.delete(d)),l.push(f.key)}}catch(p){h.e(p)}finally{h.f()}return Cu.waitFor(i).next((function(){return l}))}function Qd(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Bs();t=e.noDocument}return JSON.stringify(t).length}Yd.DEFAULT_COLLECTION_PERCENTILE=10,Yd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yd.DEFAULT=new Yd(41943040,Yd.DEFAULT_COLLECTION_PERCENTILE,Yd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yd.DISABLED=new Yd(-1,0,0);var Jd=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.userId=t,this.serializer=n,this.indexManager=r,this.referenceDelegate=a,this.Vn={}}return(0,v.Z)(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ep(e).X({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var a=this,i=tp(e),o=ep(e);return o.add({}).next((function(s){Us("number"==typeof s);var u,c=new Qh(s,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return Uf(e.fe,t)})),a=n.mutations.map((function(t){return Uf(e.fe,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:a}}(a.serializer,a.userId,c),h=[],f=new wc((function(e,t){return nu(e.canonicalString(),t.canonicalString())})),d=(0,C.Z)(r);try{for(d.s();!(u=d.n()).done;){var p=u.value,v=qu(a.userId,p.key.path,s);f=f.add(p.key.path.popLast()),h.push(o.put(l)),h.push(i.put(v,Ku))}}catch(g){d.e(g)}finally{d.f()}return f.forEach((function(t){h.push(a.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){a.Vn[s]=c.keys()})),Cu.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return ep(e).get(t).next((function(e){return e?(Us(e.userId===n.userId),sd(n.serializer,e)):null}))}},{key:"Sn",value:function(e,t){var n=this;return this.Vn[t]?Cu.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.Vn[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]),i=null;return ep(e).X({index:"userMutationsIndex",range:a},(function(e,t,a){t.userId===n.userId&&(Us(t.batchId>=r),i=sd(n.serializer,t)),a.done()})).next((function(){return i}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ep(e).X({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ep(e).j("userMutationsIndex",n).next((function(e){return e.map((function(e){return sd(t.serializer,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=Gu(this.userId,t.path),a=IDBKeyRange.lowerBound(r),i=[];return tp(e).X({range:a},(function(r,a,o){var s=l(r,3),u=s[0],c=s[1],h=s[2],f=Wu(c);if(u===n.userId&&t.path.isEqual(f))return ep(e).get(h).next((function(e){if(!e)throw Bs();Us(e.userId===n.userId),i.push(sd(n.serializer,e))}));o.done()})).next((function(){return i}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new wc(nu),a=[];return t.forEach((function(t){var i=Gu(n.userId,t.path),o=IDBKeyRange.lowerBound(i),s=tp(e).X({range:o},(function(e,a,i){var o=l(e,3),s=o[0],u=o[1],c=o[2],h=Wu(u);s===n.userId&&t.path.isEqual(h)?r=r.add(c):i.done()}));a.push(s)})),Cu.waitFor(a).next((function(){return n.Dn(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,a=r.length+1,i=Gu(this.userId,r),o=IDBKeyRange.lowerBound(i),s=new wc(nu);return tp(e).X({range:o},(function(e,t,i){var o=l(e,3),u=o[0],c=o[1],h=o[2],f=Wu(c);u===n.userId&&r.isPrefixOf(f)?f.length===a&&(s=s.add(h)):i.done()})).next((function(){return n.Dn(e,s)}))}},{key:"Dn",value:function(e,t){var n=this,r=[],a=[];return t.forEach((function(t){a.push(ep(e).get(t).next((function(e){if(null===e)throw Bs();Us(e.userId===n.userId),r.push(sd(n.serializer,e))})))})),Cu.waitFor(a).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Xd(e.ht,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.Cn(t.batchId)})),Cu.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"Cn",value:function(e){delete this.Vn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Cu.resolve();var r=IDBKeyRange.lowerBound([t.userId]),a=[];return tp(e).X({range:r},(function(e,n,r){if(e[0]===t.userId){var i=Wu(e[1]);a.push(i)}else r.done()})).next((function(){Us(0===a.length)}))}))}},{key:"containsKey",value:function(e,t){return $d(e,this.userId,t)}},{key:"xn",value:function(e){var t=this;return np(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"de",value:function(t,n,r,a){return Us(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,a)}}]),e}();function $d(e,t,n){var r=Gu(t,n.path),a=r[1],i=IDBKeyRange.lowerBound(r),o=!1;return tp(e).X({range:i,Y:!0},(function(e,n,r){var i=l(e,3),s=i[0],u=i[1];i[2];s===t&&u===a&&(o=!0),r.done()})).next((function(){return o}))}function ep(e){return vc(e,"mutations")}function tp(e){return vc(e,"documentMutations")}function np(e){return vc(e,"mutationQueues")}var rp=function(){function e(t){(0,p.Z)(this,e),this.Nn=t}return(0,v.Z)(e,[{key:"next",value:function(){return this.Nn+=2,this.Nn}}],[{key:"kn",value:function(){return new e(0)}},{key:"Mn",value:function(){return new e(-1)}}]),e}(),ap=function(){function e(t,n){(0,p.Z)(this,e),this.referenceDelegate=t,this.serializer=n}return(0,v.Z)(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.$n(e).next((function(n){var r=new rp(n.highestTargetId);return n.highestTargetId=r.next(),t.On(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.$n(e).next((function(e){return ou.fromTimestamp(new iu(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.$n(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.$n(e).next((function(a){return a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),r.On(e,a)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Fn(e,t).next((function(){return n.$n(e).next((function(r){return r.targetCount+=1,n.Bn(t,r),n.On(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Fn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return ip(e).delete(t.targetId)})).next((function(){return n.$n(e)})).next((function(t){return Us(t.targetCount>0),t.targetCount-=1,n.On(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,a=0,i=[];return ip(e).X((function(o,s){var u=ud(s);u.sequenceNumber<=t&&null===n.get(u.targetId)&&(a++,i.push(r.removeTargetData(e,u)))})).next((function(){return Cu.waitFor(i)})).next((function(){return a}))}},{key:"forEachTarget",value:function(e,t){return ip(e).X((function(e,n){var r=ud(n);t(r)}))}},{key:"$n",value:function(e){return op(e).get("targetGlobalKey").next((function(e){return Us(null!==e),e}))}},{key:"On",value:function(e,t){return op(e).put("targetGlobalKey",t)}},{key:"Fn",value:function(e,t){return ip(e).put(cd(this.serializer,t))}},{key:"Bn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.$n(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=Ml(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),a=null;return ip(e).X({range:r,index:"queryTargetsIndex"},(function(e,n,r){var i=ud(n);Ol(t,i.target)&&(a=i,r.done())})).next((function(){return a}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,a=[],i=sp(e);return t.forEach((function(t){var o=Uu(t.path);a.push(i.put({targetId:n,path:o})),a.push(r.referenceDelegate.addReference(e,n,t))})),Cu.waitFor(a)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,a=sp(e);return Cu.forEach(t,(function(t){var i=Uu(t.path);return Cu.waitFor([a.delete([n,i]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=sp(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=sp(e),a=ph();return r.X({range:n,Y:!0},(function(e,t,n){var r=Wu(e[1]),i=new hu(r);a=a.add(i)})).next((function(){return a}))}},{key:"containsKey",value:function(e,t){var n=Uu(t.path),r=IDBKeyRange.bound([n],[au(n)],!1,!0),a=0;return sp(e).X({index:"documentTargetsIndex",Y:!0,range:r},(function(e,t,n){var r=l(e,2),i=r[0];r[1];0!==i&&(a++,n.done())})).next((function(){return a>0}))}},{key:"le",value:function(e,t){return ip(e).get(t).next((function(e){return e?ud(e):null}))}}]),e}();function ip(e){return vc(e,"targets")}function op(e){return vc(e,"targetGlobal")}function sp(e){return vc(e,"targetDocuments")}function up(e,t){var n=l(e,2),r=n[0],a=n[1],i=l(t,2),o=i[0],s=i[1],u=nu(r,o);return 0===u?nu(a,s):u}var cp=function(){function e(t){(0,p.Z)(this,e),this.Ln=t,this.buffer=new wc(up),this.qn=0}return(0,v.Z)(e,[{key:"Un",value:function(){return++this.qn}},{key:"Kn",value:function(e){var t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();up(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),lp=function(){function e(t,n,r){(0,p.Z)(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Gn=null}return(0,v.Z)(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}},{key:"stop",value:function(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}},{key:"started",get:function(){return null!==this.Gn}},{key:"Qn",value:function(e){var t=this;Ps("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Gn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!Du(e.t0)){e.next=12;break}Ps("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Iu(e.t0);case 14:return e.next=16,t.Qn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),hp=function(){function e(t,n){(0,p.Z)(this,e),this.jn=t,this.params=n}return(0,v.Z)(e,[{key:"calculateTargetCount",value:function(e,t){return this.jn.zn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Cu.resolve(Lu.ct);var r=new cp(t);return this.jn.forEachTarget(e,(function(e){return r.Kn(e.sequenceNumber)})).next((function(){return n.jn.Wn(e,(function(e){return r.Kn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.jn.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.jn.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ps("LruGarbageCollector","Garbage collection skipped; disabled"),Cu.resolve(Kd)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ps("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Kd):n.Hn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.jn.getCacheSize(e)}},{key:"Hn",value:function(e,t){var n,r,a,i,o,s,u,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Ps("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return a=t,s=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),Fs()<=Lt.DEBUG&&Ps("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-i)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(u-s)+"ms\n"+"Total Duration: ".concat(u-l,"ms")),Cu.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})}))}}]),e}();function fp(e,t){return new hp(e,t)}var dp=function(){function e(t,n){(0,p.Z)(this,e),this.db=t,this.garbageCollector=fp(this,n)}return(0,v.Z)(e,[{key:"zn",value:function(e){var t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Jn",value:function(e){var t=0;return this.Wn(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Wn",value:function(e,t){return this.Yn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return pp(e,n)}},{key:"removeReference",value:function(e,t,n){return pp(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return pp(e,t)}},{key:"Xn",value:function(e,t){return function(e,t){var n=!1;return np(e).Z((function(r){return $d(e,r,t).next((function(e){return e&&(n=!0),Cu.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[],i=0;return this.Yn(e,(function(o,s){if(s<=t){var u=n.Xn(e,o).next((function(t){if(!t)return i++,r.getEntry(e,o).next((function(){return r.removeEntry(o,ou.min()),sp(e).delete([0,Uu(o.path)])}))}));a.push(u)}})).next((function(){return Cu.waitFor(a)})).next((function(){return r.apply(e)})).next((function(){return i}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return pp(e,t)}},{key:"Yn",value:function(e,t){var n,r=sp(e),a=Lu.ct;return r.X({index:"documentTargetsIndex"},(function(e,r){var i=l(e,2),o=i[0],s=(i[1],r.path),u=r.sequenceNumber;0===o?(a!==Lu.ct&&t(new hu(Wu(n)),a),a=u,n=s):a=Lu.ct})).next((function(){a!==Lu.ct&&t(new hu(Wu(n)),a)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function pp(e,t){return sp(e).put(function(e,t){return{targetId:0,path:Uu(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var vp=function(){function e(){(0,p.Z)(this,e),this.changes=new rh((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return(0,v.Z)(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,ol.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Cu.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),gp=function(){function e(t){(0,p.Z)(this,e),this.serializer=t}return(0,v.Z)(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return kp(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return kp(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],ad(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Zn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=ol.newInvalidDocument(t);return kp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(xp(t))},(function(e,a){r=n.ts(t,a)})).next((function(){return r}))}},{key:"es",value:function(e,t){var n=this,r={size:0,document:ol.newInvalidDocument(t)};return kp(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(xp(t))},(function(e,a){r={document:n.ts(t,a),size:Qd(a)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=ih();return this.ns(e,t,(function(e,t){var a=n.ts(e,t);r=r.insert(e,a)})).next((function(){return r}))}},{key:"ss",value:function(e,t){var n=this,r=ih(),a=new bc(hu.comparator);return this.ns(e,t,(function(e,t){var i=n.ts(e,t);r=r.insert(e,i),a=a.insert(e,Qd(t))})).next((function(){return{documents:r,rs:a}}))}},{key:"ns",value:function(e,t,n){if(t.isEmpty())return Cu.resolve();var r=new wc(Ip);t.forEach((function(e){return r=r.add(e)}));var a=IDBKeyRange.bound(xp(r.first()),xp(r.last())),i=r.getIterator(),o=i.getNext();return kp(e).X({index:"documentKeyIndex",range:a},(function(e,t,r){for(var a=hu.fromSegments([].concat(d(t.prefixPath),[t.collectionGroup,t.documentId]));o&&Ip(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.G(xp(o)):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var a=this,i=t.path,o=[i.popLast().toArray(),i.lastSegment(),ad(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return kp(e).j(IDBKeyRange.bound(o,s,!0)).next((function(e){var n,i=ih(),o=(0,C.Z)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=a.ts(hu.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);u.isFoundDocument()&&($l(t,u)||r.has(u.key))&&(i=i.insert(u.key,u))}}catch(c){o.e(c)}finally{o.f()}return i}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var a=this,i=ih(),o=wp(t,n),s=wp(t,bu.max());return kp(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,s,!0)},(function(e,t,n){var o=a.ts(hu.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(o.key,o)).size===r&&n.done()})).next((function(){return i}))}},{key:"newChangeBuffer",value:function(e){return new yp(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return bp(e).get("remoteDocumentGlobalKey").next((function(e){return Us(!!e),e}))}},{key:"Zn",value:function(e,t){return bp(e).put("remoteDocumentGlobalKey",t)}},{key:"ts",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=zf(e.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=hu.fromSegments(t.noDocument.path),a=od(t.noDocument.readTime);n=ol.newNoDocument(r,a),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Bs();var i=hu.fromSegments(t.unknownDocument.path),o=od(t.unknownDocument.version);n=ol.newUnknownDocument(i,o)}return t.readTime&&n.setReadTime(function(e){var t=new iu(e[0],e[1]);return ou.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!n.isNoDocument()||!n.version.isEqual(ou.min()))return n}return ol.newInvalidDocument(e)}}]),e}();function mp(e){return new gp(e)}var yp=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).os=e,a.trackRemovals=r,a.us=new rh((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),a}return(0,v.Z)(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,a=new wc((function(e,t){return nu(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(i,o){var s=t.us.get(i);if(n.push(t.os.removeEntry(e,i,s.readTime)),o.isValidDocument()){var u=rd(t.os.serializer,o);a=a.add(i.path.popLast());var c=Qd(u);r+=c-s.size,n.push(t.os.addEntry(e,i,u))}else if(r-=s.size,t.trackRemovals){var l=rd(t.os.serializer,o.convertToNoDocument(ou.min()));n.push(t.os.addEntry(e,i,l))}})),a.forEach((function(r){n.push(t.os.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.os.updateMetadata(e,r)),Cu.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.os.es(e,t).next((function(e){return n.us.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.os.ss(e,t).next((function(e){var t=e.documents;return e.rs.forEach((function(e,r){n.us.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(vp);function bp(e){return vc(e,"remoteDocumentGlobal")}function kp(e){return vc(e,"remoteDocumentsV14")}function xp(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function wp(e,t){var n=t.documentKey.path.toArray();return[e,ad(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Ip(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),a=0,i=0;i<n.length-2&&i<r.length-2;++i)if(a=nu(n[i],r[i]))return a;return(a=nu(n.length,r.length))||((a=nu(n[n.length-2],r[r.length-2]))||nu(n[n.length-1],r[r.length-1]))}var Sp=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.overlayedDocument=t,this.mutatedFields=n})),Cp=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}return(0,v.Z)(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(a){return r=a,n.remoteDocumentCache.getEntry(e,t)})).next((function(e){return null!==r&&zh(r.mutation,e,Cc.empty(),iu.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,ph()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ph(),a=ch();return this.populateOverlays(e,a,t).next((function(){return n.computeViews(e,t,a,r).next((function(e){var t=sh();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=ch();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,ph())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var a=ih(),i=hh(),o=hh();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof jh)?a=a.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),zh(o.mutation,t,o.mutation.getFieldMask(),iu.now())):i.set(t.key,Cc.empty())})),this.recalculateAndSaveOverlays(e,a).next((function(e){return e.forEach((function(e,t){return i.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new Sp(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=hh(),a=new bc((function(e,t){return e-t})),i=ph();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,i=(0,C.Z)(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var i=t.get(n);if(null!==i){var o=r.get(n)||Cc.empty();o=e.applyToLocalView(i,o),r.set(n,o);var s=(a.get(e.batchId)||ph()).add(n);a=a.insert(e.batchId,s)}}))};for(i.s();!(n=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}})).next((function(){for(var o=[],s=a.getReverseIterator(),u=function(){var a=s.getNext(),u=a.key,c=a.value,l=lh();c.forEach((function(e){if(!i.has(e)){var n=Lh(t.get(e),r.get(e));null!==n&&l.set(e,n),i=i.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return Cu.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return hu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var a=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(i){var o=r-i.size>0?a.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Cu.resolve(ch()),s=-1,u=i;return o.next((function(t){return Cu.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?Cu.resolve():a.remoteDocumentCache.getEntry(e,t).next((function(e){u=u.insert(t,e)}))})).next((function(){return a.populateOverlays(e,t,i)})).next((function(){return a.computeViews(e,u,t,ph())})).next((function(e){return{batchId:s,changes:uh(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new hu(t)).next((function(e){var t=sh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,a=t.collectionGroup,i=sh();return this.indexManager.getCollectionParents(e,a).next((function(o){return Cu.forEach(o,(function(o){var s=function(e,t){return new zl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){i=i.insert(e,t)}))}))})).next((function(){return i}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,a=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((function(i){return r=i,a.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)})).next((function(e){r.forEach((function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,ol.newInvalidDocument(r)))}));var n=sh();return e.forEach((function(e,a){var i=r.get(e);void 0!==i&&zh(i.mutation,a,Cc.empty(),iu.now()),$l(t,a)&&(n=n.insert(e,a))})),n}))}}]),e}(),_p=function(){function e(t){(0,p.Z)(this,e),this.serializer=t,this.cs=new Map,this.hs=new Map}return(0,v.Z)(e,[{key:"getBundleMetadata",value:function(e,t){return Cu.resolve(this.cs.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Nf(n.createTime)}),Cu.resolve()}},{key:"getNamedQuery",value:function(e,t){return Cu.resolve(this.hs.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:ld(e.bundledQuery),readTime:Nf(e.readTime)}}(t)),Cu.resolve()}}]),e}(),Tp=function(){function e(){(0,p.Z)(this,e),this.overlays=new bc(hu.comparator),this.ls=new Map}return(0,v.Z)(e,[{key:"getOverlay",value:function(e,t){return Cu.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=ch();return Cu.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,a){r.we(e,t,a)})),Cu.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,a=this.ls.get(n);return void 0!==a&&(a.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.ls.delete(n)),Cu.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=ch(),a=t.length+1,i=new hu(t.child("")),o=this.overlays.getIteratorFrom(i);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===a&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Cu.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var a=new bc((function(e,t){return e-t})),i=this.overlays.getIterator();i.hasNext();){var o=i.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=a.get(o.largestBatchId);null===s&&(s=ch(),a=a.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=ch(),c=a.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return Cu.resolve(u)}},{key:"we",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var a=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new $h(t,n));var i=this.ls.get(t);void 0===i&&(i=ph(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}]),e}(),Ep=function(){function e(){(0,p.Z)(this,e),this.fs=new wc(Np.ds),this.ws=new wc(Np._s)}return(0,v.Z)(e,[{key:"isEmpty",value:function(){return this.fs.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Np(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}},{key:"gs",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.ys(new Np(e,t))}},{key:"ps",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Is",value:function(e){var t=this,n=new hu(new uu([])),r=new Np(n,e),a=new Np(n,e+1),i=[];return this.ws.forEachInRange([r,a],(function(e){t.ys(e),i.push(e.key)})),i}},{key:"Ts",value:function(){var e=this;this.fs.forEach((function(t){return e.ys(t)}))}},{key:"ys",value:function(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}},{key:"Es",value:function(e){var t=new hu(new uu([])),n=new Np(t,e),r=new Np(t,e+1),a=ph();return this.ws.forEachInRange([n,r],(function(e){a=a.add(e.key)})),a}},{key:"containsKey",value:function(e){var t=new Np(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Np=function(){function e(t,n){(0,p.Z)(this,e),this.key=t,this.As=n}return(0,v.Z)(e,null,[{key:"ds",value:function(e,t){return hu.comparator(e.key,t.key)||nu(e.As,t.As)}},{key:"_s",value:function(e,t){return nu(e.As,t.As)||hu.comparator(e.key,t.key)}}]),e}(),Dp=function(){function e(t,n){(0,p.Z)(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new wc(Np.ds)}return(0,v.Z)(e,[{key:"checkEmpty",value:function(e){return Cu.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var a=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var i=new Qh(a,t,n,r);this.mutationQueue.push(i);var o,s=(0,C.Z)(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.Rs=this.Rs.add(new Np(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return Cu.resolve(i)}},{key:"lookupMutationBatch",value:function(e,t){return Cu.resolve(this.Ps(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.bs(n),a=r<0?0:r;return Cu.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Cu.resolve(0===this.mutationQueue.length?-1:this.vs-1)}},{key:"getAllMutationBatches",value:function(e){return Cu.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Np(t,0),a=new Np(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,a],(function(e){var t=n.Ps(e.As);i.push(t)})),Cu.resolve(i)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new wc(nu);return t.forEach((function(e){var t=new Np(e,0),a=new Np(e,Number.POSITIVE_INFINITY);n.Rs.forEachInRange([t,a],(function(e){r=r.add(e.As)}))})),Cu.resolve(this.Vs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,a=n;hu.isDocumentKey(a)||(a=a.child(""));var i=new Np(new hu(a),0),o=new wc(nu);return this.Rs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.As)),!0)}),i),Cu.resolve(this.Vs(o))}},{key:"Vs",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Ps(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Us(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();var r=this.Rs;return Cu.forEach(t.mutations,(function(a){var i=new Np(a.key,t.batchId);return r=r.delete(i),n.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((function(){n.Rs=r}))}},{key:"Cn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Np(t,0),r=this.Rs.firstAfterOrEqual(n);return Cu.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Cu.resolve()}},{key:"Ss",value:function(e,t){return this.bs(e)}},{key:"bs",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Ps",value:function(e){var t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Ap=function(){function e(t){(0,p.Z)(this,e),this.Ds=t,this.docs=new bc(hu.comparator),this.size=0}return(0,v.Z)(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Cu.resolve(n?n.document.mutableCopy():ol.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=ih();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ol.newInvalidDocument(e))})),Cu.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var a=ih(),i=t.path,o=new hu(i.child("")),s=this.docs.getIteratorFrom(o);s.hasNext();){var u=s.getNext(),c=u.key,l=u.value.document;if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||ku(yu(l),n)<=0||(r.has(l.key)||$l(t,l))&&(a=a.insert(l.key,l.mutableCopy()))}return Cu.resolve(a)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Bs()}},{key:"Cs",value:function(e,t){return Cu.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Rp(this)}},{key:"getSize",value:function(e){return Cu.resolve(this.size)}}]),e}(),Rp=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).os=e,r}return(0,v.Z)(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,a){a.isValidDocument()?n.push(t.os.addEntry(e,a)):t.os.removeEntry(r)})),Cu.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.os.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.os.getEntries(e,t)}}]),n}(vp),Mp=function(){function e(t){(0,p.Z)(this,e),this.persistence=t,this.xs=new rh((function(e){return Ml(e)}),Ol),this.lastRemoteSnapshotVersion=ou.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Ep,this.targetCount=0,this.Ms=rp.kn()}return(0,v.Z)(e,[{key:"forEachTarget",value:function(e,t){return this.xs.forEach((function(e,n){return t(n)})),Cu.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Cu.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Cu.resolve(this.Ns)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ms.next(),Cu.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Cu.resolve()}},{key:"Fn",value:function(e){this.xs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ms=new rp(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Fn(t),this.targetCount+=1,Cu.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Fn(t),Cu.resolve()}},{key:"removeTargetData",value:function(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Cu.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,a=0,i=[];return this.xs.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.xs.delete(o),i.push(r.removeMatchingKeysForTargetId(e,s.targetId)),a++)})),Cu.waitFor(i).next((function(){return a}))}},{key:"getTargetCount",value:function(e){return Cu.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.xs.get(t)||null;return Cu.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.ks.gs(t,n),Cu.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.ks.ps(t,n);var r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((function(t){a.push(r.markPotentiallyOrphaned(e,t))})),Cu.waitFor(a)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.ks.Is(t),Cu.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.ks.Es(t);return Cu.resolve(n)}},{key:"containsKey",value:function(e,t){return Cu.resolve(this.ks.containsKey(t))}}]),e}(),Op=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this.$s={},this.overlays={},this.Os=new Lu(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=t(this),this.Bs=new Mp(this),this.indexManager=new zd,this.remoteDocumentCache=new Ap((function(e){return r.referenceDelegate.Ls(e)})),this.serializer=new nd(n),this.qs=new _p(this.serializer)}return(0,v.Z)(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Fs=!1,Promise.resolve()}},{key:"started",get:function(){return this.Fs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Tp,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.$s[e.toKey()];return n||(n=new Dp(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Ps("MemoryPersistence","Starting transaction:",e);var a=new Fp(this.Os.next());return this.referenceDelegate.Us(),n(a).next((function(e){return r.referenceDelegate.Ks(a).next((function(){return e}))})).toPromise().then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Gs",value:function(e,t){return Cu.or(Object.values(this.$s).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),Fp=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return(0,v.Z)(n)}(wu),Pp=function(){function e(t){(0,p.Z)(this,e),this.persistence=t,this.Qs=new Ep,this.js=null}return(0,v.Z)(e,[{key:"Ws",get:function(){if(this.js)return this.js;throw Bs()}},{key:"addReference",value:function(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Cu.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Cu.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ws.add(t.toString()),Cu.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Qs.Is(t.targetId).forEach((function(e){return n.Ws.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Ws.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Us",value:function(){this.js=new Set}},{key:"Ks",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Cu.forEach(this.Ws,(function(r){var a=hu.fromPath(r);return t.Hs(e,a).next((function(e){e||n.removeEntry(a,ou.min())}))})).next((function(){return t.js=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Hs(e,t).next((function(e){e?n.Ws.delete(t.toString()):n.Ws.add(t.toString())}))}},{key:"Ls",value:function(e){return 0}},{key:"Hs",value:function(e,t){var n=this;return Cu.or([function(){return Cu.resolve(n.Qs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Gs(e,t)}])}}],[{key:"zs",value:function(t){return new e(t)}}]),e}(),Lp=function(){function e(t){(0,p.Z)(this,e),this.serializer=t}return(0,v.Z)(e,[{key:"O",value:function(e,t,n,r){var a=this,i=new _u("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hu,{unique:!0}),e.createObjectStore("documentMutations")}(e),Zp(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Cu.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Zp(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ou.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").j().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hu,{unique:!0});var r=t.store("mutations"),a=n.map((function(e){return r.put(e)}));return Cu.waitFor(a)}))}(e,i)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return a.Ys(i)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),a.Xs(i)}))),n<7&&r>=7&&(o=o.next((function(){return a.Zs(i)}))),n<8&&r>=8&&(o=o.next((function(){return a.ti(e,i)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return a.ei(i)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:oc});t.createIndex("collectionPathOverlayIndex",sc,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",uc,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:Yu});t.createIndex("documentKeyIndex",Xu),t.createIndex("collectionGroupIndex",Qu)}(e)})).next((function(){return a.ni(e,i)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return a.si(e,i)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:nc}).createIndex("sequenceNumberIndex",rc,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:ac}).createIndex("documentKeyIndex",ic,{unique:!1})}(e)}))),o}},{key:"Xs",value:function(e){var t=0;return e.store("remoteDocuments").X((function(e,n){t+=Qd(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Ys",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next((function(n){return Cu.forEach(n,(function(n){var a=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",a).next((function(r){return Cu.forEach(r,(function(r){Us(r.userId===n.userId);var a=sd(t.serializer,r);return Xd(e,n.userId,a).next((function(){}))}))}))}))}))}},{key:"Zs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.X((function(n,a){var i=new uu(n),o=function(e){return[0,Uu(e)]}(i);r.push(t.get(o).next((function(n){return n?Cu.resolve():function(n){return t.put({targetId:0,path:Uu(n),sequenceNumber:e.highestListenSequenceNumber})}(i)})))})).next((function(){return Cu.waitFor(r)}))}))}},{key:"ti",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:tc});var n=t.store("collectionParents"),r=new Bd,a=function(e){if(r.add(e)){var t=e.lastSegment(),a=e.popLast();return n.put({collectionId:t,parent:Uu(a)})}};return t.store("remoteDocuments").X({Y:!0},(function(e,t){var n=new uu(e);return a(n.popLast())})).next((function(){return t.store("documentMutations").X({Y:!0},(function(e,t){var n=l(e,3),r=(n[0],n[1]),i=(n[2],Wu(r));return a(i.popLast())}))}))}},{key:"ei",value:function(e){var t=this,n=e.store("targets");return n.X((function(e,r){var a=ud(r),i=cd(t.serializer,a);return n.put(i)}))}},{key:"ni",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.X((function(e,n){var a,i=t.store("remoteDocumentsV14"),o=(a=n,a.document?new hu(uu.fromString(a.document.name).popFirst(5)):a.noDocument?hu.fromSegments(a.noDocument.path):a.unknownDocument?hu.fromSegments(a.unknownDocument.path):Bs()).path.toArray(),s={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(s))})).next((function(){return Cu.waitFor(r)}))}},{key:"si",value:function(e,t){var n=this,r=t.store("mutations"),a=mp(this.serializer),i=new Op(Pp.zs,this.serializer.fe);return r.j().next((function(e){var r=new Map;return e.forEach((function(e){var t,a=null!==(t=r.get(e.userId))&&void 0!==t?t:ph();sd(n.serializer,e).keys().forEach((function(e){return a=a.add(e)})),r.set(e.userId,a)})),Cu.forEach(r,(function(e,r){var o=new Rs(r),s=md.de(n.serializer,o),u=i.getIndexManager(o),c=Jd.de(o,n.serializer,u,i.referenceDelegate);return new Cp(a,c,s,u).recalculateAndSaveOverlaysForDocumentKeys(new pc(t,Lu.ct),e).next()}))}))}}]),e}();function Zp(e){e.createObjectStore("targetDocuments",{keyPath:$u}).createIndex("documentTargetsIndex",ec,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Ju,{unique:!0}),e.createObjectStore("targetGlobal")}var zp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Bp=function(){function e(t,n,r,a,i,o,s,u,c,l){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if((0,p.Z)(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.ii=i,this.window=o,this.document=s,this.ri=c,this.oi=l,this.ui=h,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=function(e){return Promise.resolve()},!e.D())throw new Ws(js.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dp(this,a),this.di=n+"main",this.serializer=new nd(u),this.wi=new Tu(this.di,this.ui,new Lp(this.serializer)),this.Bs=new ap(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mp(this.serializer),this.qs=new pd,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===l&&Ls("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return(0,v.Z)(e,[{key:"start",value:function(){var e=this;return this.mi().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ws(js.FAILED_PRECONDITION,zp);return e.gi(),e.yi(),e.pi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Bs.getHighestSequenceNumber(t)}))})).then((function(t){e.Os=new Lu(t,e.ri)})).then((function(){e.Fs=!0})).catch((function(t){return e.wi&&e.wi.close(),Promise.reject(t)}))}},{key:"Ii",value:function(e){var t=this;return this.fi=function(){var n=Rt(Dt().mark((function n(r){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.wi.B(function(){var t=Rt(Dt().mark((function t(n){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.mi();case 4:case"end":return e.stop()}}),e)})))))}},{key:"mi",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return Vp(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.Ti(t).next((function(t){t||(e.isPrimary=!1,e.ii.enqueueRetryable((function(){return e.fi(!1)})))}))})).next((function(){return e.Ei(t)})).next((function(n){return e.isPrimary&&!n?e.Ai(t).next((function(){return!1})):!!n&&e.vi(t).next((function(){return!0}))}))})).catch((function(t){if(Du(t))return Ps("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Ps("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.ii.enqueueRetryable((function(){return e.fi(t)})),e.isPrimary=t}))}},{key:"Ti",value:function(e){var t=this;return Up(e).get("owner").next((function(e){return Cu.resolve(t.Ri(e))}))}},{key:"Pi",value:function(e){return Vp(e).delete(this.clientId)}},{key:"bi",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.Vi(this.li,18e5)){e.next=6;break}return this.li=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=vc(e,"clientMetadata");return t.j().next((function(e){var n=i.Si(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return Cu.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this._i){n=(0,C.Z)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,this._i.removeItem(this.Di(a.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pi",value:function(){var e=this;this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.mi().then((function(){return e.bi()})).then((function(){return e.pi()}))}))}},{key:"Ri",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"Ei",value:function(e){var t=this;return this.oi?Cu.resolve(!0):Up(e).get("owner").next((function(n){if(null!==n&&t.Vi(n.leaseTimestampMs,5e3)&&!t.Ci(n.ownerId)){if(t.Ri(n)&&t.networkEnabled)return!0;if(!t.Ri(n)){if(!n.allowTabSynchronization)throw new Ws(js.FAILED_PRECONDITION,zp);return!1}}return!(!t.networkEnabled||!t.inForeground)||Vp(e).j().next((function(e){return void 0===t.Si(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,a=t.networkEnabled===e.networkEnabled;if(n||r&&a)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Ps("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),e.next=7,this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new pc(e,Lu.ct);return t.Ai(n).next((function(){return t.Pi(n)}))}));case 7:this.wi.close(),this.Mi();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Si",value:function(e,t){var n=this;return e.filter((function(e){return n.Vi(e.updateTimeMs,t)&&!n.Ci(e.clientId)}))}},{key:"$i",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return Vp(t).j().next((function(t){return e.Si(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Fs}},{key:"getMutationQueue",value:function(e,t){return Jd.de(e,this.serializer,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Bs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new Vd(e,this.serializer.fe.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return md.de(this.serializer,e)}},{key:"getBundleCache",value:function(){return this.qs}},{key:"runTransaction",value:function(e,t,n){var r=this;Ps("IndexedDbPersistence","Starting transaction:",e);var a,i,o="readonly"===t?"readonly":"readwrite",s=15===(a=this.ui)?dc:14===a?fc:13===a?hc:12===a?lc:11===a?cc:void Bs();return this.wi.runTransaction(e,o,s,(function(a){return i=new pc(a,r.Os?r.Os.next():Lu.ct),"readwrite-primary"===t?r.Ti(i).next((function(e){return!!e||r.Ei(i)})).next((function(t){if(!t)throw Ls("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.ii.enqueueRetryable((function(){return r.fi(!1)})),new Ws(js.FAILED_PRECONDITION,xu);return n(i)})).next((function(e){return r.vi(i).next((function(){return e}))})):r.Oi(i).next((function(){return n(i)}))})).then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Oi",value:function(e){var t=this;return Up(e).get("owner").next((function(e){if(null!==e&&t.Vi(e.leaseTimestampMs,5e3)&&!t.Ci(e.ownerId)&&!t.Ri(e)&&!(t.oi||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Ws(js.FAILED_PRECONDITION,zp)}))}},{key:"vi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Up(e).put("owner",t)}},{key:"Ai",value:function(e){var t=this,n=Up(e);return n.get("owner").next((function(e){return t.Ri(e)?(Ps("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Cu.resolve()}))}},{key:"Vi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(Ls("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"gi",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=function(){e.ii.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.mi()}))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ni",value:function(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}},{key:"yi",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=function(){t.xi();var e=/(?:Version|Mobile)\/1[456]/;!lt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&t.ii.enterRestrictedMode(!0),t.ii.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.ci))}},{key:"ki",value:function(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}},{key:"Ci",value:function(e){var t;try{var n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Ps("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Ls("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"xi",value:function(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Ls("Failed to set zombie client id.",e)}}},{key:"Mi",value:function(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch(e){}}},{key:"Di",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"D",value:function(){return Tu.D()}}]),e}();function Up(e){return vc(e,"owner")}function Vp(e){return vc(e,"clientMetadata")}function jp(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var Wp=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.targetId=t,this.fromCache=n,this.Fi=r,this.Bi=a}return(0,v.Z)(e,null,[{key:"Li",value:function(t,n){var r,a=ph(),i=ph(),o=(0,C.Z)(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:a=a.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,a,i)}}]),e}(),Hp=function(){function e(){(0,p.Z)(this,e),this.qi=!1}return(0,v.Z)(e,[{key:"initialize",value:function(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var a=this;return this.Ki(e,t).next((function(i){return i||a.Gi(e,t,r,n)})).next((function(n){return n||a.Qi(e,t)}))}},{key:"Ki",value:function(e,t){var n=this;if(Vl(t))return Cu.resolve(null);var r=ql(t);return this.indexManager.getIndexType(e,r).next((function(a){return 0===a?null:(null!==t.limit&&1===a&&(t=Yl(t,null,"F"),r=ql(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next((function(a){var i=ph.apply(void 0,d(a));return n.Ui.getDocuments(e,i).next((function(a){return n.indexManager.getMinOffset(e,r).next((function(r){var o=n.ji(t,a);return n.zi(t,o,i,r.readTime)?n.Ki(e,Yl(t,null,"F")):n.Wi(e,o,t,r)}))}))})))}))}},{key:"Gi",value:function(e,t,n,r){var a=this;return Vl(t)||r.isEqual(ou.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((function(i){var o=a.ji(t,i);return a.zi(t,o,n,r)?a.Qi(e,t):(Fs()<=Lt.DEBUG&&Ps("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Jl(t)),a.Wi(e,o,t,mu(r,-1)))}))}},{key:"ji",value:function(e,t){var n=new wc(th(e));return t.forEach((function(t,r){$l(e,r)&&(n=n.add(r))})),n}},{key:"zi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}},{key:"Qi",value:function(e,t){return Fs()<=Lt.DEBUG&&Ps("QueryEngine","Using full collection scan to execute query:",Jl(t)),this.Ui.getDocumentsMatchingQuery(e,t,bu.min())}},{key:"Wi",value:function(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),Gp=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.persistence=t,this.Hi=n,this.serializer=a,this.Ji=new bc(nu),this.Yi=new rh((function(e){return Ml(e)}),Ol),this.Xi=new Map,this.Zi=t.getRemoteDocumentCache(),this.Bs=t.getTargetCache(),this.qs=t.getBundleCache(),this.tr(r)}return(0,v.Z)(e,[{key:"tr",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Cp(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Ji)}))}}]),e}();function qp(e,t,n,r){return new Gp(e,t,n,r)}function Kp(e,t){return Yp.apply(this,arguments)}function Yp(){return Yp=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(a){return t=a,r.tr(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var a,i=[],o=[],s=ph(),u=(0,C.Z)(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;i.push(c.batchId);var l,h=(0,C.Z)(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;s=s.add(f.key)}}catch(b){h.e(b)}finally{h.f()}}}catch(b){u.e(b)}finally{u.f()}var d,p=(0,C.Z)(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var g,m=(0,C.Z)(v.mutations);try{for(m.s();!(g=m.n()).done;){var y=g.value;s=s.add(y.key)}}catch(b){m.e(b)}finally{m.f()}}}catch(b){p.e(b)}finally{p.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{er:e,removedBatchIds:i,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Yp.apply(this,arguments)}function Xp(e,t){var n=Vs(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),a=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var a=n.batch,i=a.keys(),o=Cu.resolve();return i.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var i=n.docVersions.get(e);Us(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,a)}))}(n,e,t,a).next((function(){return a.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=ph(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function Qp(e){var t=Vs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Bs.getLastRemoteSnapshotVersion(e)}))}function Jp(e,t){var n=Vs(e),r=t.snapshotVersion,a=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var i=n.Zi.newChangeBuffer({trackRemovals:!0});a=n.Ji;var o=[];t.targetChanges.forEach((function(i,s){var u=a.get(s);if(u){o.push(n.Bs.removeMatchingKeys(e,i.removedDocuments,s).next((function(){return n.Bs.addMatchingKeys(e,i.addedDocuments,s)})));var c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?c=c.withResumeToken(Tc.EMPTY_BYTE_STRING,ou.min()).withLastLimboFreeSnapshotVersion(ou.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,i)&&o.push(n.Bs.updateTargetData(e,c))}}));var s=ih(),u=ph();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push($p(e,i,t.documentUpdates).next((function(e){s=e.nr,u=e.sr}))),!r.isEqual(ou.min())){var c=n.Bs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Cu.waitFor(o).next((function(){return i.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.Ji=a,e}))}function $p(e,t,n){var r=ph(),a=ph();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=ih();return n.forEach((function(n,i){var o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(ou.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Ps("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{nr:r,sr:a}}))}function ev(e,t){var n=Vs(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function tv(e,t){var n=Vs(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Bs.getTargetData(e,t).next((function(a){return a?(r=a,Cu.resolve(r)):n.Bs.allocateTargetId(e).next((function(a){return r=new td(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}function nv(e,t,n){return rv.apply(this,arguments)}function rv(){return rv=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Vs(t),i=a.Ji.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",o,(function(e){return a.persistence.referenceDelegate.removeTarget(e,i)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Du(e.t1)){e.next=12;break}throw e.t1;case 12:Ps("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:a.Ji=a.Ji.remove(n),a.Yi.delete(i.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),rv.apply(this,arguments)}function av(e,t,n){var r=Vs(e),a=ou.min(),i=ph();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Vs(e),a=r.Yi.get(n);return void 0!==a?Cu.resolve(r.Ji.get(a)):r.Bs.getTargetData(t,n)}(r,e,ql(t)).next((function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){i=e}))})).next((function(){return r.Hi.getDocumentsMatchingQuery(e,t,n?a:ou.min(),n?i:ph())})).next((function(e){return sv(r,eh(t),e),{documents:e,ir:i}}))}))}function iv(e,t){var n=Vs(e),r=Vs(n.Bs),a=n.Ji.get(t);return a?Promise.resolve(a.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.le(e,t).next((function(e){return e?e.target:null}))}))}function ov(e,t){var n=Vs(e),r=n.Xi.get(t)||ou.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Zi.getAllFromCollectionGroup(e,t,mu(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return sv(n,t,e),e}))}function sv(e,t,n){var r=e.Xi.get(t)||ou.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Xi.set(t,r)}function uv(e,t,n,r){return cv.apply(this,arguments)}function cv(){return cv=Rt(Dt().mark((function e(t,n,r,a){var i,o,s,u,c,l,h,f,d,p;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Vs(t),o=ph(),s=ih(),u=(0,C.Z)(r);try{for(u.s();!(c=u.n()).done;)l=c.value,h=n.rr(l.metadata.name),l.document&&(o=o.add(h)),(f=n.ur(l)).setReadTime(n.cr(l.metadata.readTime)),s=s.insert(h,f)}catch(v){u.e(v)}finally{u.f()}return d=i.Zi.newChangeBuffer({trackRemovals:!0}),e.next=7,tv(i,function(e){return ql(Ul(uu.fromString("__bundle__/docs/".concat(e))))}(a));case 7:return p=e.sent,e.abrupt("return",i.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return $p(e,d,s).next((function(t){return d.apply(e),t})).next((function(t){return i.Bs.removeMatchingKeysForTargetId(e,p.targetId).next((function(){return i.Bs.addMatchingKeys(e,o,p.targetId)})).next((function(){return i.localDocuments.getLocalViewOfDocuments(e,t.nr,t.sr)})).next((function(){return t.nr}))}))})));case 9:case"end":return e.stop()}}),e)}))),cv.apply(this,arguments)}function lv(e,t){return hv.apply(this,arguments)}function hv(){return hv=Rt(Dt().mark((function e(t,n){var r,a,i,o=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:ph(),e.next=3,tv(t,ql(ld(n.bundledQuery)));case 3:return a=e.sent,i=Vs(t),e.abrupt("return",i.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Nf(n.readTime);if(a.snapshotVersion.compareTo(t)>=0)return i.qs.saveNamedQuery(e,n);var o=a.withResumeToken(Tc.EMPTY_BYTE_STRING,t);return i.Ji=i.Ji.insert(o.targetId,o),i.Bs.updateTargetData(e,o).next((function(){return i.Bs.removeMatchingKeysForTargetId(e,a.targetId)})).next((function(){return i.Bs.addMatchingKeys(e,r,a.targetId)})).next((function(){return i.qs.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),hv.apply(this,arguments)}function fv(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function dv(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function pv(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var vv=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.user=t,this.batchId=n,this.state=r,this.error=a}return(0,v.Z)(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n,r){var a,i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&((o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new Ws(i.error.code,i.error.message))),o?new e(t,n,i.state,a):(Ls("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),gv=function(){function e(t,n,r){(0,p.Z)(this,e),this.targetId=t,this.state=n,this.error=r}return(0,v.Z)(e,[{key:"hr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"ar",value:function(t,n){var r,a=JSON.parse(n),i="object"==typeof a&&-1!==["not-current","current","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return i&&a.error&&((i="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(r=new Ws(a.error.code,a.error.message))),i?new e(t,a.state,r):(Ls("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),mv=function(){function e(t,n){(0,p.Z)(this,e),this.clientId=t,this.activeTargetIds=n}return(0,v.Z)(e,null,[{key:"ar",value:function(t,n){for(var r=JSON.parse(n),a="object"==typeof r&&r.activeTargetIds instanceof Array,i=gh(),o=0;a&&o<r.activeTargetIds.length;++o)a=Bu(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return a?new e(t,i):(Ls("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),yv=function(){function e(t,n){(0,p.Z)(this,e),this.clientId=t,this.onlineState=n}return(0,v.Z)(e,null,[{key:"ar",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(Ls("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),bv=function(){function e(){(0,p.Z)(this,e),this.activeTargetIds=gh()}return(0,v.Z)(e,[{key:"lr",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"dr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"hr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),kv=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.window=t,this.ii=n,this.persistenceKey=r,this.wr=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new bc(nu),this.started=!1,this.yr=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.pr=fv(this.persistenceKey,this.wr),this.Ir=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new bv),this.Tr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.Er=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.Ar=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.vr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Rr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this._r)}return(0,v.Z)(e,[{key:"start",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s,u,c,l,h,f=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.$i();case 2:t=e.sent,n=(0,C.Z)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((a=r.value)!==this.wr){e.next=10;break}return e.abrupt("continue",12);case 10:(i=this.getItem(fv(this.persistenceKey,a)))&&(o=mv.ar(a,i))&&(this.gr=this.gr.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.Pr(),(s=this.storage.getItem(this.vr))&&(u=this.br(s))&&this.Vr(u),c=(0,C.Z)(this.yr);try{for(c.s();!(l=c.n()).done;)h=l.value,this.mr(h)}catch(d){c.e(d)}finally{c.f()}this.yr=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.Ir,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Sr(this.gr)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.gr.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Dr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Dr(e,t,n),this.Cr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(pv(this.persistenceKey,e));if(n){var r=gv.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Nr.dr(e),this.Pr()}},{key:"isLocalQueryTarget",value:function(e){return this.Nr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(pv(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.kr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Cr(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.Mr(e)}},{key:"notifyBundleLoaded",value:function(e){this.$r(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Ps("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Ps("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Ps("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"mr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Ps("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void Ls("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(Rt(Dt().mark((function e(){var r,a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.Tr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Or(n.key),e.abrupt("return",t.Fr(r,null));case 6:if(!(a=t.Br(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Fr(a.clientId,a));case 9:e.next=41;break;case 11:if(!t.Er.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(i=t.Lr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.qr(i));case 16:e.next=41;break;case 18:if(!t.Ar.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.Ur(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Kr(o));case 23:e.next=41;break;case 25:if(n.key!==t.vr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(s=t.br(n.newValue))){e.next=30;break}return e.abrupt("return",t.Vr(s));case 30:e.next=41;break;case 32:if(n.key!==t.Ir){e.next=37;break}u=function(e){var t=Lu.ct;if(null!=e)try{var n=JSON.parse(e);Us("number"==typeof n),t=n}catch(e){Ls("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),u!==Lu.ct&&t.sequenceNumberHandler(u),e.next=41;break;case 37:if(n.key!==t.Rr){e.next=41;break}return c=t.Gr(n.newValue),e.next=41,Promise.all(c.map((function(e){return t.syncEngine.Qr(e)})));case 41:e.next=44;break;case 43:t.yr.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Nr",get:function(){return this.gr.get(this.wr)}},{key:"Pr",value:function(){this.setItem(this.pr,this.Nr.hr())}},{key:"Dr",value:function(e,t,n){var r=new vv(this.currentUser,e,t,n),a=dv(this.persistenceKey,this.currentUser,e);this.setItem(a,r.hr())}},{key:"Cr",value:function(e){var t=dv(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Mr",value:function(e){var t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}},{key:"kr",value:function(e,t,n){var r=pv(this.persistenceKey,e),a=new gv(e,t,n);this.setItem(r,a.hr())}},{key:"$r",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}},{key:"Or",value:function(e){var t=this.Tr.exec(e);return t?t[1]:null}},{key:"Br",value:function(e,t){var n=this.Or(e);return mv.ar(n,t)}},{key:"Lr",value:function(e,t){var n=this.Er.exec(e),r=Number(n[1]),a=void 0!==n[2]?n[2]:null;return vv.ar(new Rs(a),r,t)}},{key:"Ur",value:function(e,t){var n=this.Ar.exec(e),r=Number(n[1]);return gv.ar(r,t)}},{key:"br",value:function(e){return yv.ar(e)}},{key:"Gr",value:function(e){return JSON.parse(e)}},{key:"qr",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.jr(t.batchId,t.state,t.error));case 2:Ps("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Kr",value:function(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}},{key:"Fr",value:function(e,t){var n=this,r=t?this.gr.insert(e,t):this.gr.remove(e),a=this.Sr(this.gr),i=this.Sr(r),o=[],s=[];return i.forEach((function(e){a.has(e)||o.push(e)})),a.forEach((function(e){i.has(e)||s.push(e)})),this.syncEngine.Wr(o,s).then((function(){n.gr=r}))}},{key:"Vr",value:function(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Sr",value:function(e){var t=gh();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"D",value:function(e){return!(!e||!e.localStorage)}}]),e}(),xv=function(){function e(){(0,p.Z)(this,e),this.Hr=new bv,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return(0,v.Z)(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Jr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Hr.dr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Jr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Hr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Hr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Hr=new bv,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),wv=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"Yr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),Iv=function(){function e(){var t=this;(0,p.Z)(this,e),this.Xr=function(){return t.Zr()},this.eo=function(){return t.no()},this.so=[],this.io()}return(0,v.Z)(e,[{key:"Yr",value:function(e){this.so.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}},{key:"io",value:function(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}},{key:"Zr",value:function(){Ps("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=(0,C.Z)(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"no",value:function(){Ps("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=(0,C.Z)(this.so);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"D",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),Sv=null;function Cv(){return null===Sv?Sv=268435456+Math.round(2147483648*Math.random()):Sv++,"0x"+Sv.toString(16)}var _v={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Tv=function(){function e(t){(0,p.Z)(this,e),this.ro=t.ro,this.oo=t.oo}return(0,v.Z)(e,[{key:"uo",value:function(e){this.co=e}},{key:"ao",value:function(e){this.ho=e}},{key:"onMessage",value:function(e){this.lo=e}},{key:"close",value:function(){this.oo()}},{key:"send",value:function(e){this.ro(e)}},{key:"fo",value:function(){this.co()}},{key:"wo",value:function(e){this.ho(e)}},{key:"_o",value:function(e){this.lo(e)}}]),e}(),Ev="WebChannelConnection",Nv=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r.longPollingOptions=e.longPollingOptions,r}return(0,v.Z)(n,[{key:"Ao",value:function(e,t,n,r){var a=Cv();return new Promise((function(i,o){var s=new Es;s.setWithCredentials(!0),s.listenOnce(Is.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case ws.NO_ERROR:var t=s.getResponseJson();Ps(Ev,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(t)),i(t);break;case ws.TIMEOUT:Ps(Ev,"RPC '".concat(e,"' ").concat(a," timed out")),o(new Ws(js.DEADLINE_EXCEEDED,"Request time out"));break;case ws.HTTP_ERROR:var n=s.getStatus();if(Ps(Ev,"RPC '".concat(e,"' ").concat(a," failed with status:"),n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson();Array.isArray(r)&&(r=r[0]);var u=null==r?void 0:r.error;if(u&&u.status&&u.message){var c=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(js).indexOf(t)>=0?t:js.UNKNOWN}(u.status);o(new Ws(c,u.message))}else o(new Ws(js.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ws(js.UNAVAILABLE,"Connection failed."));break;default:Bs()}}finally{Ps(Ev,"RPC '".concat(e,"' ").concat(a," completed."))}}));var u=JSON.stringify(r);Ps(Ev,"RPC '".concat(e,"' ").concat(a," sending request:"),r),s.send(t,"POST",u,n,15)}))}},{key:"Ro",value:function(e,t,n){var r=Cv(),a=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=ks(),o=xs(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(s.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(s.xmlHttpFactory=new _s({})),this.Eo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;var c=a.join("");Ps(Ev,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);var l=i.createWebChannel(c,s),h=!1,f=!1,d=new Tv({ro:function(t){f?Ps(Ev,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Ps(Ev,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),h=!0),Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},oo:function(){return l.close()}}),p=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return p(l,Ts.EventType.OPEN,(function(){f||Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," transport opened."))})),p(l,Ts.EventType.CLOSE,(function(){f||(f=!0,Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.wo())})),p(l,Ts.EventType.ERROR,(function(t){f||(f=!0,Zs(Ev,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),d.wo(new Ws(js.UNAVAILABLE,"The operation could not be completed")))})),p(l,Ts.EventType.MESSAGE,(function(t){var n;if(!f){var a=t.data[0];Us(!!a);var i=a,o=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);var s=o.status,u=function(e){var t=qh[e];if(void 0!==t)return nf(t)}(s),c=o.message;void 0===u&&(u=js.INTERNAL,c="Unknown error status: "+s+" with message "+o.message),f=!0,d.wo(new Ws(u,c)),l.close()}else Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," received:"),a),d._o(a)}})),p(o,Ss.STAT_EVENT,(function(t){t.stat===Cs.PROXY?Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Cs.NOPROXY&&Ps(Ev,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((function(){d.fo()}),0),d}}]),n}(function(){function e(t){(0,p.Z)(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.mo=n+"://"+t.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return(0,v.Z)(e,[{key:"po",get:function(){return!1}},{key:"Io",value:function(e,t,n,r,a){var i=Cv(),o=this.To(e,t);Ps("RestConnection","Sending RPC '".concat(e,"' ").concat(i,":"),o,n);var s={};return this.Eo(s,r,a),this.Ao(e,o,s,n).then((function(t){return Ps("RestConnection","Received RPC '".concat(e,"' ").concat(i,": "),t),t}),(function(t){throw Zs("RestConnection","RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",o,"request:",n),t}))}},{key:"vo",value:function(e,t,n,r,a,i){return this.Io(e,t,n,r,a)}},{key:"Eo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ms,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"To",value:function(e,t){var n=_v[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}]),e}());function Dv(){return"undefined"!=typeof window?window:null}function Av(){return"undefined"!=typeof document?document:null}function Rv(e){return new Sf(e,!0)}var Mv=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;(0,p.Z)(this,e),this.ii=t,this.timerId=n,this.Po=r,this.bo=a,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}return(0,v.Z)(e,[{key:"reset",value:function(){this.So=0}},{key:"xo",value:function(){this.So=this.Vo}},{key:"No",value:function(e){var t=this;this.cancel();var n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),a=Math.max(0,n-r);a>0&&Ps("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,a,(function(){return t.Co=Date.now(),e()})),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}},{key:"Mo",value:function(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}},{key:"cancel",value:function(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"ko",value:function(){return(Math.random()-.5)*this.So}}]),e}(),Ov=function(){function e(t,n,r,a,i,o,s,u){(0,p.Z)(this,e),this.ii=t,this.$o=r,this.Oo=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Mv(t,n)}return(0,v.Z)(e,[{key:"Uo",value:function(){return 1===this.state||5===this.state||this.Ko()}},{key:"Ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Go()}},{key:"stop",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Uo(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Qo",value:function(){this.state=0,this.qo.reset()}},{key:"jo",value:function(){var e=this;this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(function(){return e.zo()})))}},{key:"Wo",value:function(e){this.Ho(),this.stream.send(e)}},{key:"zo",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Ko()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ho",value:function(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}},{key:"Jo",value:function(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}},{key:"close",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==t?this.qo.reset():n&&n.code===js.RESOURCE_EXHAUSTED?(Ls(n.toString()),Ls("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===js.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.ao(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Yo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=l(t,2),a=r[0],i=r[1];e.Fo===n&&e.Zo(a,i)}),(function(n){t((function(){var t=new Ws(js.UNKNOWN,"Fetching auth token failed: "+n.message);return e.tu(t)}))}))}},{key:"Zo",value:function(e,t){var n=this,r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((function(){r((function(){return n.state=2,n.Lo=n.ii.enqueueAfterDelay(n.Oo,1e4,(function(){return n.Ko()&&(n.state=3),Promise.resolve()})),n.listener.uo()}))})),this.stream.ao((function(e){r((function(){return n.tu(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"Go",value:function(){var e=this;this.state=5,this.qo.No(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"tu",value:function(e){return Ps("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Xo",value:function(e){var t=this;return function(n){t.ii.enqueueAndForget((function(){return t.Fo===e?n():(Ps("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),Fv=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i,o,s){var u;return(0,p.Z)(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,a,i,s)).serializer=o,u}return(0,v.Z)(n,[{key:"eu",value:function(e,t){return this.connection.Ro("Listen",e,t)}},{key:"onMessage",value:function(e){this.qo.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Bs()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(Us(void 0===t||"string"==typeof t),Tc.fromBase64String(t||"")):(Us(void 0===t||t instanceof Uint8Array),Tc.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?js.UNKNOWN:nf(e.code);return new Ws(t,e.message||"")}(o);n=new gf(r,a,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var c=Mf(e,u.document.name),l=Nf(u.document.updateTime),h=u.document.createTime?Nf(u.document.createTime):ou.min(),f=new al({mapValue:{fields:u.document.fields}}),d=ol.newFoundDocument(c,l,h,f),p=u.targetIds||[],v=u.removedTargetIds||[];n=new pf(p,v,d.key,d)}else if("documentDelete"in t){t.documentDelete;var g=t.documentDelete;g.document;var m=Mf(e,g.document),y=g.readTime?Nf(g.readTime):ou.min(),b=ol.newNoDocument(m,y),k=g.removedTargetIds||[];n=new pf([],k,b.key,b)}else if("documentRemove"in t){t.documentRemove;var x=t.documentRemove;x.document;var w=Mf(e,x.document),I=x.removedTargetIds||[];n=new pf([],I,w,null)}else{if(!("filter"in t))return Bs();t.filter;var S=t.filter;S.targetId;var C=S.count,_=void 0===C?0:C,T=S.unchangedNames,E=new ef(_,T),N=S.targetId;n=new vf(N,E)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ou.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?ou.min():t.readTime?Nf(t.readTime):ou.min()}(e);return this.listener.nu(t,n)}},{key:"su",value:function(e){var t={};t.database=Pf(this.serializer),t.addTarget=function(e,t){var n,r=t.target;if((n=Fl(r)?{documents:jf(e,r)}:{query:Wf(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Tf(e,t.resumeToken);var a=Cf(e,t.expectedCount);null!==a&&(n.expectedCount=a)}else if(t.snapshotVersion.compareTo(ou.min())>0){n.readTime=_f(e,t.snapshotVersion.toTimestamp());var i=Cf(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);var n=function(e,t){var n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Bs()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}},{key:"iu",value:function(e){var t={};t.database=Pf(this.serializer),t.removeTarget=e,this.Wo(t)}}]),n}(Ov),Pv=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i,o,s){var u;return(0,p.Z)(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,a,i,s)).serializer=o,u.ru=!1,u}return(0,v.Z)(n,[{key:"ou",get:function(){return this.ru}},{key:"start",value:function(){this.ru=!1,this.lastStreamToken=void 0,sr((0,y.Z)(n.prototype),"start",this).call(this)}},{key:"Yo",value:function(){this.ru&&this.uu([])}},{key:"eu",value:function(e,t){return this.connection.Ro("Write",e,t)}},{key:"onMessage",value:function(e){if(Us(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();var t=function(e,t){return e&&e.length>0?(Us(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Nf(e.updateTime):Nf(t);return n.isEqual(ou.min())&&(n=Nf(t)),new Mh(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Nf(e.commitTime);return this.listener.cu(n,t)}return Us(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}},{key:"hu",value:function(){var e={};e.database=Pf(this.serializer),this.Wo(e)}},{key:"uu",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Uf(t.serializer,e)}))};this.Wo(n)}}]),n}(Ov),Lv=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o;return(0,p.Z)(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.connection=a,o.serializer=i,o.lu=!1,o}return(0,v.Z)(n,[{key:"fu",value:function(){if(this.lu)throw new Ws(js.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Io",value:function(e,t,n){var r=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var i=l(a,2),o=i[0],s=i[1];return r.connection.Io(e,t,n,o,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===js.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Ws(js.UNKNOWN,e.toString())}))}},{key:"vo",value:function(e,t,n,r){var a=this;return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var o=l(i,2),s=o[0],u=o[1];return a.connection.vo(e,t,n,s,u,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===js.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new Ws(js.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.lu=!0}}]),n}(function(){return(0,v.Z)((function e(){(0,p.Z)(this,e)}))}());var Zv=function(){function e(t,n){(0,p.Z)(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}return(0,v.Z)(e,[{key:"gu",value:function(){var e=this;0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e._u=null,e.pu("Backend didn't respond within 10 seconds."),e.yu("Offline"),Promise.resolve()})))}},{key:"Iu",value:function(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.yu("Offline")))}},{key:"set",value:function(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}},{key:"yu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"pu",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?(Ls(t),this.mu=!1):Ps("OnlineStateTracker",t)}},{key:"Tu",value:function(){null!==this._u&&(this._u.cancel(),this._u=null)}}]),e}(),zv=(0,v.Z)((function e(t,n,r,a,i){var o=this;(0,p.Z)(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr((function(e){r.enqueueAndForget(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Xv(o),!e.t0){e.next=5;break}return Ps("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Vs(t)).vu.add(4),e.next=4,Vv(n);case 4:return n.bu.set("Unknown"),n.vu.delete(4),e.next=8,Bv(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this.bu=new Zv(r,a)}));function Bv(e){return Uv.apply(this,arguments)}function Uv(){return(Uv=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Xv(t)){e.next=18;break}n=(0,C.Z)(t.Ru),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))).apply(this,arguments)}function Vv(e){return jv.apply(this,arguments)}function jv(){return(jv=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,C.Z)(t.Ru),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}function Wv(e,t){var n=Vs(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Yv(n)?Kv(n):Cg(n).Ko()&&Gv(n,t))}function Hv(e,t){var n=Vs(e),r=Cg(n);n.Au.delete(t),r.Ko()&&qv(n,t),0===n.Au.size&&(r.Ko()?r.jo():Xv(n)&&n.bu.set("Unknown"))}function Gv(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ou.min())>0){var n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Cg(e).su(t)}function qv(e,t){e.Vu.qt(t),Cg(e).iu(t)}function Kv(e){e.Vu=new yf({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},le:function(t){return e.Au.get(t)||null},ue:function(){return e.datastore.serializer.databaseId}}),Cg(e).start(),e.bu.gu()}function Yv(e){return Xv(e)&&!Cg(e).Uo()&&e.Au.size>0}function Xv(e){return 0===Vs(e).vu.size}function Qv(e){e.Vu=void 0}function Jv(e){return $v.apply(this,arguments)}function $v(){return($v=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.Au.forEach((function(e,n){Gv(t,e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eg(e,t){return tg.apply(this,arguments)}function tg(){return(tg=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qv(t),Yv(t)?(t.bu.Iu(n),Kv(t)):t.bu.set("Unknown");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ng(e,t,n){return rg.apply(this,arguments)}function rg(){return rg=Rt(Dt().mark((function e(t,n,r){var a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.bu.set("Online"),!(n instanceof gf&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,a=(0,C.Z)(n.targetIds),e.prev=2,a.s();case 4:if((i=a.n()).done){e.next=14;break}if(o=i.value,e.t0=t.Au.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Au.delete(o),t.Vu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),a.e(e.t1);case 19:return e.prev=19,a.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Ps("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,ag(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof pf?t.Vu.Ht(n):n instanceof vf?t.Vu.ne(n):t.Vu.Xt(n),r.isEqual(ou.min())){e.next=29;break}return e.prev=14,e.next=17,Qp(t.localStore);case 17:if(a=e.sent,e.t1=r.compareTo(a)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Vu.ce(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var a=e.Au.get(r);a&&e.Au.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t,n){var r=e.Au.get(t);if(r){e.Au.set(t,r.withResumeToken(Tc.EMPTY_BYTE_STRING,r.snapshotVersion)),qv(e,t);var a=new td(r.target,t,n,r.sequenceNumber);Gv(e,a)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Ps("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,ag(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),rg.apply(this,arguments)}function ag(e,t,n){return ig.apply(this,arguments)}function ig(){return(ig=Rt(Dt().mark((function e(t,n,r){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Du(n)){e.next=2;break}throw n;case 2:return t.vu.add(1),e.next=5,Vv(t);case 5:t.bu.set("Offline"),r||(r=function(){return Qp(t.localStore)}),t.asyncQueue.enqueueRetryable(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ps("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.vu.delete(1),e.next=6,Bv(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function og(e,t){return t().catch((function(n){return ag(e,n,t)}))}function sg(e){return ug.apply(this,arguments)}function ug(){return(ug=Rt(Dt().mark((function e(t){var n,r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Vs(t),r=_g(n),a=n.Eu.length>0?n.Eu[n.Eu.length-1].batchId:-1;case 2:if(!cg(n)){e.next=19;break}return e.prev=3,e.next=6,ev(n.localStore,a);case 6:if(null!==(i=e.sent)){e.next=10;break}return 0===n.Eu.length&&r.jo(),e.abrupt("break",19);case 10:a=i.batchId,lg(n,i),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,ag(n,e.t0);case 17:e.next=2;break;case 19:hg(n)&&fg(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function cg(e){return Xv(e)&&e.Eu.length<10}function lg(e,t){e.Eu.push(t);var n=_g(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function hg(e){return Xv(e)&&!_g(e).Uo()&&e.Eu.length>0}function fg(e){_g(e).start()}function dg(e){return pg.apply(this,arguments)}function pg(){return(pg=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_g(t).hu();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vg(e){return gg.apply(this,arguments)}function gg(){return(gg=Rt(Dt().mark((function e(t){var n,r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=_g(t),r=(0,C.Z)(t.Eu);try{for(r.s();!(a=r.n()).done;)i=a.value,n.uu(i.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mg(e,t,n){return yg.apply(this,arguments)}function yg(){return(yg=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.Eu.shift(),i=Jh.from(a,n,r),e.next=3,og(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}));case 3:return e.next=5,sg(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bg(e,t){return kg.apply(this,arguments)}function kg(){return kg=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&_g(t).ou,!e.t0){e.next=4;break}return e.next=4,function(){var e=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!tf(a=n.code)||a===js.ABORTED){e.next=7;break}return r=t.Eu.shift(),_g(t).Qo(),e.next=5,og(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,sg(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:hg(t)&&fg(t);case 5:case"end":return e.stop()}}),e)}))),kg.apply(this,arguments)}function xg(e,t){return wg.apply(this,arguments)}function wg(){return(wg=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Vs(t)).asyncQueue.verifyOperationInProgress(),Ps("RemoteStore","RemoteStore received new credentials"),a=Xv(r),r.vu.add(3),e.next=6,Vv(r);case 6:return a&&r.bu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.vu.delete(3),e.next=12,Bv(r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ig(e,t){return Sg.apply(this,arguments)}function Sg(){return(Sg=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vs(t),!n){e.next=7;break}return r.vu.delete(2),e.next=5,Bv(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.vu.add(2),e.next=12,Vv(r);case 12:r.bu.set("Unknown");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cg(e){return e.Su||(e.Su=function(e,t,n){var r=Vs(e);return r.fu(),new Fv(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:Jv.bind(null,e),ao:eg.bind(null,e),nu:ng.bind(null,e)}),e.Ru.push(function(){var t=Rt(Dt().mark((function t(n){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Su.Qo(),Yv(e)?Kv(e):e.bu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Su.stop();case 6:Qv(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Su}function _g(e){return e.Du||(e.Du=function(e,t,n){var r=Vs(e);return r.fu(),new Pv(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:dg.bind(null,e),ao:bg.bind(null,e),au:vg.bind(null,e),cu:mg.bind(null,e)}),e.Ru.push(function(){var t=Rt(Dt().mark((function t(n){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Du.Qo(),t.next=4,sg(e);case 4:t.next=9;break;case 6:return t.next=8,e.Du.stop();case 8:e.Eu.length>0&&(Ps("RemoteStore","Stopping write stream with ".concat(e.Eu.length," pending writes")),e.Eu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.Du}var Tg=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new Hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return(0,v.Z)(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ws(js.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,a,i){var o=new e(t,n,Date.now()+r,a,i);return o.start(r),o}}]),e}();function Eg(e,t){if(Ls("AsyncQueue","".concat(t,": ").concat(e)),Du(e))return new Ws(js.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var Ng=function(){function e(t){(0,p.Z)(this,e),this.comparator=t?function(e,n){return t(e,n)||hu.comparator(e.key,n.key)}:function(e,t){return hu.comparator(e.key,t.key)},this.keyedMap=sh(),this.sortedSet=new bc(this.comparator)}return(0,v.Z)(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),Dg=function(){function e(){(0,p.Z)(this,e),this.Cu=new bc(hu.comparator)}return(0,v.Z)(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Bs():this.Cu=this.Cu.insert(t,e)}},{key:"xu",value:function(){var e=[];return this.Cu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),Ag=function(){function e(t,n,r,a,i,o,s,u,c){(0,p.Z)(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=c}return(0,v.Z)(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,a,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Ng.emptySet(n),o,r,a,!0,!1,i)}}]),e}(),Rg=(0,v.Z)((function e(){(0,p.Z)(this,e),this.Nu=void 0,this.listeners=[]})),Mg=(0,v.Z)((function e(){(0,p.Z)(this,e),this.queries=new rh((function(e){return Ql(e)}),Xl),this.onlineState="Unknown",this.ku=new Set}));function Og(e,t){return Fg.apply(this,arguments)}function Fg(){return Fg=Rt(Dt().mark((function e(t,n){var r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vs(t),a=n.query,i=!1,(o=r.queries.get(a))||(i=!0,o=new Rg),!i){e.next=13;break}return e.prev=3,e.next=6,r.onListen(a);case 6:o.Nu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=Eg(e.t0,"Initialization of query '".concat(Jl(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(a,o),o.listeners.push(n),n.Mu(r.onlineState),o.Nu&&n.$u(o.Nu)&&Bg(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),Fg.apply(this,arguments)}function Pg(e,t){return Lg.apply(this,arguments)}function Lg(){return Lg=Rt(Dt().mark((function e(t,n){var r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vs(t),a=n.query,i=!1,(o=r.queries.get(a))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),!i){e.next=6;break}return e.abrupt("return",(r.queries.delete(a),r.onUnlisten(a)));case 6:case"end":return e.stop()}}),e)}))),Lg.apply(this,arguments)}function Zg(e,t){var n,r=Vs(e),a=!1,i=(0,C.Z)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=o.query,u=r.queries.get(s);if(u){var c,l=(0,C.Z)(u.listeners);try{for(l.s();!(c=l.n()).done;){c.value.$u(o)&&(a=!0)}}catch(h){l.e(h)}finally{l.f()}u.Nu=o}}}catch(h){i.e(h)}finally{i.f()}a&&Bg(r)}function zg(e,t,n){var r=Vs(e),a=r.queries.get(t);if(a){var i,o=(0,C.Z)(a.listeners);try{for(o.s();!(i=o.n()).done;){i.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function Bg(e){e.ku.forEach((function(e){e.next()}))}var Ug=function(){function e(t,n,r){(0,p.Z)(this,e),this.query=t,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}return(0,v.Z)(e,[{key:"$u",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=(0,C.Z)(e.docChanges);try{for(r.s();!(t=r.n()).done;){var a=t.value;3!==a.type&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}e=new Ag(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var i=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),i=!0):this.qu(e,this.onlineState)&&(this.Uu(e),i=!0),this.Bu=e,i}},{key:"onError",value:function(e){this.Ou.error(e)}},{key:"Mu",value:function(e){this.onlineState=e;var t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}},{key:"qu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"Lu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Uu",value:function(e){e=Ag.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}]),e}(),Vg=function(){function e(t,n){(0,p.Z)(this,e),this.Gu=t,this.byteLength=n}return(0,v.Z)(e,[{key:"Qu",value:function(){return"metadata"in this.Gu}}]),e}(),jg=function(){function e(t){(0,p.Z)(this,e),this.serializer=t}return(0,v.Z)(e,[{key:"rr",value:function(e){return Mf(this.serializer,e)}},{key:"ur",value:function(e){return e.metadata.exists?zf(this.serializer,e.document,!1):ol.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}},{key:"cr",value:function(e){return Nf(e)}}]),e}(),Wg=function(){function e(t,n,r){(0,p.Z)(this,e),this.ju=t,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Hg(t)}return(0,v.Z)(e,[{key:"zu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;var n=uu.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"Wu",value:function(e){var t,n=new Map,r=new jg(this.serializer),a=(0,C.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.metadata.queries){var o,s=r.rr(i.metadata.name),u=(0,C.Z)(i.metadata.queries);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=(n.get(c)||ph()).add(s);n.set(c,l)}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){a.e(h)}finally{a.f()}return n}},{key:"complete",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,uv(this.localStore,new jg(this.serializer),this.documents,this.ju.id);case 2:t=e.sent,n=this.Wu(this.documents),r=(0,C.Z)(this.queries),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=11,lv(this.localStore,i,n.get(i.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function Hg(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var Gg=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.key=t})),qg=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.key=t})),Kg=function(){function e(t,n){(0,p.Z)(this,e),this.query=t,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=ph(),this.mutatedKeys=ph(),this.tc=th(t),this.ec=new Ng(this.tc)}return(0,v.Z)(e,[{key:"nc",get:function(){return this.Yu}},{key:"sc",value:function(e,t){var n=this,r=t?t.ic:new Dg,a=t?t.ec:this.ec,i=t?t.mutatedKeys:this.mutatedKeys,o=a,s=!1,u="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,c="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((function(e,t){var l=a.get(e),h=$l(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.rc(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.tc(h,u)>0||c&&n.tc(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(o=o.add(h),i=d?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{ec:o,ic:r,zi:s,mutatedKeys:i}}},{key:"rc",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,a=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;var i=e.ic.xu();i.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bs()}};return n(e)-n(t)}(e.type,t.type)||r.tc(e.doc,t.doc)})),this.oc(n);var o=t?this.uc():[],s=0===this.Zu.size&&this.current?1:0,u=s!==this.Xu;return this.Xu=s,0!==i.length||u?{snapshot:new Ag(this.query,e.ec,a,i,e.mutatedKeys,0===s,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}},{key:"Mu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Dg,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}},{key:"ac",value:function(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}},{key:"oc",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Yu=t.Yu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Yu=t.Yu.delete(e)})),this.current=e.current)}},{key:"uc",value:function(){var e=this;if(!this.current)return[];var t=this.Zu;this.Zu=ph(),this.ec.forEach((function(t){e.ac(t.key)&&(e.Zu=e.Zu.add(t.key))}));var n=[];return t.forEach((function(t){e.Zu.has(t)||n.push(new qg(t))})),this.Zu.forEach((function(e){t.has(e)||n.push(new Gg(e))})),n}},{key:"hc",value:function(e){this.Yu=e.ir,this.Zu=ph();var t=this.sc(e.documents);return this.applyChanges(t,!0)}},{key:"lc",value:function(){return Ag.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}]),e}(),Yg=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.query=t,this.targetId=n,this.view=r})),Xg=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.key=t,this.fc=!1})),Qg=function(){function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new rh((function(e){return Ql(e)}),Xl),this._c=new Map,this.mc=new Set,this.gc=new bc(hu.comparator),this.yc=new Map,this.Ic=new Ep,this.Tc={},this.Ec=new Map,this.Ac=rp.Mn(),this.onlineState="Unknown",this.vc=void 0}return(0,v.Z)(e,[{key:"isPrimaryClient",get:function(){return!0===this.vc}}]),e}();function Jg(e,t){return $g.apply(this,arguments)}function $g(){return $g=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Hm(t),!(o=r.wc.get(n))){e.next=6;break}a=o.targetId,r.sharedClientState.addLocalQueryTarget(a),i=o.view.lc(),e.next=15;break;case 6:return e.next=8,tv(r.localStore,ql(n));case 8:return s=e.sent,u=r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.targetId,e.next=13,em(r,n,a,"current"===u,s.resumeToken);case 13:i=e.sent,r.isPrimaryClient&&Wv(r.remoteStore,s);case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)}))),$g.apply(this,arguments)}function em(e,t,n,r,a){return tm.apply(this,arguments)}function tm(){return tm=Rt(Dt().mark((function e(t,n,r,a,i){var o,s,u,c,l,h;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Rc=function(e,n,r){return function(){var e=Rt(Dt().mark((function e(t,n,r,a){var i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.view.sc(r),e.t0=i.zi,!e.t0){e.next=6;break}return e.next=5,av(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.sc(t,i)}));case 5:i=e.sent;case 6:return o=a&&a.targetChanges.get(n.targetId),s=n.view.applyChanges(i,t.isPrimaryClient,o),e.abrupt("return",(xm(t,n.targetId,s.cc),s.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,av(t.localStore,n,!0);case 3:return o=e.sent,s=new Kg(n,o.ir),u=s.sc(o.documents),c=df.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==t.onlineState,i),l=s.applyChanges(u,t.isPrimaryClient,c),xm(t,r,l.cc),h=new Yg(n,r,s),e.abrupt("return",(t.wc.set(n,h),t._c.has(r)?t._c.get(r).push(n):t._c.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}}),e)}))),tm.apply(this,arguments)}function nm(e,t){return rm.apply(this,arguments)}function rm(){return(rm=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Vs(t),a=r.wc.get(n),!((i=r._c.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r._c.set(a.targetId,i.filter((function(e){return!Xl(e,n)}))),void r.wc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,nv(r.localStore,a.targetId,!1).then((function(){r.sharedClientState.clearQueryState(a.targetId),Hv(r.remoteStore,a.targetId),bm(r,a.targetId)})).catch(Iu);case 9:e.next=14;break;case 11:return bm(r,a.targetId),e.next=14,nv(r.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function am(e,t,n){return im.apply(this,arguments)}function im(){return im=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Gm(t),e.prev=1,e.next=4,function(e,t){var n,r,a=Vs(e),i=iu.now(),o=t.reduce((function(e,t){return e.add(t.key)}),ph());return a.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=ih(),u=ph();return a.Zi.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return a.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],u=(0,C.Z)(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Bh(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new jh(c.key,l,il(l.value.mapValue),Oh.exists(!0)))}}catch(h){u.e(h)}finally{u.f()}return a.mutationQueue.addMutationBatch(e,i,s,t)})).next((function(t){r=t;var i=t.applyToLocalDocumentSet(n,u);return a.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((function(){return{batchId:r.batchId,changes:uh(n)}}))}(a.localStore,n);case 4:return i=e.sent,a.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.Tc[e.currentUser.toKey()];r||(r=new bc(nu)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(a,i.batchId,r),e.next=9,Sm(a,i.changes);case 9:return e.next=11,sg(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=Eg(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),im.apply(this,arguments)}function om(e,t){return sm.apply(this,arguments)}function sm(){return(sm=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),e.prev=1,e.next=4,Jp(r.localStore,n);case 4:return a=e.sent,n.targetChanges.forEach((function(e,t){var n=r.yc.get(t);n&&(Us(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.fc=!0:e.modifiedDocuments.size>0?Us(n.fc):e.removedDocuments.size>0&&(Us(n.fc),n.fc=!1))})),e.next=8,Sm(r,a,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Iu(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function um(e,t,n){var r=Vs(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var a=[];r.wc.forEach((function(e,n){var r=n.view.Mu(t);r.snapshot&&a.push(r.snapshot)})),function(e,t){var n=Vs(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var a,i=(0,C.Z)(n.listeners);try{for(i.s();!(a=i.n()).done;){a.value.Mu(t)&&(r=!0)}}catch(o){i.e(o)}finally{i.f()}})),r&&Bg(n)}(r.eventManager,t),a.length&&r.dc.nu(a),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function cm(e,t,n){return lm.apply(this,arguments)}function lm(){return lm=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=Vs(t)).sharedClientState.updateQueryState(n,"rejected",r),i=a.yc.get(n),!(o=i&&i.key)){e.next=14;break}return s=(s=new bc(hu.comparator)).insert(o,ol.newNoDocument(o,ou.min())),u=ph().add(o),c=new ff(ou.min(),new Map,new bc(nu),s,u),e.next=9,om(a,c);case 9:a.gc=a.gc.remove(o),a.yc.delete(n),Im(a),e.next=16;break;case 14:return e.next=16,nv(a.localStore,n,!1).then((function(){return bm(a,n,r)})).catch(Iu);case 16:case"end":return e.stop()}}),e)}))),lm.apply(this,arguments)}function hm(e,t){return fm.apply(this,arguments)}function fm(){return(fm=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),a=n.batch.batchId,e.prev=1,e.next=4,Xp(r.localStore,n);case 4:return i=e.sent,ym(r,a,null),mm(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,Sm(r,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Iu(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function dm(e,t,n){return pm.apply(this,arguments)}function pm(){return(pm=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Vs(t),e.prev=1,e.next=4,function(e,t){var n=Vs(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Us(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,n);case 4:return i=e.sent,ym(a,n,r),mm(a,n),a.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,Sm(a,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Iu(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function vm(e,t){return gm.apply(this,arguments)}function gm(){return(gm=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xv((r=Vs(t)).remoteStore)||Ps("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Vs(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(a=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(i=r.Ec.get(a)||[]).push(n),r.Ec.set(a,i),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=Eg(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function mm(e,t){(e.Ec.get(t)||[]).forEach((function(e){e.resolve()})),e.Ec.delete(t)}function ym(e,t,n){var r=Vs(e),a=r.Tc[r.currentUser.toKey()];if(a){var i=a.get(t);i&&(n?i.reject(n):i.resolve(),a=a.remove(t)),r.Tc[r.currentUser.toKey()]=a}}function bm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,a=(0,C.Z)(e._c.get(t));try{for(a.s();!(r=a.n()).done;){var i=r.value;e.wc.delete(i),n&&e.dc.Pc(i,n)}}catch(o){a.e(o)}finally{a.f()}e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((function(t){e.Ic.containsKey(t)||km(e,t)}))}function km(e,t){e.mc.delete(t.path.canonicalString());var n=e.gc.get(t);null!==n&&(Hv(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Im(e))}function xm(e,t,n){var r,a=(0,C.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;i instanceof Gg?(e.Ic.addReference(i.key,t),wm(e,i)):i instanceof qg?(Ps("SyncEngine","Document no longer in limbo: "+i.key),e.Ic.removeReference(i.key,t),e.Ic.containsKey(i.key)||km(e,i.key)):Bs()}}catch(o){a.e(o)}finally{a.f()}}function wm(e,t){var n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Ps("SyncEngine","New document in limbo: "+n),e.mc.add(r),Im(e))}function Im(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){var t=e.mc.values().next().value;e.mc.delete(t);var n=new hu(uu.fromString(t)),r=e.Ac.next();e.yc.set(r,new Xg(n)),e.gc=e.gc.insert(n,r),Wv(e.remoteStore,new td(ql(Ul(n.path)),r,"TargetPurposeLimboResolution",Lu.ct))}}function Sm(e,t,n){return Cm.apply(this,arguments)}function Cm(){return Cm=Rt(Dt().mark((function e(t,n,r){var a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Vs(t),i=[],o=[],s=[],e.t0=a.wc.isEmpty(),e.t0){e.next=9;break}return a.wc.forEach((function(e,t){s.push(a.Rc(t,n,r).then((function(e){if((e||r)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);var n=Wp.Li(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(s);case 6:return a.dc.nu(i),e.next=9,function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Cu.forEach(n,(function(t){return Cu.forEach(t.Fi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Cu.forEach(t.Bi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Du(e.t0)){e.next=10;break}throw e.t0;case 10:Ps("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:a=(0,C.Z)(n);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.targetId,o.fromCache||(u=r.Ji.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),r.Ji=r.Ji.insert(s,l))}catch(h){a.e(h)}finally{a.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(a.localStore,o);case 9:case"end":return e.stop()}}),e)}))),Cm.apply(this,arguments)}function _m(e,t){return Tm.apply(this,arguments)}function Tm(){return(Tm=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Vs(t)).currentUser.isEqual(n)){e.next=11;break}return Ps("SyncEngine","User change. New user:",n.toKey()),e.next=5,Kp(r.localStore,n);case 5:return a=e.sent,r.currentUser=n,function(e,t){e.Ec.forEach((function(e){e.forEach((function(e){e.reject(new Ws(js.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(r),r.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),e.next=11,Sm(r,a.er);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Em(e,t){var n=Vs(e),r=n.yc.get(t);if(r&&r.fc)return ph().add(r.key);var a=ph(),i=n._c.get(t);if(!i)return a;var o,s=(0,C.Z)(i);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.wc.get(u);a=a.unionWith(c.view.nc)}}catch(l){s.e(l)}finally{s.f()}return a}function Nm(e,t){return Dm.apply(this,arguments)}function Dm(){return(Dm=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),e.next=3,av(r.localStore,n.query,!0);case 3:return a=e.sent,i=n.view.hc(a),e.abrupt("return",(r.isPrimaryClient&&xm(r,n.targetId,i.cc),i));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Am(e,t){return Rm.apply(this,arguments)}function Rm(){return(Rm=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),e.abrupt("return",ov(r.localStore,n).then((function(e){return Sm(r,e)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mm(e,t,n,r){return Om.apply(this,arguments)}function Om(){return Om=Rt(Dt().mark((function e(t,n,r,a){var i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Vs(t),e.next=3,function(e,t){var n=Vs(e),r=Vs(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Sn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Cu.resolve(null)}))}))}(i.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,sg(i.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(ym(i,n,a||null),mm(i,n),function(e,t){Vs(Vs(e).mutationQueue).Cn(t)}(i.localStore,n)):Bs();case 11:return e.next=13,Sm(i,o);case 13:e.next=16;break;case 15:Ps("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),Om.apply(this,arguments)}function Fm(e,t){return Pm.apply(this,arguments)}function Pm(){return(Pm=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Hm(r=Vs(t)),Gm(r),!0!==n||!0===r.vc){e.next=13;break}return a=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,Lm(r,a.toArray());case 5:return i=e.sent,r.vc=!0,e.next=9,Ig(r.remoteStore,!0);case 9:o=(0,C.Z)(i);try{for(o.s();!(s=o.n()).done;)u=s.value,Wv(r.remoteStore,u)}catch(h){o.e(h)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.vc){e.next=25;break}return c=[],l=Promise.resolve(),r._c.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then((function(){return bm(r,t),nv(r.localStore,t,!0)})),Hv(r.remoteStore,t)})),e.next=19,l;case 19:return e.next=21,Lm(r,c);case 21:return function(e){var t=Vs(e);t.yc.forEach((function(e,n){Hv(t.remoteStore,n)})),t.Ic.Ts(),t.yc=new Map,t.gc=new bc(hu.comparator)}(r),r.vc=!1,e.next=25,Ig(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lm(e,t,n){return Zm.apply(this,arguments)}function Zm(){return Zm=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p,v,g,m;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Vs(t),i=[],o=[],s=(0,C.Z)(n),e.prev=2,s.s();case 4:if((u=s.n()).done){e.next=45;break}if(c=u.value,l=void 0,!(h=a._c.get(c))||0===h.length){e.next=34;break}return e.next=11,tv(a.localStore,ql(h[0]));case 11:l=e.sent,f=(0,C.Z)(h),e.prev=13,f.s();case 15:if((d=f.n()).done){e.next=24;break}return p=d.value,v=a.wc.get(p),e.next=20,Nm(a,v);case 20:(g=e.sent).snapshot&&o.push(g.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),f.e(e.t0);case 29:return e.prev=29,f.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,iv(a.localStore,c);case 36:return m=e.sent,e.next=39,tv(a.localStore,m);case 39:return l=e.sent,e.next=42,em(a,zm(m),c,!1,l.resumeToken);case 42:i.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),s.e(e.t1);case 50:return e.prev=50,s.f(),e.finish(50);case 53:return e.abrupt("return",(a.dc.nu(o),i));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),Zm.apply(this,arguments)}function zm(e){return Bl(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Bm(e){var t=Vs(e);return Vs(Vs(t.localStore).persistence).$i()}function Um(e,t,n,r){return Vm.apply(this,arguments)}function Vm(){return Vm=Rt(Dt().mark((function e(t,n,r,a){var i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Vs(t)).vc){e.next=3;break}return e.abrupt("return",void Ps("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((o=i._c.get(n))&&o.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,ov(i.localStore,eh(o[0]));case 10:return s=e.sent,u=ff.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,Tc.EMPTY_BYTE_STRING),e.next=14,Sm(i,s,u);case 14:return e.abrupt("break",20);case 15:return e.next=17,nv(i.localStore,n,!0);case 17:return bm(i,n,a),e.abrupt("break",20);case 19:Bs();case 20:case"end":return e.stop()}}),e)}))),Vm.apply(this,arguments)}function jm(e,t,n){return Wm.apply(this,arguments)}function Wm(){return(Wm=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Hm(t)).vc){e.next=45;break}i=(0,C.Z)(n),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=21;break}if(s=o.value,!a._c.has(s)){e.next=10;break}return Ps("SyncEngine","Adding an already active target "+s),e.abrupt("continue",19);case 10:return e.next=12,iv(a.localStore,s);case 12:return u=e.sent,e.next=15,tv(a.localStore,u);case 15:return c=e.sent,e.next=18,em(a,zm(u),c.targetId,!1,c.resumeToken);case 18:Wv(a.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),i.e(e.t0);case 26:return e.prev=26,i.f(),e.finish(26);case 29:l=(0,C.Z)(r),e.prev=30,f=Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=a._c.has(t),!e.t0){e.next=5;break}return e.next=5,nv(a.localStore,t,!1).then((function(){Hv(a.remoteStore,t),bm(a,t)})).catch(Iu);case 5:case"end":return e.stop()}}),e)})),l.s();case 33:if((h=l.n()).done){e.next=37;break}return e.delegateYield(f(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])})))).apply(this,arguments)}function Hm(e){var t=Vs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=om.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Em.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=cm.bind(null,t),t.dc.nu=Zg.bind(null,t.eventManager),t.dc.Pc=zg.bind(null,t.eventManager),t}function Gm(e){var t=Vs(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=hm.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=dm.bind(null,t),t}function qm(e,t,n){var r=Vs(e);(function(){var e=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return a=e.sent,e.next=6,function(e,t){var n=Vs(e),r=Nf(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.qs.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,a);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(a)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(Hg(a)),i=new Wg(a,t.localStore,n.serializer),e.next=15,n.bc();case 15:o=e.sent;case 16:if(!o){e.next=26;break}return e.next=19,i.zu(o);case 19:return(s=e.sent)&&r._updateProgress(s),e.next=23,n.bc();case 23:o=e.sent;case 24:e.next=16;break;case 26:return e.next=28,i.complete();case 28:return u=e.sent,e.next=31,Sm(t,u.Ju,void 0);case 31:return e.next=33,function(e,t){var n=Vs(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.qs.saveBundleMetadata(e,t)}))}(t.localStore,a);case 33:return r._completeWith(u.progress),e.abrupt("return",Promise.resolve(u.Hu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Zs("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var Km=function(){function e(){(0,p.Z)(this,e),this.synchronizeTabs=!1}return(0,v.Z)(e,[{key:"initialize",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.serializer=Rv(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),e.next=5,this.persistence.start();case 5:this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createGarbageCollectionScheduler",value:function(e,t){return null}},{key:"createIndexBackfillerScheduler",value:function(e,t){return null}},{key:"createLocalStore",value:function(e){return qp(this.persistence,new Hp,e.initialUser,this.serializer)}},{key:"createPersistence",value:function(e){return new Op(Pp.zs,this.serializer)}},{key:"createSharedClientState",value:function(e){return new xv}},{key:"terminate",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ym=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this)).Vc=e,i.cacheSizeBytes=r,i.forceOwnership=a,i.synchronizeTabs=!1,i}return(0,v.Z)(n,[{key:"initialize",value:function(){var e=Rt(Dt().mark((function e(t){var r=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr((0,y.Z)(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Vc.initialize(this,t);case 4:return e.next=6,Gm(this.Vc.syncEngine);case 6:return e.next=8,sg(this.Vc.remoteStore);case 8:return e.next=10,this.persistence.Ii((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createLocalStore",value:function(e){return qp(this.persistence,new Hp,e.initialUser,this.serializer)}},{key:"createGarbageCollectionScheduler",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new lp(n,e.asyncQueue,t)}},{key:"createIndexBackfillerScheduler",value:function(e,t){var n=new Pu(t,this.persistence);return new Fu(e.asyncQueue,n)}},{key:"createPersistence",value:function(e){var t=jp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Yd.withCacheSize(this.cacheSizeBytes):Yd.DEFAULT;return new Bp(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Dv(),Av(),this.serializer,this.sharedClientState,!!this.forceOwnership)}},{key:"createSharedClientState",value:function(e){return new xv}}]),n}(Km),Xm=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r,!1)).Vc=e,a.cacheSizeBytes=r,a.synchronizeTabs=!0,a}return(0,v.Z)(n,[{key:"initialize",value:function(){var e=Rt(Dt().mark((function e(t){var r,a=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr((0,y.Z)(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Vc.syncEngine,e.t0=this.sharedClientState instanceof kv,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={jr:Mm.bind(null,r),zr:Um.bind(null,r),Wr:jm.bind(null,r),$i:Bm.bind(null,r),Qr:Am.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.Ii(function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fm(a.Vc.syncEngine,t);case 2:a.gcScheduler&&(t&&!a.gcScheduler.started?a.gcScheduler.start():t||a.gcScheduler.stop()),a.indexBackfillerScheduler&&(t&&!a.indexBackfillerScheduler.started?a.indexBackfillerScheduler.start():t||a.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSharedClientState",value:function(e){var t=Dv();if(!kv.D(t))throw new Ws(js.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=jp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new kv(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(Ym),Qm=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"initialize",value:function(){var e=Rt(Dt().mark((function e(t,n){var r=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return um(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=_m.bind(null,this.syncEngine),e.next=12,Ig(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new Mg}},{key:"createDatastore",value:function(e){var t,n=Rv(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Nv(t));return function(e,t,n,r){return new Lv(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,a,i,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,a=function(e){return um(o.syncEngine,e,0)},i=Iv.D()?new Iv:new wv,new zv(t,n,r,a,i)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,a,i,o){var s=new Qg(e,t,n,r,a,i);return o&&(s.vc=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vs(t),Ps("RemoteStore","RemoteStore shutting down."),n.vu.add(5),e.next=5,Vv(n);case 5:n.Pu.shutdown(),n.bu.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function Jm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return Rt(Dt().mark((function r(){var a;return Dt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return a={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,a));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.resolve()}}var $m=function(){function e(t){(0,p.Z)(this,e),this.observer=t,this.muted=!1}return(0,v.Z)(e,[{key:"next",value:function(e){this.observer.next&&this.Sc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Sc(this.observer.error,e):Ls("Uncaught Error in snapshot listener:",e.toString())}},{key:"Dc",value:function(){this.muted=!0}},{key:"Sc",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),ey=function(){function e(t,n){var r=this;(0,p.Z)(this,e),this.Cc=t,this.serializer=n,this.metadata=new Hs,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then((function(e){e&&e.Qu()?r.metadata.resolve(e.Gu.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.Gu))))}),(function(e){return r.metadata.reject(e)}))}return(0,v.Z)(e,[{key:"close",value:function(){return this.Cc.cancel()}},{key:"getMetadata",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bc",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Nc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Nc",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.kc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.xc.decode(t),r=Number(n),isNaN(r)&&this.Mc("length string (".concat(n,") is not valid number")),e.next=9,this.$c(r);case 9:return a=e.sent,e.abrupt("return",new Vg(JSON.parse(a),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Oc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"kc",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Oc()<0)){e.next=7;break}return e.next=3,this.Fc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Oc())<0&&this.Mc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"$c",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Fc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Mc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.xc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Mc",value:function(e){throw this.Cc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Fc",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Cc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ty=function(){function e(t){(0,p.Z)(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return(0,v.Z)(e,[{key:"lookup",value:function(){var e=Rt(Dt().mark((function e(t){var n,r=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new Ws(js.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),a=Pf(r.serializer)+"/documents",i={documents:n.map((function(e){return Rf(r.serializer,e)}))},e.next=5,r.vo("BatchGetDocuments",a,i,n.length);case 5:return o=e.sent,s=new Map,o.forEach((function(e){var t=Bf(r.serializer,e);s.set(t.key.toString(),t)})),u=[],e.abrupt("return",(n.forEach((function(e){var t=s.get(e.toString());Us(!!t),u.push(t)})),u));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new Yh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=Rt(Dt().mark((function e(){var t,n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=hu.fromPath(t);n.mutations.push(new Xh(r,n.precondition(r)))})),e.next=7,function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Vs(t),a=Pf(r.serializer)+"/documents",i={writes:n.map((function(e){return Uf(r.serializer,e)}))},e.next=3,r.Io("Commit",a,i);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Bs();t=ou.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Ws(js.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ou.min())?Oh.exists(!1):Oh.updateTime(t):Oh.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ou.min()))throw new Ws(js.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oh.updateTime(t)}return Oh.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),ny=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=a,this.deferred=i,this.Bc=r.maxAttempts,this.qo=new Mv(this.asyncQueue,"transaction_retry")}return(0,v.Z)(e,[{key:"run",value:function(){this.Bc-=1,this.Lc()}},{key:"Lc",value:function(){var e=this;this.qo.No(Rt(Dt().mark((function t(){var n,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new ty(e.datastore),(r=e.qc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Uc(t)}))}))})).catch((function(t){e.Uc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"qc",value:function(e){try{var t=this.updateFunction(e);return!Zu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Uc",value:function(e){var t=this;this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Lc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"Kc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!tf(t)}return!1}}]),e}(),ry=function(){function e(t,n,r,a){var i=this;(0,p.Z)(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=Rs.UNAUTHENTICATED,this.clientId=tu.A(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ps("FirestoreClient","Received user=",t.uid),e.next=3,i.authCredentialListener(t);case 3:i.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Ps("FirestoreClient","Received new app check token=",e),i.appCheckCredentialListener(e,i.user)}))}return(0,v.Z)(e,[{key:"getConfiguration",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Ws(js.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Rt(Dt().mark((function n(){var r;return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e._onlineComponents,!n.t0){n.next=5;break}return n.next=5,e._onlineComponents.terminate();case 5:if(n.t1=e._offlineComponents,!n.t1){n.next=9;break}return n.next=9,e._offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=Eg(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function ay(e,t){return iy.apply(this,arguments)}function iy(){return iy=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Ps("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:a=r.initialUser,t.setCredentialChangeListener(function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(t),e.t0){e.next=5;break}return e.next=4,Kp(n.localStore,t);case 4:a=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t._offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),iy.apply(this,arguments)}function oy(e,t){return sy.apply(this,arguments)}function sy(){return(sy=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,cy(t);case 3:return r=e.sent,Ps("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return a=e.sent,e.next=10,n.initialize(r,a);case 10:t.setCredentialChangeListener((function(e){return xg(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return xg(n.remoteStore,t)})),t._onlineComponents=n;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uy(e){return"FirebaseError"===e.name?e.code===js.FAILED_PRECONDITION||e.code===js.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}function cy(e){return ly.apply(this,arguments)}function ly(){return(ly=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._offlineComponents){e.next=21;break}if(!t._uninitializedComponentsProvider){e.next=18;break}return Ps("FirestoreClient","Using user provided OfflineComponentProvider"),e.prev=3,e.next=6,ay(t,t._uninitializedComponentsProvider._offline);case 6:e.next=16;break;case 8:if(e.prev=8,e.t0=e.catch(3),uy(n=e.t0)){e.next=13;break}throw n;case 13:return Zs("Error using user provided cache. Falling back to memory cache: "+n),e.next=16,ay(t,new Km);case 16:e.next=21;break;case 18:return Ps("FirestoreClient","Using default OfflineComponentProvider"),e.next=21,ay(t,new Km);case 21:return e.abrupt("return",t._offlineComponents);case 22:case"end":return e.stop()}}),e,null,[[3,8]])})))).apply(this,arguments)}function hy(e){return fy.apply(this,arguments)}function fy(){return(fy=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t._onlineComponents,e.t0){e.next=11;break}if(!t._uninitializedComponentsProvider){e.next=8;break}return Ps("FirestoreClient","Using user provided OnlineComponentProvider"),e.next=6,oy(t,t._uninitializedComponentsProvider._online);case 6:e.next=11;break;case 8:return Ps("FirestoreClient","Using default OnlineComponentProvider"),e.next=11,oy(t,new Qm);case 11:return e.abrupt("return",t._onlineComponents);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dy(e){return cy(e).then((function(e){return e.persistence}))}function py(e){return cy(e).then((function(e){return e.localStore}))}function vy(e){return hy(e).then((function(e){return e.remoteStore}))}function gy(e){return hy(e).then((function(e){return e.syncEngine}))}function my(e){return hy(e).then((function(e){return e.datastore}))}function yy(e){return by.apply(this,arguments)}function by(){return(by=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hy(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=Jg.bind(null,n.syncEngine),r.onUnlisten=nm.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ky(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function a(){return Dt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new $m({next:function(i){t.enqueueAndForget((function(){return Pg(e,o)}));var s=i.docs.has(n);!s&&i.fromCache?a.reject(new Ws(js.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&i.fromCache&&r&&"server"===r.source?a.reject(new Ws(js.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(i)},error:function(e){return a.reject(e)}}),o=new Ug(Ul(n.path),i,{includeMetadataChanges:!0,Ku:!0});return Og(e,o)},a.next=3,yy(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}function xy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function a(){return Dt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=function(e,t,n,r,a){var i=new $m({next:function(n){t.enqueueAndForget((function(){return Pg(e,o)})),n.fromCache&&"server"===r.source?a.reject(new Ws(js.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:function(e){return a.reject(e)}}),o=new Ug(n,i,{includeMetadataChanges:!0,Ku:!0});return Og(e,o)},a.next=3,yy(e);case 3:return a.t1=a.sent,a.t2=e.asyncQueue,a.t3=t,a.t4=n,a.t5=r,a.abrupt("return",(0,a.t0)(a.t1,a.t2,a.t3,a.t4,a.t5));case 9:case"end":return a.stop()}}),a)})))),r.promise}function wy(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}var Iy=new Map;function Sy(e,t,n){if(!n)throw new Ws(js.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Cy(e,t,n,r){if(!0===t&&!0===r)throw new Ws(js.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function _y(e){if(!hu.isDocumentKey(e))throw new Ws(js.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ty(e){if(hu.isDocumentKey(e))throw new Ws(js.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ey(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Bs()}function Ny(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ws(js.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Ey(e);throw new Ws(js.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function Dy(e,t){if(t<=0)throw new Ws(js.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Ay=function(){function e(t){var n,r;if((0,p.Z)(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Ws(js.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ws(js.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Cy("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wy(null!==(r=t.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ws(js.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Ws(js.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Ws(js.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}return(0,v.Z)(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}]),e}(),Ry=function(){function e(t,n,r,a){(0,p.Z)(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ay({}),this._settingsFrozen=!1}return(0,v.Z)(e,[{key:"app",get:function(){if(!this._app)throw new Ws(js.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Ws(js.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ay(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new qs;switch(e.type){case"firstParty":return new Qs(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ws(js.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=Iy.get(e);t&&(Ps("ComponentProvider","Removing Datastore"),Iy.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function My(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(e=Ny(e,Ry))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==i.host&&i.host!==o&&Zs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),a.mockUserToken){var s,u;if("string"==typeof a.mockUserToken)s=a.mockUserToken,u=Rs.MOCK_USER;else{s=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[nt(JSON.stringify({alg:"none",type:"JWT"})),nt(JSON.stringify(i)),""].join(".")}(a.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=a.mockUserToken.sub||a.mockUserToken.user_id;if(!c)throw new Ws(js.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Rs(c)}e._authCredentials=new Ks(new Gs(s,u))}}var Oy=function(){function e(t,n,r){(0,p.Z)(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return(0,v.Z)(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new Py(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),Fy=function(){function e(t,n,r){(0,p.Z)(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return(0,v.Z)(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),Py=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this,e,r,Ul(a)))._path=a,i.type="collection",i}return(0,v.Z)(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Oy(this.firestore,null,new hu(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(Fy);function Ly(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=Et(e),Sy("collection","path",t),e instanceof Ry){var i=uu.fromString.apply(uu,[t].concat(r));return Ty(i),new Py(e,null,i)}if(!(e instanceof Oy||e instanceof Py))throw new Ws(js.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(uu.fromString.apply(uu,[t].concat(r)));return Ty(o),new Py(e.firestore,null,o)}function Zy(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=Et(e),1===arguments.length&&(t=tu.A()),Sy("doc","path",t),e instanceof Ry){var i=uu.fromString.apply(uu,[t].concat(r));return _y(i),new Oy(e,null,new hu(i))}if(!(e instanceof Oy||e instanceof Py))throw new Ws(js.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(uu.fromString.apply(uu,[t].concat(r)));return _y(o),new Oy(e.firestore,e instanceof Py?e.converter:null,new hu(o))}function zy(e,t){return e=Et(e),t=Et(t),(e instanceof Oy||e instanceof Py)&&(t instanceof Oy||t instanceof Py)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function By(e,t){return e=Et(e),t=Et(t),e instanceof Fy&&t instanceof Fy&&e.firestore===t.firestore&&Xl(e._query,t._query)&&e.converter===t.converter}var Uy=function(){function e(){var t=this;(0,p.Z)(this,e),this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Mv(this,"async_queue_retry"),this.Xc=function(){var e=Av();e&&Ps("AsyncQueue","Visibility state changed to "+e.visibilityState),t.qo.Mo()};var n=Av();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Xc)}return(0,v.Z)(e,[{key:"isShuttingDown",get:function(){return this.jc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Zc(),this.ta(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;var t=Av();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Zc(),this.jc)return new Promise((function(){}));var n=new Hs;return this.ta((function(){return t.jc&&t.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Qc.push(e),t.ea()}))}},{key:"ea",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Qc.length){e.next=14;break}return e.prev=1,e.next=4,this.Qc[0]();case 4:this.Qc.shift(),this.qo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),Du(e.t0)){e.next=12;break}throw e.t0;case 12:Ps("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Qc.length>0&&this.qo.No((function(){return t.ea()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"ta",value:function(e){var t=this,n=this.Gc.then((function(){return t.Hc=!0,e().catch((function(e){t.Wc=e,t.Hc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ls("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Hc=!1,e}))}));return this.Gc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);var a=Tg.createAndSchedule(this,e,t,n,(function(e){return r.na(e)}));return this.zc.push(a),a}},{key:"Zc",value:function(){this.Wc&&Bs()}},{key:"verifyOperationInProgress",value:function(){}},{key:"sa",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Gc,e.next=3,t;case 3:if(t!==this.Gc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ia",value:function(e){var t,n=(0,C.Z)(this.zc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"ra",value:function(e){var t=this;return this.sa().then((function(){t.zc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=(0,C.Z)(t.zc);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.skipDelay(),"all"!==e&&a.timerId===e)break}}catch(i){r.e(i)}finally{r.f()}return t.sa()}))}},{key:"oa",value:function(e){this.Yc.push(e)}},{key:"na",value:function(e){var t=this.zc.indexOf(e);this.zc.splice(t,1)}}]),e}();function Vy(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,a=(0,C.Z)(["next","error","complete"]);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i in r&&"function"==typeof r[i])return!0}}catch(o){a.e(o)}finally{a.f()}return!1}(e)}var jy=function(){function e(){(0,p.Z)(this,e),this._progressObserver={},this._taskCompletionResolver=new Hs,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return(0,v.Z)(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),Wy=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o;return(0,p.Z)(this,n),(o=t.call(this,e,r,a,i)).type="firestore",o._queue=new Uy,o._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]",o}return(0,v.Z)(n,[{key:"_terminate",value:function(){return this._firestoreClient||Gy(this),this._firestoreClient.terminate()}}]),n}(Ry);function Hy(e){return e._firestoreClient||Gy(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Gy(e){var t,n,r,a=e._freezeSettings(),i=function(e,t,n,r){return new Fc(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,wy(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._firestoreClient=new ry(e._authCredentials,e._appCheckCredentials,e._queue,i),(null===(n=a.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.cache.kind,_offline:a.cache._offlineComponentProvider,_online:a.cache._onlineComponentProvider})}function qy(e,t,n){var r=new Hs;return e.asyncQueue.enqueue(Rt(Dt().mark((function a(){var i;return Dt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,ay(e,n);case 3:return a.next=5,oy(e,t);case 5:r.resolve(),a.next=14;break;case 8:if(a.prev=8,a.t0=a.catch(0),uy(i=a.t0)){a.next=13;break}throw i;case 13:Zs("Error enabling indexeddb cache. Falling back to memory cache: "+i),r.reject(i);case 14:case"end":return a.stop()}}),a,null,[[0,8]])})))).then((function(){return r.promise}))}function Ky(e){return function(e){return e.asyncQueue.enqueue(Rt(Dt().mark((function t(){var n,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dy(e);case 2:return n=t.sent,t.next=5,vy(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Vs(e);return t.vu.delete(0),Bv(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(Hy(e=Ny(e,Wy)))}function Yy(e){return function(e){return e.asyncQueue.enqueue(Rt(Dt().mark((function t(){var n,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dy(e);case 2:return n=t.sent,t.next=5,vy(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Vs(t)).vu.add(0),e.next=4,Vv(n);case 4:n.bu.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(Hy(e=Ny(e,Wy)))}function Xy(e,t){var n=Hy(e=Ny(e,Wy)),r=new jy;return function(e,t,n,r){var a=function(e,t){return function(e,t){return new ey(e,t)}(function(e,t){if(e instanceof Uint8Array)return Jm(e,t);if(e instanceof ArrayBuffer)return Jm(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?of().encode(e):e),t)}(n,Rv(t));e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=qm,t.next=3,gy(e);case 3:t.t1=t.sent,t.t2=a,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function Qy(e,t){return function(e,t){return e.asyncQueue.enqueue(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Vs(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.qs.getNamedQuery(e,t)}))},n.next=3,py(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(Hy(e=Ny(e,Wy)),t).then((function(t){return t?new Fy(e,null,t.query):null}))}function Jy(e){if(e._initialized||e._terminated)throw new Ws(js.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var $y=function(){function e(t){(0,p.Z)(this,e),this._byteString=t}return(0,v.Z)(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Tc.fromBase64String(t))}catch(t){throw new Ws(js.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Tc.fromUint8Array(t))}}]),e}(),eb=function(){function e(){(0,p.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0;a<n.length;++a)if(0===n[a].length)throw new Ws(js.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lu(n)}return(0,v.Z)(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var tb=(0,v.Z)((function e(t){(0,p.Z)(this,e),this._methodName=t})),nb=function(){function e(t,n){if((0,p.Z)(this,e),!isFinite(t)||t<-90||t>90)throw new Ws(js.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Ws(js.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return(0,v.Z)(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return nu(this._lat,e._lat)||nu(this._long,e._long)}}]),e}(),rb=/^__.*__$/,ab=function(){function e(t,n,r){(0,p.Z)(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return(0,v.Z)(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new jh(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vh(e,this.data,t,this.fieldTransforms)}}]),e}(),ib=function(){function e(t,n,r){(0,p.Z)(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return(0,v.Z)(e,[{key:"toMutation",value:function(e,t){return new jh(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function ob(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Bs()}}var sb=function(){function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.settings=t,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return(0,v.Z)(e,[{key:"path",get:function(){return this.settings.path}},{key:"ca",get:function(){return this.settings.ca}},{key:"aa",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ha",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}},{key:"da",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}},{key:"wa",value:function(e){return this.aa({path:void 0,la:!0})}},{key:"_a",value:function(e){return Tb(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"ua",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.fa(this.path.get(e))}},{key:"fa",value:function(e){if(0===e.length)throw this._a("Document fields must not be empty");if(ob(this.ca)&&rb.test(e))throw this._a('Document fields cannot begin and end with "__"')}}]),e}(),ub=function(){function e(t,n,r){(0,p.Z)(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.serializer=r||Rv(t)}return(0,v.Z)(e,[{key:"ya",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new sb({ca:e,methodName:t,ga:n,path:lu.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}]),e}();function cb(e){var t=e._freezeSettings(),n=Rv(e._databaseId);return new ub(e._databaseId,!!t.ignoreUndefinedProperties,n)}function lb(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.ya(i.merge||i.mergeFields?2:0,t,n,a);Ib("Data must be an object, but it was:",o,r);var s,u,c=xb(r,o);if(i.merge)s=new Cc(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){var l,h=[],f=(0,C.Z)(i.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=Sb(t,l.value,n);if(!o.contains(d))throw new Ws(js.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));Eb(h,d)||h.push(d)}}catch(p){f.e(p)}finally{f.f()}s=new Cc(h),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new ab(new al(c),s,u)}var hb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.ca)throw 1===e.ca?e._a("".concat(this._methodName,"() can only appear at the top level of your update data")):e._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(tb);function fb(e,t,n){return new sb({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var db=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"_toFieldTransform",value:function(e){return new Rh(e.path,new Sh)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(tb),pb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e)).pa=r,a}return(0,v.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=fb(this,e,!0),n=this.pa.map((function(e){return kb(e,t)})),r=new Ch(n);return new Rh(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(tb),vb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e)).pa=r,a}return(0,v.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=fb(this,e,!0),n=this.pa.map((function(e){return kb(e,t)})),r=new Th(n);return new Rh(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(tb),gb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e)).Ia=r,a}return(0,v.Z)(n,[{key:"_toFieldTransform",value:function(e){var t=new Nh(e.serializer,bh(e.serializer,this.Ia));return new Rh(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(tb);function mb(e,t,n,r){var a=e.ya(1,t,n);Ib("Data must be an object, but it was:",a,r);var i=[],o=al.empty();mc(r,(function(e,r){var s=_b(t,e,n);r=Et(r);var u=a.da(s);if(r instanceof hb)i.push(s);else{var c=kb(r,u);null!=c&&(i.push(s),o.set(s,c))}}));var s=new Cc(i);return new ib(o,s,a.fieldTransforms)}function yb(e,t,n,r,a,i){var o=e.ya(1,t,n),s=[Sb(t,r,n)],u=[a];if(i.length%2!=0)throw new Ws(js.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<i.length;c+=2)s.push(Sb(t,i[c])),u.push(i[c+1]);for(var l=[],h=al.empty(),f=s.length-1;f>=0;--f)if(!Eb(l,s[f])){var d=s[f],p=u[f];p=Et(p);var v=o.da(d);if(p instanceof hb)l.push(d);else{var g=kb(p,v);null!=g&&(l.push(d),h.set(d,g))}}var m=new Cc(l);return new ib(h,m,o.fieldTransforms)}function bb(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return kb(n,e.ya(r?4:3,t))}function kb(e,t){if(wb(e=Et(e)))return Ib("Unsupported field value:",t,e),xb(e,t);if(e instanceof tb)return function(e,t){if(!ob(t.ca))throw t._a("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t._a("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){var n,r=[],a=0,i=(0,C.Z)(e);try{for(i.s();!(n=i.n()).done;){var o=kb(n.value,t.wa(a));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),a++}}catch(s){i.e(s)}finally{i.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=Et(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return bh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=iu.fromDate(e);return{timestampValue:_f(t.serializer,n)}}if(e instanceof iu){var r=new iu(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:_f(t.serializer,r)}}if(e instanceof nb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof $y)return{bytesValue:Tf(t.serializer,e._byteString)};if(e instanceof Oy){var a=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(a))throw t._a("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(a.projectId,"/").concat(a.database));return{referenceValue:Df(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a("Unsupported field value: ".concat(Ey(e)))}(e,t)}function xb(e,t){var n={};return yc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):mc(e,(function(e,r){var a=kb(r,t.ha(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function wb(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof iu||e instanceof nb||e instanceof $y||e instanceof Oy||e instanceof tb)}function Ib(e,t,n){if(!wb(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Ey(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function Sb(e,t,n){if((t=Et(t))instanceof eb)return t._internalPath;if("string"==typeof t)return _b(e,t);throw Tb("Field path arguments must be of type string or ",e,!1,void 0,n)}var Cb=new RegExp("[~\\*/\\[\\]]");function _b(e,t,n){if(t.search(Cb)>=0)throw Tb("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return x(eb,d(t.split(".")))._internalPath}catch(r){throw Tb("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Tb(e,t,n,r,a){var i=r&&!r.isEmpty(),o=void 0!==a,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(i||o)&&(u+=" (found",i&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(a)),u+=")"),new Ws(js.INVALID_ARGUMENT,s+e+u)}function Eb(e,t){return e.some((function(e){return e.isEqual(t)}))}var Nb=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}return(0,v.Z)(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Oy(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Db(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Ab("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),Db=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"data",value:function(){return sr((0,y.Z)(n.prototype),"data",this).call(this)}}]),n}(Nb);function Ab(e,t){return"string"==typeof t?_b(e,t):t instanceof eb?t._internalPath:t._delegate._internalPath}function Rb(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ws(js.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Mb=(0,v.Z)((function e(){(0,p.Z)(this,e)})),Ob=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(Mb);function Fb(e,t){for(var n=[],r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof Mb&&n.push(t),function(e){var t=e.filter((function(e){return e instanceof Lb})).length,n=e.filter((function(e){return e instanceof Pb})).length;if(t>1||t>0&&n>0)throw new Ws(js.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(a));var o,s=(0,C.Z)(n);try{for(s.s();!(o=s.n()).done;){e=o.value._apply(e)}}catch(u){s.e(u)}finally{s.f()}return e}var Pb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this))._field=e,i._op=r,i._value=a,i.type="where",i}return(0,v.Z)(n,[{key:"_apply",value:function(e){var t=this._parse(e);return Yb(e._query,t),new Fy(e.firestore,e.converter,Kl(e._query,t))}},{key:"_parse",value:function(e){var t=cb(e.firestore),n=function(e,t,n,r,a,i,o){var s;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Ws(js.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){Kb(o,i);var u,c=[],l=(0,C.Z)(o);try{for(l.s();!(u=l.n()).done;){var h=u.value;c.push(qb(r,e,h))}}catch(f){l.e(f)}finally{l.f()}s={arrayValue:{values:c}}}else s=qb(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Kb(o,i),s=bb(n,"where",o,"in"===i||"not-in"===i);return dl.create(a,i,s)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(Ob);var Lb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).type=e,a._queryConstraints=r,a}return(0,v.Z)(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map((function(t){return t._parse(e)})).filter((function(e){return e.getFilters().length>0}));return 1===t.length?t[0]:pl.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,a=t.getFlattenedFilters(),i=(0,C.Z)(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;Yb(r,o),r=Kl(r,o)}}catch(s){i.e(s)}finally{i.f()}}(e._query,t),new Fy(e.firestore,e.converter,Kl(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Mb);var Zb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this))._field=e,a._direction=r,a.type="orderBy",a}return(0,v.Z)(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Ws(js.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Ws(js.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ll(t,n);return function(e,t){if(null===jl(e)){var n=Wl(e);null!==n&&Xb(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Fy(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new zl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Ob);var zb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this)).type=e,i._limit=r,i._limitType=a,i}return(0,v.Z)(n,[{key:"_apply",value:function(e){return new Fy(e.firestore,e.converter,Yl(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(Ob);var Bb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this)).type=e,i._docOrFields=r,i._inclusive=a,i}return(0,v.Z)(n,[{key:"_apply",value:function(e){var t=Gb(e,this.type,this._docOrFields,this._inclusive);return new Fy(e.firestore,e.converter,function(e,t){return new zl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(Ob);function Ub(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Bb._create("startAt",t,!0)}function Vb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Bb._create("startAfter",t,!1)}var jb=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this)).type=e,i._docOrFields=r,i._inclusive=a,i}return(0,v.Z)(n,[{key:"_apply",value:function(e){var t=Gb(e,this.type,this._docOrFields,this._inclusive);return new Fy(e.firestore,e.converter,function(e,t){return new zl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}(Ob);function Wb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jb._create("endBefore",t,!1)}function Hb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return jb._create("endAt",t,!0)}function Gb(e,t,n,r){if(n[0]=Et(n[0]),n[0]instanceof Nb)return function(e,t,n,r,a){if(!r)throw new Ws(js.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var i,o=[],s=(0,C.Z)(Gl(e));try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u.field.isKeyField())o.push(Gc(t,r.key));else{var c=r.data.field(u.field);if(Rc(c))throw new Ws(js.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Ws(js.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(h){s.e(h)}finally{s.f()}return new sl(o,a)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var a=cb(e.firestore);return function(e,t,n,r,a,i){var o=e.explicitOrderBy;if(a.length>o.length)throw new Ws(js.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var s=[],u=0;u<a.length;u++){var c=a[u];if(o[u].field.isKeyField()){if("string"!=typeof c)throw new Ws(js.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!Hl(e)&&-1!==c.indexOf("/"))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(uu.fromString(c));if(!hu.isDocumentKey(l))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var h=new hu(l);s.push(Gc(t,h))}else{var f=bb(n,r,c);s.push(f)}}return new sl(s,i)}(e._query,e.firestore._databaseId,a,t,n,r)}function qb(e,t,n){if("string"==typeof(n=Et(n))){if(""===n)throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hl(t)&&-1!==n.indexOf("/"))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(uu.fromString(n));if(!hu.isDocumentKey(r))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Gc(e,new hu(r))}if(n instanceof Oy)return Gc(e,n._key);throw new Ws(js.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Ey(n),"."))}function Kb(e,t){if(!Array.isArray(e)||0===e.length)throw new Ws(js.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Yb(e,t){if(t.isInequality()){var n=Wl(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var a=jl(e);null!==a&&Xb(e,r,a)}var i=function(e,t){var n,r=(0,C.Z)(e);try{for(r.s();!(n=r.n()).done;){var a,i=n.value,o=(0,C.Z)(i.getFlattenedFilters());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.indexOf(s.op)>=0)return s.op}}catch(u){o.e(u)}finally{o.f()}}}catch(u){r.e(u)}finally{r.f()}return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new Ws(js.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Ws(js.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}function Xb(e,t,n){if(!n.isEqual(t))throw new Ws(js.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var Qb=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(zc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ac(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Bs()}}},{key:"convertObject",value:function(e,t){return this.convertObjectMap(e.fields,t)}},{key:"convertObjectMap",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",r={};return mc(e,(function(e,a){r[e]=t.convertValue(a,n)})),r}},{key:"convertGeoPoint",value:function(e){return new nb(Dc(e.latitude),Dc(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Mc(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Oc(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Nc(e);return new iu(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=uu.fromString(e);Us(ed(n));var r=new Pc(n.get(1),n.get(3)),a=new hu(n.popFirst(5));return r.isEqual(t)||Ls("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}]),e}();function Jb(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var $b=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,v.Z)(n,[{key:"convertBytes",value:function(e){return new $y(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Oy(this.firestore,null,t)}}]),n}(Qb);var ek=function(){function e(t,n){(0,p.Z)(this,e),this.hasPendingWrites=t,this.fromCache=n}return(0,v.Z)(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),tk=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i,o,s){var u;return(0,p.Z)(this,n),(u=t.call(this,e,r,a,i,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return(0,v.Z)(n,[{key:"exists",value:function(){return sr((0,y.Z)(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new nk(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Ab("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(Nb),nk=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sr((0,y.Z)(n.prototype),"data",this).call(this,e)}}]),n}(tk),rk=function(){function e(t,n,r,a){(0,p.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new ek(a.hasPendingWrites,a.fromCache),this.query=r}return(0,v.Z)(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new nk(n._firestore,n._userDataWriter,r.key,r,new ek(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ws(js.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new nk(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ek(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new nk(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ek(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),a=-1,i=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(i=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:ak(t.type),doc:n,oldIndex:a,newIndex:i}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function ak(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bs()}}function ik(e,t){return e instanceof tk&&t instanceof tk?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof rk&&t instanceof rk&&e._firestore===t._firestore&&By(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}var ok=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,v.Z)(n,[{key:"convertBytes",value:function(e){return new $y(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Oy(this.firestore,null,t)}}]),n}(Qb);function sk(e){e=Ny(e,Oy);var t=Ny(e.firestore,Wy),n=Hy(t),r=new ok(t);return function(e,t){var n=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function r(){return Dt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Vs(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(a=e.sent).isFoundDocument()?r.resolve(a):a.isNoDocument()?r.resolve(null):r.reject(new Ws(js.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),i=Eg(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(i);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,py(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new tk(t,r,e._key,n,new ek(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function uk(e){e=Ny(e,Fy);var t=Ny(e.firestore,Wy),n=Hy(t),r=new ok(t);return function(e,t){var n=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function r(){return Dt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,av(t,n,!0);case 3:a=e.sent,i=new Kg(n,a.ir),o=i.sc(a.documents),s=i.applyChanges(o,!1),r.resolve(s.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),u=Eg(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(u);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,py(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new rk(t,r,e,n)}))}function ck(e,t,n){e=Ny(e,Oy);var r=Ny(e.firestore,Wy),a=Jb(e.converter,t,n);return dk(r,[lb(cb(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,Oh.none())])}function lk(e,t,n){e=Ny(e,Oy);for(var r=Ny(e.firestore,Wy),a=cb(r),i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return dk(r,[("string"==typeof(t=Et(t))||t instanceof eb?yb(a,"updateDoc",e._key,t,n,o):mb(a,"updateDoc",e._key,t)).toMutation(e._key,Oh.exists(!0))])}function hk(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i,o;e=Et(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||Vy(n[u])||(s=n[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Vy(n[u])){var d=n[u];n[u]=null===(a=d.next)||void 0===a?void 0:a.bind(d),n[u+1]=null===(i=d.error)||void 0===i?void 0:i.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof Oy)l=Ny(e.firestore,Wy),h=Ul(e._key.path),c={next:function(t){n[u]&&n[u](pk(l,e,t))},error:n[u+1],complete:n[u+2]};else{var p=Ny(e,Fy);l=Ny(p.firestore,Wy),h=p._query;var v=new ok(l);c={next:function(e){n[u]&&n[u](new rk(l,v,p,e))},error:n[u+1],complete:n[u+2]},Rb(e._query)}return function(e,t,n,r){var a=new $m(r),i=new Ug(t,a,n);return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Og,t.next=3,yy(e);case 3:return t.t1=t.sent,t.t2=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){a.Dc(),e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Pg,t.next=3,yy(e);case 3:return t.t1=t.sent,t.t2=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(Hy(l),h,f,c)}function fk(e,t){return function(e,t){var n=new $m(t);return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Vs(e).ku.add(t),t.next()},t.next=3,yy(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.Dc(),e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Vs(e).ku.delete(t)},t.next=3,yy(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(Hy(e=Ny(e,Wy)),Vy(t)?t:{next:t})}function dk(e,t){return function(e,t){var n=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function r(){return Dt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=am,r.next=3,gy(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Hy(e),t)}function pk(e,t,n){var r=n.docs.get(t._key),a=new ok(e);return new tk(e,a,t._key,r,new ek(n.hasPendingWrites,n.fromCache),t.converter)}var vk={maxAttempts:5},gk=function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=cb(t)}return(0,v.Z)(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=mk(e,this._firestore),a=Jb(r.converter,t,n),i=lb(this._dataReader,"WriteBatch.set",r._key,a,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,Oh.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,a=mk(e,this._firestore),i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return r="string"==typeof(t=Et(t))||t instanceof eb?yb(this._dataReader,"WriteBatch.update",a._key,t,n,o):mb(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(r.toMutation(a._key,Oh.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=mk(e,this._firestore);return this._mutations=this._mutations.concat(new Yh(t._key,Oh.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new Ws(js.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function mk(e,t){if((e=Et(e)).firestore!==t)throw new Ws(js.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var yk=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r))._firestore=e,a}return(0,v.Z)(n,[{key:"get",value:function(e){var t=this,r=mk(e,this._firestore),a=new ok(this._firestore);return sr((0,y.Z)(n.prototype),"get",this).call(this,e).then((function(e){return new tk(t._firestore,a,r._key,e._document,new ek(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._transaction=n,this._dataReader=cb(t)}return(0,v.Z)(e,[{key:"get",value:function(e){var t=this,n=mk(e,this._firestore),r=new $b(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Bs();var a=e[0];if(a.isFoundDocument())return new Nb(t._firestore,r,a.key,a,n.converter);if(a.isNoDocument())return new Nb(t._firestore,r,n._key,null,n.converter);throw Bs()}))}},{key:"set",value:function(e,t,n){var r=mk(e,this._firestore),a=Jb(r.converter,t,n),i=lb(this._dataReader,"Transaction.set",r._key,a,null!==r.converter,n);return this._transaction.set(r._key,i),this}},{key:"update",value:function(e,t,n){for(var r,a=mk(e,this._firestore),i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return r="string"==typeof(t=Et(t))||t instanceof eb?yb(this._dataReader,"Transaction.update",a._key,t,n,o):mb(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,r),this}},{key:"delete",value:function(e){var t=mk(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function bk(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new pb("arrayUnion",t)}function kk(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new vb("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Ms=e}(En),xn(new Mt("firestore",(function(e,n){var r=n.instanceIdentifier,a=n.options,i=e.getProvider("app").getImmediate(),o=new Wy(new Ys(e.getProvider("auth-internal")),new $s(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ws(js.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pc(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),o._setSettings(a),o}),"PUBLIC").setMultipleInstances(!0)),On(As,"3.12.2",e),On(As,"3.12.2","esm2017")}();function xk(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Ws("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function wk(){if("undefined"===typeof Uint8Array)throw new Ws("unimplemented","Uint8Arrays are not available in this environment.")}function Ik(){if("undefined"==typeof atob)throw new Ws("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Sk=function(){function e(t){(0,p.Z)(this,e),this._delegate=t}return(0,v.Z)(e,[{key:"toBase64",value:function(){return Ik(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return wk(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return Ik(),new e($y.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return wk(),new e($y.fromUint8Array(t))}}]),e}();function Ck(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,a=(0,C.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i in r&&"function"===typeof r[i])return!0}}catch(o){a.e(o)}finally{a.f()}return!1}(e,["next","error","complete"])}var _k=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){Jy(e=Ny(e,Wy));var n=Hy(e);if(n._uninitializedComponentsProvider)throw new Ws(js.FAILED_PRECONDITION,"SDK cache is already specified.");Zs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var r=e._freezeSettings(),a=new Qm;return qy(n,a,new Ym(a,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){Jy(e=Ny(e,Wy));var t=Hy(e);if(t._uninitializedComponentsProvider)throw new Ws(js.FAILED_PRECONDITION,"SDK cache is already specified.");Zs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");var n=e._freezeSettings(),r=new Qm;return qy(t,r,new Xm(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new Ws(js.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new Hs;return e._queue.enqueueAndForgetEvenWhileRestricted(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Tu.D()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,Tu.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(jp(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),Tk=function(){function e(t,n,r){var a=this;(0,p.Z)(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return a.terminate()}},t instanceof Pc||(this._appCompat=t)}return(0,v.Z)(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Zs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};My(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return Ky(this._delegate)}},{key:"disableNetwork",value:function(){return Yy(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&Cy("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){var t=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=vm,n.next=3,gy(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(Hy(Ny(this._delegate,Wy)))}},{key:"onSnapshotsInSync",value:function(e){return fk(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new Ws("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new Uk(this,Ly(this._delegate,e))}catch(t){throw Mk(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new Rk(this,Zy(this._delegate,e))}catch(t){throw Mk(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new Zk(this,function(e,t){if(e=Ny(e,Ry),Sy("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Ws(js.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new Fy(e,null,function(e){return new zl(uu.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw Mk(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return function(e,t,n){e=Ny(e,Wy);var r=Object.assign(Object.assign({},vk),n);return function(e){if(e.maxAttempts<1)throw new Ws(js.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new Hs;return e.asyncQueue.enqueueAndForget(Rt(Dt().mark((function a(){var i;return Dt().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,my(e);case 2:i=a.sent,new ny(e.asyncQueue,i,n,t,r).run();case 4:case"end":return a.stop()}}),a)})))),r.promise}(Hy(e),(function(n){return t(new yk(e,n))}),r)}(this._delegate,(function(n){return e(new Nk(t,n))}))}},{key:"batch",value:function(){var e=this;return Hy(this._delegate),new Dk(new gk(this._delegate,(function(t){return dk(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return Xy(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return Qy(this._delegate,e).then((function(e){return e?new Zk(t,e):null}))}}]),e}(),Ek=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).firestore=e,r}return(0,v.Z)(n,[{key:"convertBytes",value:function(e){return new Sk(new $y(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return Rk.forKey(t,this.firestore,null)}}]),n}(Qb);var Nk=function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new Ek(t)}return(0,v.Z)(e,[{key:"get",value:function(e){var t=this,n=Vk(e);return this._delegate.get(n).then((function(e){return new Pk(t._firestore,new tk(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=Vk(e);return n?(xk("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),i=3;i<r;i++)a[i-3]=arguments[i];var o,s=Vk(e);2===arguments.length?this._delegate.update(s,t):(o=this._delegate).update.apply(o,[s,t,n].concat(a));return this}},{key:"delete",value:function(e){var t=Vk(e);return this._delegate.delete(t),this}}]),e}(),Dk=function(){function e(t){(0,p.Z)(this,e),this._delegate=t}return(0,v.Z)(e,[{key:"set",value:function(e,t,n){var r=Vk(e);return n?(xk("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,a=new Array(r>3?r-3:0),i=3;i<r;i++)a[i-3]=arguments[i];var o,s=Vk(e);2===arguments.length?this._delegate.update(s,t):(o=this._delegate).update.apply(o,[s,t,n].concat(a));return this}},{key:"delete",value:function(e){var t=Vk(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),Ak=function(){function e(t,n,r){(0,p.Z)(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return(0,v.Z)(e,[{key:"fromFirestore",value:function(e,t){var n=new nk(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Lk(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,a=r.get(t);a||(a=new WeakMap,r.set(t,a));var i=a.get(n);return i||(i=new e(t,new Ek(t),n),a.set(n,i)),i}}]),e}();Ak.INSTANCES=new WeakMap;var Rk=function(){function e(t,n){(0,p.Z)(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new Ek(t)}return(0,v.Z)(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new Uk(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new Uk(this.firestore,Ly(this._delegate,e))}catch(t){throw Mk(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=Et(e))instanceof Oy&&zy(this._delegate,e)}},{key:"set",value:function(e,t){t=xk("DocumentReference.set",t);try{return t?ck(this._delegate,e,t):ck(this._delegate,e)}catch(n){throw Mk(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];try{return 1===arguments.length?lk(this._delegate,e):lk.apply(void 0,[this._delegate,e,t].concat(r))}catch(i){throw Mk(i,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return dk(Ny((e=this._delegate).firestore,Wy),[new Yh(e._key,Oh.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=Ok(n),i=Fk(n,(function(t){return new Pk(e.firestore,new tk(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return hk(this._delegate,a,i)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?sk(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Ny(e,Oy);var t=Ny(e.firestore,Wy);return ky(Hy(t),e._key,{source:"server"}).then((function(n){return pk(t,e,n)}))}(this._delegate):function(e){e=Ny(e,Oy);var t=Ny(e.firestore,Wy);return ky(Hy(t),e._key).then((function(n){return pk(t,e,n)}))}(this._delegate)).then((function(e){return new Pk(t.firestore,new tk(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(Ak.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new Ws("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new Oy(n._delegate,r,new hu(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new Oy(n._delegate,r,t))}}]),e}();function Mk(e,t,n){return e.message=e.message.replace(t,n),e}function Ok(e){var t,n=(0,C.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!Ck(r))return r}}catch(a){n.e(a)}finally{n.f()}return{}}function Fk(e,t){var n,r,a;return{next:function(e){a.next&&a.next(t(e))},error:null===(n=(a=Ck(e[0])?e[0]:Ck(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(a),complete:null===(r=a.complete)||void 0===r?void 0:r.bind(a)}}var Pk=function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._delegate=n}return(0,v.Z)(e,[{key:"ref",get:function(){return new Rk(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return ik(this._delegate,e._delegate)}}]),e}(),Lk=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||Bs(),t}}]),n}(Pk),Zk=function(){function e(t,n){(0,p.Z)(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new Ek(t)}return(0,v.Z)(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,Fb(this._delegate,function(e,t,n){var r=t,a=Ab("where",e);return Pb._create(a,r,n)}(t,n,r)))}catch(a){throw Mk(a,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,Fb(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Ab("orderBy",e);return Zb._create(n,t)}(t,n)))}catch(r){throw Mk(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,Fb(this._delegate,(Dy("limit",n=t),zb._create("limit",n,"F"))))}catch(r){throw Mk(r,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,Fb(this._delegate,(Dy("limitToLast",n=t),zb._create("limitToLast",n,"L"))))}catch(r){throw Mk(r,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){try{return new e(this.firestore,Fb(this._delegate,Ub.apply(void 0,arguments)))}catch(t){throw Mk(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,Fb(this._delegate,Vb.apply(void 0,arguments)))}catch(t){throw Mk(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,Fb(this._delegate,Wb.apply(void 0,arguments)))}catch(t){throw Mk(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,Fb(this._delegate,Hb.apply(void 0,arguments)))}catch(t){throw Mk(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return By(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null===e||void 0===e?void 0:e.source)?uk(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Ny(e,Fy);var t=Ny(e.firestore,Wy),n=Hy(t),r=new ok(t);return xy(n,e._query,{source:"server"}).then((function(n){return new rk(t,r,e,n)}))}(this._delegate):function(e){e=Ny(e,Fy);var t=Ny(e.firestore,Wy),n=Hy(t),r=new ok(t);return Rb(e._query),xy(n,e._query).then((function(n){return new rk(t,r,e,n)}))}(this._delegate)).then((function(e){return new Bk(t.firestore,new rk(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=Ok(n),i=Fk(n,(function(t){return new Bk(e.firestore,new rk(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return hk(this._delegate,a,i)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(Ak.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),zk=function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._delegate=n}return(0,v.Z)(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new Lk(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),Bk=function(){function e(t,n){(0,p.Z)(this,e),this._firestore=t,this._delegate=n}return(0,v.Z)(e,[{key:"query",get:function(){return new Zk(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new Lk(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new zk(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new Lk(n._firestore,r))}))}},{key:"isEqual",value:function(e){return ik(this._delegate,e._delegate)}}]),e}(),Uk=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r)).firestore=e,a._delegate=r,a}return(0,v.Z)(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new Rk(this.firestore,e):null}},{key:"doc",value:function(e){try{return new Rk(this.firestore,void 0===e?Zy(this._delegate):Zy(this._delegate,e))}catch(t){throw Mk(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=Ny(e.firestore,Wy),r=Zy(e),a=Jb(e.converter,t);return dk(n,[lb(cb(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Oh.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new Rk(t.firestore,e)}))}},{key:"isEqual",value:function(e){return zy(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(Ak.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(Zk);function Vk(e){return Ny(e,Oy)}var jk,Wk=function(){function e(){(0,p.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=x(eb,n)}return(0,v.Z)(e,[{key:"isEqual",value:function(e){return(e=Et(e))instanceof eb&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(lu.keyField().canonicalString())}}]),e}(),Hk=function(){function e(t){(0,p.Z)(this,e),this._delegate=t}return(0,v.Z)(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new db("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new hb("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=bk.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=kk.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=new gb("increment",t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),Gk={Firestore:Tk,GeoPoint:nb,Timestamp:iu,Blob:Sk,Transaction:Nk,WriteBatch:Dk,DocumentReference:Rk,DocumentSnapshot:Pk,Query:Zk,QueryDocumentSnapshot:Lk,QuerySnapshot:Bk,CollectionReference:Uk,FieldPath:Wk,FieldValue:Hk,setLogLevel:function(e){var t;t=e,Os.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(function(e,t){e.INTERNAL.registerComponent(new Mt("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},Gk)))})(jk=or,(function(e,t){return new Tk(e,t,new _k)})),jk.registerVersion("@firebase/firestore-compat","0.3.11");function qk(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;var Kk,Yk={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Xk="EMAIL_SIGNIN",Qk="PASSWORD_RESET",Jk="RECOVER_EMAIL",$k="REVERT_SECOND_FACTOR_ADDITION",ex="VERIFY_AND_CHANGE_EMAIL",tx="VERIFY_EMAIL";function nx(){return(0,Ye.Z)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var rx=function(){var e;return e={},(0,Ye.Z)(e,"admin-restricted-operation","This operation is restricted to administrators only."),(0,Ye.Z)(e,"argument-error",""),(0,Ye.Z)(e,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),(0,Ye.Z)(e,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),(0,Ye.Z)(e,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),(0,Ye.Z)(e,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),(0,Ye.Z)(e,"cordova-not-ready","Cordova framework is not ready."),(0,Ye.Z)(e,"cors-unsupported","This browser is not supported."),(0,Ye.Z)(e,"credential-already-in-use","This credential is already associated with a different user account."),(0,Ye.Z)(e,"custom-token-mismatch","The custom token corresponds to a different audience."),(0,Ye.Z)(e,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),(0,Ye.Z)(e,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),(0,Ye.Z)(e,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),(0,Ye.Z)(e,"email-change-needs-verification","Multi-factor users must always have a verified email."),(0,Ye.Z)(e,"email-already-in-use","The email address is already in use by another account."),(0,Ye.Z)(e,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),(0,Ye.Z)(e,"expired-action-code","The action code has expired."),(0,Ye.Z)(e,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),(0,Ye.Z)(e,"internal-error","An internal AuthError has occurred."),(0,Ye.Z)(e,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),(0,Ye.Z)(e,"invalid-app-id","The mobile app identifier is not registed for the current project."),(0,Ye.Z)(e,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),(0,Ye.Z)(e,"invalid-auth-event","An internal AuthError has occurred."),(0,Ye.Z)(e,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),(0,Ye.Z)(e,"invalid-continue-uri","The continue URL provided in the request is invalid."),(0,Ye.Z)(e,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),(0,Ye.Z)(e,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),(0,Ye.Z)(e,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),(0,Ye.Z)(e,"invalid-email","The email address is badly formatted."),(0,Ye.Z)(e,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),(0,Ye.Z)(e,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),(0,Ye.Z)(e,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),(0,Ye.Z)(e,"invalid-credential","The supplied auth credential is malformed or has expired."),(0,Ye.Z)(e,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),(0,Ye.Z)(e,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),(0,Ye.Z)(e,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),(0,Ye.Z)(e,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),(0,Ye.Z)(e,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),(0,Ye.Z)(e,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),(0,Ye.Z)(e,"wrong-password","The password is invalid or the user does not have a password."),(0,Ye.Z)(e,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),(0,Ye.Z)(e,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),(0,Ye.Z)(e,"invalid-provider-id","The specified provider ID is invalid."),(0,Ye.Z)(e,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),(0,Ye.Z)(e,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),(0,Ye.Z)(e,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),(0,Ye.Z)(e,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),(0,Ye.Z)(e,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),(0,Ye.Z)(e,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),(0,Ye.Z)(e,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),(0,Ye.Z)(e,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),(0,Ye.Z)(e,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),(0,Ye.Z)(e,"missing-continue-uri","A continue URL must be provided in the request."),(0,Ye.Z)(e,"missing-iframe-start","An internal AuthError has occurred."),(0,Ye.Z)(e,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),(0,Ye.Z)(e,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),(0,Ye.Z)(e,"missing-password","A non-empty password must be provided"),(0,Ye.Z)(e,"missing-multi-factor-info","No second factor identifier is provided."),(0,Ye.Z)(e,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),(0,Ye.Z)(e,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),(0,Ye.Z)(e,"missing-verification-id","The phone auth credential was created with an empty verification ID."),(0,Ye.Z)(e,"app-deleted","This instance of FirebaseApp has been deleted."),(0,Ye.Z)(e,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),(0,Ye.Z)(e,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),(0,Ye.Z)(e,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),(0,Ye.Z)(e,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),(0,Ye.Z)(e,"no-auth-event","An internal AuthError has occurred."),(0,Ye.Z)(e,"no-such-provider","User was not linked to an account with the given provider."),(0,Ye.Z)(e,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),(0,Ye.Z)(e,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),(0,Ye.Z)(e,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),(0,Ye.Z)(e,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),(0,Ye.Z)(e,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),(0,Ye.Z)(e,"provider-already-linked","User can only be linked to one identity for the given provider."),(0,Ye.Z)(e,"quota-exceeded","The project's quota for this operation has been exceeded."),(0,Ye.Z)(e,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),(0,Ye.Z)(e,"redirect-operation-pending","A redirect sign-in operation is already pending."),(0,Ye.Z)(e,"rejected-credential","The request contains malformed or mismatching credentials."),(0,Ye.Z)(e,"second-factor-already-in-use","The second factor is already enrolled on this account."),(0,Ye.Z)(e,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),(0,Ye.Z)(e,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),(0,Ye.Z)(e,"timeout","The operation has timed out."),(0,Ye.Z)(e,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),(0,Ye.Z)(e,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),(0,Ye.Z)(e,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),(0,Ye.Z)(e,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),(0,Ye.Z)(e,"unsupported-persistence-type","The current environment does not support the specified persistence type."),(0,Ye.Z)(e,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),(0,Ye.Z)(e,"unverified-email","The operation requires a verified email."),(0,Ye.Z)(e,"user-cancelled","The user did not grant your application the permissions it requested."),(0,Ye.Z)(e,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),(0,Ye.Z)(e,"user-disabled","The user account has been disabled by an administrator."),(0,Ye.Z)(e,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),(0,Ye.Z)(e,"user-signed-out",""),(0,Ye.Z)(e,"weak-password","The password must be 6 characters long or more."),(0,Ye.Z)(e,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),(0,Ye.Z)(e,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),(0,Ye.Z)(e,"missing-recaptcha-token","The reCAPTCHA token is missing when sending request to the backend."),(0,Ye.Z)(e,"invalid-recaptcha-token","The reCAPTCHA token is invalid when sending request to the backend."),(0,Ye.Z)(e,"invalid-recaptcha-action","The reCAPTCHA action is invalid when sending request to the backend."),(0,Ye.Z)(e,"recaptcha-not-enabled","reCAPTCHA Enterprise integration is not enabled for this project."),(0,Ye.Z)(e,"missing-client-type","The reCAPTCHA client type is missing when sending request to the backend."),(0,Ye.Z)(e,"missing-recaptcha-version","The reCAPTCHA version is missing when sending request to the backend."),(0,Ye.Z)(e,"invalid-req-type","Invalid request parameters."),(0,Ye.Z)(e,"invalid-recaptcha-version","The reCAPTCHA version is invalid when sending request to the backend."),e},ax=nx,ix=new gt("auth","Firebase",nx()),ox=new Wt("@firebase/auth");function sx(e){if(ox.logLevel<=Lt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ox.warn.apply(ox,["Auth (".concat(En,"): ").concat(e)].concat(n))}}function ux(e){if(ox.logLevel<=Lt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ox.error.apply(ox,["Auth (".concat(En,"): ").concat(e)].concat(n))}}function cx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw dx.apply(void 0,[e].concat(n))}function lx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return dx.apply(void 0,[e].concat(n))}function hx(e,t,n){var r=Object.assign(Object.assign({},ax()),(0,Ye.Z)({},t,n));return new gt("auth","Firebase",r).create(t,{appName:e.name})}function fx(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&cx(e,"argument-error"),hx(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function dx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var a,i=n[0],o=d(n.slice(1));return o[0]&&(o[0].appName=e.name),(a=e._errorFactory).create.apply(a,[i].concat(d(o)))}return ix.create.apply(ix,[e].concat(n))}function px(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw dx.apply(void 0,[t].concat(r))}}function vx(e){var t="INTERNAL ASSERTION FAILED: "+e;throw ux(t),new Error(t)}function gx(e,t){e||vx(t)}function mx(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function yx(){return"http:"===bx()||"https:"===bx()}function bx(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var kx=function(){function e(t,n){(0,p.Z)(this,e),this.shortDelay=t,this.longDelay=n,gx(n>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ct())||ft()}return(0,v.Z)(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(yx()||ht()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function xx(e,t){gx(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var wx=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void vx("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void vx("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void vx("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Ix=(Kk={},(0,Ye.Z)(Kk,"CREDENTIAL_MISMATCH","custom-token-mismatch"),(0,Ye.Z)(Kk,"MISSING_CUSTOM_TOKEN","internal-error"),(0,Ye.Z)(Kk,"INVALID_IDENTIFIER","invalid-email"),(0,Ye.Z)(Kk,"MISSING_CONTINUE_URI","internal-error"),(0,Ye.Z)(Kk,"INVALID_PASSWORD","wrong-password"),(0,Ye.Z)(Kk,"MISSING_PASSWORD","missing-password"),(0,Ye.Z)(Kk,"EMAIL_EXISTS","email-already-in-use"),(0,Ye.Z)(Kk,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),(0,Ye.Z)(Kk,"INVALID_IDP_RESPONSE","invalid-credential"),(0,Ye.Z)(Kk,"INVALID_PENDING_TOKEN","invalid-credential"),(0,Ye.Z)(Kk,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),(0,Ye.Z)(Kk,"MISSING_REQ_TYPE","internal-error"),(0,Ye.Z)(Kk,"EMAIL_NOT_FOUND","user-not-found"),(0,Ye.Z)(Kk,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),(0,Ye.Z)(Kk,"EXPIRED_OOB_CODE","expired-action-code"),(0,Ye.Z)(Kk,"INVALID_OOB_CODE","invalid-action-code"),(0,Ye.Z)(Kk,"MISSING_OOB_CODE","internal-error"),(0,Ye.Z)(Kk,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),(0,Ye.Z)(Kk,"INVALID_ID_TOKEN","invalid-user-token"),(0,Ye.Z)(Kk,"TOKEN_EXPIRED","user-token-expired"),(0,Ye.Z)(Kk,"USER_NOT_FOUND","user-token-expired"),(0,Ye.Z)(Kk,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),(0,Ye.Z)(Kk,"INVALID_CODE","invalid-verification-code"),(0,Ye.Z)(Kk,"INVALID_SESSION_INFO","invalid-verification-id"),(0,Ye.Z)(Kk,"INVALID_TEMPORARY_PROOF","invalid-credential"),(0,Ye.Z)(Kk,"MISSING_SESSION_INFO","missing-verification-id"),(0,Ye.Z)(Kk,"SESSION_EXPIRED","code-expired"),(0,Ye.Z)(Kk,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),(0,Ye.Z)(Kk,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),(0,Ye.Z)(Kk,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),(0,Ye.Z)(Kk,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),(0,Ye.Z)(Kk,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),(0,Ye.Z)(Kk,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),(0,Ye.Z)(Kk,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),(0,Ye.Z)(Kk,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),(0,Ye.Z)(Kk,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),(0,Ye.Z)(Kk,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),(0,Ye.Z)(Kk,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),(0,Ye.Z)(Kk,"RECAPTCHA_NOT_ENABLED","recaptcha-not-enabled"),(0,Ye.Z)(Kk,"MISSING_RECAPTCHA_TOKEN","missing-recaptcha-token"),(0,Ye.Z)(Kk,"INVALID_RECAPTCHA_TOKEN","invalid-recaptcha-token"),(0,Ye.Z)(Kk,"INVALID_RECAPTCHA_ACTION","invalid-recaptcha-action"),(0,Ye.Z)(Kk,"MISSING_CLIENT_TYPE","missing-client-type"),(0,Ye.Z)(Kk,"MISSING_RECAPTCHA_VERSION","missing-recaptcha-version"),(0,Ye.Z)(Kk,"INVALID_RECAPTCHA_VERSION","invalid-recaptcha-version"),(0,Ye.Z)(Kk,"INVALID_REQ_TYPE","invalid-req-type"),Kk),Sx=new kx(3e4,6e4);function Cx(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function _x(e,t,n,r){return Tx.apply(this,arguments)}function Tx(){return Tx=Rt(Dt().mark((function e(t,n,r,a){var i,o=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Ex(t,i,Rt(Dt().mark((function e(){var i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},o={},a&&("GET"===n?o=a:i={body:JSON.stringify(a)}),s=wt(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(u=e.sent)["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",wx.fetch()(Rx(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},i)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Tx.apply(this,arguments)}function Ex(e,t,n){return Nx.apply(this,arguments)}function Nx(){return Nx=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,h,f,d,p;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,a=Object.assign(Object.assign({},Ix),n),e.prev=2,i=new Mx(t),e.next=6,Promise.race([r(),i.promise]);case 6:return o=e.sent,i.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw Ox(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=17;break}return e.abrupt("return",s);case 17:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),h=l(c,2),f=h[0],d=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=23;break}throw Ox(t,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==f){e.next=27;break}throw Ox(t,"email-already-in-use",s);case 27:if("USER_DISABLED"!==f){e.next=29;break}throw Ox(t,"user-disabled",s);case 29:if(p=a[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw hx(t,p,d);case 34:cx(t,p);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof vt)){e.next=41;break}throw e.t0;case 41:cx(t,"network-request-failed",{message:String(e.t0)});case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Nx.apply(this,arguments)}function Dx(e,t,n,r){return Ax.apply(this,arguments)}function Ax(){return Ax=Rt(Dt().mark((function e(t,n,r,a){var i,o,s=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,_x(t,n,r,a,i);case 3:return"mfaPendingCredential"in(o=e.sent)&&cx(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Ax.apply(this,arguments)}function Rx(e,t,n,r){var a="".concat(t).concat(n,"?").concat(r);return e.config.emulator?xx(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}var Mx=function(){function e(t){var n=this;(0,p.Z)(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(lx(n.auth,"network-request-failed"))}),Sx.get())}))}return(0,v.Z)(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Ox(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var a=lx(e,t,r);return a.customData._tokenResponse=n,a}function Fx(e,t){return Px.apply(this,arguments)}function Px(){return(Px=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lx(e,t){return Zx.apply(this,arguments)}function Zx(){return(Zx=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zx(e,t){return Bx.apply(this,arguments)}function Bx(){return(Bx=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ux(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Vx(){return Vx=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=Et(t),e.next=4,r.getIdToken(n);case 4:return a=e.sent,px((i=Wx(a))&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error"),o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:i,token:a,authTime:Ux(jx(i.auth_time)),issuedAtTime:Ux(jx(i.iat)),expirationTime:Ux(jx(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),Vx.apply(this,arguments)}function jx(e){return 1e3*Number(e)}function Wx(e){var t=l(e.split("."),3),n=t[0],r=t[1],a=t[2];if(void 0===n||void 0===r||void 0===a)return ux("JWT malformed, contained fewer than 3 sections"),null;try{var i=rt(r);return i?JSON.parse(i):(ux("Failed to decode base64 JWT payload"),null)}catch(o){return ux("Caught error parsing JWT payload as JSON",null===o||void 0===o?void 0:o.toString()),null}}function Hx(e,t){return Gx.apply(this,arguments)}function Gx(){return Gx=Rt(Dt().mark((function e(t,n){var r=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof vt&&qx(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),Gx.apply(this,arguments)}function qx(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var Kx=function(){function e(t){(0,p.Z)(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return(0,v.Z)(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Yx=function(){function e(t,n){(0,p.Z)(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return(0,v.Z)(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Ux(this.lastLoginAt),this.creationTime=Ux(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function Xx(e){return Qx.apply(this,arguments)}function Qx(){return Qx=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,e.next=6,Hx(t,zx(r,{idToken:a}));case 6:px(null===(i=e.sent)||void 0===i?void 0:i.users.length,r,"internal-error"),o=i.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?o.providerUserInfo.map((function(e){var t=e.providerId,n=qk(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],u=$x(t.providerData,s),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===u||void 0===u?void 0:u.length),h=!!c&&l,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Yx(o.createdAt,o.lastLoginAt),isAnonymous:h},Object.assign(t,f);case 17:case"end":return e.stop()}}),e)}))),Qx.apply(this,arguments)}function Jx(){return(Jx=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Et(t),e.next=3,Xx(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $x(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(d(n),d(t))}function ew(e,t){return tw.apply(this,arguments)}function tw(){return(tw=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ex(t,{},Rt(Dt().mark((function e(){var r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=wt({grant_type:"refresh_token",refresh_token:n}).slice(1),a=t.config,i=a.tokenApiHost,o=a.apiKey,s=Rx(t,i,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(u=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",wx.fetch()(s,{method:"POST",headers:u,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var nw=function(){function e(){(0,p.Z)(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return(0,v.Z)(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){px(e.idToken,"internal-error"),px("undefined"!==typeof e.idToken,"internal-error"),px("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=Wx(e);return px(t,"internal-error"),px("undefined"!==typeof t.exp,"internal-error"),px("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=Rt(Dt().mark((function e(t){var n,r=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],px(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ew(t,n);case 2:r=e.sent,a=r.accessToken,i=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(a,i,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return vx("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,a=n.accessToken,i=n.expirationTime,o=new e;return r&&(px("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),a&&(px("string"===typeof a,"internal-error",{appName:t}),o.accessToken=a),i&&(px("number"===typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}}]),e}();function rw(e,t){px("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var aw=function(){function e(t){(0,p.Z)(this,e);var n=t.uid,r=t.auth,a=t.stsTokenManager,i=qk(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Kx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?d(i.providerData):[],this.metadata=new Yx(i.createdAt||void 0,i.lastLoginAt||void 0)}return(0,v.Z)(e,[{key:"getIdToken",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hx(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(px(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return Vx.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return Jx.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(px(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){var n=new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}},{key:"_onReload",value:function(e){px(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,Xx(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,Hx(this,Fx(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,a,i,o,s,u,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(a=n.email)&&void 0!==a?a:void 0,d=null!==(i=n.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,y=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,k=n.emailVerified,x=n.isAnonymous,w=n.providerData,I=n.stsTokenManager;px(b&&I,t,"internal-error");var S=nw.fromJSON(this.name,I);px("string"===typeof b,t,"internal-error"),rw(h,t.name),rw(f,t.name),px("boolean"===typeof k,t,"internal-error"),px("boolean"===typeof x,t,"internal-error"),rw(d,t.name),rw(p,t.name),rw(v,t.name),rw(g,t.name),rw(m,t.name),rw(y,t.name);var C=new e({uid:b,auth:t,email:f,emailVerified:k,displayName:h,isAnonymous:x,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:S,createdAt:m,lastLoginAt:y});return w&&Array.isArray(w)&&(C.providerData=w.map((function(e){return Object.assign({},e)}))),g&&(C._redirectEventId=g),C}},{key:"_fromIdTokenResponse",value:function(){var t=Rt(Dt().mark((function t(n,r){var a,i,o,s=arguments;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],(i=new nw).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:i,isAnonymous:a}),t.next=6,Xx(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),iw=new Map;function ow(e){gx(e instanceof Function,"Expected a class definition");var t=iw.get(e);return t?(gx(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,iw.set(e,t),t)}var sw=function(){function e(){(0,p.Z)(this,e),this.type="NONE",this.storage={}}return(0,v.Z)(e,[{key:"_isAvailable",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();sw.type="NONE";var uw=sw;function cw(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var lw=function(){function e(t,n,r){(0,p.Z)(this,e),this.persistence=t,this.auth=n,this.userKey=r;var a=this.auth,i=a.config,o=a.name;this.fullUserKey=cw(this.userKey,i.apiKey,o),this.fullPersistenceKey=cw("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return(0,v.Z)(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?aw._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=Rt(Dt().mark((function t(n,r){var a,i,o,s,u,c,l,h,f,d,p,v=arguments;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(ow(uw),n,a));case 3:return t.next=5,Promise.all(r.map(function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:i=t.sent.filter((function(e){return e})),o=i[0]||ow(uw),s=cw(a,n.config.apiKey,n.name),u=null,c=(0,C.Z)(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return h=l.value,t.prev=14,t.next=17,h._get(s);case 17:if(!(f=t.sent)){t.next=23;break}return d=aw._fromJSON(n,f),h!==o&&(u=d),o=h,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(p=i.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&p.length){t.next=40;break}return t.abrupt("return",new e(o,n,a));case 40:if(o=p[0],!u){t.next=44;break}return t.next=44,o._set(s,u.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,a));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function hw(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(vw(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fw(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(mw(t))return"Blackberry";if(yw(t))return"Webos";if(dw(t))return"Safari";if((t.includes("chrome/")||pw(t))&&!t.includes("edge/"))return"Chrome";if(gw(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function fw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/firefox\//i.test(e)}function dw(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/crios\//i.test(e)}function vw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/iemobile/i.test(e)}function gw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/android/i.test(e)}function mw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/blackberry/i.test(e)}function yw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/webos/i.test(e)}function bw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function kw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return bw(e)||gw(e)||yw(e)||mw(e)||/windows phone/i.test(e)||vw(e)}function xw(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=hw(ct());break;case"Worker":t="".concat(hw(ct()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(En,"/").concat(r)}function ww(e){return Iw.apply(this,arguments)}function Iw(){return(Iw=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_x(t,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sw(e,t){return Cw.apply(this,arguments)}function Cw(){return(Cw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"GET","/v2/recaptchaConfig",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _w(e){return void 0!==e&&void 0!==e.getResponse}function Tw(e){return void 0!==e&&void 0!==e.enterprise}var Ew=(0,v.Z)((function e(t){if((0,p.Z)(this,e),this.siteKey="",this.emailPasswordEnabled=!1,void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.emailPasswordEnabled=t.recaptchaEnforcementState.some((function(e){return"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState}))}));function Nw(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=lx("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Dw(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var Aw=function(){function e(t){(0,p.Z)(this,e),this.type="recaptcha-enterprise",this.auth=Pw(t)}return(0,v.Z)(e,[{key:"verify",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o=this,s=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e,n,r){var a=window.grecaptcha;Tw(a)?a.enterprise.ready((function(){a.enterprise.execute(e,{action:t}).then((function(e){n(e)})).catch((function(){n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))},a=function(){return a=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}if(null!=t.tenantId||null==t._agentRecaptchaConfig){e.next=3;break}return e.abrupt("return",t._agentRecaptchaConfig.siteKey);case 3:if(null==t.tenantId||void 0===t._tenantRecaptchaConfigs[t.tenantId]){e.next=5;break}return e.abrupt("return",t._tenantRecaptchaConfigs[t.tenantId].siteKey);case 5:return e.abrupt("return",new Promise(function(){var e=Rt(Dt().mark((function e(n,r){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Sw(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((function(e){if(void 0!==e.recaptchaKey){var a=new Ew(e);return null==t.tenantId?t._agentRecaptchaConfig=a:t._tenantRecaptchaConfigs[t.tenantId]=a,n(a.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((function(e){r(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)},r=function(e){return a.apply(this,arguments)},t=s.length>0&&void 0!==s[0]?s[0]:"verify",n=s.length>1&&void 0!==s[1]&&s[1],e.abrupt("return",new Promise((function(e,t){r(o.auth).then((function(r){if(!n&&Tw(window.grecaptcha))i(r,e,t);else{if("undefined"===typeof window)return void t(new Error("RecaptchaVerifier is only supported in browser"));Nw("https://www.google.com/recaptcha/enterprise.js?render="+r).then((function(){i(r,e,t)})).catch((function(e){t(e)}))}})).catch((function(e){t(e)}))})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Rw(e,t,n){return Mw.apply(this,arguments)}function Mw(){return Mw=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>3&&void 0!==u[3]&&u[3],i=new Aw(t),e.prev=2,e.next=5,i.verify(r);case 5:o=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),e.next=12,i.verify(r,!0);case 12:o=e.sent;case 13:return s=Object.assign({},n),a?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,null,[[2,8]])}))),Mw.apply(this,arguments)}var Ow=function(){function e(t){(0,p.Z)(this,e),this.auth=t,this.queue=[]}return(0,v.Z)(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(a){r(a)}}))};r.onAbort=t,this.queue.push(r);var a=this.queue.length-1;return function(){n.queue[a]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=(0,C.Z)(this.queue),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=14;break}return i=a.value,e.next=11,i(t);case 11:i.onAbort&&n.push(i.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),o=(0,C.Z)(n);try{for(o.s();!(s=o.n()).done;){u=s.value;try{u()}catch(c){}}}catch(l){o.e(l)}finally{o.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Fw=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Lw(this),this.idTokenSubscription=new Lw(this),this.beforeStateQueue=new Ow(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ix,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=a.sdkClientVersion}return(0,v.Z)(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=ow(t)),this._initializationPromise=this.queue(Rt(Dt().mark((function r(){var a,i;return Dt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,lw.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,a=r,i=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===a||void 0===a?void 0:a._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:u=e.sent,o&&o!==s||!(null===u||void 0===u?void 0:u.user)||(a=u.user,i=!0);case 14:if(a){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(a._redirectEventId){e.next=32;break}if(!i){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(a);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),a=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!a){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return px(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xx(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?Et(t):null)&&px(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=Rt(Dt().mark((function e(t){var n,r=this,a=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&px(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(ow(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"initializeRecaptchaConfig",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sw(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"});case 2:t=e.sent,n=new Ew(t),null==this.tenantId?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new Aw(this).verify();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getRecaptchaConfig",value:function(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new gt("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return px(n=t&&ow(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,lw.create(this,[ow(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=Rt(Dt().mark((function e(t){var n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var a=this;if(this._deleted)return function(){};var i="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return px(o,this,"internal-error"),o.then((function(){return i(a.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return px(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xw(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,Ye.Z)({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.next=8,this._getAppCheckToken();case 8:return(a=e.sent)&&(n["X-Firebase-AppCheck"]=a),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();case 2:return(null===(n=e.sent)||void 0===n?void 0:n.error)&&sx("Error while retrieving App Check token: ".concat(n.error)),e.abrupt("return",null===n||void 0===n?void 0:n.token);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Pw(e){return Et(e)}var Lw=function(){function e(t){var n=this;(0,p.Z)(this,e),this.auth=t,this.observer=null,this.addObserver=Ct((function(e){return n.observer=e}))}return(0,v.Z)(e,[{key:"next",get:function(){return px(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function Zw(e,t,n){var r=Pw(e);px(r._canInitEmulator,r,"emulator-config-failed"),px(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=zw(t),o=function(e){var t=zw(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){var i=a[1];return{host:i,port:Bw(r.substr(i.length+1))}}var o=l(r.split(":"),2);return{host:o[0],port:Bw(o[1])}}(t),s=o.host,u=o.port,c=null===u?"":":".concat(u);r.config.emulator={url:"".concat(i,"//").concat(s).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function zw(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Bw(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Uw=function(){function e(t,n){(0,p.Z)(this,e),this.providerId=t,this.signInMethod=n}return(0,v.Z)(e,[{key:"toJSON",value:function(){return vx("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return vx("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return vx("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return vx("not implemented")}}]),e}();function Vw(e,t){return jw.apply(this,arguments)}function jw(){return(jw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:resetPassword",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ww(e,t){return Hw.apply(this,arguments)}function Hw(){return(Hw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gw(e,t){return qw.apply(this,arguments)}function qw(){return(qw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:update",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kw(e,t){return Yw.apply(this,arguments)}function Yw(){return(Yw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithPassword",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xw(e,t){return Qw.apply(this,arguments)}function Qw(){return(Qw=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:sendOobCode",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jw(e,t){return $w.apply(this,arguments)}function $w(){return($w=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xw(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eI(e,t){return tI.apply(this,arguments)}function tI(){return(tI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xw(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nI(e,t){return rI.apply(this,arguments)}function rI(){return(rI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xw(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aI(e,t){return iI.apply(this,arguments)}function iI(){return(iI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xw(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oI(e,t){return sI.apply(this,arguments)}function sI(){return(sI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithEmailLink",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uI(e,t){return cI.apply(this,arguments)}function cI(){return(cI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithEmailLink",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var lI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,p.Z)(this,n),(i=t.call(this,"password",a))._email=e,i._password=r,i._tenantId=o,i}return(0,v.Z)(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?12:13;break;case 3:if(r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},!(null===(n=t._getRecaptchaConfig())||void 0===n?void 0:n.emailPasswordEnabled)){e.next=11;break}return e.next=7,Rw(t,r,"signInWithPassword");case 7:return a=e.sent,e.abrupt("return",Kw(t,a));case 11:return e.abrupt("return",Kw(t,r).catch(function(){var e=Rt(Dt().mark((function e(n){var a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow."),e.next=4,Rw(t,r,"signInWithPassword");case 4:return a=e.sent,e.abrupt("return",Kw(t,a));case 8:return e.abrupt("return",Promise.reject(n));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return e.abrupt("return",oI(t,{email:this._email,oobCode:this._password}));case 13:cx(t,"internal-error");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Ww(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",uI(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:cx(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){return new n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Uw);function hI(e,t){return fI.apply(this,arguments)}function fI(){return(fI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithIdp",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return(0,v.Z)(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return hI(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,hI(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,hI(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wt(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):cx("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,a=t.signInMethod,i=qk(t,["providerId","signInMethod"]);if(!r||!a)return null;var o=new n(r,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}}]),n}(Uw);function pI(e,t){return vI.apply(this,arguments)}function vI(){return(vI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:sendVerificationCode",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gI(){return(gI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithPhoneNumber",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mI(){return(mI=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dx(t,"POST","/v1/accounts:signInWithPhoneNumber",Cx(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Ox(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yI=(0,Ye.Z)({},"USER_NOT_FOUND","user-not-found");function bI(){return(bI=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithPhoneNumber",Cx(t,r),yI));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var kI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,"phone","phone")).params=e,r}return(0,v.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return gI.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return mI.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return bI.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,a=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:a}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,a=t.verificationCode,i=t.phoneNumber,o=t.temporaryProof;return a||r||i||o?new n({verificationId:r,verificationCode:a,phoneNumber:i,temporaryProof:o}):null}}]),n}(Uw);var xI=function(){function e(t){var n,r,a,i,o,s;(0,p.Z)(this,e);var u=It(St(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=u.mode)&&void 0!==a?a:null);px(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return(0,v.Z)(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=It(St(e)).link,n=t?It(St(t)).deep_link_id:null,r=It(St(e)).deep_link_id;return(r?It(St(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(zm){return null}}}]),e}();var wI=function(){function e(){(0,p.Z)(this,e),this.providerId=e.PROVIDER_ID}return(0,v.Z)(e,null,[{key:"credential",value:function(e,t){return lI._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=xI.parseLink(t);return px(n,"argument-error"),lI._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();wI.PROVIDER_ID="password",wI.EMAIL_PASSWORD_SIGN_IN_METHOD="password",wI.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var II=function(){function e(t){(0,p.Z)(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return(0,v.Z)(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),SI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).scopes=[],e}return(0,v.Z)(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return d(this.scopes)}}]),n}(II),CI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return px(e.idToken||e.accessToken,"argument-error"),dI._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;return px("providerId"in t&&"signInMethod"in t,"argument-error"),dI._fromParams(t)}},{key:"credentialFromResult",value:function(e){return n.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,a=t.oauthAccessToken,i=t.oauthTokenSecret,o=t.pendingToken,s=t.nonce,u=t.providerId;if(!a&&!i&&!r&&!o)return null;if(!u)return null;try{return new n(u)._credential({idToken:r,accessToken:a,nonce:s,pendingToken:o})}catch(c){return null}}}]),n}(SI),_I=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this,"facebook.com")}return(0,v.Z)(n,null,[{key:"credential",value:function(e){return dI._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(zm){return null}}}]),n}(SI);_I.FACEBOOK_SIGN_IN_METHOD="facebook.com",_I.PROVIDER_ID="facebook.com";var TI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return(0,v.Z)(n,null,[{key:"credential",value:function(e,t){return dI._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,a=t.oauthAccessToken;if(!r&&!a)return null;try{return n.credential(r,a)}catch(zm){return null}}}]),n}(SI);TI.GOOGLE_SIGN_IN_METHOD="google.com",TI.PROVIDER_ID="google.com";var EI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this,"github.com")}return(0,v.Z)(n,null,[{key:"credential",value:function(e){return dI._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(zm){return null}}}]),n}(SI);EI.GITHUB_SIGN_IN_METHOD="github.com",EI.PROVIDER_ID="github.com";var NI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,e)).pendingToken=r,a}return(0,v.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return hI(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,hI(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,hI(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,a=t.signInMethod,i=t.pendingToken;return r&&a&&i&&r===a?new n(r,i):null}},{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Uw),DI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),px(e.startsWith("saml."),"argument-error"),t.call(this,e)}return(0,v.Z)(n,null,[{key:"credentialFromResult",value:function(e){return n.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=NI.fromJSON(e);return px(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return NI._create(r,n)}catch(a){return null}}}]),n}(II),AI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this,"twitter.com")}return(0,v.Z)(n,null,[{key:"credential",value:function(e,t){return dI._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,a=t.oauthTokenSecret;if(!r||!a)return null;try{return n.credential(r,a)}catch(zm){return null}}}]),n}(SI);function RI(e,t){return MI.apply(this,arguments)}function MI(){return(MI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signUp",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}AI.TWITTER_SIGN_IN_METHOD="twitter.com",AI.PROVIDER_ID="twitter.com";var OI=function(){function e(t){(0,p.Z)(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return(0,v.Z)(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=Rt(Dt().mark((function t(n,r,a){var i,o,s,u,c=arguments;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],t.next=3,aw._fromIdTokenResponse(n,a,i);case 3:return o=t.sent,s=FI(a),u=new e({user:o,providerId:s,_tokenResponse:a,operationType:r}),t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=Rt(Dt().mark((function t(n,r,a){var i;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(a,!0);case 2:return i=FI(a),t.abrupt("return",new e({user:n,providerId:i,_tokenResponse:a,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function FI(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function PI(){return PI=Rt(Dt().mark((function e(t){var n,r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.next=3,r._initializationPromise;case 3:if(!(null===(n=r.currentUser)||void 0===n?void 0:n.isAnonymous)){e.next=5;break}return e.abrupt("return",new OI({user:r.currentUser,providerId:null,operationType:"signIn"}));case 5:return e.next=7,RI(r,{returnSecureToken:!0});case 7:return a=e.sent,e.next=10,OI._fromIdTokenResponse(r,"signIn",a,!0);case 10:return i=e.sent,e.next=13,r._updateCurrentUser(i.user);case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e)}))),PI.apply(this,arguments)}var LI=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o,s;return(0,p.Z)(this,n),(o=t.call(this,r.code,r.message)).operationType=a,o.user=i,Object.setPrototypeOf((0,Je.Z)(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:a},o}return(0,v.Z)(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,a){return new n(e,t,r,a)}}]),n}(vt);function ZI(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw LI._fromErrorAndOperation(e,n,t,r);throw n}))}function zI(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function BI(e,t){return UI.apply(this,arguments)}function UI(){return UI=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Et(t),e.next=3,WI(!0,r,n);case 3:return e.t0=Lx,e.t1=r.auth,e.next=7,r.getIdToken();case 7:return e.t2=e.sent,e.t3=[n],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return a=e.sent,i=a.providerUserInfo,o=zI(i||[]),r.providerData=r.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(r.phoneNumber=null),e.next=19,r.auth._persistUserIfCurrent(r);case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)}))),UI.apply(this,arguments)}function VI(e,t){return jI.apply(this,arguments)}function jI(){return jI=Rt(Dt().mark((function e(t,n){var r,a,i=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],e.t0=Hx,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",OI._forOperation(t,"link",a));case 14:case"end":return e.stop()}}),e)}))),jI.apply(this,arguments)}function WI(e,t,n){return HI.apply(this,arguments)}function HI(){return(HI=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xx(n);case 2:a=zI(n.providerData),i=!1===t?"provider-already-linked":"no-such-provider",px(a.has(r)===t,n.auth,i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function GI(e,t){return qI.apply(this,arguments)}function qI(){return qI=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],a=t.auth,i="reauthenticate",e.prev=3,e.next=6,Hx(t,ZI(a,i,n,t),r);case 6:return px((o=e.sent).idToken,a,"internal-error"),px(s=Wx(o.idToken),a,"internal-error"),u=s.sub,px(t.uid===u,a,"user-mismatch"),e.abrupt("return",OI._forOperation(t,i,o));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&cx(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),qI.apply(this,arguments)}function KI(e,t){return YI.apply(this,arguments)}function YI(){return YI=Rt(Dt().mark((function e(t,n){var r,a,i,o,s=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,ZI(t,a,n);case 4:return i=e.sent,e.next=7,OI._fromIdTokenResponse(t,a,i);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),YI.apply(this,arguments)}function XI(e,t){return QI.apply(this,arguments)}function QI(){return(QI=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",KI(Pw(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function JI(e,t){return $I.apply(this,arguments)}function $I(){return($I=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Et(t),e.next=3,WI(!1,r,n.providerId);case 3:return e.abrupt("return",VI(r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eS(e,t){return tS.apply(this,arguments)}function tS(){return(tS=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",GI(Et(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nS(e,t){return rS.apply(this,arguments)}function rS(){return(rS=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Dx(t,"POST","/v1/accounts:signInWithCustomToken",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aS(){return(aS=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.next=3,nS(r,{token:n,returnSecureToken:!0});case 3:return a=e.sent,e.next=6,OI._fromIdTokenResponse(r,"signIn",a);case 6:return i=e.sent,e.next=9,r._updateCurrentUser(i.user);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var iS=function(){function e(t,n){(0,p.Z)(this,e),this.factorId=t,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}return(0,v.Z)(e,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?oS._fromServerResponse(e,t):"totpInfo"in t?sS._fromServerResponse(e,t):cx(e,"internal-error")}}]),e}(),oS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,"phone",e)).phoneNumber=e.phoneInfo,r}return(0,v.Z)(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(iS),sS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,"totp",e)}return(0,v.Z)(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(iS);function uS(e,t,n){var r;px((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),px("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(px(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(px(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function cS(){return cS=Rt(Dt().mark((function e(t,n,r){var a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Pw(t),o={requestType:"PASSWORD_RESET",email:n,clientType:"CLIENT_TYPE_WEB"},!(null===(a=i._getRecaptchaConfig())||void 0===a?void 0:a.emailPasswordEnabled)){e.next=11;break}return e.next=5,Rw(i,o,"getOobCode",!0);case 5:return s=e.sent,r&&uS(i,s,r),e.next=9,eI(i,s);case 9:e.next=14;break;case 11:return r&&uS(i,o,r),e.next=14,eI(i,o).catch(function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=10;break}return console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow."),e.next=4,Rw(i,o,"getOobCode",!0);case 4:return n=e.sent,r&&uS(i,n,r),e.next=8,eI(i,n);case 8:e.next=11;break;case 10:return e.abrupt("return",Promise.reject(t));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 14:case"end":return e.stop()}}),e)}))),cS.apply(this,arguments)}function lS(){return(lS=Rt(Dt().mark((function e(t,n,r){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vw(Et(t),{oobCode:n,newPassword:r});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hS(){return(hS=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gw(Et(t),{oobCode:n});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fS(e,t){return dS.apply(this,arguments)}function dS(){return(dS=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Et(t),e.next=3,Vw(r,{oobCode:n});case 3:a=e.sent,px(i=a.requestType,r,"internal-error"),e.t0=i,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return px(a.newEmail,r,"internal-error"),e.abrupt("break",14);case 12:px(a.mfaInfo,r,"internal-error");case 13:px(a.email,r,"internal-error");case 14:return o=null,a.mfaInfo&&(o=iS._fromServerResponse(Pw(r),a.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.newEmail:a.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.email:a.newEmail)||null,multiFactorInfo:o},operation:i});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pS(){return(pS=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fS(Et(t),n);case 2:return r=e.sent,a=r.data,e.abrupt("return",a.email);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vS(e,t,n){return gS.apply(this,arguments)}function gS(){return gS=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Pw(t),o={returnSecureToken:!0,email:n,password:r,clientType:"CLIENT_TYPE_WEB"},!(null===(a=i._getRecaptchaConfig())||void 0===a?void 0:a.emailPasswordEnabled)){e.next=9;break}return e.next=5,Rw(i,o,"signUpPassword");case 5:u=e.sent,s=RI(i,u),e.next=10;break;case 9:s=RI(i,o).catch(function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow."),e.next=4,Rw(i,o,"signUpPassword");case 4:return n=e.sent,e.abrupt("return",RI(i,n));case 8:return e.abrupt("return",Promise.reject(t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:return e.next=12,s.catch((function(e){return Promise.reject(e)}));case 12:return c=e.sent,e.next=15,OI._fromIdTokenResponse(i,"signIn",c);case 15:return l=e.sent,e.next=18,i._updateCurrentUser(l.user);case 18:return e.abrupt("return",l);case 19:case"end":return e.stop()}}),e)}))),gS.apply(this,arguments)}function mS(){return mS=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(e,t){px(t.handleCodeInApp,i,"argument-error"),t&&uS(i,e,t)},i=Pw(t),o={requestType:"EMAIL_SIGNIN",email:n,clientType:"CLIENT_TYPE_WEB"},!(null===(a=i._getRecaptchaConfig())||void 0===a?void 0:a.emailPasswordEnabled)){e.next=12;break}return e.next=6,Rw(i,o,"getOobCode",!0);case 6:return u=e.sent,s(u,r),e.next=10,nI(i,u);case 10:e.next=15;break;case 12:return s(o,r),e.next=15,nI(i,o).catch(function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=10;break}return console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow."),e.next=4,Rw(i,o,"getOobCode",!0);case 4:return n=e.sent,s(n,r),e.next=8,nI(i,n);case 8:e.next=11;break;case 10:return e.abrupt("return",Promise.reject(t));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 15:case"end":return e.stop()}}),e)}))),mS.apply(this,arguments)}function yS(){return(yS=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Et(t),px((i=wI.credentialWithLink(n,r||mx()))._tenantId===(a.tenantId||null),a,"tenant-id-mismatch"),e.abrupt("return",XI(a,i));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bS(e,t){return kS.apply(this,arguments)}function kS(){return(kS=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:createAuthUri",Cx(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xS(){return(xS=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=yx()?mx():"http://localhost",a={identifier:n,continueUri:r},e.next=4,bS(Et(t),a);case 4:return i=e.sent,o=i.signinMethods,e.abrupt("return",o||[]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wS(){return(wS=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Et(t),e.next=3,t.getIdToken();case 3:return a=e.sent,i={requestType:"VERIFY_EMAIL",idToken:a},n&&uS(r.auth,i,n),e.next=8,Jw(r.auth,i);case 8:if(o=e.sent,o.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function IS(){return(IS=Rt(Dt().mark((function e(t,n,r){var a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Et(t),e.next=3,t.getIdToken();case 3:return i=e.sent,o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:n},r&&uS(a.auth,o,r),e.next=8,aI(a.auth,o);case 8:if(s=e.sent,s.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function SS(e,t){return CS.apply(this,arguments)}function CS(){return(CS=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_x(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _S(){return(_S=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,a=n.photoURL,void 0!==r||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return i=Et(t),e.next=6,i.getIdToken();case 6:return o=e.sent,s={idToken:o,displayName:r,photoUrl:a,returnSecureToken:!0},e.next=10,Hx(i,SS(i.auth,s));case 10:return u=e.sent,i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null,(c=i.providerData.find((function(e){return"password"===e.providerId})))&&(c.displayName=i.displayName,c.photoURL=i.photoURL),e.next=17,i._updateTokensIfNecessary(u);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function TS(e,t,n){return ES.apply(this,arguments)}function ES(){return(ES=Rt(Dt().mark((function e(t,n,r){var a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,o={idToken:i,returnSecureToken:!0},n&&(o.email=n),r&&(o.password=r),e.next=9,Hx(t,Ww(a,o));case 9:return s=e.sent,e.next=12,t._updateTokensIfNecessary(s,!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var NS=(0,v.Z)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,p.Z)(this,e),this.isNewUser=t,this.providerId=n,this.profile=r})),DS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o;return(0,p.Z)(this,n),(o=t.call(this,e,r,a)).username=i,o}return(0,v.Z)(n)}(NS),AS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"facebook.com",r)}return(0,v.Z)(n)}(NS),RS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"github.com",r,"string"===typeof(null===r||void 0===r?void 0:r.login)?null===r||void 0===r?void 0:r.login:null)}return(0,v.Z)(n)}(DS),MS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){return(0,p.Z)(this,n),t.call(this,e,"google.com",r)}return(0,v.Z)(n)}(NS),OS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){return(0,p.Z)(this,n),t.call(this,e,"twitter.com",r,a)}return(0,v.Z)(n)}(DS);function FS(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,a=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},i=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){var o=null===(n=null===(t=Wx(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new NS(i,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new AS(i,a);case"github.com":return new RS(i,a);case"google.com":return new MS(i,a);case"twitter.com":return new OS(i,a,e.screenName||null);case"custom":case"anonymous":return new NS(i,null);default:return new NS(i,r,a)}}(n)}var PS=function(){function e(t,n,r){(0,p.Z)(this,e),this.type=t,this.credential=n,this.auth=r}return(0,v.Z)(e,[{key:"toJSON",value:function(){var e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:(0,Ye.Z)({},e,this.credential)}}}],[{key:"_fromIdtoken",value:function(t,n){return new e("enroll",t,n)}},{key:"_fromMfaPendingCredential",value:function(t){return new e("signin",t)}},{key:"fromJSON",value:function(t){var n,r;if(null===t||void 0===t?void 0:t.multiFactorSession){if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return e._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(r=t.multiFactorSession)||void 0===r?void 0:r.idToken)return e._fromIdtoken(t.multiFactorSession.idToken)}return null}}]),e}(),LS=function(){function e(t,n,r){(0,p.Z)(this,e),this.session=t,this.hints=n,this.signInResolver=r}return(0,v.Z)(e,[{key:"resolveSignIn",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.abrupt("return",this.signInResolver(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromError",value:function(t,n){var r=Pw(t),a=n.customData._serverResponse,i=(a.mfaInfo||[]).map((function(e){return iS._fromServerResponse(r,e)}));px(a.mfaPendingCredential,r,"internal-error");var o=PS._fromMfaPendingCredential(a.mfaPendingCredential);return new e(o,i,function(){var e=Rt(Dt().mark((function e(t){var i,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._process(r,o);case 2:i=e.sent,delete a.mfaInfo,delete a.mfaPendingCredential,s=Object.assign(Object.assign({},a),{idToken:i.idToken,refreshToken:i.refreshToken}),e.t0=n.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,OI._fromIdTokenResponse(r,n.operationType,s);case 11:return u=e.sent,e.next=14,r._updateCurrentUser(u.user);case 14:return e.abrupt("return",u);case 15:return px(n.user,r,"internal-error"),e.abrupt("return",OI._forOperation(n.user,n.operationType,s));case 17:cx(r,"internal-error");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}();function ZS(e,t){return _x(e,"POST","/v2/accounts/mfaEnrollment:start",Cx(e,t))}function zS(e,t){return _x(e,"POST","/v2/accounts/mfaEnrollment:finalize",Cx(e,t))}var BS=function(){function e(t){var n=this;(0,p.Z)(this,e),this.user=t,this.enrolledFactors=[],t._onReload((function(e){e.mfaInfo&&(n.enrolledFactors=e.mfaInfo.map((function(e){return iS._fromServerResponse(t.auth,e)})))}))}return(0,v.Z)(e,[{key:"getSession",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=PS,e.next=3,this.user.getIdToken();case 3:return e.t1=e.sent,e.t2=this.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enroll",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.getSession();case 3:return a=e.sent,e.next=6,Hx(this.user,r._process(this.user.auth,a,n));case 6:return i=e.sent,e.next=9,this.user._updateTokensIfNecessary(i);case 9:return e.abrupt("return",this.user.reload());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unenroll",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="string"===typeof t?t:t.uid,e.next=3,this.user.getIdToken();case 3:return r=e.sent,e.prev=4,e.next=7,Hx(this.user,_x(i=this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",Cx(i,{idToken:r,mfaEnrollmentId:n})));case 7:return a=e.sent,this.enrolledFactors=this.enrolledFactors.filter((function(e){return e.uid!==n})),e.next=11,this.user._updateTokensIfNecessary(a);case 11:return e.next=13,this.user.reload();case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(4),e.t0;case 18:case"end":return e.stop()}var i}),e,this,[[4,15]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromUser",value:function(t){return new e(t)}}]),e}(),US=new WeakMap;var VS="__sak",jS=function(){function e(t,n){(0,p.Z)(this,e),this.storageRetriever=t,this.type=n}return(0,v.Z)(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(VS,"1"),this.storage.removeItem(VS),Promise.resolve(!0)):Promise.resolve(!1)}catch(zm){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var WS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=ct();return dw(e)||bw(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=kw(),e._shouldAllowMigration=!0,e}return(0,v.Z)(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],a=this.storage.getItem(r),i=this.localCache[r];a!==i&&e(r,i,a)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var a=this.storage.getItem(r);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);dt()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=Rt(Dt().mark((function e(t,r){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr((0,y.Z)(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Rt(Dt().mark((function e(t){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr((0,y.Z)(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr((0,y.Z)(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(jS);WS.type="LOCAL";var HS=WS,GS=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return(0,v.Z)(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(jS);GS.type="SESSION";var qS=GS;function KS(e){return Promise.all(e.map(function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var YS=function(){function e(t){(0,p.Z)(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return(0,v.Z)(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,a=r.eventId,i=r.eventType,o=r.data,null===(s=this.handlersMap[i])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:a,eventType:i}),u=Array.from(s).map(function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,KS(u);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:a,eventType:i,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function XS(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}YS.receivers=[];var QS=function(){function e(t){(0,p.Z)(this,e),this.target=t,this.handlers=new Set}return(0,v.Z)(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o,s=this,u=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:50,a="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,u){var c=XS("",20);a.port1.start();var l=setTimeout((function(){u(new Error("unsupported_event"))}),r);o={messageChannel:a,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),i=setTimeout((function(){u(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),e(n.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"))}}},s.handlers.add(o),a.port1.addEventListener("message",o.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[a.port2])})).finally((function(){o&&s.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function JS(){return window}function $S(e){JS().location.href=e}function eC(){return"undefined"!==typeof JS().WorkerGlobalScope&&"function"===typeof JS().importScripts}function tC(){return nC.apply(this,arguments)}function nC(){return(nC=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function rC(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var aC="firebaseLocalStorageDb",iC="firebaseLocalStorage",oC="fbase_key",sC=function(){function e(t){(0,p.Z)(this,e),this.request=t}return(0,v.Z)(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function uC(e,t){return e.transaction([iC],t?"readwrite":"readonly").objectStore(iC)}function cC(){var e=indexedDB.deleteDatabase(aC);return new sC(e).toPromise()}function lC(){var e=indexedDB.open(aC,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(iC,{keyPath:oC})}catch(r){n(r)}})),e.addEventListener("success",Rt(Dt().mark((function n(){var r;return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(iC)){n.next=12;break}return r.close(),n.next=5,cC();case 5:return n.t0=t,n.next=8,lC();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function hC(e,t,n){return fC.apply(this,arguments)}function fC(){return fC=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=uC(t,!0).put((a={},(0,Ye.Z)(a,oC,n),(0,Ye.Z)(a,"value",r),a)),e.abrupt("return",new sC(i).toPromise());case 2:case"end":return e.stop()}}),e)}))),fC.apply(this,arguments)}function dC(e,t){return pC.apply(this,arguments)}function pC(){return pC=Rt(Dt().mark((function e(t,n){var r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=uC(t,!1).get(n),e.next=3,new sC(r).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),e)}))),pC.apply(this,arguments)}function vC(e,t){var n=uC(e,!0).delete(t);return new sC(n).toPromise()}var gC=function(){function e(){(0,p.Z)(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return(0,v.Z)(e,[{key:"_openDb",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,lC();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",eC()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=YS._getInstance(eC()?self:null),this.receiver._subscribe("keyChanged",function(){var e=Rt(Dt().mark((function e(n,r){var a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tC();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new QS(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&rC()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,lC();case 5:return t=e.sent,e.next=8,hC(t,VS,"1");case 8:return e.next=10,vC(t,VS);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=Rt(Dt().mark((function e(t,n){var r=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return hC(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return dC(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=Rt(Dt().mark((function e(t){var n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return vC(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s,u,c,l,h;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=uC(e,!1).getAll();return new sC(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,a=(0,C.Z)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.fbase_key,u=o.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(u)&&(this.notifyListeners(s,u),n.push(s))}catch(f){a.e(f)}finally{a.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)h=l[c],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();gC.type="LOCAL";var mC=gC;function yC(e,t){return _x(e,"POST","/v2/accounts/mfaSignIn:start",Cx(e,t))}function bC(e,t){return _x(e,"POST","/v2/accounts/mfaSignIn:finalize",Cx(e,t))}var kC=1e12,xC=function(){function e(t){(0,p.Z)(this,e),this.auth=t,this.counter=kC,this._widgets=new Map}return(0,v.Z)(e,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new wC(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||kC;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||kC;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||kC,null===(n=this._widgets.get(r))||void 0===n||n.execute(),e.abrupt("return","");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),wC=function(){function e(t,n,r){var a=this;(0,p.Z)(this,e),this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){a.execute()};var i="string"===typeof t?document.getElementById(t):t;px(i,"argument-error",{appName:n}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return(0,v.Z)(e,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);var t=e.params,n=t.callback,r=t["expired-callback"];if(n)try{n(e.responseToken)}catch(a){}e.timerId=window.setTimeout((function(){if(e.timerId=null,e.responseToken=null,r)try{r()}catch(a){}e.isVisible&&e.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),e}();var IC=Dw("rcb"),SC=new kx(3e4,6e4),CC=function(){function e(){var t;(0,p.Z)(this,e),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(t=JS().grecaptcha)||void 0===t?void 0:t.render)}return(0,v.Z)(e,[{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return px(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(n),e,"argument-error"),this.shouldResolveImmediately(n)&&_w(JS().grecaptcha)?Promise.resolve(JS().grecaptcha):new Promise((function(r,a){var i=JS().setTimeout((function(){a(lx(e,"network-request-failed"))}),SC.get());JS()[IC]=function(){JS().clearTimeout(i),delete JS()[IC];var o=JS().grecaptcha;if(o&&_w(o)){var s=o.render;o.render=function(e,n){var r=s(e,n);return t.counter++,r},t.hostLanguage=n,r(o)}else a(lx(e,"internal-error"))},Nw("".concat("https://www.google.com/recaptcha/api.js?","?").concat(wt({onload:IC,render:"explicit",hl:n}))).catch((function(){clearTimeout(i),a(lx(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=JS().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),e}();var _C=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"load",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new xC(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearedOneInstance",value:function(){}}]),e}(),TC="recaptcha",EC={theme:"light",type:"image"},NC=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},EC),r=arguments.length>2?arguments[2]:void 0;(0,p.Z)(this,e),this.parameters=n,this.type=TC,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Pw(r),this.isInvisible="invisible"===this.parameters.size,px("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");var a="string"===typeof t?document.getElementById(t):t;px(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new _C:new CC,this.validateStartingState()}return(0,v.Z)(e,[{key:"verify",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotDestroyed(),e.next=3,this.render();case 3:if(t=e.sent,n=this.getAssertedRecaptcha(),!(r=n.getResponse(t))){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new Promise((function(e){a.tokenChangeListeners.add((function t(n){n&&(a.tokenChangeListeners.delete(t),e(n))})),a.isInvisible&&n.execute(t)})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){px(!this.parameters.sitekey,this.auth,"argument-error"),px(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),px("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"===typeof e)e(n);else if("string"===typeof e){var r=JS()[e];"function"===typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){px(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.widgetId||(t=this.container,this.isInvisible||(n=document.createElement("div"),t.appendChild(n),t=n),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),e.abrupt("return",this.widgetId);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return px(yx()&&!eC(),this.auth,"internal-error"),e.next=3,DC();case 3:return e.next=5,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);case 5:return this.recaptcha=e.sent,e.next=8,ww(this.auth);case 8:px(t=e.sent,this.auth,"internal-error"),this.parameters.sitekey=t;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAssertedRecaptcha",value:function(){return px(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),e}();function DC(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}var AC=function(){function e(t,n){(0,p.Z)(this,e),this.verificationId=t,this.onConfirmation=n}return(0,v.Z)(e,[{key:"confirm",value:function(e){var t=kI._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),e}();function RC(){return(RC=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pw(t),e.next=3,PC(a,n,Et(r));case 3:return i=e.sent,e.abrupt("return",new AC(i,(function(e){return XI(a,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function MC(e,t,n){return OC.apply(this,arguments)}function OC(){return(OC=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Et(t),e.next=3,WI(!1,a,"phone");case 3:return e.next=5,PC(a.auth,n,Et(r));case 5:return i=e.sent,e.abrupt("return",new AC(i,(function(e){return JI(a,e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function FC(){return(FC=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Et(t),e.next=3,PC(a.auth,n,Et(r));case 3:return i=e.sent,e.abrupt("return",new AC(i,(function(e){return eS(a,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function PC(e,t,n){return LC.apply(this,arguments)}function LC(){return LC=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(i=e.sent,e.prev=3,px("string"===typeof i,t,"argument-error"),px(r.type===TC,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=o.session,!("phoneNumber"in o)){e.next=17;break}return px("enroll"===s.type,t,"internal-error"),e.next=13,ZS(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});case 13:return u=e.sent,e.abrupt("return",u.phoneSessionInfo.sessionInfo);case 17:return px("signin"===s.type,t,"internal-error"),px(c=(null===(a=o.multiFactorHint)||void 0===a?void 0:a.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,yC(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:i}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,pI(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});case 28:return h=e.sent,f=h.sessionInfo,e.abrupt("return",f);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),LC.apply(this,arguments)}function ZC(){return(ZC=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,VI(Et(t),n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var zC=function(){function e(t){(0,p.Z)(this,e),this.providerId=e.PROVIDER_ID,this.auth=Pw(t)}return(0,v.Z)(e,[{key:"verifyPhoneNumber",value:function(e,t){return PC(this.auth,e,Et(t))}}],[{key:"credential",value:function(e,t){return kI._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?kI._fromTokenResponse(n,r):null}}]),e}();function BC(e,t){return t?ow(t):(px(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}zC.PROVIDER_ID="phone",zC.PHONE_SIGN_IN_METHOD="phone";var UC=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,"custom","custom")).params=e,r}return(0,v.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return hI(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return hI(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return hI(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Uw);function VC(e){return KI(e.auth,new UC(e),e.bypassAuthState)}function jC(e){var t=e.auth,n=e.user;return px(n,t,"internal-error"),GI(n,new UC(e),e.bypassAuthState)}function WC(e){return HC.apply(this,arguments)}function HC(){return(HC=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,px(r=t.user,n,"internal-error"),e.abrupt("return",VI(r,new UC(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var GC=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,p.Z)(this,e),this.auth=t,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return(0,v.Z)(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=Rt(Dt().mark((function t(n,r){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,a=t.postBody,i=t.tenantId,o=t.error,s=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(u);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VC;case"linkViaPopup":case"linkViaRedirect":return WC;case"reauthViaPopup":case"reauthViaRedirect":return jC;default:cx(this.auth,"internal-error")}}},{key:"resolve",value:function(e){gx(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){gx(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),qC=new kx(2e3,1e4);function KC(e,t,n){return YC.apply(this,arguments)}function YC(){return(YC=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pw(t),fx(t,n,II),i=BC(a,r),o=new $C(a,"signInViaPopup",n,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function XC(){return(XC=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fx((a=Et(t)).auth,n,II),i=BC(a.auth,r),o=new $C(a.auth,"reauthViaPopup",n,i,a),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function QC(e,t,n){return JC.apply(this,arguments)}function JC(){return(JC=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fx((a=Et(t)).auth,n,II),i=BC(a.auth,r),o=new $C(a.auth,"linkViaPopup",n,i,a),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $C=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i,o){var s;return(0,p.Z)(this,n),(s=t.call(this,e,r,i,o)).provider=a,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=(0,Je.Z)(s),s}return(0,v.Z)(n,[{key:"executeNotNull",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return px(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=Rt(Dt().mark((function e(){var t,n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gx(1===this.filter.length,"Popup operations only handle one event"),t=XS(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(lx(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(lx(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(lx(e.auth,"popup-closed-by-user"))}),8e3):e.pollId=window.setTimeout(t,qC.get())}()}}]),n}(GC);$C.currentPopupAction=null;var e_="pendingRedirect",t_=new Map,n_=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,p.Z)(this,n),(a=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i)).eventId=null,a}return(0,v.Z)(n,[{key:"execute",value:function(){var e=Rt(Dt().mark((function e(){var t,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t_.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,r_(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,sr((0,y.Z)(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:t_.set(this.auth._key(),t);case 21:return this.bypassAuthState||t_.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=Rt(Dt().mark((function e(t){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",sr((0,y.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",sr((0,y.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(GC);function r_(e,t){return a_.apply(this,arguments)}function a_(){return(a_=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c_(n),a=u_(t),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(r);case 8:return e.t0=e.sent,i="true"===e.t0,e.next=12,a._remove(r);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i_(e,t){return o_.apply(this,arguments)}function o_(){return(o_=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u_(t)._set(c_(n),"true"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s_(e,t){t_.set(e._key(),t)}function u_(e){return ow(e._redirectPersistence)}function c_(e){return cw(e_,e.config.apiKey,e.name)}function l_(e,t,n){return function(e,t,n){return h_.apply(this,arguments)}(e,t,n)}function h_(){return(h_=Rt(Dt().mark((function e(t,n,r){var a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pw(t),fx(t,n,II),e.next=4,a._initializationPromise;case 4:return i=BC(a,r),e.next=7,i_(i,a);case 7:return e.abrupt("return",i._openRedirect(a,n,"signInViaRedirect"));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f_(e,t,n){return function(e,t,n){return d_.apply(this,arguments)}(e,t,n)}function d_(){return(d_=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fx((a=Et(t)).auth,n,II),e.next=4,a.auth._initializationPromise;case 4:return i=BC(a.auth,r),e.next=7,i_(i,a.auth);case 7:return e.next=9,k_(a);case 9:return o=e.sent,e.abrupt("return",i._openRedirect(a.auth,n,"reauthViaRedirect",o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p_(e,t,n){return function(e,t,n){return v_.apply(this,arguments)}(e,t,n)}function v_(){return(v_=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fx((a=Et(t)).auth,n,II),e.next=4,a.auth._initializationPromise;case 4:return i=BC(a.auth,r),e.next=7,WI(!1,a,n.providerId);case 7:return e.next=9,i_(i,a.auth);case 9:return e.next=11,k_(a);case 11:return o=e.sent,e.abrupt("return",i._openRedirect(a.auth,n,"linkViaRedirect",o));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g_(e,t){return m_.apply(this,arguments)}function m_(){return(m_=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pw(t)._initializationPromise;case 2:return e.abrupt("return",y_(t,n,!1));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y_(e,t){return b_.apply(this,arguments)}function b_(){return b_=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],a=Pw(t),i=BC(a,n),o=new n_(a,i,r),e.next=6,o.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),b_.apply(this,arguments)}function k_(e){return x_.apply(this,arguments)}function x_(){return(x_=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=XS("".concat(t.uid,":::")),t._redirectEventId=n,e.next=4,t.auth._setRedirectUser(t);case 4:return e.next=6,t.auth._persistUserIfCurrent(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w_=function(){function e(t){(0,p.Z)(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return(0,v.Z)(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S_(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!S_(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(lx(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(I_(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(I_(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function I_(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function S_(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function C_(e){return __.apply(this,arguments)}function __(){return __=Rt(Dt().mark((function e(t){var n,r=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",_x(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),__.apply(this,arguments)}var T_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,E_=/^https?/;function N_(){return(N_=Rt(Dt().mark((function e(t){var n,r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C_(t);case 4:n=e.sent,r=n.authorizedDomains,a=(0,C.Z)(r),e.prev=7,a.s();case 9:if((i=a.n()).done){e.next=20;break}if(o=i.value,e.prev=11,!D_(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:cx(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])})))).apply(this,arguments)}function D_(e){var t=mx(),n=new URL(t),r=n.protocol,a=n.hostname;if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===a?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===a}if(!E_.test(r))return!1;if(T_.test(e))return a===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}var A_=new kx(3e4,6e4);function R_(){var e=JS().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=d(e.H[r].L),e.CP)for(var a=0;a<e.CP.length;a++)e.CP[a]=null}}var M_=null;function O_(e){return M_=M_||function(e){return new Promise((function(t,n){var r,a,i;function o(){R_(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){R_(),n(lx(e,"network-request-failed"))},timeout:A_.get()})}if(null===(a=null===(r=JS().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=JS().gapi)||void 0===i?void 0:i.load)){var s=Dw("iframefcb");return JS()[s]=function(){gapi.load?o():n(lx(e,"network-request-failed"))},Nw("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw M_=null,e}))}(e),M_}var F_=new kx(5e3,15e3),P_="__/auth/iframe",L_="emulator/auth/iframe",Z_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function B_(e){var t=e.config;px(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?xx(t,L_):"https://".concat(e.config.authDomain,"/").concat(P_),r={apiKey:t.apiKey,appName:e.name,v:En},a=z_.get(e.config.apiHost);a&&(r.eid=a);var i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(wt(r).slice(1))}function U_(e){return V_.apply(this,arguments)}function V_(){return V_=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O_(t);case 2:return n=e.sent,px(r=JS().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:B_(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Z_,dontclear:!0},(function(e){return new Promise(function(){var n=Rt(Dt().mark((function n(r,a){var i,o,s;return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){JS().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:i=lx(t,"network-request-failed"),o=JS().setTimeout((function(){a(i)}),F_.get()),e.ping(s).then(s,(function(){a(i)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),V_.apply(this,arguments)}var j_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W_=function(){function e(t){(0,p.Z)(this,e),this.window=t,this.associatedEvent=null}return(0,v.Z)(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function H_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},j_),{width:r.toString(),height:a.toString(),top:i,left:o}),c=ct().toLowerCase();n&&(s=pw(c)?"_blank":n),fw(c)&&(t=t||"http://localhost",u.scrollbars="yes");var h=Object.entries(u).reduce((function(e,t){var n=l(t,2),r=n[0],a=n[1];return"".concat(e).concat(r,"=").concat(a,",")}),"");if(function(){var e;return bw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new W_(null);var f=window.open(t||"",s,h);px(f,e,"popup-blocked");try{f.focus()}catch(d){}return new W_(f)}var G_="__/auth/handler",q_="emulator/auth/handler",K_=encodeURIComponent("fac");function Y_(e,t,n,r,a,i){return X_.apply(this,arguments)}function X_(){return X_=Rt(Dt().mark((function e(t,n,r,a,i,o){var s,u,c,h,f,d,p,v,g,m,y,b,k;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(px(t.config.authDomain,t,"auth-domain-config-required"),px(t.config.apiKey,t,"invalid-api-key"),s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:a,v:En,eventId:i},n instanceof II)for(n.setDefaultLanguage(t.languageCode),s.providerId=n.providerId||"",bt(n.getCustomParameters())||(s.customParameters=JSON.stringify(n.getCustomParameters())),u=0,c=Object.entries(o||{});u<c.length;u++)h=l(c[u],2),f=h[0],d=h[1],s[f]=d;for(n instanceof SI&&(p=n.getScopes().filter((function(e){return""!==e}))).length>0&&(s.scopes=p.join(",")),t.tenantId&&(s.tid=t.tenantId),v=s,g=0,m=Object.keys(v);g<m.length;g++)y=m[g],void 0===v[y]&&delete v[y];return e.next=10,t._getAppCheckToken();case 10:return b=e.sent,k=b?"#".concat(K_,"=").concat(encodeURIComponent(b)):"",e.abrupt("return","".concat(Q_(t),"?").concat(wt(v).slice(1)).concat(k));case 13:case"end":return e.stop()}}),e)}))),X_.apply(this,arguments)}function Q_(e){var t=e.config;return t.emulator?xx(t,q_):"https://".concat(t.authDomain,"/").concat(G_)}var J_="webStorageSupport",$_=function(){function e(){(0,p.Z)(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qS,this._completeRedirectFn=y_,this._overrideRedirectResult=s_}return(0,v.Z)(e,[{key:"_openPopup",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){var i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gx(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),e.next=3,Y_(t,n,r,mx(),a);case 3:return o=e.sent,e.abrupt("return",H_(t,o,XS()));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return e.next=4,Y_(t,n,r,mx(),a);case 4:return $S(e.sent),e.abrupt("return",new Promise((function(){})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],a=r.manager,i=r.promise;return a?Promise.resolve(a):(gx(i,"If manager is not set, promise should be"),i)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U_(t);case 2:return n=e.sent,r=new w_(t),n.register("authEvent",(function(e){return px(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(J_,{type:J_},(function(n){var r,a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[J_];void 0!==a&&t(!!a),cx(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return N_.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return kw()||dw()||bw()}}]),e}(),eT=$_,tT=function(){function e(t){(0,p.Z)(this,e),this.factorId=t}return(0,v.Z)(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return vx("unexpected MultiFactorSessionType")}}}]),e}(),nT=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,"phone")).credential=e,r}return(0,v.Z)(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return _x(e,"POST","/v2/accounts/mfaEnrollment:finalize",Cx(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return _x(e,"POST","/v2/accounts/mfaSignIn:finalize",Cx(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(tT),rT=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"assertion",value:function(e){return nT._fromCredential(e)}}]),e}();rT.FACTOR_ID="phone";var aT=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"assertionForEnrollment",value:function(e,t){return iT._fromSecret(e,t)}},{key:"assertionForSignIn",value:function(e,t){return iT._fromEnrollmentId(e,t)}},{key:"generateSecret",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return px("undefined"!==typeof(n=t).auth,"internal-error"),e.next=4,a=n.auth,i={idToken:n.credential,totpEnrollmentInfo:{}},_x(a,"POST","/v2/accounts/mfaEnrollment:start",Cx(a,i));case 4:return r=e.sent,e.abrupt("return",oT._fromStartTotpMfaEnrollmentResponse(r,n.auth));case 6:case"end":return e.stop()}var a,i}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();aT.FACTOR_ID="totp";var iT=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this,"totp")).otp=e,i.enrollmentId=r,i.secret=a,i}return(0,v.Z)(n,[{key:"_finalizeEnroll",value:function(){var e=Rt(Dt().mark((function e(t,n,r){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return px("undefined"!==typeof this.secret,t,"argument-error"),e.abrupt("return",zS(t,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_finalizeSignIn",value:function(){var e=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return px(void 0!==this.enrollmentId&&void 0!==this.otp,t,"argument-error"),r={verificationCode:this.otp},e.abrupt("return",bC(t,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"_fromSecret",value:function(e,t){return new n(t,void 0,e)}},{key:"_fromEnrollmentId",value:function(e,t){return new n(t,e)}}]),n}(tT),oT=function(){function e(t,n,r,a,i,o,s){(0,p.Z)(this,e),this.sessionInfo=o,this.auth=s,this.secretKey=t,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=a,this.enrollmentCompletionDeadline=i}return(0,v.Z)(e,[{key:"_makeTotpVerificationInfo",value:function(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}},{key:"generateQrCodeUrl",value:function(e,t){var n,r=!1;return(sT(e)||sT(t))&&(r=!0),r&&(sT(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),sT(t)&&(t=this.auth.name)),"otpauth://totp/".concat(t,":").concat(e,"?secret=").concat(this.secretKey,"&issuer=").concat(t,"&algorithm=").concat(this.hashingAlgorithm,"&digits=").concat(this.codeLength)}}],[{key:"_fromStartTotpMfaEnrollmentResponse",value:function(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}}]),e}();function sT(e){return"undefined"===typeof e||0===(null===e||void 0===e?void 0:e.length)}var uT="@firebase/auth",cT="0.23.2",lT=function(){function e(t){(0,p.Z)(this,e),this.auth=t,this.internalListeners=new Map}return(0,v.Z)(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){px(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var hT;!function(e){var t;null===(t=ot())||void 0===t||t["_".concat(e)]}("authIdTokenMaxAge");function fT(){return window}hT="Browser",xn(new Mt("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),o=r.options,s=o.apiKey,u=o.authDomain;px(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});var c={apiKey:s,authDomain:u,clientPlatform:hT,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xw(hT)},l=new Fw(r,a,i,c);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ow);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),xn(new Mt("auth-internal",(function(e){return function(e){return new lT(e)}(Pw(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),On(uT,cT,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(hT)),On(uT,cT,"esm2017");var dT=2e3;function pT(e,t,n){return vT.apply(this,arguments)}function vT(){return vT=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=fT(),o=i.BuildInfo,gx(n.sessionId,"AuthEvent did not contain a session ID"),e.next=4,xT(n.sessionId);case 4:return s=e.sent,u={},bw()?u.ibi=o.packageName:gw()?u.apn=o.packageName:cx(t,"operation-not-supported-in-this-environment"),o.displayName&&(u.appDisplayName=o.displayName),u.sessionId=s,e.abrupt("return",Y_(t,r,n.type,void 0,null!==(a=n.eventId)&&void 0!==a?a:void 0,u));case 10:case"end":return e.stop()}}),e)}))),vT.apply(this,arguments)}function gT(){return(gT=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=fT(),r=n.BuildInfo,a={},bw()?a.iosBundleId=r.packageName:gw()?a.androidPackageName=r.packageName:cx(t,"operation-not-supported-in-this-environment"),e.next=5,C_(t,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mT(e){var t=fT().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var a=null;r?t.plugins.browsertab.openUrl(e):a=t.InAppBrowser.open(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(a)}))}))}function yT(e,t,n){return bT.apply(this,arguments)}function bT(){return bT=Rt(Dt().mark((function e(t,n,r){var a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=fT(),i=a.cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,a){var s=null;function u(){var t;e();var n=null===(t=i.plugins.browsertab)||void 0===t?void 0:t.close;"function"===typeof n&&n(),"function"===typeof(null===r||void 0===r?void 0:r.close)&&r.close()}function c(){s||(s=window.setTimeout((function(){a(lx(t,"redirect-cancelled-by-user"))}),dT))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}n.addPassiveListener(u),document.addEventListener("resume",c,!1),gw()&&document.addEventListener("visibilitychange",l,!1),o=function(){n.removePassiveListener(u),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),s&&window.clearTimeout(s)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])}))),bT.apply(this,arguments)}function kT(e){var t,n,r,a,i,o,s,u,c,l,h=fT();px("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),px("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),px("function"===typeof(null===(i=null===(a=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===a?void 0:a.browsertab)||void 0===i?void 0:i.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),px("function"===typeof(null===(u=null===(s=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===s?void 0:s.browsertab)||void 0===u?void 0:u.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),px("function"===typeof(null===(l=null===(c=null===h||void 0===h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function xT(e){return wT.apply(this,arguments)}function wT(){return(wT=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=IT(t),e.next=3,crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,a=Array.from(new Uint8Array(r)),e.abrupt("return",a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function IT(e){if(gx(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}var ST=20,CT=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.apply(this,arguments)).passiveListeners=new Set,e.initPromise=new Promise((function(t){e.resolveInialized=t})),e}return(0,v.Z)(n,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(e){return this.resolveInialized(),this.passiveListeners.forEach((function(t){return t(e)})),sr((0,y.Z)(n.prototype),"onEvent",this).call(this,e)}},{key:"initialized",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(w_);function _T(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:AT(),postBody:null,tenantId:e.tenantId,error:lx(e,"no-auth-event")}}function TT(e,t){return RT()._set(MT(e),t)}function ET(e){return NT.apply(this,arguments)}function NT(){return(NT=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,RT()._get(MT(t));case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,RT()._remove(MT(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function DT(e,t){var n,r,a=function(e){var t=OT(e),n=t.link?decodeURIComponent(t.link):void 0,r=OT(n).link,a=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return OT(a).link||a||r||n||e}(t);if(a.includes("/__/auth/callback")){var i=OT(a),o=i.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(i.firebaseError)):null,s=null===(r=null===(n=null===o||void 0===o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],u=s?lx(s):null;return u?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:a,postBody:null}}return null}function AT(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<ST;n++){var r=Math.floor(62*Math.random());e.push(t.charAt(r))}return e.join("")}function RT(){return ow(HS)}function MT(e){return cw("authEvent",e.config.apiKey,e.name)}function OT(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};var t=I(e.split("?"));t[0];return It(t.slice(1).join("?"))}var FT=function(){function e(){(0,p.Z)(this,e),this._redirectPersistence=qS,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=y_,this._overrideRedirectResult=s_}return(0,v.Z)(e,[{key:"_initialize",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._key(),(r=this.eventManagers.get(n))||(r=new CT(t),this.eventManagers.set(n,r),this.attachCallbackListeners(t,r)),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(e){cx(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){var i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kT(t),e.next=3,this._initialize(t);case 3:return i=e.sent,e.next=6,i.initialized();case 6:return i.resetRedirect(),t_.clear(),e.next=10,this._originValidation(t);case 10:return o=_T(t,r,a),e.next=13,TT(t,o);case 13:return e.next=15,pT(t,o,n);case 15:return s=e.sent,e.next=18,mT(s);case 18:return u=e.sent,e.abrupt("return",yT(t,i,u));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return gT.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(e,t){var n=fT(),r=n.universalLinks,a=n.handleOpenURL,i=n.BuildInfo,o=setTimeout(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ET(e);case 2:t.onEvent(LT());case 3:case"end":return n.stop()}}),n)}))),500),s=function(){var n=Rt(Dt().mark((function n(r){var a,i;return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(o),n.next=3,ET(e);case 3:a=n.sent,i=null,a&&(null===r||void 0===r?void 0:r.url)&&(i=DT(a,r.url)),t.onEvent(i||LT());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();"undefined"!==typeof r&&"function"===typeof r.subscribe&&r.subscribe(null,s);var u=a,c="".concat(i.packageName.toLowerCase(),"://");fT().handleOpenURL=function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.toLowerCase().startsWith(c)&&s({url:t}),"function"===typeof u)try{u(t)}catch(n){console.error(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]),e}(),PT=FT;function LT(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:lx("no-auth-event")}}var ZT=1e3;function zT(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function BT(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return!("file:"!==zT()&&"ionic:"!==zT()&&"capacitor:"!==zT()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function UT(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return dt()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct();return/Edge\/\d+/.test(e)}(e)}function VT(){try{var e=self.localStorage,t=XS();if(e)return e.setItem(t,"1"),e.removeItem(t),!UT()||pt()}catch(n){return jT()&&pt()}return!1}function jT(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function WT(){return("http:"===zT()||"https:"===zT()||ht()||BT())&&!(ft()||lt())&&VT()&&!jT()}function HT(){return BT()&&"undefined"!==typeof document}function GT(){return qT.apply(this,arguments)}function qT(){return qT=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(HT()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),ZT);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),e)}))),qT.apply(this,arguments)}var KT={LOCAL:"local",NONE:"none",SESSION:"session"},YT=px,XT="persistence";function QT(e,t){YT(Object.values(KT).includes(t),e,"invalid-persistence-type"),ft()?YT(t!==KT.SESSION,e,"unsupported-persistence-type"):lt()?YT(t===KT.NONE,e,"unsupported-persistence-type"):jT()?YT(t===KT.NONE||t===KT.LOCAL&&pt(),e,"unsupported-persistence-type"):YT(t===KT.NONE||VT(),e,"unsupported-persistence-type")}function JT(e){return $T.apply(this,arguments)}function $T(){return($T=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._initializationPromise;case 2:n=eE(),r=cw(XT,t.config.apiKey,t.name),n&&n.setItem(r,t._getPersistence());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eE(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}var tE=px,nE=function(){function e(){(0,p.Z)(this,e),this.browserResolver=ow(eT),this.cordovaResolver=ow(PT),this.underlyingResolver=null,this._redirectPersistence=qS,this._completeRedirectFn=y_,this._overrideRedirectResult=s_}return(0,v.Z)(e,[{key:"_initialize",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openPopup(t,n,r,a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openRedirect(t,n,r,a));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return HT()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return tE(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,GT();case 4:t=e.sent,this.underlyingResolver=t?this.cordovaResolver:this.browserResolver;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function rE(e){return e.unwrap()}function aE(e,t){var n,r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code))t.resolver=new cE(e,function(e,t){var n,r=Et(e),a=t;return px(t.customData.operationType,r,"argument-error"),px(null===(n=a.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),LS._fromError(r,a)}(e,t));else if(r){var a=iE(t),i=t;a&&(i.credential=a,i.tenantId=r.tenantId||void 0,i.email=r.email||void 0,i.phoneNumber=r.phoneNumber||void 0)}}function iE(e){var t=(e instanceof vt?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof vt)&&"temporaryProof"in t&&"phoneNumber"in t)return zC.credentialFromResult(e);var n,r=t.providerId;if(!r||r===Yk.PASSWORD)return null;switch(r){case Yk.GOOGLE:n=TI;break;case Yk.FACEBOOK:n=_I;break;case Yk.GITHUB:n=EI;break;case Yk.TWITTER:n=AI;break;default:var a=t.oauthIdToken,i=t.oauthAccessToken,o=t.oauthTokenSecret,s=t.pendingToken,u=t.nonce;return i||o||a||s?s?r.startsWith("saml.")?NI._create(r,s):dI._fromParams({providerId:r,signInMethod:r,pendingToken:s,idToken:a,accessToken:i}):new CI(r).credential({idToken:a,accessToken:i,rawNonce:u}):null}return e instanceof vt?n.credentialFromError(e):n.credentialFromResult(e)}function oE(e,t){return t.catch((function(t){throw t instanceof vt&&aE(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,iE(t)),additionalUserInfo:FS(e),user:lE.getOrCreate(r)}}))}function sE(e,t){return uE.apply(this,arguments)}function uE(){return(uE=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return r=e.sent,e.abrupt("return",{verificationId:r.verificationId,confirm:function(e){return oE(t,r.confirm(e))}});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var cE=function(){function e(t,n){(0,p.Z)(this,e),this.resolver=n,this.auth=function(e){return e.wrapped()}(t)}return(0,v.Z)(e,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return oE(rE(this.auth),this.resolver.resolveSignIn(e))}}]),e}(),lE=function(){function e(t){(0,p.Z)(this,e),this._delegate=t,this.multiFactor=function(e){var t=Et(e);return US.has(t)||US.set(t,BS._fromUser(t)),US.get(t)}(t)}return(0,v.Z)(e,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oE(this.auth,JI(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithPhoneNumber",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sE(this.auth,MC(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"linkWithPopup",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oE(this.auth,QC(this._delegate,t,nE)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithRedirect",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JT(Pw(this.auth));case 2:return e.abrupt("return",p_(this._delegate,t,nE));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oE(this.auth,eS(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return sE(this.auth,function(e,t,n){return FC.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return oE(this.auth,function(e,t,n){return XC.apply(this,arguments)}(this._delegate,e,nE))}},{key:"reauthenticateWithRedirect",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JT(Pw(this.auth));case 2:return e.abrupt("return",f_(this._delegate,t,nE));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmailVerification",value:function(e){return function(e,t){return wS.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,BI(this._delegate,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEmail",value:function(e){return function(e,t){return TS(Et(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return TS(Et(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return ZC.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return _S.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return IS.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(t){return e.USER_MAP.has(t)||e.USER_MAP.set(t,new e(t)),e.USER_MAP.get(t)}}]),e}();lE.USER_MAP=new WeakMap;var hE=px,fE=function(){function e(t,n){if((0,p.Z)(this,e),this.app=t,n.isInitialized())return this._delegate=n.getImmediate(),void this.linkUnderlyingAuth();var r=t.options.apiKey;hE(r,"invalid-api-key",{appName:t.name}),hE(r,"invalid-api-key",{appName:t.name});var a="undefined"!==typeof window?nE:void 0;this._delegate=n.initialize({options:{persistence:pE(r,t.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(rx),this.linkUnderlyingAuth()}return(0,v.Z)(e,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?lE.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){Zw(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return hS.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return fS(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return lS.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oE(this._delegate,vS(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return xS.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=xI.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hE(WT(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,g_(this._delegate,nE);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",oE(this._delegate,Promise.resolve(t)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFrameworkForLogging",value:function(e){!function(e,t){Pw(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=dE(e,t,n),a=r.next,i=r.error,o=r.complete;return this._delegate.onAuthStateChanged(a,i,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=dE(e,t,n),a=r.next,i=r.error,o=r.complete;return this._delegate.onIdTokenChanged(a,i,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return mS.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return cS.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:QT(this._delegate,t),e.t0=t,e.next=e.t0===KT.SESSION?4:e.t0===KT.LOCAL?6:e.t0===KT.NONE?11:13;break;case 4:return n=qS,e.abrupt("break",14);case 6:return e.next=8,ow(mC)._isAvailable();case 8:return r=e.sent,n=r?mC:HS,e.abrupt("break",14);case 11:return n=uw,e.abrupt("break",14);case 13:return e.abrupt("return",cx("argument-error",{appName:this._delegate.name}));case 14:return e.abrupt("return",this._delegate.setPersistence(n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return oE(this._delegate,function(e){return PI.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return oE(this._delegate,XI(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return oE(this._delegate,function(e,t){return aS.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return oE(this._delegate,function(e,t,n){return XI(Et(e),wI.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return oE(this._delegate,function(e,t,n){return yS.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return sE(this._delegate,function(e,t,n){return RC.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hE(WT(),this._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",oE(this._delegate,KC(this._delegate,t,nE)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithRedirect",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hE(WT(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,JT(this._delegate);case 3:return e.abrupt("return",l_(this._delegate,t,nE));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return pS.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),e}();function dE(e,t,n){var r=e;"function"!==typeof e&&(r=e.next,t=e.error,n=e.complete);var a=r;return{next:function(e){return a(e&&lE.getOrCreate(e))},error:t,complete:n}}function pE(e,t){var n=function(e,t){var n=eE();if(!n)return[];var r=cw(XT,e,t);switch(n.getItem(r)){case KT.NONE:return[uw];case KT.LOCAL:return[mC,qS];case KT.SESSION:return[qS];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(mC)||n.push(mC),"undefined"!==typeof window)for(var r=0,a=[HS,qS];r<a.length;r++){var i=a[r];n.includes(i)||n.push(i)}return n.includes(uw)||n.push(uw),n}fE.Persistence=KT;var vE=function(){function e(){(0,p.Z)(this,e),this.providerId="phone",this._delegate=new zC(rE(or.auth()))}return(0,v.Z)(e,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return zC.credential(e,t)}}]),e}();vE.PHONE_SIGN_IN_METHOD=zC.PHONE_SIGN_IN_METHOD,vE.PROVIDER_ID=zC.PROVIDER_ID;var gE=px,mE=function(){function e(t,n){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:or.app();(0,p.Z)(this,e),gE(null===(r=a.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:a.name}),this._delegate=new NC(t,n,a.auth()),this.type=this._delegate.type}return(0,v.Z)(e,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),e}();!function(e){e.INTERNAL.registerComponent(new Mt("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new fE(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Xk,PASSWORD_RESET:Qk,RECOVER_EMAIL:Jk,REVERT_SECOND_FACTOR_ADDITION:$k,VERIFY_AND_CHANGE_EMAIL:ex,VERIFY_EMAIL:tx}},EmailAuthProvider:wI,FacebookAuthProvider:_I,GithubAuthProvider:EI,GoogleAuthProvider:TI,OAuthProvider:CI,SAMLAuthProvider:DI,PhoneAuthProvider:vE,PhoneMultiFactorGenerator:rT,RecaptchaVerifier:mE,TwitterAuthProvider:AI,Auth:fE,AuthCredential:Uw,Error:vt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),e.registerVersion("@firebase/auth-compat","0.4.2")}(or);or.initializeApp({apiKey:"AIzaSyDLK9QzB0CppEeQOjjyZeY3Kpbdd7-XsAA",authDomain:"yuhu5998.firebaseapp.com",databaseURL:"https://yuhu5998-default-rtdb.firebaseio.com",projectId:"yuhu5998",storageBucket:"yuhu5998.appspot.com",messagingSenderId:"142613113769",appId:"1:142613113769:web:e4566b08a2d60ac782f2b8",measurementId:"G-MPPG5QXYK9"});var yE=or.firestore(),bE=or.auth(),kE=or.firestore.Timestamp,xE=n(184),wE=(0,r.createContext)(),IE=function(e,t){switch(t.type){case"LOGIN":return Qe(Qe({},e),{},{user:t.payload});case"LOGOUT":return Qe(Qe({},e),{},{user:null});case"AUTH_IS_READY":return{user:t.payload,authIsReady:!0};default:return e}},SE=function(e){var t=e.children,n=l((0,r.useReducer)(IE,{user:null,authIsReady:!1}),2),a=n[0],i=n[1];return(0,r.useEffect)((function(){var e=bE.onAuthStateChanged((function(t){i({type:"AUTH_IS_READY",payload:t}),e()}))}),[]),console.log("AuthContext state:",a),(0,xE.jsx)(wE.Provider,{value:Qe(Qe({},a),{},{dispatch:i}),children:t})},CE=function(){var e=(0,r.useContext)(wE);if(!e)throw Error("useAuthContext must be used inside an AuthContextProvider");return e},_E="Introduction_animation__Nkh-j",TE="Introduction_landingText__IkidO",EE="Introduction_landingSection__Ojimt",NE="Introduction_landingBackground__Zuytl",DE="Introduction_about-us-box__XWCtV",AE="Introduction_about-us__4tjrR",RE="Introduction_features__xQf6H",ME="Introduction_features-icons__XJhWe",OE="Introduction_feature__hMw+I",FE=n.p+"static/media/dashboards_icon.3ba0361da41f4df066e1.png",PE=n.p+"static/media/tracking_icon.826e4dc0ff5502416e0c.png",LE=n.p+"static/media/order_management_icon.f5bb214f97f12c2bab19.png",ZE=n.p+"static/media/alerts_icon.dd4e0c2568091a73f854.png",zE=n.p+"static/media/WarehouseBackground.6a877abea1c16710ce0d.gif",BE=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"componentDidMount",value:function(){document.querySelectorAll(".scroll-link").forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault();var n=e.getAttribute("href").substring(1);document.getElementById(n).scrollIntoView({behavior:"smooth"})}))}))}},{key:"render",value:function(){return(0,xE.jsxs)("div",{children:[(0,xE.jsxs)("section",{id:"home",className:"".concat(_E," ").concat(EE),children:[(0,xE.jsx)("div",{className:NE,style:{backgroundImage:"url(".concat(zE,")")}}),(0,xE.jsxs)("div",{className:TE,children:[(0,xE.jsx)("h1",{children:"Welcome to Yuhu!!"}),(0,xE.jsx)("p",{children:"the yoo-hoo to your inventory boo-hoo"})]})]}),(0,xE.jsx)("div",{className:DE,children:(0,xE.jsxs)("section",{id:"about",className:AE,children:[(0,xE.jsx)("h1",{children:"About Us"}),(0,xE.jsx)("p",{children:"At YuHu, we aim to empower small businesses like you with a comprehensive digital solution to transform your stock-taking process and inventory management. Our user-friendly web application streamlines inventory tasks, saving valuable time and effort for small business owners like you. With advanced analytics and automated alerts, we provide valuable insights into your inventory performance, enabling informed decision-making to reduce costs and increase profitability for you. We understand the challenges faced by small businesses in accessing affordable and intuitive inventory management tools, which is why our solution is specifically designed to cater to your unique needs and budgets. At YuHu, we are committed to helping small businesses thrive and succeed by providing them with the tools you need to optimize your inventory management processes."})]})}),(0,xE.jsxs)("section",{id:"features",className:RE,children:[(0,xE.jsx)("h1",{children:"Features"}),(0,xE.jsxs)("div",{className:ME,children:[(0,xE.jsxs)("div",{className:OE,children:[(0,xE.jsx)("img",{src:FE,alt:"Dashboards"}),(0,xE.jsx)("p",{children:"Analytics Dashboards"})]}),(0,xE.jsxs)("div",{className:OE,children:[(0,xE.jsx)("img",{src:PE,alt:"Tracking"}),(0,xE.jsx)("p",{children:"Inventory Tracking"})]}),(0,xE.jsxs)("div",{className:OE,children:[(0,xE.jsx)("img",{src:LE,alt:"Order Management"}),(0,xE.jsx)("p",{children:"Order Management"})]}),(0,xE.jsxs)("div",{className:OE,children:[(0,xE.jsx)("img",{src:ZE,alt:"Alerts"}),(0,xE.jsx)("p",{children:"Automated Alerts"})]})]})]})]})}}]),n}(r.Component),UE=BE,VE=function(){var e=l((0,r.useState)(""),2),t=e[0],n=e[1],a=l((0,r.useState)(""),2),i=a[0],o=a[1],s=l((0,r.useState)(null),2),u=s[0],c=s[1],h=l((0,r.useState)(""),2),f=h[0],d=h[1],p=(0,r.useContext)(wE).dispatch,v=function(){var e=Rt(Dt().mark((function e(n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),c(null),d(null),""!==t.trim()&&""!==i.trim()){e.next=6;break}return d("Please enter both email and password."),e.abrupt("return");case 6:return e.prev=6,e.next=9,bE.signInWithEmailAndPassword(t,i);case 9:r=bE.currentUser,p({type:"LOGIN",payload:r}),console.log("Logged in successfully!"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),c(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}();return{email:t,setEmail:n,password:i,setPassword:o,error:u,formError:f,handleSubmit:v}},jE={"login-form":"Login_login-form__A0K9i"};function WE(){var e=VE(),t=e.email,n=e.setEmail,r=e.password,a=e.setPassword,i=e.error,o=e.formError,s=e.handleSubmit;return(0,xE.jsxs)("form",{onSubmit:s,className:jE["login-form"],children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("h2",{children:"Welcome back to YuHu!"}),o&&(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{children:o})]}),i&&(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{children:"Invalid email or password. Please try again."})]}),(0,xE.jsxs)("label",{children:[(0,xE.jsx)("span",{children:"Email:"}),(0,xE.jsx)("input",{type:"email",onChange:function(e){return n(e.target.value)},value:t})]}),(0,xE.jsxs)("label",{children:[(0,xE.jsx)("span",{children:"Password:"}),(0,xE.jsx)("input",{type:"password",onChange:function(e){return a(e.target.value)},value:r})]}),(0,xE.jsx)("button",{className:"btn",children:"Login"})]})}var HE=function(){var e=l((0,r.useState)(null),2),t=e[0],n=e[1],a=l((0,r.useState)(!1),2),i=a[0],o=a[1],s=CE().dispatch,u=function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,yE.collection("users").doc("".concat(t.uid)).set({uid:t.uid,email:t.email,displayName:t.displayName});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error creating user document: ",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Rt(Dt().mark((function e(t,r,a){var i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(null),o(!0),e.prev=2,e.next=5,bE.createUserWithEmailAndPassword(t,r);case 5:if(i=e.sent){e.next=8;break}throw new Error("Could not complete signup");case 8:return e.next=10,i.user.updateProfile({displayName:a});case 10:return e.next=12,u(i.user);case 12:s({type:"LOGIN",payload:i.user}),o(!1),n(null),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),n(e.t0.message),o(!1);case 21:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,n,r){return e.apply(this,arguments)}}();return{signup:c,error:t,isPending:i}},GE={"signup-form":"Signup_signup-form__-MhR9"};function qE(){var e=l((0,r.useState)(""),2),t=e[0],n=e[1],a=l((0,r.useState)(""),2),i=a[0],o=a[1],s=l((0,r.useState)(""),2),u=s[0],c=s[1],h=HE(),f=h.signup,d=h.isPending,p=h.error,v=l((0,r.useState)(""),2),g=v[0],m=v[1],y=function(){var e=Rt(Dt().mark((function e(n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==t.trim()&&""!==i.trim()&&""!==u.trim()){e.next=4;break}return m("Please enter all the required information."),e.abrupt("return");case 4:f(t,i,u),"Firebase: The email address is already in use by another account. (auth/email-already-in-use)."===p?m("The email address is already in use. Please login instead."):p&&m("Sign up was unsuccessful. Please verify your details and try again or contact our support staff.");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,xE.jsxs)("form",{onSubmit:y,className:GE["signup-form"],children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("h2",{children:"Sign Up Now!"}),g&&(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{children:g})]}),(0,xE.jsxs)("label",{children:[(0,xE.jsx)("span",{children:"Company Name:"}),(0,xE.jsx)("input",{type:"text",onChange:function(e){return c(e.target.value)},value:u})]}),(0,xE.jsxs)("label",{children:[(0,xE.jsx)("span",{children:"Email:"}),(0,xE.jsx)("input",{type:"email",onChange:function(e){return n(e.target.value)},value:t})]}),(0,xE.jsxs)("label",{children:[(0,xE.jsx)("span",{children:"Password:"}),(0,xE.jsx)("input",{type:"password",onChange:function(e){return o(e.target.value)},value:i})]}),!d&&(0,xE.jsx)("button",{className:"btn",children:"Sign Up"}),d&&(0,xE.jsx)("button",{className:"btn",disabled:!0,children:"Loading"})]})}var KE=function(e,t,n){var a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)(null),2),u=s[0],c=s[1],h=(0,r.useRef)(t),f=(0,r.useRef)(n);return(0,r.useEffect)((function(){var t,n,r=yE.collection(e);h.current&&(r=(t=r).where.apply(t,d(h.current)));f.current&&(r=(n=r).orderBy.apply(n,d(f.current)));var a=r.onSnapshot((function(e){var t=[];e.docs.forEach((function(e){t.push(Qe(Qe({},e.data()),{},{id:e.id}))})),o(t),c(null)}),(function(e){console.log(e),c("Could not fetch the data")}));return function(){return a()}}),[e,h,f]),{documents:i,error:u}},YE={home:"Home_home__JTgz3",listContainer:"Home_listContainer__P-qNZ",carousel:"Home_carousel__1bFmg",carouselContainer:"Home_carouselContainer__rod+t",carouselItem:"Home_carouselItem__bxtyQ",metricsContainer:"Home_metricsContainer__6SPKP",buttonContainer:"Home_buttonContainer__egK5F",metrics:"Home_metrics__A4NDS",chartContainer:"Home_chartContainer__Yxnum",centered:"Home_centered__RW24x",toggleButton:"Home_toggleButton__SHJt1",toggleOption:"Home_toggleOption__FKb9l",active:"Home_active__gbirH",datePicker:"Home_datePicker__Dw4L4"};function XE(){var e=l((0,r.useState)([]),2),t=e[0],n=e[1],a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)([]),2),u=s[0],c=s[1],h=CE().user,f=KE("users/".concat(null===h||void 0===h?void 0:h.uid,"/products")),d=f.documents,p=f.error;return(0,r.useEffect)((function(){p?o(p):n(d||[])}),[d,p]),(0,r.useEffect)((function(){!function(){var e=new Date;if((new Date).setDate(e.getDate()+5),t){var n=t.reduce((function(t,n){var r=(n.batchDetails||[]).filter((function(t){var n=t.expiryDate&&t.expiryDate.toDate?t.expiryDate.toDate():null;return!(!n||isNaN(n))&&(n.getTime()-e.getTime())/864e5<5}));if(r.length>0){var a=Qe(Qe({},n),{},{batchDetails:r});t.push(a)}return t}),[]);c(n)}}()}),[t]),i?(0,xE.jsxs)("p",{children:["Error: ",i]}):(0,xE.jsxs)("div",{className:YE.carousel,children:[(0,xE.jsx)("h3",{children:"Expiring/Expired Products"}),u.length>0?(0,xE.jsx)("div",{className:YE.carouselContainer,children:(0,xE.jsx)("ul",{children:u.map((function(e){return e.batchDetails.map((function(t,n){return(0,xE.jsxs)("li",{className:YE.carouselItem,children:[(0,xE.jsxs)("strong",{children:[e.productId," | ",e.productName]}),(0,xE.jsx)("p",{children:t.batchId?"Batch ID: ".concat(t.batchId):"Batch Index: ".concat(n+1)}),(0,xE.jsxs)("p",{children:["Quantity: ",t.quantity]}),(0,xE.jsxs)("p",{children:["Expiry Date:"," ",t.expiryDate.toDate().toLocaleDateString()]})]},"".concat(e.productId,"-").concat(n))}))}))})}):(0,xE.jsx)("p",{children:"No batches near expiry."})]})}function QE(){var e=l((0,r.useState)([]),2),t=e[0],n=e[1],a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)([]),2),u=s[0],c=s[1],h=CE().user,f=KE("users/".concat(null===h||void 0===h?void 0:h.uid,"/products")),d=f.documents,p=f.error;return(0,r.useEffect)((function(){p?o(p):n(d||[])}),[d,p]),(0,r.useEffect)((function(){!function(){var e=t.filter((function(e){return(e.totalQuantity||0)<10}));c(e)}()}),[t]),i?(0,xE.jsxs)("p",{children:["Error: ",i]}):(0,xE.jsxs)("div",{className:YE.carousel,children:[(0,xE.jsx)("h3",{children:"Low Quantity Products"}),u.length>0?(0,xE.jsx)("ul",{className:YE.carouselContainer,children:u.map((function(e){return(0,xE.jsxs)("li",{className:YE.carouselItem,children:[(0,xE.jsx)("div",{children:(0,xE.jsxs)("strong",{children:[e.productId," | ",e.productName]})}),(0,xE.jsxs)("div",{children:["Quantity Left: ",e.totalQuantity]})]},e.productId)}))}):(0,xE.jsx)("p",{children:"No low quantity products found."})]})}function JE(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function $E(e){return e+.5|0}var eN=function(e,t,n){return Math.max(Math.min(e,n),t)};function tN(e){return eN($E(2.55*e),0,255)}function nN(e){return eN($E(255*e),0,255)}function rN(e){return eN($E(e/2.55)/100,0,1)}function aN(e){return eN($E(100*e),0,100)}var iN={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},oN=d("0123456789ABCDEF"),sN=function(e){return oN[15&e]},uN=function(e){return oN[(240&e)>>4]+oN[15&e]},cN=function(e){return(240&e)>>4===(15&e)};function lN(e){var t=function(e){return cN(e.r)&&cN(e.g)&&cN(e.b)&&cN(e.a)}(e)?sN:uN;return e?"#"+t(e.r)+t(e.g)+t(e.b)+function(e,t){return e<255?t(e):""}(e.a,t):void 0}var hN=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function fN(e,t,n){var r=t*Math.min(n,1-n),a=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(a-3,9-a,1),-1)};return[a(0),a(8),a(4)]}function dN(e,t,n){var r=function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(a,4-a,1),0)};return[r(5),r(3),r(1)]}function pN(e,t,n){var r,a=fN(e,1,.5);for(t+n>1&&(t*=r=1/(t+n),n*=r),r=0;r<3;r++)a[r]*=1-t-n,a[r]+=t;return a}function vN(e){var t,n,r,a=e.r/255,i=e.g/255,o=e.b/255,s=Math.max(a,i,o),u=Math.min(a,i,o),c=(s+u)/2;return s!==u&&(r=s-u,n=c>.5?r/(2-s-u):r/(s+u),t=function(e,t,n,r,a){return e===a?(t-n)/r+(t<n?6:0):t===a?(n-e)/r+2:(e-t)/r+4}(a,i,o,r,s),t=60*t+.5),[0|t,n||0,c]}function gN(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(nN)}function mN(e,t,n){return gN(fN,e,t,n)}function yN(e){return(e%360+360)%360}function bN(e){var t,n=hN.exec(e),r=255;if(n){n[5]!==t&&(r=n[6]?tN(+n[5]):nN(+n[5]));var a=yN(+n[2]),i=+n[3]/100,o=+n[4]/100;return t="hwb"===n[1]?function(e,t,n){return gN(pN,e,t,n)}(a,i,o):"hsv"===n[1]?function(e,t,n){return gN(dN,e,t,n)}(a,i,o):mN(a,i,o),{r:t[0],g:t[1],b:t[2],a:r}}}var kN,xN={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wN={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function IN(e){kN||(kN=function(){var e,t,n,r,a,i={},o=Object.keys(wN),s=Object.keys(xN);for(e=0;e<o.length;e++){for(r=a=o[e],t=0;t<s.length;t++)n=s[t],a=a.replace(n,xN[n]);n=parseInt(wN[r],16),i[a]=[n>>16&255,n>>8&255,255&n]}return i}(),kN.transparent=[0,0,0,0]);var t=kN[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}var SN=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;var CN=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},_N=function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)};function TN(e,t,n){if(e){var r=vN(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=mN(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function EN(e,t){return e?Object.assign(t||{},e):e}function NN(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=nN(e[3]))):(t=EN(e,{r:0,g:0,b:0,a:1})).a=nN(t.a),t}function DN(e){return"r"===e.charAt(0)?function(e){var t,n,r,a=SN.exec(e),i=255;if(a){if(a[7]!==t){var o=+a[7];i=a[8]?tN(o):eN(255*o,0,255)}return t=+a[1],n=+a[3],r=+a[5],{r:t=255&(a[2]?tN(t):eN(t,0,255)),g:n=255&(a[4]?tN(n):eN(n,0,255)),b:r=255&(a[6]?tN(r):eN(r,0,255)),a:i}}}(e):bN(e)}var AN=function(){function e(t){if((0,p.Z)(this,e),t instanceof e)return t;var n,r=typeof t;"object"===r?n=NN(t):"string"===r&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*iN[e[1]],g:255&17*iN[e[2]],b:255&17*iN[e[3]],a:5===n?17*iN[e[4]]:255}:7!==n&&9!==n||(t={r:iN[e[1]]<<4|iN[e[2]],g:iN[e[3]]<<4|iN[e[4]],b:iN[e[5]]<<4|iN[e[6]],a:9===n?iN[e[7]]<<4|iN[e[8]]:255})),t}(t)||IN(t)||DN(t)),this._rgb=n,this._valid=!!n}return(0,v.Z)(e,[{key:"valid",get:function(){return this._valid}},{key:"rgb",get:function(){var e=EN(this._rgb);return e&&(e.a=rN(e.a)),e},set:function(e){this._rgb=NN(e)}},{key:"rgbString",value:function(){return this._valid?function(e){return e&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(rN(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}(this._rgb):void 0}},{key:"hexString",value:function(){return this._valid?lN(this._rgb):void 0}},{key:"hslString",value:function(){return this._valid?function(e){if(e){var t=vN(e),n=t[0],r=aN(t[1]),a=aN(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(r,"%, ").concat(a,"%, ").concat(rN(e.a),")"):"hsl(".concat(n,", ").concat(r,"%, ").concat(a,"%)")}}(this._rgb):void 0}},{key:"mix",value:function(e,t){if(e){var n,r=this.rgb,a=e.rgb,i=t===n?.5:t,o=2*i-1,s=r.a-a.a,u=((o*s===-1?o:(o+s)/(1+o*s))+1)/2;n=1-u,r.r=255&u*r.r+n*a.r+.5,r.g=255&u*r.g+n*a.g+.5,r.b=255&u*r.b+n*a.b+.5,r.a=i*r.a+(1-i)*a.a,this.rgb=r}return this}},{key:"interpolate",value:function(e,t){return e&&(this._rgb=function(e,t,n){var r=_N(rN(e.r)),a=_N(rN(e.g)),i=_N(rN(e.b));return{r:nN(CN(r+n*(_N(rN(t.r))-r))),g:nN(CN(a+n*(_N(rN(t.g))-a))),b:nN(CN(i+n*(_N(rN(t.b))-i))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}},{key:"clone",value:function(){return new e(this.rgb)}},{key:"alpha",value:function(e){return this._rgb.a=nN(e),this}},{key:"clearer",value:function(e){return this._rgb.a*=1-e,this}},{key:"greyscale",value:function(){var e=this._rgb,t=$E(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}},{key:"opaquer",value:function(e){return this._rgb.a*=1+e,this}},{key:"negate",value:function(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}},{key:"lighten",value:function(e){return TN(this._rgb,2,e),this}},{key:"darken",value:function(e){return TN(this._rgb,2,-e),this}},{key:"saturate",value:function(e){return TN(this._rgb,1,e),this}},{key:"desaturate",value:function(e){return TN(this._rgb,1,-e),this}},{key:"rotate",value:function(e){return function(e,t){var n=vN(e);n[0]=yN(n[0]+t),n=mN(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}]),e}();function RN(){}var MN=function(){var e=0;return function(){return e++}}();function ON(e){return null===e||"undefined"===typeof e}function FN(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function PN(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function LN(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function ZN(e,t){return LN(e)?e:t}function zN(e,t){return"undefined"===typeof e?t:e}var BN=function(e,t){return"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e};function UN(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function VN(e,t,n,r){var a,i,o;if(FN(e))if(i=e.length,r)for(a=i-1;a>=0;a--)t.call(n,e[a],a);else for(a=0;a<i;a++)t.call(n,e[a],a);else if(PN(e))for(i=(o=Object.keys(e)).length,a=0;a<i;a++)t.call(n,e[o[a]],o[a])}function jN(e,t){var n,r,a,i;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(a=e[n],i=t[n],a.datasetIndex!==i.datasetIndex||a.index!==i.index)return!1;return!0}function WN(e){if(FN(e))return e.map(WN);if(PN(e)){for(var t=Object.create(null),n=Object.keys(e),r=n.length,a=0;a<r;++a)t[n[a]]=WN(e[n[a]]);return t}return e}function HN(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function GN(e,t,n,r){if(HN(e)){var a=t[e],i=n[e];PN(a)&&PN(i)?qN(a,i,r):t[e]=WN(i)}}function qN(e,t,n){var r=FN(t)?t:[t],a=r.length;if(!PN(e))return e;for(var i,o=(n=n||{}).merger||GN,s=0;s<a;++s)if(PN(i=r[s]))for(var u=Object.keys(i),c=0,l=u.length;c<l;++c)o(u[c],e,i,n);return e}function KN(e,t){return qN(e,t,{merger:YN})}function YN(e,t,n){if(HN(e)){var r=t[e],a=n[e];PN(r)&&PN(a)?KN(r,a):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=WN(a))}}var XN={"":function(e){return e},x:function(e){return e.x},y:function(e){return e.y}};function QN(e){var t=function(e){var t,n=e.split("."),r=[],a="",i=(0,C.Z)(n);try{for(i.s();!(t=i.n()).done;)(a+=t.value).endsWith("\\")?a=a.slice(0,-1)+".":(r.push(a),a="")}catch(o){i.e(o)}finally{i.f()}return r}(e);return function(e){var n,r=(0,C.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(""===a)break;e=e&&e[a]}}catch(i){r.e(i)}finally{r.f()}return e}}function JN(e,t){return(XN[t]||(XN[t]=QN(t)))(e)}function $N(e){return e.charAt(0).toUpperCase()+e.slice(1)}var eD=function(e){return"undefined"!==typeof e},tD=function(e){return"function"===typeof e},nD=function(e,t){if(e.size!==t.size)return!1;var n,r=(0,C.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0};var rD=Math.PI,aD=2*rD,iD=aD+rD,oD=Number.POSITIVE_INFINITY,sD=rD/180,uD=rD/2,cD=rD/4,lD=2*rD/3,hD=Math.log10,fD=Math.sign;function dD(e,t,n){return Math.abs(e-t)<n}function pD(e){var t=Math.round(e);e=dD(e,t,e/1e3)?t:e;var n=Math.pow(10,Math.floor(hD(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function vD(e){return!isNaN(parseFloat(e))&&isFinite(e)}function gD(e,t,n){var r,a,i;for(r=0,a=e.length;r<a;r++)i=e[r][n],isNaN(i)||(t.min=Math.min(t.min,i),t.max=Math.max(t.max,i))}function mD(e){return e*(rD/180)}function yD(e){return e*(180/rD)}function bD(e){if(LN(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}}function kD(e,t){var n=t.x-e.x,r=t.y-e.y,a=Math.sqrt(n*n+r*r),i=Math.atan2(r,n);return i<-.5*rD&&(i+=aD),{angle:i,distance:a}}function xD(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function wD(e,t){return(e-t+iD)%aD-rD}function ID(e){return(e%aD+aD)%aD}function SD(e,t,n,r){var a=ID(e),i=ID(t),o=ID(n),s=ID(i-a),u=ID(o-a),c=ID(a-i),l=ID(a-o);return a===i||a===o||r&&i===o||s>u&&c<l}function CD(e,t,n){return Math.max(t,Math.min(n,e))}function _D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function TD(e,t,n){n=n||function(n){return e[n]<t};for(var r,a=e.length-1,i=0;a-i>1;)n(r=i+a>>1)?i=r:a=r;return{lo:i,hi:a}}var ED=function(e,t,n,r){return TD(e,n,r?function(r){var a=e[r][t];return a<n||a===n&&e[r+1][t]===n}:function(r){return e[r][t]<n})},ND=function(e,t,n){return TD(e,n,(function(r){return e[r][t]>=n}))};var DD=["push","pop","shift","splice","unshift"];function AD(e,t){var n=e._chartjs;if(n){var r=n.listeners,a=r.indexOf(t);-1!==a&&r.splice(a,1),r.length>0||(DD.forEach((function(t){delete e[t]})),delete e._chartjs)}}function RD(e){var t=new Set(e);return t.size===e.length?e:Array.from(t)}var MD="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function OD(e,t){var n=[],r=!1;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];n=i,r||(r=!0,MD.call(window,(function(){r=!1,e.apply(t,n)})))}}var FD=function(e){return"start"===e?"left":"end"===e?"right":"center"},PD=function(e,t,n){return"start"===e?t:"end"===e?n:(t+n)/2};function LD(e,t,n){var r=t.length,a=0,i=r;if(e._sorted){var o=e.iScale,s=e._parsed,u=o.axis,c=o.getUserBounds(),l=c.min,h=c.max,f=c.minDefined,d=c.maxDefined;f&&(a=CD(Math.min(ED(s,o.axis,l).lo,n?r:ED(t,u,o.getPixelForValue(l)).lo),0,r-1)),i=d?CD(Math.max(ED(s,o.axis,h,!0).hi+1,n?0:ED(t,u,o.getPixelForValue(h),!0).hi+1),a,r)-a:r-a}return{start:a,count:i}}function ZD(e){var t=e.xScale,n=e.yScale,r=e._scaleRanges,a={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=a,!0;var i=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,a),i}var zD=function(e){return 0===e||1===e},BD=function(e,t,n){return-Math.pow(2,10*(e-=1))*Math.sin((e-t)*aD/n)},UD=function(e,t,n){return Math.pow(2,-10*e)*Math.sin((e-t)*aD/n)+1},VD={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*uD)},easeOutSine:function(e){return Math.sin(e*uD)},easeInOutSine:function(e){return-.5*(Math.cos(rD*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return zD(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1)))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){return zD(e)?e:BD(e,.075,.3)},easeOutElastic:function(e){return zD(e)?e:UD(e,.075,.3)},easeInOutElastic:function(e){var t=.1125;return zD(e)?e:e<.5?.5*BD(2*e,t,.45):.5+.5*UD(2*e-1,t,.45)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-VD.easeOutBounce(1-e)},easeOutBounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*VD.easeInBounce(2*e):.5*VD.easeOutBounce(2*e-1)+.5}};function jD(e){if(e&&"object"===typeof e){var t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function WD(e){return jD(e)?e:new AN(e)}function HD(e){return jD(e)?e:new AN(e).saturate(.5).darken(.1).hexString()}var GD=["x","y","borderWidth","radius","tension"],qD=["color","borderColor","backgroundColor"];var KD=new Map;function YD(e,t,n){return function(e,t){t=t||{};var n=e+JSON.stringify(t),r=KD.get(n);return r||(r=new Intl.NumberFormat(e,t),KD.set(n,r)),r}(t,n).format(e)}var XD={values:function(e){return FN(e)?e:""+e},numeric:function(e,t,n){if(0===e)return"0";var r,a=this.chart.options.locale,i=e;if(n.length>1){var o=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(o<1e-4||o>1e15)&&(r="scientific"),i=function(e,t){var n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}var s=hD(Math.abs(i)),u=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),c={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(c,this.options.ticks.format),YD(e,a,c)},logarithmic:function(e,t,n){if(0===e)return"0";var r=n[t].significand||e/Math.pow(10,Math.floor(hD(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?XD.numeric.call(this,e,t,n):""}};var QD={formatters:XD};var JD=Object.create(null),$D=Object.create(null);function eA(e,t){if(!t)return e;for(var n=t.split("."),r=0,a=n.length;r<a;++r){var i=n[r];e=e[i]||(e[i]=Object.create(null))}return e}function tA(e,t,n){return"string"===typeof t?qN(eA(e,t),n):qN(eA(e,""),t)}var nA=function(){function e(t,n){(0,p.Z)(this,e),this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=function(e){return e.chart.platform.getDevicePixelRatio()},this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=function(e,t){return HD(t.backgroundColor)},this.hoverBorderColor=function(e,t){return HD(t.borderColor)},this.hoverColor=function(e,t){return HD(t.color)},this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}return(0,v.Z)(e,[{key:"set",value:function(e,t){return tA(this,e,t)}},{key:"get",value:function(e){return eA(this,e)}},{key:"describe",value:function(e,t){return tA($D,e,t)}},{key:"override",value:function(e,t){return tA(JD,e,t)}},{key:"route",value:function(e,t,n,r){var a,i=eA(this,e),o=eA(this,n),s="_"+t;Object.defineProperties(i,(a={},(0,Ye.Z)(a,s,{value:i[t],writable:!0}),(0,Ye.Z)(a,t,{enumerable:!0,get:function(){var e=this[s],t=o[r];return PN(e)?Object.assign({},t,e):zN(e,t)},set:function(e){this[s]=e}}),a))}},{key:"apply",value:function(e){var t=this;e.forEach((function(e){return e(t)}))}}]),e}(),rA=new nA({_scriptable:function(e){return!e.startsWith("on")},_indexable:function(e){return"events"!==e},hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:function(e){return"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}}),e.set("animations",{colors:{type:"color",properties:qD},numbers:{type:"number",properties:GD}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:function(e){return 0|e}}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:function(e,t){return t.lineWidth},tickColor:function(e,t){return t.color},offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:QD.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:function(e){return!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e},_indexable:function(e){return"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:function(e){return"backdropPadding"!==e&&"callback"!==e},_indexable:function(e){return"backdropPadding"!==e}})}]);function aA(e,t,n,r,a){var i=t[a];return i||(i=t[a]=e.measureText(a).width,n.push(a)),i>r&&(r=i),r}function iA(e,t,n,r){var a=(r=r||{}).data=r.data||{},i=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(a=r.data={},i=r.garbageCollect=[],r.font=t),e.save(),e.font=t;var o,s,u,c,l,h=0,f=n.length;for(o=0;o<f;o++)if(void 0===(c=n[o])||null===c||FN(c)){if(FN(c))for(s=0,u=c.length;s<u;s++)void 0===(l=c[s])||null===l||FN(l)||(h=aA(e,a,i,h,l))}else h=aA(e,a,i,h,c);e.restore();var d=i.length/2;if(d>n.length){for(o=0;o<d;o++)delete a[i[o]];i.splice(0,d)}return h}function oA(e,t,n){var r=e.currentDevicePixelRatio,a=0!==n?Math.max(n/2,.5):0;return Math.round((t-a)*r)/r+a}function sA(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function uA(e,t,n,r){cA(e,t,n,r,null)}function cA(e,t,n,r,a){var i,o,s,u,c,l,h,f,d=t.pointStyle,p=t.rotation,v=t.radius,g=(p||0)*sD;if(d&&"object"===typeof d&&("[object HTMLImageElement]"===(i=d.toString())||"[object HTMLCanvasElement]"===i))return e.save(),e.translate(n,r),e.rotate(g),e.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),void e.restore();if(!(isNaN(v)||v<=0)){switch(e.beginPath(),d){default:a?e.ellipse(n,r,a/2,v,0,0,aD):e.arc(n,r,v,0,aD),e.closePath();break;case"triangle":l=a?a/2:v,e.moveTo(n+Math.sin(g)*l,r-Math.cos(g)*v),g+=lD,e.lineTo(n+Math.sin(g)*l,r-Math.cos(g)*v),g+=lD,e.lineTo(n+Math.sin(g)*l,r-Math.cos(g)*v),e.closePath();break;case"rectRounded":u=v-(c=.516*v),o=Math.cos(g+cD)*u,h=Math.cos(g+cD)*(a?a/2-c:u),s=Math.sin(g+cD)*u,f=Math.sin(g+cD)*(a?a/2-c:u),e.arc(n-h,r-s,c,g-rD,g-uD),e.arc(n+f,r-o,c,g-uD,g),e.arc(n+h,r+s,c,g,g+uD),e.arc(n-f,r+o,c,g+uD,g+rD),e.closePath();break;case"rect":if(!p){u=Math.SQRT1_2*v,l=a?a/2:u,e.rect(n-l,r-u,2*l,2*u);break}g+=cD;case"rectRot":h=Math.cos(g)*(a?a/2:v),o=Math.cos(g)*v,s=Math.sin(g)*v,f=Math.sin(g)*(a?a/2:v),e.moveTo(n-h,r-s),e.lineTo(n+f,r-o),e.lineTo(n+h,r+s),e.lineTo(n-f,r+o),e.closePath();break;case"crossRot":g+=cD;case"cross":h=Math.cos(g)*(a?a/2:v),o=Math.cos(g)*v,s=Math.sin(g)*v,f=Math.sin(g)*(a?a/2:v),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+f,r-o),e.lineTo(n-f,r+o);break;case"star":h=Math.cos(g)*(a?a/2:v),o=Math.cos(g)*v,s=Math.sin(g)*v,f=Math.sin(g)*(a?a/2:v),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+f,r-o),e.lineTo(n-f,r+o),g+=cD,h=Math.cos(g)*(a?a/2:v),o=Math.cos(g)*v,s=Math.sin(g)*v,f=Math.sin(g)*(a?a/2:v),e.moveTo(n-h,r-s),e.lineTo(n+h,r+s),e.moveTo(n+f,r-o),e.lineTo(n-f,r+o);break;case"line":o=a?a/2:Math.cos(g)*v,s=Math.sin(g)*v,e.moveTo(n-o,r-s),e.lineTo(n+o,r+s);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(g)*(a?a/2:v),r+Math.sin(g)*v);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function lA(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function hA(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function fA(e){e.restore()}function dA(e,t,n,r,a){if(!t)return e.lineTo(n.x,n.y);if("middle"===a){var i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===a!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function pA(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function vA(e,t,n,r,a){if(a.strikethrough||a.underline){var i=e.measureText(r),o=t-i.actualBoundingBoxLeft,s=t+i.actualBoundingBoxRight,u=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,l=a.strikethrough?(u+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=a.decorationWidth||2,e.moveTo(o,l),e.lineTo(s,l),e.stroke()}}function gA(e,t){var n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function mA(e,t,n,r,a){var i,o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=FN(t)?t:[t],c=s.strokeWidth>0&&""!==s.strokeColor;for(e.save(),e.font=a.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),ON(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),i=0;i<u.length;++i)o=u[i],s.backdrop&&gA(e,s.backdrop),c&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),ON(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(o,n,r,s.maxWidth)),e.fillText(o,n,r,s.maxWidth),vA(e,n,r,o,s),r+=Number(a.lineHeight);e.restore()}function yA(e,t){var n=t.x,r=t.y,a=t.w,i=t.h,o=t.radius;e.arc(n+o.topLeft,r+o.topLeft,o.topLeft,-uD,rD,!0),e.lineTo(n,r+i-o.bottomLeft),e.arc(n+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,rD,uD,!0),e.lineTo(n+a-o.bottomRight,r+i),e.arc(n+a-o.bottomRight,r+i-o.bottomRight,o.bottomRight,uD,0,!0),e.lineTo(n+a,r+o.topRight),e.arc(n+a-o.topRight,r+o.topRight,o.topRight,0,-uD,!0),e.lineTo(n+o.topLeft,r)}var bA=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,kA=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function xA(e,t){var n=(""+e).match(bA);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}var wA=function(e){return+e||0};function IA(e,t){var n,r={},a=PN(t),i=a?Object.keys(t):t,o=PN(e)?a?function(n){return zN(e[n],e[t[n]])}:function(t){return e[t]}:function(){return e},s=(0,C.Z)(i);try{for(s.s();!(n=s.n()).done;){var u=n.value;r[u]=wA(o(u))}}catch(c){s.e(c)}finally{s.f()}return r}function SA(e){return IA(e,{top:"y",right:"x",bottom:"y",left:"x"})}function CA(e){return IA(e,["topLeft","topRight","bottomLeft","bottomRight"])}function _A(e){var t=SA(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function TA(e,t){e=e||{},t=t||rA.font;var n=zN(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));var r=zN(e.style,t.style);r&&!(""+r).match(kA)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);var a={family:zN(e.family,t.family),lineHeight:xA(zN(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:zN(e.weight,t.weight),string:""};return a.string=function(e){return!e||ON(e.size)||ON(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(a),a}function EA(e,t,n,r){var a,i,o,s=!0;for(a=0,i=e.length;a<i;++a)if(void 0!==(o=e[a])&&(void 0!==t&&"function"===typeof o&&(o=o(t),s=!1),void 0!==n&&FN(o)&&(o=o[n%o.length],s=!1),void 0!==o))return r&&!s&&(r.cacheable=!1),o}function NA(e,t){return Object.assign(Object.create(e),t)}function DA(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return e[0]},i=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof r&&(r=UA("_fallback",e));var o=(t={},(0,Ye.Z)(t,Symbol.toStringTag,"Object"),(0,Ye.Z)(t,"_cacheable",!0),(0,Ye.Z)(t,"_scopes",e),(0,Ye.Z)(t,"_rootScopes",i),(0,Ye.Z)(t,"_fallback",r),(0,Ye.Z)(t,"_getTarget",a),(0,Ye.Z)(t,"override",(function(t){return DA([t].concat(d(e)),n,i,r)})),t);return new Proxy(o,{deleteProperty:function(t,n){return delete t[n],delete t._keys,delete e[0][n],!0},get:function(t,r){return FA(t,r,(function(){return function(e,t,n,r){var a,i,o=(0,C.Z)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;if("undefined"!==typeof(a=UA(MA(s,e),n)))return OA(e,a)?zA(n,r,e,a):a}}catch(u){o.e(u)}finally{o.f()}}(r,n,e,t)}))},getOwnPropertyDescriptor:function(e,t){return Reflect.getOwnPropertyDescriptor(e._scopes[0],t)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e[0])},has:function(e,t){return VA(e).includes(t)},ownKeys:function(e){return VA(e)},set:function(e,t,n){var r=e._storage||(e._storage=a());return e[t]=r[t]=n,delete e._keys,!0}})}function AA(e,t,n,r){var a={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:RA(e,r),setContext:function(t){return AA(e,t,n,r)},override:function(a){return AA(e.override(a),t,n,r)}};return new Proxy(a,{deleteProperty:function(t,n){return delete t[n],delete e[n],!0},get:function(e,t,n){return FA(e,t,(function(){return function(e,t,n){var r=e._proxy,a=e._context,i=e._subProxy,o=e._descriptors,s=r[t];tD(s)&&o.isScriptable(t)&&(s=function(e,t,n,r){var a=n._proxy,i=n._context,o=n._subProxy,s=n._stack;if(s.has(e))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+e);s.add(e);var u=t(i,o||r);s.delete(e),OA(e,u)&&(u=zA(a._scopes,a,e,u));return u}(t,s,e,n));FN(s)&&s.length&&(s=function(e,t,n,r){var a=n._proxy,i=n._context,o=n._subProxy,s=n._descriptors;if("undefined"!==typeof i.index&&r(e))return t[i.index%t.length];if(PN(t[0])){var u=t,c=a._scopes.filter((function(e){return e!==u}));t=[];var l,h=(0,C.Z)(u);try{for(h.s();!(l=h.n()).done;){var f=zA(c,a,e,l.value);t.push(AA(f,i,o&&o[e],s))}}catch(d){h.e(d)}finally{h.f()}}return t}(t,s,e,o.isIndexable));OA(t,s)&&(s=AA(s,a,i&&i[t],o));return s}(e,t,n)}))},getOwnPropertyDescriptor:function(t,n){return t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e)},has:function(t,n){return Reflect.has(e,n)},ownKeys:function(){return Reflect.ownKeys(e)},set:function(t,n,r){return e[n]=r,delete t[n],!0}})}function RA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0},n=e._scriptable,r=void 0===n?t.scriptable:n,a=e._indexable,i=void 0===a?t.indexable:a,o=e._allKeys;return{allKeys:void 0===o?t.allKeys:o,scriptable:r,indexable:i,isScriptable:tD(r)?r:function(){return r},isIndexable:tD(i)?i:function(){return i}}}var MA=function(e,t){return e?e+$N(t):t},OA=function(e,t){return PN(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object)};function FA(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];var r=n();return e[t]=r,r}function PA(e,t,n){return tD(e)?e(t,n):e}var LA=function(e,t){return!0===e?t:"string"===typeof e?JN(t,e):void 0};function ZA(e,t,n,r,a){var i,o=(0,C.Z)(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=LA(n,s);if(u){e.add(u);var c=PA(u._fallback,n,a);if("undefined"!==typeof c&&c!==n&&c!==r)return c}else if(!1===u&&"undefined"!==typeof r&&n!==r)return null}}catch(l){o.e(l)}finally{o.f()}return!1}function zA(e,t,n,r){var a=t._rootScopes,i=PA(t._fallback,n,r),o=[].concat(d(e),d(a)),s=new Set;s.add(r);var u=BA(s,o,n,i||n,r);return null!==u&&(("undefined"===typeof i||i===n||null!==(u=BA(s,o,i,u,r)))&&DA(Array.from(s),[""],a,i,(function(){return function(e,t,n){var r=e._getTarget();t in r||(r[t]={});var a=r[t];if(FN(a)&&PN(n))return n;return a||{}}(t,n,r)})))}function BA(e,t,n,r,a){for(;n;)n=ZA(e,t,n,r,a);return n}function UA(e,t){var n,r=(0,C.Z)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a){var i=a[e];if("undefined"!==typeof i)return i}}}catch(o){r.e(o)}finally{r.f()}}function VA(e){var t=e._keys;return t||(t=e._keys=function(e){var t,n=new Set,r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=(0,C.Z)(Object.keys(i).filter((function(e){return!e.startsWith("_")})));try{for(o.s();!(a=o.n()).done;){var s=a.value;n.add(s)}}catch(u){o.e(u)}finally{o.f()}}}catch(u){r.e(u)}finally{r.f()}return Array.from(n)}(e._scopes)),t}function jA(e,t,n,r){var a,i,o,s,u=e.iScale,c=this._parsing.key,l=void 0===c?"r":c,h=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],h[a]={r:u.parse(JN(s,l),o)};return h}var WA=Number.EPSILON||1e-14,HA=function(e,t){return t<e.length&&!e[t].skip&&e[t]},GA=function(e){return"x"===e?"y":"x"};function qA(e,t,n,r){var a=e.skip?t:e,i=t,o=n.skip?t:n,s=xD(i,a),u=xD(o,i),c=s/(s+u),l=u/(s+u),h=r*(c=isNaN(c)?0:c),f=r*(l=isNaN(l)?0:l);return{previous:{x:i.x-h*(o.x-a.x),y:i.y-h*(o.y-a.y)},next:{x:i.x+f*(o.x-a.x),y:i.y+f*(o.y-a.y)}}}function KA(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",i=GA(a),o=e.length,s=Array(o).fill(0),u=Array(o),c=HA(e,0);for(t=0;t<o;++t)if(n=r,r=c,c=HA(e,t+1),r){if(c){var l=c[a]-r[a];s[t]=0!==l?(c[i]-r[i])/l:0}u[t]=n?c?fD(s[t-1])!==fD(s[t])?0:(s[t-1]+s[t])/2:s[t-1]:s[t]}!function(e,t,n){for(var r,a,i,o,s,u=e.length,c=HA(e,0),l=0;l<u-1;++l)s=c,c=HA(e,l+1),s&&c&&(dD(t[l],0,WA)?n[l]=n[l+1]=0:(r=n[l]/t[l],a=n[l+1]/t[l],(o=Math.pow(r,2)+Math.pow(a,2))<=9||(i=3/Math.sqrt(o),n[l]=r*i*t[l],n[l+1]=a*i*t[l])))}(e,s,u),function(e,t){for(var n,r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",o=GA(i),s=e.length,u=HA(e,0),c=0;c<s;++c)if(r=a,a=u,u=HA(e,c+1),a){var l=a[i],h=a[o];r&&(n=(l-r[i])/3,a["cp1".concat(i)]=l-n,a["cp1".concat(o)]=h-n*t[c]),u&&(n=(u[i]-l)/3,a["cp2".concat(i)]=l+n,a["cp2".concat(o)]=h+n*t[c])}}(e,u,a)}function YA(e,t,n){return Math.max(Math.min(e,n),t)}function XA(e,t,n,r,a){var i,o,s,u;if(t.spanGaps&&(e=e.filter((function(e){return!e.skip}))),"monotone"===t.cubicInterpolationMode)KA(e,a);else{var c=r?e[e.length-1]:e[0];for(i=0,o=e.length;i<o;++i)u=qA(c,s=e[i],e[Math.min(i+1,o-(r?0:1))%o],t.tension),s.cp1x=u.previous.x,s.cp1y=u.previous.y,s.cp2x=u.next.x,s.cp2y=u.next.y,c=s}t.capBezierPoints&&function(e,t){var n,r,a,i,o,s=lA(e[0],t);for(n=0,r=e.length;n<r;++n)o=i,i=s,s=n<r-1&&lA(e[n+1],t),i&&(a=e[n],o&&(a.cp1x=YA(a.cp1x,t.left,t.right),a.cp1y=YA(a.cp1y,t.top,t.bottom)),s&&(a.cp2x=YA(a.cp2x,t.left,t.right),a.cp2y=YA(a.cp2y,t.top,t.bottom)))}(e,n)}function QA(){return"undefined"!==typeof window&&"undefined"!==typeof document}function JA(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function $A(e,t,n){var r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}var eR=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)};var tR=["top","right","bottom","left"];function nR(e,t,n){var r={};n=n?"-"+n:"";for(var a=0;a<4;a++){var i=tR[a];r[i]=parseFloat(e[t+"-"+i+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}var rR=function(e,t,n){return(e>0||t>0)&&(!n||!n.shadowRoot)};function aR(e,t){if("native"in e)return e;var n=t.canvas,r=t.currentDevicePixelRatio,a=eR(n),i="border-box"===a.boxSizing,o=nR(a,"padding"),s=nR(a,"border","width"),u=function(e,t){var n,r,a=e.touches,i=a&&a.length?a[0]:e,o=i.offsetX,s=i.offsetY,u=!1;if(rR(o,s,e.target))n=o,r=s;else{var c=t.getBoundingClientRect();n=i.clientX-c.left,r=i.clientY-c.top,u=!0}return{x:n,y:r,box:u}}(e,n),c=u.x,l=u.y,h=u.box,f=o.left+(h&&s.left),d=o.top+(h&&s.top),p=t.width,v=t.height;return i&&(p-=o.width+s.width,v-=o.height+s.height),{x:Math.round((c-f)/p*n.width/r),y:Math.round((l-d)/v*n.height/r)}}var iR=function(e){return Math.round(10*e)/10};function oR(e,t,n,r){var a=eR(e),i=nR(a,"margin"),o=$A(a.maxWidth,e,"clientWidth")||oD,s=$A(a.maxHeight,e,"clientHeight")||oD,u=function(e,t,n){var r,a;if(void 0===t||void 0===n){var i=JA(e);if(i){var o=i.getBoundingClientRect(),s=eR(i),u=nR(s,"border","width"),c=nR(s,"padding");t=o.width-c.width-u.width,n=o.height-c.height-u.height,r=$A(s.maxWidth,i,"clientWidth"),a=$A(s.maxHeight,i,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||oD,maxHeight:a||oD}}(e,t,n),c=u.width,l=u.height;if("content-box"===a.boxSizing){var h=nR(a,"border","width"),f=nR(a,"padding");c-=f.width+h.width,l-=f.height+h.height}return c=Math.max(0,c-i.width),l=Math.max(0,r?c/r:l-i.height),c=iR(Math.min(c,o,u.maxWidth)),l=iR(Math.min(l,s,u.maxHeight)),c&&!l&&(l=iR(c/2)),(void 0!==t||void 0!==n)&&r&&u.height&&l>u.height&&(l=u.height,c=iR(Math.floor(l*r))),{width:c,height:l}}function sR(e,t,n){var r=t||1,a=Math.floor(e.height*r),i=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);var o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height="".concat(e.height,"px"),o.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==r||o.height!==a||o.width!==i)&&(e.currentDevicePixelRatio=r,o.height=a,o.width=i,e.ctx.setTransform(r,0,0,r,0,0),!0)}var uR=function(){var e=!1;try{var t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(n){}return e}();function cR(e,t){var n=function(e,t){return eR(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function lR(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function hR(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function fR(e,t,n,r){var a={x:e.cp2x,y:e.cp2y},i={x:t.cp1x,y:t.cp1y},o=lR(e,a,n),s=lR(a,i,n),u=lR(i,t,n),c=lR(o,s,n),l=lR(s,u,n);return lR(c,l,n)}function dR(e,t,n){return e?function(e,t){return{x:function(n){return e+e+t-n},setWidth:function(e){t=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}}(t,n):{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}}function pR(e,t){var n,r;"ltr"!==t&&"rtl"!==t||(r=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function vR(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function gR(e){return"angle"===e?{between:SD,compare:wD,normalize:ID}:{between:_D,compare:function(e,t){return e-t},normalize:function(e){return e}}}function mR(e){var t=e.start,n=e.end,r=e.count;return{start:t%r,end:n%r,loop:e.loop&&(n-t+1)%r===0,style:e.style}}function yR(e,t,n){if(!n)return[e];for(var r,a,i,o=n.property,s=n.start,u=n.end,c=t.length,l=gR(o),h=l.compare,f=l.between,d=l.normalize,p=function(e,t,n){var r,a,i=n.property,o=n.start,s=n.end,u=gR(i),c=u.between,l=u.normalize,h=t.length,f=e.start,d=e.end,p=e.loop;if(p){for(f+=h,d+=h,r=0,a=h;r<a&&c(l(t[f%h][i]),o,s);++r)f--,d--;f%=h,d%=h}return d<f&&(d+=h),{start:f,end:d,loop:p,style:e.style}}(e,t,n),v=p.start,g=p.end,m=p.loop,y=p.style,b=[],k=!1,x=null,w=function(){return k||f(s,i,r)&&0!==h(s,i)},I=function(){return!k||0===h(u,r)||f(u,i,r)},S=v,C=v;S<=g;++S)(a=t[S%c]).skip||(r=d(a[o]))!==i&&(k=f(r,s,u),null===x&&w()&&(x=0===h(r,s)?S:C),null!==x&&I()&&(b.push(mR({start:x,end:S,loop:m,count:c,style:y})),x=null),C=S,i=r);return null!==x&&b.push(mR({start:x,end:g,loop:m,count:c,style:y})),b}function bR(e,t){for(var n=[],r=e.segments,a=0;a<r.length;a++){var i=yR(r[a],e.points,t);i.length&&n.push.apply(n,d(i))}return n}function kR(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){var a=e._chart.getContext(),i=xR(e.options),o=e._datasetIndex,s=e.options.spanGaps,u=n.length,c=[],l=i,h=t[0].start,f=h;function d(e,t,r,a){var i=s?-1:1;if(e!==t){for(e+=u;n[e%u].skip;)e-=i;for(;n[t%u].skip;)t+=i;e%u!==t%u&&(c.push({start:e%u,end:t%u,loop:r,style:a}),l=a,h=t%u)}}var p,v=(0,C.Z)(t);try{for(v.s();!(p=v.n()).done;){var g=p.value;h=s?h:g.start;var m=n[h%u],y=void 0;for(f=h+1;f<=g.end;f++){var b=n[f%u];wR(y=xR(r.setContext(NA(a,{type:"segment",p0:m,p1:b,p0DataIndex:(f-1)%u,p1DataIndex:f%u,datasetIndex:o}))),l)&&d(h,f-1,g.loop,l),m=b,l=y}h<f-1&&d(h,f-1,g.loop,l)}}catch(k){v.e(k)}finally{v.f()}return c}(e,t,n,r):t}function xR(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function wR(e,t){if(!t)return!1;var n=[],r=function(e,t){return jD(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}var IR=function(){function e(){(0,p.Z)(this,e),this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}return(0,v.Z)(e,[{key:"_notify",value:function(e,t,n,r){var a=t.listeners[r],i=t.duration;a.forEach((function(r){return r({chart:e,initial:t.initial,numSteps:i,currentStep:Math.min(n-t.start,i)})}))}},{key:"_refresh",value:function(){var e=this;this._request||(this._running=!0,this._request=MD.call(window,(function(){e._update(),e._request=null,e._running&&e._refresh()})))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=0;this._charts.forEach((function(r,a){if(r.running&&r.items.length){for(var i,o=r.items,s=o.length-1,u=!1;s>=0;--s)(i=o[s])._active?(i._total>r.duration&&(r.duration=i._total),i.tick(t),u=!0):(o[s]=o[o.length-1],o.pop());u&&(a.draw(),e._notify(a,r,t,"progress")),o.length||(r.running=!1,e._notify(a,r,t,"complete"),r.initial=!1),n+=o.length}})),this._lastDate=t,0===n&&(this._running=!1)}},{key:"_getAnims",value:function(e){var t=this._charts,n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}},{key:"listen",value:function(e,t,n){this._getAnims(e).listeners[t].push(n)}},{key:"add",value:function(e,t){var n;t&&t.length&&(n=this._getAnims(e).items).push.apply(n,d(t))}},{key:"has",value:function(e){return this._getAnims(e).items.length>0}},{key:"start",value:function(e){var t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((function(e,t){return Math.max(e,t._duration)}),0),this._refresh())}},{key:"running",value:function(e){if(!this._running)return!1;var t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}},{key:"stop",value:function(e){var t=this._charts.get(e);if(t&&t.items.length){for(var n=t.items,r=n.length-1;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}}},{key:"remove",value:function(e){return this._charts.delete(e)}}]),e}(),SR=new IR,CR="transparent",_R={boolean:function(e,t,n){return n>.5?t:e},color:function(e,t,n){var r=WD(e||CR),a=r.valid&&WD(t||CR);return a&&a.valid?a.mix(r,n).hexString():t},number:function(e,t,n){return e+(t-e)*n}},TR=function(){function e(t,n,r,a){(0,p.Z)(this,e);var i=n[r];a=EA([t.to,a,i,t.from]);var o=EA([t.from,i,a]);this._active=!0,this._fn=t.fn||_R[t.type||typeof o],this._easing=VD[t.easing]||VD.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=r,this._from=o,this._to=a,this._promises=void 0}return(0,v.Z)(e,[{key:"active",value:function(){return this._active}},{key:"update",value:function(e,t,n){if(this._active){this._notify(!1);var r=this._target[this._prop],a=n-this._start,i=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=EA([e.to,t,r,e.from]),this._from=EA([e.from,r,t])}}},{key:"cancel",value:function(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}},{key:"tick",value:function(e){var t,n=e-this._start,r=this._duration,a=this._prop,i=this._from,o=this._loop,s=this._to;if(this._active=i!==s&&(o||n<r),!this._active)return this._target[a]=s,void this._notify(!0);n<0?this._target[a]=i:(t=n/r%2,t=o&&t>1?2-t:t,t=this._easing(Math.min(1,Math.max(0,t))),this._target[a]=this._fn(i,s,t))}},{key:"wait",value:function(){var e=this._promises||(this._promises=[]);return new Promise((function(t,n){e.push({res:t,rej:n})}))}},{key:"_notify",value:function(e){for(var t=e?"res":"rej",n=this._promises||[],r=0;r<n.length;r++)n[r][t]()}}]),e}(),ER=function(){function e(t,n){(0,p.Z)(this,e),this._chart=t,this._properties=new Map,this.configure(n)}return(0,v.Z)(e,[{key:"configure",value:function(e){if(PN(e)){var t=Object.keys(rA.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((function(r){var a=e[r];if(PN(a)){for(var i={},o=0,s=t;o<s.length;o++){var u=s[o];i[u]=a[u]}(FN(a.properties)&&a.properties||[r]).forEach((function(e){e!==r&&n.has(e)||n.set(e,i)}))}}))}}},{key:"_animateOptions",value:function(e,t){var n=t.options,r=function(e,t){if(!t)return;var n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];var a=this._createAnimations(r,n);return n.$shared&&function(e,t){for(var n=[],r=Object.keys(t),a=0;a<r.length;a++){var i=e[r[a]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}(e.options.$animations,n).then((function(){e.options=n}),(function(){})),a}},{key:"_createAnimations",value:function(e,t){var n,r=this._properties,a=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),s=Date.now();for(n=o.length-1;n>=0;--n){var u=o[n];if("$"!==u.charAt(0))if("options"!==u){var c=t[u],l=i[u],h=r.get(u);if(l){if(h&&l.active()){l.update(h,c,s);continue}l.cancel()}h&&h.duration?(i[u]=l=new TR(h,e,u,c),a.push(l)):e[u]=c}else a.push.apply(a,d(this._animateOptions(e,t)))}return a}},{key:"update",value:function(e,t){if(0!==this._properties.size){var n=this._createAnimations(e,t);return n.length?(SR.add(this._chart,n),!0):void 0}Object.assign(e,t)}}]),e}();function NR(e,t){var n=e&&e.options||{},r=n.reverse,a=void 0===n.min?t:0,i=void 0===n.max?t:0;return{start:r?i:a,end:r?a:i}}function DR(e,t){var n,r,a=[],i=e._getSortedDatasetMetas(t);for(n=0,r=i.length;n<r;++n)a.push(i[n].index);return a}function AR(e,t,n){var r,a,i,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=e.keys,c="single"===s.mode;if(null!==t){for(r=0,a=u.length;r<a;++r){if((i=+u[r])===n){if(s.all)continue;break}LN(o=e.values[i])&&(c||0===t||fD(t)===fD(o))&&(t+=o)}return t}}function RR(e,t){var n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function MR(e,t,n){var r=e[t]||(e[t]={});return r[n]||(r[n]={})}function OR(e,t,n,r){var a,i=(0,C.Z)(t.getMatchingVisibleMetas(r).reverse());try{for(i.s();!(a=i.n()).done;){var o=a.value,s=e[o.index];if(n&&s>0||!n&&s<0)return o.index}}catch(u){i.e(u)}finally{i.f()}return null}function FR(e,t){for(var n,r=e.chart,a=e._cachedMeta,i=r._stacks||(r._stacks={}),o=a.iScale,s=a.vScale,u=a.index,c=o.axis,l=s.axis,h=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(o,s,a),f=t.length,d=0;d<f;++d){var p=t[d],v=p[c],g=p[l];(n=(p._stacks||(p._stacks={}))[l]=MR(i,h,v))[u]=g,n._top=OR(n,s,!0,a.type),n._bottom=OR(n,s,!1,a.type),(n._visualValues||(n._visualValues={}))[u]=g}}function PR(e,t){var n=e.scales;return Object.keys(n).filter((function(e){return n[e].axis===t})).shift()}function LR(e,t){var n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;var a,i=(0,C.Z)(t);try{for(i.s();!(a=i.n()).done;){var o=a.value._stacks;if(!o||void 0===o[r]||void 0===o[r][n])return;delete o[r][n],void 0!==o[r]._visualValues&&void 0!==o[r]._visualValues[n]&&delete o[r]._visualValues[n]}}catch(s){i.e(s)}finally{i.f()}}}var ZR=function(e){return"reset"===e||"none"===e},zR=function(e,t){return t?e:Object.assign({},e)},BR=function(){function e(t,n){(0,p.Z)(this,e),this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=(this instanceof e?this.constructor:void 0).datasetElementType,this.dataElementType=(this instanceof e?this.constructor:void 0).dataElementType,this.initialize()}return(0,v.Z)(e,[{key:"initialize",value:function(){var e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=RR(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}},{key:"updateIndex",value:function(e){this.index!==e&&LR(this._cachedMeta),this.index=e}},{key:"linkScales",value:function(){var e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=function(e,t,n,r){return"x"===e?t:"r"===e?r:n},a=t.xAxisID=zN(n.xAxisID,PR(e,"x")),i=t.yAxisID=zN(n.yAxisID,PR(e,"y")),o=t.rAxisID=zN(n.rAxisID,PR(e,"r")),s=t.indexAxis,u=t.iAxisID=r(s,a,i,o),c=t.vAxisID=r(s,i,a,o);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(i),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(u),t.vScale=this.getScaleForId(c)}},{key:"getDataset",value:function(){return this.chart.data.datasets[this.index]}},{key:"getMeta",value:function(){return this.chart.getDatasetMeta(this.index)}},{key:"getScaleForId",value:function(e){return this.chart.scales[e]}},{key:"_getOtherScale",value:function(e){var t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}},{key:"reset",value:function(){this._update("reset")}},{key:"_destroy",value:function(){var e=this._cachedMeta;this._data&&AD(this._data,this),e._stacked&&LR(e)}},{key:"_dataCheck",value:function(){var e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(PN(t))this._data=function(e){var t,n,r,a=Object.keys(e),i=new Array(a.length);for(t=0,n=a.length;t<n;++t)r=a[t],i[t]={x:r,y:e[r]};return i}(t);else if(n!==t){if(n){AD(n,this);var r=this._cachedMeta;LR(r),r._parsed=[]}t&&Object.isExtensible(t)&&function(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),DD.forEach((function(t){var n="_onData"+$N(t),r=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var o=r.apply(this,a);return e._chartjs.listeners.forEach((function(e){"function"===typeof e[n]&&e[n].apply(e,a)})),o}})})))}(t,this),this._syncList=[],this._data=t}}},{key:"addElements",value:function(){var e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}},{key:"buildOrUpdateElements",value:function(e){var t=this._cachedMeta,n=this.getDataset(),r=!1;this._dataCheck();var a=t._stacked;t._stacked=RR(t.vScale,t),t.stack!==n.stack&&(r=!0,LR(t),t.stack=n.stack),this._resyncElements(e),(r||a!==t._stacked)&&FR(this,t._parsed)}},{key:"configure",value:function(){var e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}},{key:"parse",value:function(e,t){var n,r,a,i=this._cachedMeta,o=this._data,s=i.iScale,u=i._stacked,c=s.axis,l=0===e&&t===o.length||i._sorted,h=e>0&&i._parsed[e-1];if(!1===this._parsing)i._parsed=o,i._sorted=!0,a=o;else{a=FN(o[e])?this.parseArrayData(i,o,e,t):PN(o[e])?this.parseObjectData(i,o,e,t):this.parsePrimitiveData(i,o,e,t);for(n=0;n<t;++n)i._parsed[n+e]=r=a[n],l&&((null===r[c]||h&&r[c]<h[c])&&(l=!1),h=r);i._sorted=l}u&&FR(this,a)}},{key:"parsePrimitiveData",value:function(e,t,n,r){var a,i,o,s=e.iScale,u=e.vScale,c=s.axis,l=u.axis,h=s.getLabels(),f=s===u,d=new Array(r);for(a=0,i=r;a<i;++a){var p;o=a+n,d[a]=(p={},(0,Ye.Z)(p,c,f||s.parse(h[o],o)),(0,Ye.Z)(p,l,u.parse(t[o],o)),p)}return d}},{key:"parseArrayData",value:function(e,t,n,r){var a,i,o,s,u=e.xScale,c=e.yScale,l=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],l[a]={x:u.parse(s[0],o),y:c.parse(s[1],o)};return l}},{key:"parseObjectData",value:function(e,t,n,r){var a,i,o,s,u=e.xScale,c=e.yScale,l=this._parsing,h=l.xAxisKey,f=void 0===h?"x":h,d=l.yAxisKey,p=void 0===d?"y":d,v=new Array(r);for(a=0,i=r;a<i;++a)s=t[o=a+n],v[a]={x:u.parse(JN(s,f),o),y:c.parse(JN(s,p),o)};return v}},{key:"getParsed",value:function(e){return this._cachedMeta._parsed[e]}},{key:"getDataElement",value:function(e){return this._cachedMeta.data[e]}},{key:"applyStack",value:function(e,t,n){var r=this.chart,a=this._cachedMeta,i=t[e.axis];return AR({keys:DR(r,!0),values:t._stacks[e.axis]._visualValues},i,a.index,{mode:n})}},{key:"updateRangeFromParsed",value:function(e,t,n,r){var a=n[t.axis],i=null===a?NaN:a,o=r&&n._stacks[t.axis];r&&o&&(r.values=o,i=AR(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}},{key:"getMinMax",value:function(e,t){var n,r,a=this._cachedMeta,i=a._parsed,o=a._sorted&&e===a.iScale,s=i.length,u=this._getOtherScale(e),c=function(e,t,n){return e&&!t.hidden&&t._stacked&&{keys:DR(n,!0),values:null}}(t,a,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},h=function(e){var t=e.getUserBounds(),n=t.min,r=t.max,a=t.minDefined,i=t.maxDefined;return{min:a?n:Number.NEGATIVE_INFINITY,max:i?r:Number.POSITIVE_INFINITY}}(u),f=h.min,d=h.max;function p(){var t=(r=i[n])[u.axis];return!LN(r[e.axis])||f>t||d<t}for(n=0;n<s&&(p()||(this.updateRangeFromParsed(l,e,r,c),!o));++n);if(o)for(n=s-1;n>=0;--n)if(!p()){this.updateRangeFromParsed(l,e,r,c);break}return l}},{key:"getAllParsedValues",value:function(e){var t,n,r,a=this._cachedMeta._parsed,i=[];for(t=0,n=a.length;t<n;++t)LN(r=a[t][e.axis])&&i.push(r);return i}},{key:"getMaxOverflow",value:function(){return!1}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}},{key:"_update",value:function(e){var t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){var t,n,r,a;return PN(e)?(t=e.top,n=e.right,r=e.bottom,a=e.left):t=n=r=a=e,{top:t,right:n,bottom:r,left:a,disabled:!1===e}}(zN(this.options.clip,function(e,t,n){if(!1===n)return!1;var r=NR(e,n),a=NR(t,n);return{top:a.end,right:r.end,bottom:a.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}},{key:"update",value:function(e){}},{key:"draw",value:function(){var e,t=this._ctx,n=this.chart,r=this._cachedMeta,a=r.data||[],i=n.chartArea,o=[],s=this._drawStart||0,u=this._drawCount||a.length-s,c=this.options.drawActiveElementsOnTop;for(r.dataset&&r.dataset.draw(t,i,s,u),e=s;e<s+u;++e){var l=a[e];l.hidden||(l.active&&c?o.push(l):l.draw(t,i))}for(e=0;e<o.length;++e)o[e].draw(t,i)}},{key:"getStyle",value:function(e,t){var n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}},{key:"getContext",value:function(e,t,n){var r,a=this.getDataset();if(e>=0&&e<this._cachedMeta.data.length){var i=this._cachedMeta.data[e];r=i.$context||(i.$context=function(e,t,n){return NA(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,i)),r.parsed=this.getParsed(e),r.raw=a.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return NA(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=a,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}},{key:"resolveDatasetElementOptions",value:function(e){return this._resolveElementOptions(this.datasetElementType.id,e)}},{key:"resolveDataElementOptions",value:function(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}},{key:"_resolveElementOptions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,a="active"===n,i=this._cachedDataOpts,o=e+"-"+n,s=i[o],u=this.enableOptionSharing&&eD(r);if(s)return zR(s,u);var c=this.chart.config,l=c.datasetElementScopeKeys(this._type,e),h=a?["".concat(e,"Hover"),"hover",e,""]:[e,""],f=c.getOptionScopes(this.getDataset(),l),d=Object.keys(rA.elements[e]),p=c.resolveNamedOptions(f,d,(function(){return t.getContext(r,a,n)}),h);return p.$shared&&(p.$shared=u,i[o]=Object.freeze(zR(p,u))),p}},{key:"_resolveAnimations",value:function(e,t,n){var r,a=this.chart,i=this._cachedDataOpts,o="animation-".concat(t),s=i[o];if(s)return s;if(!1!==a.options.animation){var u=this.chart.config,c=u.datasetAnimationScopeKeys(this._type,t),l=u.getOptionScopes(this.getDataset(),c);r=u.createResolver(l,this.getContext(e,n,t))}var h=new ER(a,r&&r.animations);return r&&r._cacheable&&(i[o]=Object.freeze(h)),h}},{key:"getSharedOptions",value:function(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}},{key:"includeOptions",value:function(e,t){return!t||ZR(e)||this.chart._animationsDisabled}},{key:"_getSharedOptions",value:function(e,t){var n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,a=this.getSharedOptions(n),i=this.includeOptions(t,a)||a!==r;return this.updateSharedOptions(a,t,n),{sharedOptions:a,includeOptions:i}}},{key:"updateElement",value:function(e,t,n,r){ZR(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}},{key:"updateSharedOptions",value:function(e,t,n){e&&!ZR(t)&&this._resolveAnimations(void 0,t).update(e,n)}},{key:"_setStyle",value:function(e,t,n,r){e.active=r;var a=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}},{key:"removeHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!1)}},{key:"setHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!0)}},{key:"_removeDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}},{key:"_setDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}},{key:"_resyncElements",value:function(e){var t,n=this._data,r=this._cachedMeta.data,a=(0,C.Z)(this._syncList);try{for(a.s();!(t=a.n()).done;){var i=l(t.value,3),o=i[0],s=i[1],u=i[2];this[o](s,u)}}catch(d){a.e(d)}finally{a.f()}this._syncList=[];var c=r.length,h=n.length,f=Math.min(h,c);f&&this.parse(0,f),h>c?this._insertElements(c,h-c,e):h<c&&this._removeElements(h,c-h)}},{key:"_insertElements",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this._cachedMeta,i=a.data,o=e+t,s=function(e){for(e.length+=t,n=e.length-1;n>=o;n--)e[n]=e[n-t]};for(s(i),n=e;n<o;++n)i[n]=new this.dataElementType;this._parsing&&s(a._parsed),this.parse(e,t),r&&this.updateElements(i,e,t,"reset")}},{key:"updateElements",value:function(e,t,n,r){}},{key:"_removeElements",value:function(e,t){var n=this._cachedMeta;if(this._parsing){var r=n._parsed.splice(e,t);n._stacked&&LR(n,r)}n.data.splice(e,t)}},{key:"_sync",value:function(e){if(this._parsing)this._syncList.push(e);else{var t=l(e,3),n=t[0],r=t[1],a=t[2];this[n](r,a)}this.chart._dataChanges.push([this.index].concat(d(e)))}},{key:"_onDataPush",value:function(){var e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}},{key:"_onDataPop",value:function(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}},{key:"_onDataShift",value:function(){this._sync(["_removeElements",0,1])}},{key:"_onDataSplice",value:function(e,t){t&&this._sync(["_removeElements",e,t]);var n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}},{key:"_onDataUnshift",value:function(){this._sync(["_insertElements",0,arguments.length])}}]),e}();function UR(e){var t,n,r,a,i=e.iScale,o=function(e,t){if(!e._cache.$bar){for(var n=e.getMatchingVisibleMetas(t),r=[],a=0,i=n.length;a<i;a++)r=r.concat(n[a].controller.getAllParsedValues(e));e._cache.$bar=RD(r.sort((function(e,t){return e-t})))}return e._cache.$bar}(i,e.type),s=i._length,u=function(){32767!==r&&-32768!==r&&(eD(a)&&(s=Math.min(s,Math.abs(r-a)||s)),a=r)};for(t=0,n=o.length;t<n;++t)r=i.getPixelForValue(o[t]),u();for(a=void 0,t=0,n=i.ticks.length;t<n;++t)r=i.getPixelForTick(t),u();return s}function VR(e,t,n,r){return FN(e)?function(e,t,n,r){var a=n.parse(e[0],r),i=n.parse(e[1],r),o=Math.min(a,i),s=Math.max(a,i),u=o,c=s;Math.abs(o)>Math.abs(s)&&(u=s,c=o),t[n.axis]=c,t._custom={barStart:u,barEnd:c,start:a,end:i,min:o,max:s}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function jR(e,t,n,r){var a,i,o,s,u=e.iScale,c=e.vScale,l=u.getLabels(),h=u===c,f=[];for(a=n,i=n+r;a<i;++a)s=t[a],(o={})[u.axis]=h||u.parse(l[a],a),f.push(VR(s,o,c,a));return f}function WR(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function HR(e,t,n,r){var a=t.borderSkipped,i={};if(a)if(!0!==a){var o=function(e){var t,n,r,a,i;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(a="end",i="start"):(a="start",i="end"),{start:n,end:r,reverse:t,top:a,bottom:i}}(e),s=o.start,u=o.end,c=o.reverse,l=o.top,h=o.bottom;"middle"===a&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?a=l:(n._bottom||0)===r?a=h:(i[GR(h,s,u,c)]=!0,a=l)),i[GR(a,s,u,c)]=!0,e.borderSkipped=i}else e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};else e.borderSkipped=i}function GR(e,t,n,r){var a,i,o;return r?(o=n,e=qR(e=(a=e)===(i=t)?o:a===o?i:a,n,t)):e=qR(e,t,n),e}function qR(e,t,n){return"start"===e?t:"end"===e?n:e}function KR(e,t,n){var r=t.inflateAmount;e.inflateAmount="auto"===r?1===n?.33:0:r}(0,Ye.Z)(BR,"defaults",{}),(0,Ye.Z)(BR,"datasetElementType",null),(0,Ye.Z)(BR,"dataElementType",null);var YR=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"parsePrimitiveData",value:function(e,t,n,r){return jR(e,t,n,r)}},{key:"parseArrayData",value:function(e,t,n,r){return jR(e,t,n,r)}},{key:"parseObjectData",value:function(e,t,n,r){var a,i,o,s,u=e.iScale,c=e.vScale,l=this._parsing,h=l.xAxisKey,f=void 0===h?"x":h,d=l.yAxisKey,p=void 0===d?"y":d,v="x"===u.axis?f:p,g="x"===c.axis?f:p,m=[];for(a=n,i=n+r;a<i;++a)s=t[a],(o={})[u.axis]=u.parse(JN(s,v),a),m.push(VR(JN(s,g),o,c,a));return m}},{key:"updateRangeFromParsed",value:function(e,t,r,a){sr((0,y.Z)(n.prototype),"updateRangeFromParsed",this).call(this,e,t,r,a);var i=r._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}},{key:"getMaxOverflow",value:function(){return 0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,a=this.getParsed(e),i=a._custom,o=WR(i)?"["+i.start+", "+i.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:o}}},{key:"initialize",value:function(){this.enableOptionSharing=!0,sr((0,y.Z)(n.prototype),"initialize",this).call(this),this._cachedMeta.stack=this.getDataset().stack}},{key:"update",value:function(e){var t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this.index,o=this._cachedMeta.vScale,s=o.getBasePixel(),u=o.isHorizontal(),c=this._getRuler(),l=this._getSharedOptions(t,r),h=l.sharedOptions,f=l.includeOptions,d=t;d<t+n;d++){var p=this.getParsed(d),v=a||ON(p[o.axis])?{base:s,head:s}:this._calculateBarValuePixels(d),g=this._calculateBarIndexPixels(d,c),m=(p._stacks||{})[o.axis],y={horizontal:u,base:v.base,enableBorderRadius:!m||WR(p._custom)||i===m._top||i===m._bottom,x:u?v.head:g.center,y:u?g.center:v.head,height:u?g.size:Math.abs(v.size),width:u?Math.abs(v.size):g.size};f&&(y.options=h||this.resolveDataElementOptions(d,e[d].active?"active":r));var b=y.options||e[d].options;HR(y,b,m,i),KR(y,b,c.ratio),this.updateElement(e[d],d,y,r)}}},{key:"_getStacks",value:function(e,t){var n,r=this._cachedMeta.iScale,a=r.getMatchingVisibleMetas(this._type).filter((function(e){return e.controller.options.grouped})),i=r.options.stacked,o=[],s=function(e){var n=e.controller.getParsed(t),r=n&&n[e.vScale.axis];if(ON(r)||isNaN(r))return!0},u=(0,C.Z)(a);try{for(u.s();!(n=u.n()).done;){var c=n.value;if((void 0===t||!s(c))&&((!1===i||-1===o.indexOf(c.stack)||void 0===i&&void 0===c.stack)&&o.push(c.stack),c.index===e))break}}catch(l){u.e(l)}finally{u.f()}return o.length||o.push(void 0),o}},{key:"_getStackCount",value:function(e){return this._getStacks(void 0,e).length}},{key:"_getStackIndex",value:function(e,t,n){var r=this._getStacks(e,n),a=void 0!==t?r.indexOf(t):-1;return-1===a?r.length-1:a}},{key:"_getRuler",value:function(){var e,t,n=this.options,r=this._cachedMeta,a=r.iScale,i=[];for(e=0,t=r.data.length;e<t;++e)i.push(a.getPixelForValue(this.getParsed(e)[a.axis],e));var o=n.barThickness;return{min:o||UR(r),pixels:i,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:n.grouped,ratio:o?1:n.categoryPercentage*n.barPercentage}}},{key:"_calculateBarValuePixels",value:function(e){var t,n,r=this._cachedMeta,a=r.vScale,i=r._stacked,o=r.index,s=this.options,u=s.base,c=s.minBarLength,l=u||0,h=this.getParsed(e),f=h._custom,d=WR(f),p=h[a.axis],v=0,g=i?this.applyStack(a,h,i):p;g!==p&&(v=g-p,g=p),d&&(p=f.barStart,g=f.barEnd-f.barStart,0!==p&&fD(p)!==fD(f.barEnd)&&(v=0),v+=p);var m=ON(u)||d?v:u,y=a.getPixelForValue(m);if(n=(t=this.chart.getDataVisibility(e)?a.getPixelForValue(v+g):y)-y,Math.abs(n)<c){n=function(e,t,n){return 0!==e?fD(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(n,a,l)*c,p===l&&(y-=n/2);var b=a.getPixelForDecimal(0),k=a.getPixelForDecimal(1),x=Math.min(b,k),w=Math.max(b,k);t=(y=Math.max(Math.min(y,w),x))+n,i&&!d&&(h._stacks[a.axis]._visualValues[o]=a.getValueForPixel(t)-a.getValueForPixel(y))}if(y===a.getPixelForValue(l)){var I=fD(n)*a.getLineWidthForValue(l)/2;y+=I,n-=I}return{size:n,base:y,head:t,center:t+n/2}}},{key:"_calculateBarIndexPixels",value:function(e,t){var n,r,a=t.scale,i=this.options,o=i.skipNull,s=zN(i.maxBarThickness,1/0);if(t.grouped){var u=o?this._getStackCount(e):t.stackCount,c="flex"===i.barThickness?function(e,t,n,r){var a=t.pixels,i=a[e],o=e>0?a[e-1]:null,s=e<a.length-1?a[e+1]:null,u=n.categoryPercentage;null===o&&(o=i-(null===s?t.end-t.start:s-i)),null===s&&(s=i+i-o);var c=i-(i-Math.min(o,s))/2*u;return{chunk:Math.abs(s-o)/2*u/r,ratio:n.barPercentage,start:c}}(e,t,i,u):function(e,t,n,r){var a,i,o=n.barThickness;return ON(o)?(a=t.min*n.categoryPercentage,i=n.barPercentage):(a=o*r,i=1),{chunk:a/r,ratio:i,start:t.pixels[e]-a/2}}(e,t,i,u),l=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0);n=c.start+c.chunk*l+c.chunk/2,r=Math.min(s,c.chunk*c.ratio)}else n=a.getPixelForValue(this.getParsed(e)[a.axis],e),r=Math.min(s,t.min*t.ratio);return{base:n-r/2,head:n+r/2,center:n,size:r}}},{key:"draw",value:function(){for(var e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length,a=0;a<r;++a)null!==this.getParsed(a)[t.axis]&&n[a].draw(this._ctx)}}]),n}(BR);(0,Ye.Z)(YR,"id","bar"),(0,Ye.Z)(YR,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,Ye.Z)(YR,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});var XR=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"initialize",value:function(){this.enableOptionSharing=!0,sr((0,y.Z)(n.prototype),"initialize",this).call(this)}},{key:"parsePrimitiveData",value:function(e,t,r,a){for(var i=sr((0,y.Z)(n.prototype),"parsePrimitiveData",this).call(this,e,t,r,a),o=0;o<i.length;o++)i[o]._custom=this.resolveDataElementOptions(o+r).radius;return i}},{key:"parseArrayData",value:function(e,t,r,a){for(var i=sr((0,y.Z)(n.prototype),"parseArrayData",this).call(this,e,t,r,a),o=0;o<i.length;o++){var s=t[r+o];i[o]._custom=zN(s[2],this.resolveDataElementOptions(o+r).radius)}return i}},{key:"parseObjectData",value:function(e,t,r,a){for(var i=sr((0,y.Z)(n.prototype),"parseObjectData",this).call(this,e,t,r,a),o=0;o<i.length;o++){var s=t[r+o];i[o]._custom=zN(s&&s.r&&+s.r,this.resolveDataElementOptions(o+r).radius)}return i}},{key:"getMaxOverflow",value:function(){for(var e=this._cachedMeta.data,t=0,n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,a=t.yScale,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y),u=i._custom;return{label:n[e]||"",value:"("+o+", "+s+(u?", "+u:"")+")"}}},{key:"update",value:function(e){var t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=this._getSharedOptions(t,r),c=u.sharedOptions,l=u.includeOptions,h=o.axis,f=s.axis,d=t;d<t+n;d++){var p=e[d],v=!a&&this.getParsed(d),g={},m=g[h]=a?o.getPixelForDecimal(.5):o.getPixelForValue(v[h]),y=g[f]=a?s.getBasePixel():s.getPixelForValue(v[f]);g.skip=isNaN(m)||isNaN(y),l&&(g.options=c||this.resolveDataElementOptions(d,p.active?"active":r),a&&(g.options.radius=0)),this.updateElement(p,d,g,r)}}},{key:"resolveDataElementOptions",value:function(e,t){var r=this.getParsed(e),a=sr((0,y.Z)(n.prototype),"resolveDataElementOptions",this).call(this,e,t);a.$shared&&(a=Object.assign({},a,{$shared:!1}));var i=a.radius;return"active"!==t&&(a.radius=0),a.radius+=zN(r&&r._custom,i),a}}]),n}(BR);(0,Ye.Z)(XR,"id","bubble"),(0,Ye.Z)(XR,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,Ye.Z)(XR,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});var QR=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r)).enableOptionSharing=!0,a.innerRadius=void 0,a.outerRadius=void 0,a.offsetX=void 0,a.offsetY=void 0,a}return(0,v.Z)(n,[{key:"linkScales",value:function(){}},{key:"parse",value:function(e,t){var n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{var a,i,o=function(e){return+n[e]};if(PN(n[e])){var s=this._parsing.key,u=void 0===s?"value":s;o=function(e){return+JN(n[e],u)}}for(a=e,i=e+t;a<i;++a)r._parsed[a]=o(a)}}},{key:"_getRotation",value:function(){return mD(this.options.rotation-90)}},{key:"_getCircumference",value:function(){return mD(this.options.circumference)}},{key:"_getRotationExtents",value:function(){for(var e=aD,t=-aD,n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){var r=this.chart.getDatasetMeta(n).controller,a=r._getRotation(),i=r._getCircumference();e=Math.min(e,a),t=Math.max(t,a+i)}return{rotation:e,circumference:t-e}}},{key:"update",value:function(e){var t=this.chart.chartArea,n=this._cachedMeta,r=n.data,a=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,i=Math.max((Math.min(t.width,t.height)-a)/2,0),o=Math.min(function(e,t){return"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100:+e/t}(this.options.cutout,i),1),s=this._getRingWeight(this.index),u=this._getRotationExtents(),c=u.circumference,l=function(e,t,n){var r=1,a=1,i=0,o=0;if(t<aD){var s=e,u=s+t,c=Math.cos(s),l=Math.sin(s),h=Math.cos(u),f=Math.sin(u),d=function(e,t,r){return SD(e,s,u,!0)?1:Math.max(t,t*n,r,r*n)},p=function(e,t,r){return SD(e,s,u,!0)?-1:Math.min(t,t*n,r,r*n)},v=d(0,c,h),g=d(uD,l,f),m=p(rD,c,h),y=p(rD+uD,l,f);r=(v-m)/2,a=(g-y)/2,i=-(v+m)/2,o=-(g+y)/2}return{ratioX:r,ratioY:a,offsetX:i,offsetY:o}}(u.rotation,c,o),h=l.ratioX,f=l.ratioY,d=l.offsetX,p=l.offsetY,v=(t.width-a)/h,g=(t.height-a)/f,m=Math.max(Math.min(v,g)/2,0),y=BN(this.options.radius,m),b=(y-Math.max(y*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=d*y,this.offsetY=p*y,n.total=this.calculateTotal(),this.outerRadius=y-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*s,0),this.updateElements(r,0,r.length,e)}},{key:"_circumference",value:function(e,t){var n=this.options,r=this._cachedMeta,a=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/aD)}},{key:"updateElements",value:function(e,t,n,r){var a,i="reset"===r,o=this.chart,s=o.chartArea,u=o.options.animation,c=(s.left+s.right)/2,l=(s.top+s.bottom)/2,h=i&&u.animateScale,f=h?0:this.innerRadius,d=h?0:this.outerRadius,p=this._getSharedOptions(t,r),v=p.sharedOptions,g=p.includeOptions,m=this._getRotation();for(a=0;a<t;++a)m+=this._circumference(a,i);for(a=t;a<t+n;++a){var y=this._circumference(a,i),b=e[a],k={x:c+this.offsetX,y:l+this.offsetY,startAngle:m,endAngle:m+y,circumference:y,outerRadius:d,innerRadius:f};g&&(k.options=v||this.resolveDataElementOptions(a,b.active?"active":r)),m+=y,this.updateElement(b,a,k,r)}}},{key:"calculateTotal",value:function(){var e,t=this._cachedMeta,n=t.data,r=0;for(e=0;e<n.length;e++){var a=t._parsed[e];null===a||isNaN(a)||!this.chart.getDataVisibility(e)||n[e].hidden||(r+=Math.abs(a))}return r}},{key:"calculateCircumference",value:function(e){var t=this._cachedMeta.total;return t>0&&!isNaN(e)?aD*(Math.abs(e)/t):0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=YD(t._parsed[e],n.options.locale);return{label:r[e]||"",value:a}}},{key:"getMaxBorderWidth",value:function(e){var t,n,r,a,i,o=0,s=this.chart;if(!e)for(t=0,n=s.data.datasets.length;t<n;++t)if(s.isDatasetVisible(t)){e=(r=s.getDatasetMeta(t)).data,a=r.controller;break}if(!e)return 0;for(t=0,n=e.length;t<n;++t)"inner"!==(i=a.resolveDataElementOptions(t)).borderAlign&&(o=Math.max(o,i.borderWidth||0,i.hoverBorderWidth||0));return o}},{key:"getMaxOffset",value:function(e){for(var t=0,n=0,r=e.length;n<r;++n){var a=this.resolveDataElementOptions(n);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}},{key:"_getRingWeightOffset",value:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}},{key:"_getRingWeight",value:function(e){return Math.max(zN(this.chart.data.datasets[e].weight,1),0)}},{key:"_getVisibleDatasetWeightTotal",value:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}]),n}(BR);(0,Ye.Z)(QR,"id","doughnut"),(0,Ye.Z)(QR,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,Ye.Z)(QR,"descriptors",{_scriptable:function(e){return"spacing"!==e},_indexable:function(e){return"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}}),(0,Ye.Z)(QR,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,a=n.color;return t.labels.map((function(t,n){var i=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});var JR=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"initialize",value:function(){this.enableOptionSharing=!0,this.supportsDecimation=!0,sr((0,y.Z)(n.prototype),"initialize",this).call(this)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data,a=void 0===r?[]:r,i=t._dataset,o=this.chart._animationsDisabled,s=LD(t,a,o),u=s.start,c=s.count;this._drawStart=u,this._drawCount=c,ZD(t)&&(u=0,c=a.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=a;var l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},e),this.updateElements(a,u,c,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=i._stacked,c=i._dataset,l=this._getSharedOptions(t,r),h=l.sharedOptions,f=l.includeOptions,d=o.axis,p=s.axis,v=this.options,g=v.spanGaps,m=v.segment,y=vD(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||a||"none"===r,k=t+n,x=e.length,w=t>0&&this.getParsed(t-1),I=0;I<x;++I){var S=e[I],C=b?S:{};if(I<t||I>=k)C.skip=!0;else{var _=this.getParsed(I),T=ON(_[p]),E=C[d]=o.getPixelForValue(_[d],I),N=C[p]=a||T?s.getBasePixel():s.getPixelForValue(u?this.applyStack(s,_,u):_[p],I);C.skip=isNaN(E)||isNaN(N)||T,C.stop=I>0&&Math.abs(_[d]-w[d])>y,m&&(C.parsed=_,C.raw=c.data[I]),f&&(C.options=h||this.resolveDataElementOptions(I,S.active?"active":r)),b||this.updateElement(S,I,C,r),w=_}}}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;var a=r[0].size(this.resolveDataElementOptions(0)),i=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,a,i)/2}},{key:"draw",value:function(){var e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),sr((0,y.Z)(n.prototype),"draw",this).call(this)}}]),n}(BR);(0,Ye.Z)(JR,"id","line"),(0,Ye.Z)(JR,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,Ye.Z)(JR,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});var $R=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r)).innerRadius=void 0,a.outerRadius=void 0,a}return(0,v.Z)(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],a=YD(t._parsed[e].r,n.options.locale);return{label:r[e]||"",value:a}}},{key:"parseObjectData",value:function(e,t,n,r){return jA.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}},{key:"getMinMax",value:function(){var e=this,t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((function(t,r){var a=e.getParsed(r).r;!isNaN(a)&&e.chart.getDataVisibility(r)&&(a<n.min&&(n.min=a),a>n.max&&(n.max=a))})),n}},{key:"_updateRadius",value:function(){var e=this.chart,t=e.chartArea,n=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),a=Math.max(r/2,0),i=(a-Math.max(n.cutoutPercentage?a/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=a-i*this.index,this.innerRadius=this.outerRadius-i}},{key:"updateElements",value:function(e,t,n,r){var a,i="reset"===r,o=this.chart,s=o.options.animation,u=this._cachedMeta.rScale,c=u.xCenter,l=u.yCenter,h=u.getIndexAngle(0)-.5*rD,f=h,d=360/this.countVisibleElements();for(a=0;a<t;++a)f+=this._computeAngle(a,r,d);for(a=t;a<t+n;a++){var p=e[a],v=f,g=f+this._computeAngle(a,r,d),m=o.getDataVisibility(a)?u.getDistanceFromCenterForValue(this.getParsed(a).r):0;f=g,i&&(s.animateScale&&(m=0),s.animateRotate&&(v=g=h));var y={x:c,y:l,innerRadius:0,outerRadius:m,startAngle:v,endAngle:g,options:this.resolveDataElementOptions(a,p.active?"active":r)};this.updateElement(p,a,y,r)}}},{key:"countVisibleElements",value:function(){var e=this,t=this._cachedMeta,n=0;return t.data.forEach((function(t,r){!isNaN(e.getParsed(r).r)&&e.chart.getDataVisibility(r)&&n++})),n}},{key:"_computeAngle",value:function(e,t,n){return this.chart.getDataVisibility(e)?mD(this.resolveDataElementOptions(e,t).angle||n):0}}]),n}(BR);(0,Ye.Z)($R,"id","polarArea"),(0,Ye.Z)($R,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,Ye.Z)($R,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,a=n.color;return t.labels.map((function(t,n){var i=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:i.backgroundColor,strokeStyle:i.borderColor,fontColor:a,lineWidth:i.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}}))}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});var eM=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(QR);(0,Ye.Z)(eM,"id","pie"),(0,Ye.Z)(eM,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});var tM=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}},{key:"parseObjectData",value:function(e,t,n,r){return jA.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data||[],a=t.iScale.getLabels();if(n.points=r,"resize"!==e){var i=this.resolveDatasetElementOptions(e);this.options.showLine||(i.borderWidth=0);var o={_loop:!0,_fullLoop:a.length===r.length,options:i};this.updateElement(n,void 0,o,e)}this.updateElements(r,0,r.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var a=this._cachedMeta.rScale,i="reset"===r,o=t;o<t+n;o++){var s=e[o],u=this.resolveDataElementOptions(o,s.active?"active":r),c=a.getPointPositionForValue(o,this.getParsed(o).r),l=i?a.xCenter:c.x,h=i?a.yCenter:c.y,f={x:l,y:h,angle:c.angle,skip:isNaN(l)||isNaN(h),options:u};this.updateElement(s,o,f,r)}}}]),n}(BR);(0,Ye.Z)(tM,"id","radar"),(0,Ye.Z)(tM,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,Ye.Z)(tM,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});var nM=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,a=t.yScale,i=this.getParsed(e),o=r.getLabelForValue(i.x),s=a.getLabelForValue(i.y);return{label:n[e]||"",value:"("+o+", "+s+")"}}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.data,r=void 0===n?[]:n,a=this.chart._animationsDisabled,i=LD(t,r,a),o=i.start,s=i.count;if(this._drawStart=o,this._drawCount=s,ZD(t)&&(o=0,s=r.length),this.options.showLine){var u=t.dataset,c=t._dataset;u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!c._decimated,u.points=r;var l=this.resolveDatasetElementOptions(e);l.segment=this.options.segment,this.updateElement(u,void 0,{animated:!a,options:l},e)}this.updateElements(r,o,s,e)}},{key:"addElements",value:function(){var e=this.options.showLine;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),sr((0,y.Z)(n.prototype),"addElements",this).call(this)}},{key:"updateElements",value:function(e,t,n,r){for(var a="reset"===r,i=this._cachedMeta,o=i.iScale,s=i.vScale,u=i._stacked,c=i._dataset,l=this.resolveDataElementOptions(t,r),h=this.getSharedOptions(l),f=this.includeOptions(r,h),d=o.axis,p=s.axis,v=this.options,g=v.spanGaps,m=v.segment,y=vD(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||a||"none"===r,k=t>0&&this.getParsed(t-1),x=t;x<t+n;++x){var w=e[x],I=this.getParsed(x),S=b?w:{},C=ON(I[p]),_=S[d]=o.getPixelForValue(I[d],x),T=S[p]=a||C?s.getBasePixel():s.getPixelForValue(u?this.applyStack(s,I,u):I[p],x);S.skip=isNaN(_)||isNaN(T)||C,S.stop=x>0&&Math.abs(I[d]-k[d])>y,m&&(S.parsed=I,S.raw=c.data[x]),f&&(S.options=h||this.resolveDataElementOptions(x,w.active?"active":r)),b||this.updateElement(w,x,S,r),k=I}this.updateSharedOptions(h,r,l)}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){for(var n=0,r=t.length-1;r>=0;--r)n=Math.max(n,t[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}var a=e.dataset,i=a.options&&a.options.borderWidth||0;if(!t.length)return i;var o=t[0].size(this.resolveDataElementOptions(0)),s=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,o,s)/2}}]),n}(BR);(0,Ye.Z)(nM,"id","scatter"),(0,Ye.Z)(nM,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,Ye.Z)(nM,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var rM=Object.freeze({__proto__:null,BarController:YR,BubbleController:XR,DoughnutController:QR,LineController:JR,PieController:eM,PolarAreaController:$R,RadarController:tM,ScatterController:nM});function aM(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var iM={_date:function(){function e(t){(0,p.Z)(this,e),(0,Ye.Z)(this,"options",void 0),this.options=t||{}}return(0,v.Z)(e,[{key:"init",value:function(){}},{key:"formats",value:function(){return aM()}},{key:"parse",value:function(){return aM()}},{key:"format",value:function(){return aM()}},{key:"add",value:function(){return aM()}},{key:"diff",value:function(){return aM()}},{key:"startOf",value:function(){return aM()}},{key:"endOf",value:function(){return aM()}}],[{key:"override",value:function(t){Object.assign(e.prototype,t)}}]),e}()};function oM(e,t,n,r){var a=e.controller,i=e.data,o=e._sorted,s=a._cachedMeta.iScale;if(s&&t===s.axis&&"r"!==t&&o&&i.length){var u=s._reversePixels?ND:ED;if(!r)return u(i,t,n);if(a._sharedOptions){var c=i[0],l="function"===typeof c.getRange&&c.getRange(t);if(l){var h=u(i,t,n-l),f=u(i,t,n+l);return{lo:h.lo,hi:f.hi}}}}return{lo:0,hi:i.length-1}}function sM(e,t,n,r,a){for(var i=e.getSortedVisibleDatasetMetas(),o=n[t],s=0,u=i.length;s<u;++s)for(var c=i[s],l=c.index,h=c.data,f=oM(i[s],t,o,a),d=f.lo,p=f.hi,v=d;v<=p;++v){var g=h[v];g.skip||r(g,l,v)}}function uM(e,t,n,r,a){var i=[];if(!a&&!e.isPointInArea(t))return i;return sM(e,n,t,(function(n,o,s){(a||lA(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&i.push({element:n,datasetIndex:o,index:s})}),!0),i}function cM(e,t,n,r,a,i){var o=[],s=function(e){var t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){var a=t?Math.abs(e.x-r.x):0,i=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}(n),u=Number.POSITIVE_INFINITY;return sM(e,n,t,(function(n,c,l){var h=n.inRange(t.x,t.y,a);if(!r||h){var f=n.getCenterPoint(a);if(!!i||e.isPointInArea(f)||h){var d=s(t,f);d<u?(o=[{element:n,datasetIndex:c,index:l}],u=d):d===u&&o.push({element:n,datasetIndex:c,index:l})}}})),o}function lM(e,t,n,r,a,i){return i||e.isPointInArea(t)?"r"!==n||r?cM(e,t,n,r,a,i):function(e,t,n,r){var a=[];return sM(e,n,t,(function(e,n,i){var o=e.getProps(["startAngle","endAngle"],r),s=o.startAngle,u=o.endAngle;SD(kD(e,{x:t.x,y:t.y}).angle,s,u)&&a.push({element:e,datasetIndex:n,index:i})})),a}(e,t,n,a):[]}function hM(e,t,n,r,a){var i=[],o="x"===n?"inXRange":"inYRange",s=!1;return sM(e,n,t,(function(e,r,u){e[o](t[n],a)&&(i.push({element:e,datasetIndex:r,index:u}),s=s||e.inRange(t.x,t.y,a))})),r&&!s?[]:i}var fM={evaluateInteractionItems:sM,modes:{index:function(e,t,n,r){var a=aR(t,e),i=n.axis||"x",o=n.includeInvisible||!1,s=n.intersect?uM(e,a,i,r,o):lM(e,a,i,!1,r,o),u=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach((function(e){var t=s[0].index,n=e.data[t];n&&!n.skip&&u.push({element:n,datasetIndex:e.index,index:t})})),u):[]},dataset:function(e,t,n,r){var a=aR(t,e),i=n.axis||"xy",o=n.includeInvisible||!1,s=n.intersect?uM(e,a,i,r,o):lM(e,a,i,!1,r,o);if(s.length>0){var u=s[0].datasetIndex,c=e.getDatasetMeta(u).data;s=[];for(var l=0;l<c.length;++l)s.push({element:c[l],datasetIndex:u,index:l})}return s},point:function(e,t,n,r){return uM(e,aR(t,e),n.axis||"xy",r,n.includeInvisible||!1)},nearest:function(e,t,n,r){var a=aR(t,e),i=n.axis||"xy",o=n.includeInvisible||!1;return lM(e,a,i,n.intersect,r,o)},x:function(e,t,n,r){return hM(e,aR(t,e),"x",n.intersect,r)},y:function(e,t,n,r){return hM(e,aR(t,e),"y",n.intersect,r)}}},dM=["left","top","right","bottom"];function pM(e,t){return e.filter((function(e){return e.pos===t}))}function vM(e,t){return e.filter((function(e){return-1===dM.indexOf(e.pos)&&e.box.axis===t}))}function gM(e,t){return e.sort((function(e,n){var r=t?n:e,a=t?e:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight}))}function mM(e,t){var n,r,a,i=function(e){var t,n={},r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=a.stack,o=a.pos,s=a.stackWeight;if(i&&dM.includes(o)){var u=n[i]||(n[i]={count:0,placed:0,weight:0,size:0});u.count++,u.weight+=s}}}catch(c){r.e(c)}finally{r.f()}return n}(e),o=t.vBoxMaxWidth,s=t.hBoxMaxHeight;for(n=0,r=e.length;n<r;++n){var u=(a=e[n]).box.fullSize,c=i[a.stack],l=c&&a.stackWeight/c.weight;a.horizontal?(a.width=l?l*o:u&&t.availableWidth,a.height=s):(a.width=o,a.height=l?l*s:u&&t.availableHeight)}return i}function yM(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function bM(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function kM(e,t,n,r){var a=n.pos,i=n.box,o=e.maxPadding;if(!PN(a)){n.size&&(e[a]-=n.size);var s=r[n.stack]||{size:0,count:1};s.size=Math.max(s.size,n.horizontal?i.height:i.width),n.size=s.size/s.count,e[a]+=n.size}i.getPadding&&bM(o,i.getPadding());var u=Math.max(0,t.outerWidth-yM(o,e,"left","right")),c=Math.max(0,t.outerHeight-yM(o,e,"top","bottom")),l=u!==e.w,h=c!==e.h;return e.w=u,e.h=c,n.horizontal?{same:l,other:h}:{same:h,other:l}}function xM(e,t){var n=t.maxPadding;function r(e){var r={left:0,top:0,right:0,bottom:0};return e.forEach((function(e){r[e]=Math.max(t[e],n[e])})),r}return r(e?["left","right"]:["top","bottom"])}function wM(e,t,n,r){var a,i,o,s,u,c,l=[];for(a=0,i=e.length,u=0;a<i;++a){(s=(o=e[a]).box).update(o.width||t.w,o.height||t.h,xM(o.horizontal,t));var h=kM(t,n,o,r),f=h.same,d=h.other;u|=f&&l.length,c=c||d,s.fullSize||l.push(o)}return u&&wM(l,t,n,r)||c}function IM(e,t,n,r,a){e.top=n,e.left=t,e.right=t+r,e.bottom=n+a,e.width=r,e.height=a}function SM(e,t,n,r){var a,i=n.padding,o=t.x,s=t.y,u=(0,C.Z)(e);try{for(u.s();!(a=u.n()).done;){var c=a.value,l=c.box,h=r[c.stack]||{count:1,placed:0,weight:1},f=c.stackWeight/h.weight||1;if(c.horizontal){var d=t.w*f,p=h.size||l.height;eD(h.start)&&(s=h.start),l.fullSize?IM(l,i.left,s,n.outerWidth-i.right-i.left,p):IM(l,t.left+h.placed,s,d,p),h.start=s,h.placed+=d,s=l.bottom}else{var v=t.h*f,g=h.size||l.width;eD(h.start)&&(o=h.start),l.fullSize?IM(l,o,i.top,g,n.outerHeight-i.bottom-i.top):IM(l,o,t.top+h.placed,g,v),h.start=o,h.placed+=v,o=l.right}}}catch(m){u.e(m)}finally{u.f()}t.x=o,t.y=s}var CM=function(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(e){t.draw(e)}}]},e.boxes.push(t)},_M=function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},TM=function(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},EM=function(e,t,n,r){if(e){var a=_A(e.options.layout.padding),i=Math.max(t-a.width,0),o=Math.max(n-a.height,0),s=function(e){var t=function(e){var t,n,r,a,i,o,s=[];for(t=0,n=(e||[]).length;t<n;++t){var u=r=e[t];a=u.position;var c=u.options;i=c.stack;var l=c.stackWeight;o=void 0===l?1:l,s.push({index:t,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:i&&a+i,stackWeight:o})}return s}(e),n=gM(t.filter((function(e){return e.box.fullSize})),!0),r=gM(pM(t,"left"),!0),a=gM(pM(t,"right")),i=gM(pM(t,"top"),!0),o=gM(pM(t,"bottom")),s=vM(t,"x"),u=vM(t,"y");return{fullSize:n,leftAndTop:r.concat(i),rightAndBottom:a.concat(u).concat(o).concat(s),chartArea:pM(t,"chartArea"),vertical:r.concat(a).concat(u),horizontal:i.concat(o).concat(s)}}(e.boxes),u=s.vertical,c=s.horizontal;VN(e.boxes,(function(e){"function"===typeof e.beforeLayout&&e.beforeLayout()}));var l=u.reduce((function(e,t){return t.box.options&&!1===t.box.options.display?e:e+1}),0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:a,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/l,hBoxMaxHeight:o/2}),f=Object.assign({},a);bM(f,_A(r));var d=Object.assign({maxPadding:f,w:i,h:o,x:a.left,y:a.top},a),p=mM(u.concat(c),h);wM(s.fullSize,d,h,p),wM(u,d,h,p),wM(c,d,h,p)&&wM(u,d,h,p),function(e){var t=e.maxPadding;function n(n){var r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(d),SM(s.leftAndTop,d,h,p),d.x+=d.w,d.y+=d.h,SM(s.rightAndBottom,d,h,p),e.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},VN(s.chartArea,(function(t){var n=t.box;Object.assign(n,e.chartArea),n.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})}))}},NM=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"acquireContext",value:function(e,t){}},{key:"releaseContext",value:function(e){return!1}},{key:"addEventListener",value:function(e,t,n){}},{key:"removeEventListener",value:function(e,t,n){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getMaximumSize",value:function(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}},{key:"isAttached",value:function(e){return!0}},{key:"updateConfig",value:function(e){}}]),e}(),DM=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"acquireContext",value:function(e){return e&&e.getContext&&e.getContext("2d")||null}},{key:"updateConfig",value:function(e){e.options.animation=!1}}]),n}(NM),AM="$chartjs",RM={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},MM=function(e){return null===e||""===e};var OM=!!uR&&{passive:!0};function FM(e,t,n){e.canvas.removeEventListener(t,n,OM)}function PM(e,t){var n,r=(0,C.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a===t||a.contains(t))return!0}}catch(i){r.e(i)}finally{r.f()}}function LM(e,t,n){var r=e.canvas,a=new MutationObserver((function(e){var t,a=!1,i=(0,C.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a=(a=a||PM(o.addedNodes,r))&&!PM(o.removedNodes,r)}}catch(s){i.e(s)}finally{i.f()}a&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}function ZM(e,t,n){var r=e.canvas,a=new MutationObserver((function(e){var t,a=!1,i=(0,C.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;a=(a=a||PM(o.removedNodes,r))&&!PM(o.addedNodes,r)}}catch(s){i.e(s)}finally{i.f()}a&&n()}));return a.observe(document,{childList:!0,subtree:!0}),a}var zM=new Map,BM=0;function UM(){var e=window.devicePixelRatio;e!==BM&&(BM=e,zM.forEach((function(t,n){n.currentDevicePixelRatio!==e&&t()})))}function VM(e,t,n){var r=e.canvas,a=r&&JA(r);if(a){var i=OD((function(e,t){var r=a.clientWidth;n(e,t),r<a.clientWidth&&n()}),window),o=new ResizeObserver((function(e){var t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||i(n,r)}));return o.observe(a),function(e,t){zM.size||window.addEventListener("resize",UM),zM.set(e,t)}(e,i),o}}function jM(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){zM.delete(e),zM.size||window.removeEventListener("resize",UM)}(e)}function WM(e,t,n){var r=e.canvas,a=OD((function(t){null!==e.ctx&&n(function(e,t){var n=RM[e.type]||e.type,r=aR(e,t),a=r.x,i=r.y;return{type:n,chart:t,native:e,x:void 0!==a?a:null,y:void 0!==i?i:null}}(t,e))}),e);return function(e,t,n){e.addEventListener(t,n,OM)}(r,t,a),a}var HM=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"acquireContext",value:function(e,t){var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){var n=e.style,r=e.getAttribute("height"),a=e.getAttribute("width");if(e[AM]={initial:{height:r,width:a,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",MM(a)){var i=cR(e,"width");void 0!==i&&(e.width=i)}if(MM(r))if(""===e.style.height)e.height=e.width/(t||2);else{var o=cR(e,"height");void 0!==o&&(e.height=o)}}(e,t),n):null}},{key:"releaseContext",value:function(e){var t=e.canvas;if(!t[AM])return!1;var n=t[AM].initial;["height","width"].forEach((function(e){var r=n[e];ON(r)?t.removeAttribute(e):t.setAttribute(e,r)}));var r=n.style||{};return Object.keys(r).forEach((function(e){t.style[e]=r[e]})),t.width=t.width,delete t[AM],!0}},{key:"addEventListener",value:function(e,t,n){this.removeEventListener(e,t);var r=e.$proxies||(e.$proxies={}),a={attach:LM,detach:ZM,resize:VM}[t]||WM;r[t]=a(e,t,n)}},{key:"removeEventListener",value:function(e,t){var n=e.$proxies||(e.$proxies={}),r=n[t];r&&(({attach:jM,detach:jM,resize:jM}[t]||FM)(e,t,r),n[t]=void 0)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getMaximumSize",value:function(e,t,n,r){return oR(e,t,n,r)}},{key:"isAttached",value:function(e){var t=JA(e);return!(!t||!t.isConnected)}}]),n}(NM);var GM=function(){function e(){(0,p.Z)(this,e),(0,Ye.Z)(this,"x",void 0),(0,Ye.Z)(this,"y",void 0),(0,Ye.Z)(this,"active",!1),(0,Ye.Z)(this,"options",void 0),(0,Ye.Z)(this,"$animations",void 0)}return(0,v.Z)(e,[{key:"tooltipPosition",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"hasValue",value:function(){return vD(this.x)&&vD(this.y)}},{key:"getProps",value:function(e,t){var n=this,r=this.$animations;if(!t||!r)return this;var a={};return e.forEach((function(e){a[e]=r[e]&&r[e].active()?r[e]._to:n[e]})),a}}]),e}();function qM(e,t){var n=e.options.ticks,r=function(e){var t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),a=e._maxLength/n;return Math.floor(Math.min(r,a))}(e),a=Math.min(n.maxTicksLimit||r,r),i=n.major.enabled?function(e){var t,n,r=[];for(t=0,n=e.length;t<n;t++)e[t].major&&r.push(t);return r}(t):[],o=i.length,s=i[0],u=i[o-1],c=[];if(o>a)return function(e,t,n,r){var a,i=0,o=n[0];for(r=Math.ceil(r),a=0;a<e.length;a++)a===o&&(t.push(e[a]),o=n[++i*r])}(t,c,i,o/a),c;var l=function(e,t,n){var r=function(e){var t,n,r=e.length;if(r<2)return!1;for(n=e[0],t=1;t<r;++t)if(e[t]-e[t-1]!==n)return!1;return n}(e),a=t.length/n;if(!r)return Math.max(a,1);for(var i=function(e){var t,n=[],r=Math.sqrt(e);for(t=1;t<r;t++)e%t===0&&(n.push(t),n.push(e/t));return r===(0|r)&&n.push(r),n.sort((function(e,t){return e-t})).pop(),n}(r),o=0,s=i.length-1;o<s;o++){var u=i[o];if(u>a)return u}return Math.max(a,1)}(i,t,a);if(o>0){var h,f,d=o>1?Math.round((u-s)/(o-1)):null;for(KM(t,c,l,ON(d)?0:s-d,s),h=0,f=o-1;h<f;h++)KM(t,c,l,i[h],i[h+1]);return KM(t,c,l,u,ON(d)?t.length:u+d),c}return KM(t,c,l),c}function KM(e,t,n,r,a){var i,o,s,u=zN(r,0),c=Math.min(zN(a,e.length),e.length),l=0;for(n=Math.ceil(n),a&&(n=(i=a-r)/Math.floor(i/n)),s=u;s<0;)l++,s=Math.round(u+l*n);for(o=Math.max(u,0);o<c;o++)o===s&&(t.push(e[o]),l++,s=Math.round(u+l*n))}(0,Ye.Z)(GM,"defaults",{}),(0,Ye.Z)(GM,"defaultRoutes",void 0);var YM=function(e,t,n){return"top"===t||"left"===t?e[t]+n:e[t]-n},XM=function(e,t){return Math.min(t||e,e)};function QM(e,t){for(var n=[],r=e.length/t,a=e.length,i=0;i<a;i+=r)n.push(e[Math.floor(i)]);return n}function JM(e,t,n){var r,a=e.ticks.length,i=Math.min(t,a-1),o=e._startPixel,s=e._endPixel,u=1e-6,c=e.getPixelForTick(i);if(!(n&&(r=1===a?Math.max(c-o,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(i-1))/2,(c+=i<t?r:-r)<o-u||c>s+u)))return c}function $M(e){return e.drawTicks?e.tickLength:0}function eO(e,t){if(!e.display)return 0;var n=TA(e.font,t),r=_A(e.padding);return(FN(e.text)?e.text.length:1)*n.lineHeight+r.height}function tO(e,t,n){var r=FD(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=function(e){return"left"===e?"right":"right"===e?"left":e}(r)),r}var nO=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).id=e.id,r.type=e.type,r.options=void 0,r.ctx=e.ctx,r.chart=e.chart,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.width=void 0,r.height=void 0,r._margins={left:0,right:0,top:0,bottom:0},r.maxWidth=void 0,r.maxHeight=void 0,r.paddingTop=void 0,r.paddingBottom=void 0,r.paddingLeft=void 0,r.paddingRight=void 0,r.axis=void 0,r.labelRotation=void 0,r.min=void 0,r.max=void 0,r._range=void 0,r.ticks=[],r._gridLineItems=null,r._labelItems=null,r._labelSizes=null,r._length=0,r._maxLength=0,r._longestTextCache={},r._startPixel=void 0,r._endPixel=void 0,r._reversePixels=!1,r._userMax=void 0,r._userMin=void 0,r._suggestedMax=void 0,r._suggestedMin=void 0,r._ticksLength=0,r._borderValue=0,r._cache={},r._dataLimitsCached=!1,r.$context=void 0,r}return(0,v.Z)(n,[{key:"init",value:function(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}},{key:"parse",value:function(e,t){return e}},{key:"getUserBounds",value:function(){var e=this._userMin,t=this._userMax,n=this._suggestedMin,r=this._suggestedMax;return e=ZN(e,Number.POSITIVE_INFINITY),t=ZN(t,Number.NEGATIVE_INFINITY),n=ZN(n,Number.POSITIVE_INFINITY),r=ZN(r,Number.NEGATIVE_INFINITY),{min:ZN(e,n),max:ZN(t,r),minDefined:LN(e),maxDefined:LN(t)}}},{key:"getMinMax",value:function(e){var t,n=this.getUserBounds(),r=n.min,a=n.max,i=n.minDefined,o=n.maxDefined;if(i&&o)return{min:r,max:a};for(var s=this.getMatchingVisibleMetas(),u=0,c=s.length;u<c;++u)t=s[u].controller.getMinMax(this,e),i||(r=Math.min(r,t.min)),o||(a=Math.max(a,t.max));return{min:ZN(r=o&&r>a?a:r,ZN(a=i&&r>a?r:a,r)),max:ZN(a,ZN(r,a))}}},{key:"getPadding",value:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}},{key:"getTicks",value:function(){return this.ticks}},{key:"getLabels",value:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}},{key:"getLabelItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}},{key:"beforeLayout",value:function(){this._cache={},this._dataLimitsCached=!1}},{key:"beforeUpdate",value:function(){UN(this.options.beforeUpdate,[this])}},{key:"update",value:function(e,t,n){var r=this.options,a=r.beginAtZero,i=r.grace,o=r.ticks,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){var r=e.min,a=e.max,i=BN(t,(a-r)/2),o=function(e,t){return n&&0===e?0:e+t};return{min:o(r,-Math.abs(i)),max:o(a,i)}}(this,i,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();var u=s<this.ticks.length;this._convertTicksToLabels(u?QM(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=qM(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),u&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}},{key:"configure",value:function(){var e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}},{key:"afterUpdate",value:function(){UN(this.options.afterUpdate,[this])}},{key:"beforeSetDimensions",value:function(){UN(this.options.beforeSetDimensions,[this])}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}},{key:"afterSetDimensions",value:function(){UN(this.options.afterSetDimensions,[this])}},{key:"_callHooks",value:function(e){this.chart.notifyPlugins(e,this.getContext()),UN(this.options[e],[this])}},{key:"beforeDataLimits",value:function(){this._callHooks("beforeDataLimits")}},{key:"determineDataLimits",value:function(){}},{key:"afterDataLimits",value:function(){this._callHooks("afterDataLimits")}},{key:"beforeBuildTicks",value:function(){this._callHooks("beforeBuildTicks")}},{key:"buildTicks",value:function(){return[]}},{key:"afterBuildTicks",value:function(){this._callHooks("afterBuildTicks")}},{key:"beforeTickToLabelConversion",value:function(){UN(this.options.beforeTickToLabelConversion,[this])}},{key:"generateTickLabels",value:function(e){var t,n,r,a=this.options.ticks;for(t=0,n=e.length;t<n;t++)(r=e[t]).label=UN(a.callback,[r.value,t,e],this)}},{key:"afterTickToLabelConversion",value:function(){UN(this.options.afterTickToLabelConversion,[this])}},{key:"beforeCalculateLabelRotation",value:function(){UN(this.options.beforeCalculateLabelRotation,[this])}},{key:"calculateLabelRotation",value:function(){var e,t,n,r=this.options,a=r.ticks,i=XM(this.ticks.length,r.ticks.maxTicksLimit),o=a.minRotation||0,s=a.maxRotation,u=o;if(!this._isVisible()||!a.display||o>=s||i<=1||!this.isHorizontal())this.labelRotation=o;else{var c=this._getLabelSizes(),l=c.widest.width,h=c.highest.height,f=CD(this.chart.width-l,0,this.maxWidth);l+6>(e=r.offset?this.maxWidth/i:f/(i-1))&&(e=f/(i-(r.offset?.5:1)),t=this.maxHeight-$M(r.grid)-a.padding-eO(r.title,this.chart.options.font),n=Math.sqrt(l*l+h*h),u=yD(Math.min(Math.asin(CD((c.highest.height+6)/e,-1,1)),Math.asin(CD(t/n,-1,1))-Math.asin(CD(h/n,-1,1)))),u=Math.max(o,Math.min(s,u))),this.labelRotation=u}}},{key:"afterCalculateLabelRotation",value:function(){UN(this.options.afterCalculateLabelRotation,[this])}},{key:"afterAutoSkip",value:function(){}},{key:"beforeFit",value:function(){UN(this.options.beforeFit,[this])}},{key:"fit",value:function(){var e={width:0,height:0},t=this.chart,n=this.options,r=n.ticks,a=n.title,i=n.grid,o=this._isVisible(),s=this.isHorizontal();if(o){var u=eO(a,t.options.font);if(s?(e.width=this.maxWidth,e.height=$M(i)+u):(e.height=this.maxHeight,e.width=$M(i)+u),r.display&&this.ticks.length){var c=this._getLabelSizes(),l=c.first,h=c.last,f=c.widest,d=c.highest,p=2*r.padding,v=mD(this.labelRotation),g=Math.cos(v),m=Math.sin(v);if(s){var y=r.mirror?0:m*f.width+g*d.height;e.height=Math.min(this.maxHeight,e.height+y+p)}else{var b=r.mirror?0:g*f.width+m*d.height;e.width=Math.min(this.maxWidth,e.width+b+p)}this._calculatePadding(l,h,m,g)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}},{key:"_calculatePadding",value:function(e,t,n,r){var a=this.options,i=a.ticks,o=i.align,s=i.padding,u=a.position,c=0!==this.labelRotation,l="top"!==u&&"x"===this.axis;if(this.isHorizontal()){var h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1),d=0,p=0;c?l?(d=r*e.width,p=n*t.height):(d=n*e.height,p=r*t.width):"start"===o?p=t.width:"end"===o?d=e.width:"inner"!==o&&(d=e.width/2,p=t.width/2),this.paddingLeft=Math.max((d-h+s)*this.width/(this.width-h),0),this.paddingRight=Math.max((p-f+s)*this.width/(this.width-f),0)}else{var v=t.height/2,g=e.height/2;"start"===o?(v=0,g=e.height):"end"===o&&(v=t.height,g=0),this.paddingTop=v+s,this.paddingBottom=g+s}}},{key:"_handleMargins",value:function(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}},{key:"afterFit",value:function(){UN(this.options.afterFit,[this])}},{key:"isHorizontal",value:function(){var e=this.options,t=e.axis,n=e.position;return"top"===n||"bottom"===n||"x"===t}},{key:"isFullSize",value:function(){return this.options.fullSize}},{key:"_convertTicksToLabels",value:function(e){var t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)ON(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}},{key:"_getLabelSizes",value:function(){var e=this._labelSizes;if(!e){var t=this.options.ticks.sampleSize,n=this.ticks;t<n.length&&(n=QM(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}},{key:"_computeLabelSizes",value:function(e,t,n){var r,a,i,o,s,u,c,l,h,f,d,p=this.ctx,v=this._longestTextCache,g=[],m=[],y=Math.floor(t/XM(t,n)),b=0,k=0;for(r=0;r<t;r+=y){if(o=e[r].label,s=this._resolveTickFontOptions(r),p.font=u=s.string,c=v[u]=v[u]||{data:{},gc:[]},l=s.lineHeight,h=f=0,ON(o)||FN(o)){if(FN(o))for(a=0,i=o.length;a<i;++a)ON(d=o[a])||FN(d)||(h=aA(p,c.data,c.gc,h,d),f+=l)}else h=aA(p,c.data,c.gc,h,o),f=l;g.push(h),m.push(f),b=Math.max(h,b),k=Math.max(f,k)}!function(e,t){VN(e,(function(e){var n,r=e.gc,a=r.length/2;if(a>t){for(n=0;n<a;++n)delete e.data[r[n]];r.splice(0,a)}}))}(v,t);var x=g.indexOf(b),w=m.indexOf(k),I=function(e){return{width:g[e]||0,height:m[e]||0}};return{first:I(0),last:I(t-1),widest:I(x),highest:I(w),widths:g,heights:m}}},{key:"getLabelForValue",value:function(e){return e}},{key:"getPixelForValue",value:function(e,t){return NaN}},{key:"getValueForPixel",value:function(e){}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getPixelForDecimal",value:function(e){this._reversePixels&&(e=1-e);var t=this._startPixel+e*this._length;return function(e){return CD(e,-32768,32767)}(this._alignToPixels?oA(this.chart,t,0):t)}},{key:"getDecimalForPixel",value:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}},{key:"getBasePixel",value:function(){return this.getPixelForValue(this.getBaseValue())}},{key:"getBaseValue",value:function(){var e=this.min,t=this.max;return e<0&&t<0?t:e>0&&t>0?e:0}},{key:"getContext",value:function(e){var t=this.ticks||[];if(e>=0&&e<t.length){var n=t[e];return n.$context||(n.$context=function(e,t,n){return NA(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=function(e,t){return NA(e,{scale:t,type:"scale"})}(this.chart.getContext(),this))}},{key:"_tickSize",value:function(){var e=this.options.ticks,t=mD(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),a=this._getLabelSizes(),i=e.autoSkipPadding||0,o=a?a.widest.width+i:0,s=a?a.highest.height+i:0;return this.isHorizontal()?s*n>o*r?o/n:s/r:s*r<o*n?s/n:o/r}},{key:"_isVisible",value:function(){var e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}},{key:"_computeGridLineItems",value:function(e){var t,n,r,a,i,o,s,u,c,l,h,f,d=this.axis,p=this.chart,v=this.options,g=v.grid,m=v.position,y=v.border,b=g.offset,k=this.isHorizontal(),x=this.ticks.length+(b?1:0),w=$M(g),I=[],S=y.setContext(this.getContext()),C=S.display?S.width:0,_=C/2,T=function(e){return oA(p,e,C)};if("top"===m)t=T(this.bottom),o=this.bottom-w,u=t-_,l=T(e.top)+_,f=e.bottom;else if("bottom"===m)t=T(this.top),l=e.top,f=T(e.bottom)-_,o=t+_,u=this.top+w;else if("left"===m)t=T(this.right),i=this.right-w,s=t-_,c=T(e.left)+_,h=e.right;else if("right"===m)t=T(this.left),c=e.left,h=T(e.right)-_,i=t+_,s=this.left+w;else if("x"===d){if("center"===m)t=T((e.top+e.bottom)/2+.5);else if(PN(m)){var E=Object.keys(m)[0],N=m[E];t=T(this.chart.scales[E].getPixelForValue(N))}l=e.top,f=e.bottom,u=(o=t+_)+w}else if("y"===d){if("center"===m)t=T((e.left+e.right)/2);else if(PN(m)){var D=Object.keys(m)[0],A=m[D];t=T(this.chart.scales[D].getPixelForValue(A))}s=(i=t-_)-w,c=e.left,h=e.right}var R=zN(v.ticks.maxTicksLimit,x),M=Math.max(1,Math.ceil(x/R));for(n=0;n<x;n+=M){var O=this.getContext(n),F=g.setContext(O),P=y.setContext(O),L=F.lineWidth,Z=F.color,z=P.dash||[],B=P.dashOffset,U=F.tickWidth,V=F.tickColor,j=F.tickBorderDash||[],W=F.tickBorderDashOffset;void 0!==(r=JM(this,n,b))&&(a=oA(p,r,L),k?i=s=c=h=a:o=u=l=f=a,I.push({tx1:i,ty1:o,tx2:s,ty2:u,x1:c,y1:l,x2:h,y2:f,width:L,color:Z,borderDash:z,borderDashOffset:B,tickWidth:U,tickColor:V,tickBorderDash:j,tickBorderDashOffset:W}))}return this._ticksLength=x,this._borderValue=t,I}},{key:"_computeLabelItems",value:function(e){var t,n,r,a,i,o,s,u,c,l,h,f=this.axis,d=this.options,p=d.position,v=d.ticks,g=this.isHorizontal(),m=this.ticks,y=v.align,b=v.crossAlign,k=v.padding,x=v.mirror,w=$M(d.grid),I=w+k,S=x?-k:I,C=-mD(this.labelRotation),_=[],T="middle";if("top"===p)i=this.bottom-S,o=this._getXAxisLabelAlignment();else if("bottom"===p)i=this.top+S,o=this._getXAxisLabelAlignment();else if("left"===p){var E=this._getYAxisLabelAlignment(w);o=E.textAlign,a=E.x}else if("right"===p){var N=this._getYAxisLabelAlignment(w);o=N.textAlign,a=N.x}else if("x"===f){if("center"===p)i=(e.top+e.bottom)/2+I;else if(PN(p)){var D=Object.keys(p)[0],A=p[D];i=this.chart.scales[D].getPixelForValue(A)+I}o=this._getXAxisLabelAlignment()}else if("y"===f){if("center"===p)a=(e.left+e.right)/2-I;else if(PN(p)){var R=Object.keys(p)[0],M=p[R];a=this.chart.scales[R].getPixelForValue(M)}o=this._getYAxisLabelAlignment(w).textAlign}"y"===f&&("start"===y?T="top":"end"===y&&(T="bottom"));var O=this._getLabelSizes();for(t=0,n=m.length;t<n;++t){r=m[t].label;var F=v.setContext(this.getContext(t));s=this.getPixelForTick(t)+v.labelOffset,c=(u=this._resolveTickFontOptions(t)).lineHeight;var P=(l=FN(r)?r.length:1)/2,L=F.color,Z=F.textStrokeColor,z=F.textStrokeWidth,B=o;g?(a=s,"inner"===o&&(B=t===n-1?this.options.reverse?"left":"right":0===t?this.options.reverse?"right":"left":"center"),h="top"===p?"near"===b||0!==C?-l*c+c/2:"center"===b?-O.highest.height/2-P*c+c:-O.highest.height+c/2:"near"===b||0!==C?c/2:"center"===b?O.highest.height/2-P*c:O.highest.height-l*c,x&&(h*=-1),0===C||F.showLabelBackdrop||(a+=c/2*Math.sin(C))):(i=s,h=(1-l)*c/2);var U=void 0;if(F.showLabelBackdrop){var V=_A(F.backdropPadding),j=O.heights[t],W=O.widths[t],H=h-V.top,G=0-V.left;switch(T){case"middle":H-=j/2;break;case"bottom":H-=j}switch(o){case"center":G-=W/2;break;case"right":G-=W}U={left:G,top:H,width:W+V.width,height:j+V.height,color:F.backdropColor}}_.push({label:r,font:u,textOffset:h,options:{rotation:C,color:L,strokeColor:Z,strokeWidth:z,textAlign:B,textBaseline:T,translation:[a,i],backdrop:U}})}return _}},{key:"_getXAxisLabelAlignment",value:function(){var e=this.options,t=e.position,n=e.ticks;if(-mD(this.labelRotation))return"top"===t?"left":"right";var r="center";return"start"===n.align?r="left":"end"===n.align?r="right":"inner"===n.align&&(r="inner"),r}},{key:"_getYAxisLabelAlignment",value:function(e){var t,n,r=this.options,a=r.position,i=r.ticks,o=i.crossAlign,s=i.mirror,u=i.padding,c=e+u,l=this._getLabelSizes().widest.width;return"left"===a?s?(n=this.right+u,"near"===o?t="left":"center"===o?(t="center",n+=l/2):(t="right",n+=l)):(n=this.right-c,"near"===o?t="right":"center"===o?(t="center",n-=l/2):(t="left",n=this.left)):"right"===a?s?(n=this.left+u,"near"===o?t="right":"center"===o?(t="center",n-=l/2):(t="left",n-=l)):(n=this.left+c,"near"===o?t="left":"center"===o?(t="center",n+=l/2):(t="right",n=this.right)):t="right",{textAlign:t,x:n}}},{key:"_computeLabelArea",value:function(){if(!this.options.ticks.mirror){var e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}}},{key:"drawBackground",value:function(){var e=this.ctx,t=this.options.backgroundColor,n=this.left,r=this.top,a=this.width,i=this.height;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,a,i),e.restore())}},{key:"getLineWidthForValue",value:function(e){var t=this.options.grid;if(!this._isVisible()||!t.display)return 0;var n=this.ticks.findIndex((function(t){return t.value===e}));return n>=0?t.setContext(this.getContext(n)).lineWidth:0}},{key:"drawGrid",value:function(e){var t,n,r=this.options.grid,a=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),o=function(e,t,n){n.width&&n.color&&(a.save(),a.lineWidth=n.width,a.strokeStyle=n.color,a.setLineDash(n.borderDash||[]),a.lineDashOffset=n.borderDashOffset,a.beginPath(),a.moveTo(e.x,e.y),a.lineTo(t.x,t.y),a.stroke(),a.restore())};if(r.display)for(t=0,n=i.length;t<n;++t){var s=i[t];r.drawOnChartArea&&o({x:s.x1,y:s.y1},{x:s.x2,y:s.y2},s),r.drawTicks&&o({x:s.tx1,y:s.ty1},{x:s.tx2,y:s.ty2},{color:s.tickColor,width:s.tickWidth,borderDash:s.tickBorderDash,borderDashOffset:s.tickBorderDashOffset})}}},{key:"drawBorder",value:function(){var e=this.chart,t=this.ctx,n=this.options,r=n.border,a=n.grid,i=r.setContext(this.getContext()),o=r.display?i.width:0;if(o){var s,u,c,l,h=a.setContext(this.getContext(0)).lineWidth,f=this._borderValue;this.isHorizontal()?(s=oA(e,this.left,o)-o/2,u=oA(e,this.right,h)+h/2,c=l=f):(c=oA(e,this.top,o)-o/2,l=oA(e,this.bottom,h)+h/2,s=u=f),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(s,c),t.lineTo(u,l),t.stroke(),t.restore()}}},{key:"drawLabels",value:function(e){if(this.options.ticks.display){var t=this.ctx,n=this._computeLabelArea();n&&hA(t,n);var r,a=this.getLabelItems(e),i=(0,C.Z)(a);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.options,u=o.font;mA(t,o.label,0,o.textOffset,u,s)}}catch(c){i.e(c)}finally{i.f()}n&&fA(t)}}},{key:"drawTitle",value:function(){var e=this.ctx,t=this.options,n=t.position,r=t.title,a=t.reverse;if(r.display){var i=TA(r.font),o=_A(r.padding),s=r.align,u=i.lineHeight/2;"bottom"===n||"center"===n||PN(n)?(u+=o.bottom,FN(r.text)&&(u+=i.lineHeight*(r.text.length-1))):u+=o.top;var c=function(e,t,n,r){var a,i,o,s=e.top,u=e.left,c=e.bottom,l=e.right,h=e.chart,f=h.chartArea,d=h.scales,p=0,v=c-s,g=l-u;if(e.isHorizontal()){if(i=PD(r,u,l),PN(n)){var m=Object.keys(n)[0],y=n[m];o=d[m].getPixelForValue(y)+v-t}else o="center"===n?(f.bottom+f.top)/2+v-t:YM(e,n,t);a=l-u}else{if(PN(n)){var b=Object.keys(n)[0],k=n[b];i=d[b].getPixelForValue(k)-g+t}else i="center"===n?(f.left+f.right)/2-g+t:YM(e,n,t);o=PD(r,c,s),p="left"===n?-uD:uD}return{titleX:i,titleY:o,maxWidth:a,rotation:p}}(this,u,n,s),l=c.titleX,h=c.titleY,f=c.maxWidth,d=c.rotation;mA(e,r.text,0,0,i,{color:r.color,maxWidth:f,rotation:d,textAlign:tO(s,n,a),textBaseline:"middle",translation:[l,h]})}}},{key:"draw",value:function(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}},{key:"_layers",value:function(){var e=this,t=this.options,r=t.ticks&&t.ticks.z||0,a=zN(t.grid&&t.grid.z,-1),i=zN(t.border&&t.border.z,0);return this._isVisible()&&this.draw===n.prototype.draw?[{z:a,draw:function(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:i,draw:function(){e.drawBorder()}},{z:r,draw:function(t){e.drawLabels(t)}}]:[{z:r,draw:function(t){e.draw(t)}}]}},{key:"getMatchingVisibleMetas",value:function(e){var t,n,r=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",i=[];for(t=0,n=r.length;t<n;++t){var o=r[t];o[a]!==this.id||e&&o.type!==e||i.push(o)}return i}},{key:"_resolveTickFontOptions",value:function(e){return TA(this.options.ticks.setContext(this.getContext(e)).font)}},{key:"_maxDigits",value:function(){var e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}]),n}(GM),rO=function(){function e(t,n,r){(0,p.Z)(this,e),this.type=t,this.scope=n,this.override=r,this.items=Object.create(null)}return(0,v.Z)(e,[{key:"isForType",value:function(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}},{key:"register",value:function(e){var t,n=Object.getPrototypeOf(e);(function(e){return"id"in e&&"defaults"in e})(n)&&(t=this.register(n));var r=this.items,a=e.id,i=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,function(e,t,n){var r=qN(Object.create(null),[n?rA.get(n):{},rA.get(t),e.defaults]);rA.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((function(n){var r=n.split("."),a=r.pop(),i=[e].concat(r).join("."),o=t[n].split("."),s=o.pop(),u=o.join(".");rA.route(i,a,u,s)}))}(t,e.defaultRoutes);e.descriptors&&rA.describe(t,e.descriptors)}(e,i,t),this.override&&rA.override(e.id,e.overrides)),i}},{key:"get",value:function(e){return this.items[e]}},{key:"unregister",value:function(e){var t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in rA[r]&&(delete rA[r][n],this.override&&delete JD[n])}}]),e}();var aO=function(){function e(){(0,p.Z)(this,e),this.controllers=new rO(BR,"datasets",!0),this.elements=new rO(GM,"elements"),this.plugins=new rO(Object,"plugins"),this.scales=new rO(nO,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}return(0,v.Z)(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}},{key:"addControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}},{key:"addElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}},{key:"addScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}},{key:"getController",value:function(e){return this._get(e,this.controllers,"controller")}},{key:"getElement",value:function(e){return this._get(e,this.elements,"element")}},{key:"getPlugin",value:function(e){return this._get(e,this.plugins,"plugin")}},{key:"getScale",value:function(e){return this._get(e,this.scales,"scale")}},{key:"removeControllers",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}},{key:"removeElements",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}},{key:"removePlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}},{key:"removeScales",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}},{key:"_each",value:function(e,t,n){var r=this;d(t).forEach((function(t){var a=n||r._getRegistryForType(t);n||a.isForType(t)||a===r.plugins&&t.id?r._exec(e,a,t):VN(t,(function(t){var a=n||r._getRegistryForType(t);r._exec(e,a,t)}))}))}},{key:"_exec",value:function(e,t,n){var r=$N(e);UN(n["before"+r],[],n),t[e](n),UN(n["after"+r],[],n)}},{key:"_getRegistryForType",value:function(e){for(var t=0;t<this._typedRegistries.length;t++){var n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}},{key:"_get",value:function(e,t,n){var r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}]),e}(),iO=new aO,oO=function(){function e(){(0,p.Z)(this,e),this._init=[]}return(0,v.Z)(e,[{key:"notify",value:function(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));var a=r?this._descriptors(e).filter(r):this._descriptors(e),i=this._notify(a,e,t,n);return"afterDestroy"===t&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall")),i}},{key:"_notify",value:function(e,t,n,r){r=r||{};var a,i=(0,C.Z)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.plugin;if(!1===UN(s[n],[t,r,o.options],s)&&r.cancelable)return!1}}catch(u){i.e(u)}finally{i.f()}return!0}},{key:"invalidate",value:function(){ON(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}},{key:"_descriptors",value:function(e){if(this._cache)return this._cache;var t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}},{key:"_createDescriptors",value:function(e,t){var n=e&&e.config,r=zN(n.options&&n.options.plugins,{}),a=function(e){for(var t={},n=[],r=Object.keys(iO.plugins.items),a=0;a<r.length;a++)n.push(iO.getPlugin(r[a]));for(var i=e.plugins||[],o=0;o<i.length;o++){var s=i[o];-1===n.indexOf(s)&&(n.push(s),t[s.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){var a,i=t.plugins,o=t.localIds,s=[],u=e.getContext(),c=(0,C.Z)(i);try{for(c.s();!(a=c.n()).done;){var l=a.value,h=l.id,f=sO(n[h],r);null!==f&&s.push({plugin:l,options:uO(e.config,{plugin:l,local:o[h]},f,u)})}}catch(d){c.e(d)}finally{c.f()}return s}(e,a,r,t):[]}},{key:"_notifyStateChanges",value:function(e){var t=this._oldCache||[],n=this._cache,r=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.plugin.id===t.plugin.id}))}))};this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}]),e}();function sO(e,t){return t||!1!==e?!0===e?{}:e:null}function uO(e,t,n,r){var a=t.plugin,i=t.local,o=e.pluginScopeKeys(a),s=e.getOptionScopes(n,o);return i&&a.defaults&&s.push(a.defaults),e.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cO(e,t){var n=rA.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function lO(e){if("x"===e||"y"===e||"r"===e)return e}function hO(e){if(lO(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a],s=o.axis||("top"===(u=o.position)||"bottom"===u?"x":"left"===u||"right"===u?"y":void 0)||e.length>1&&lO(e[0].toLowerCase());if(s)return s}var u;throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function fO(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function dO(e,t){var n=JD[e.type]||{scales:{}},r=t.scales||{},a=cO(e.type,t),i=Object.create(null);return Object.keys(r).forEach((function(t){var o=r[t];if(!PN(o))return console.error("Invalid scale configuration for scale: ".concat(t));if(o._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));var s=hO(t,o,function(e,t){if(t.data&&t.data.datasets){var n=t.data.datasets.filter((function(t){return t.xAxisID===e||t.yAxisID===e}));if(n.length)return fO(e,"x",n[0])||fO(e,"y",n[0])}return{}}(t,e),rA.scales[o.type]),u=function(e,t){return e===t?"_index_":"_value_"}(s,a),c=n.scales||{};i[t]=KN(Object.create(null),[{axis:s},o,c[s],c[u]])})),e.data.datasets.forEach((function(n){var a=n.type||e.type,o=n.indexAxis||cO(a,t),s=(JD[a]||{}).scales||{};Object.keys(s).forEach((function(e){var t=function(e,t){var n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,o),a=n[t+"AxisID"]||t;i[a]=i[a]||Object.create(null),KN(i[a],[{axis:t},r[a],s[e]])}))})),Object.keys(i).forEach((function(e){var t=i[e];KN(t,[rA.scales[t.type],rA.scale])})),i}function pO(e){var t=e.options||(e.options={});t.plugins=zN(t.plugins,{}),t.scales=dO(e,t)}function vO(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}var gO=new Map,mO=new Set;function yO(e,t){var n=gO.get(e);return n||(n=t(),gO.set(e,n),mO.add(n)),n}var bO=function(e,t,n){var r=JN(t,n);void 0!==r&&e.add(r)},kO=function(){function e(t){(0,p.Z)(this,e),this._config=function(e){return(e=e||{}).data=vO(e.data),pO(e),e}(t),this._scopeCache=new Map,this._resolverCache=new Map}return(0,v.Z)(e,[{key:"platform",get:function(){return this._config.platform}},{key:"type",get:function(){return this._config.type},set:function(e){this._config.type=e}},{key:"data",get:function(){return this._config.data},set:function(e){this._config.data=vO(e)}},{key:"options",get:function(){return this._config.options},set:function(e){this._config.options=e}},{key:"plugins",get:function(){return this._config.plugins}},{key:"update",value:function(){var e=this._config;this.clearCache(),pO(e)}},{key:"clearCache",value:function(){this._scopeCache.clear(),this._resolverCache.clear()}},{key:"datasetScopeKeys",value:function(e){return yO(e,(function(){return[["datasets.".concat(e),""]]}))}},{key:"datasetAnimationScopeKeys",value:function(e,t){return yO("".concat(e,".transition.").concat(t),(function(){return[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]}))}},{key:"datasetElementScopeKeys",value:function(e,t){return yO("".concat(e,"-").concat(t),(function(){return[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]}))}},{key:"pluginScopeKeys",value:function(e){var t=e.id,n=this.type;return yO("".concat(n,"-plugin-").concat(t),(function(){return[["plugins.".concat(t)].concat(d(e.additionalOptionScopes||[]))]}))}},{key:"_cachedScopes",value:function(e,t){var n=this._scopeCache,r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}},{key:"getOptionScopes",value:function(e,t,n){var r=this.options,a=this.type,i=this._cachedScopes(e,n),o=i.get(t);if(o)return o;var s=new Set;t.forEach((function(t){e&&(s.add(e),t.forEach((function(t){return bO(s,e,t)}))),t.forEach((function(e){return bO(s,r,e)})),t.forEach((function(e){return bO(s,JD[a]||{},e)})),t.forEach((function(e){return bO(s,rA,e)})),t.forEach((function(e){return bO(s,$D,e)}))}));var u=Array.from(s);return 0===u.length&&u.push(Object.create(null)),mO.has(t)&&i.set(t,u),u}},{key:"chartOptionScopes",value:function(){var e=this.options,t=this.type;return[e,JD[t]||{},rA.datasets[t]||{},{type:t},rA,$D]}},{key:"resolveNamedOptions",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""],a={$shared:!0},i=xO(this._resolverCache,e,r),o=i.resolver,s=i.subPrefixes,u=o;(function(e,t){var n,r=RA(e),a=r.isScriptable,i=r.isIndexable,o=(0,C.Z)(t);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=a(s),c=i(s),l=(c||u)&&e[s];if(u&&(tD(l)||wO(l))||c&&FN(l))return!0}}catch(h){o.e(h)}finally{o.f()}return!1})(o,t)&&(a.$shared=!1,u=AA(o,n=tD(n)?n():n,this.createResolver(e,n,s)));var c,l=(0,C.Z)(t);try{for(l.s();!(c=l.n()).done;){var h=c.value;a[h]=u[h]}}catch(f){l.e(f)}finally{l.f()}return a}},{key:"createResolver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0,a=xO(this._resolverCache,e,n).resolver;return PN(t)?AA(a,t,void 0,r):a}}]),e}();function xO(e,t,n){var r=e.get(t);r||(r=new Map,e.set(t,r));var a=n.join(),i=r.get(a);i||(i={resolver:DA(t,n),subPrefixes:n.filter((function(e){return!e.toLowerCase().includes("hover")}))},r.set(a,i));return i}var wO=function(e){return PN(e)&&Object.getOwnPropertyNames(e).reduce((function(t,n){return t||tD(e[n])}),!1)};var IO=["top","bottom","left","right","chartArea"];function SO(e,t){return"top"===e||"bottom"===e||-1===IO.indexOf(e)&&"x"===t}function CO(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function _O(e){var t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),UN(n&&n.onComplete,[e],t)}function TO(e){var t=e.chart,n=t.options.animation;UN(n&&n.onProgress,[e],t)}function EO(e){return QA()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var NO={},DO=function(e){var t=EO(e);return Object.values(NO).filter((function(e){return e.canvas===t})).pop()};function AO(e,t,n){for(var r=0,a=Object.keys(e);r<a.length;r++){var i=a[r],o=+i;if(o>=t){var s=e[i];delete e[i],(n>0||o>t)&&(e[o+n]=s)}}}var RO=function(){function e(t,n){var r=this;(0,p.Z)(this,e);var a=this.config=new kO(n),i=EO(t),o=DO(i);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");var s=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||function(e){return!QA()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?DM:HM}(i)),this.platform.updateConfig(a);var u=this.platform.acquireContext(i,s.aspectRatio),c=u&&u.canvas,l=c&&c.height,h=c&&c.width;this.id=MN(),this.ctx=u,this.canvas=c,this.width=h,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new oO,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){var n;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}((function(e){return r.update(e)}),s.resizeDelay||0),this._dataChanges=[],NO[this.id]=this,u&&c?(SR.listen(this,"complete",_O),SR.listen(this,"progress",TO),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}return(0,v.Z)(e,[{key:"aspectRatio",get:function(){var e=this.options,t=e.aspectRatio,n=e.maintainAspectRatio,r=this.width,a=this.height,i=this._aspectRatio;return ON(t)?n&&i?i:a?r/a:null:t}},{key:"data",get:function(){return this.config.data},set:function(e){this.config.data=e}},{key:"options",get:function(){return this._options},set:function(e){this.config.options=e}},{key:"registry",get:function(){return iO}},{key:"_initialize",value:function(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}},{key:"clear",value:function(){return sA(this.canvas,this.ctx),this}},{key:"stop",value:function(){return SR.stop(this),this}},{key:"resize",value:function(e,t){SR.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}},{key:"_resize",value:function(e,t){var n=this.options,r=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(r,e,t,a),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,sR(this,o,!0)&&(this.notifyPlugins("resize",{size:i}),UN(n.onResize,[this,i],this),this.attached&&this._doResize(s)&&this.render())}},{key:"ensureScalesHaveIDs",value:function(){VN(this.options.scales||{},(function(e,t){e.id=t}))}},{key:"buildOrUpdateScales",value:function(){var e=this,t=this.options,n=t.scales,r=this.scales,a=Object.keys(r).reduce((function(e,t){return e[t]=!1,e}),{}),i=[];n&&(i=i.concat(Object.keys(n).map((function(e){var t=n[e],r=hO(e,t),a="r"===r,i="x"===r;return{options:t,dposition:a?"chartArea":i?"bottom":"left",dtype:a?"radialLinear":i?"category":"linear"}})))),VN(i,(function(n){var i=n.options,o=i.id,s=hO(o,i),u=zN(i.type,n.dtype);void 0!==i.position&&SO(i.position,s)===SO(n.dposition)||(i.position=n.dposition),a[o]=!0;var c=null;o in r&&r[o].type===u?c=r[o]:(c=new(iO.getScale(u))({id:o,type:u,ctx:e.ctx,chart:e}),r[c.id]=c);c.init(i,t)})),VN(a,(function(e,t){e||delete r[t]})),VN(r,(function(t){TM(e,t,t.options),CM(e,t)}))}},{key:"_updateMetasets",value:function(){var e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((function(e,t){return e.index-t.index})),n>t){for(var r=t;r<n;++r)this._destroyDatasetMeta(r);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(CO("order","index"))}},{key:"_removeUnreferencedMetasets",value:function(){var e=this,t=this._metasets,n=this.data.datasets;t.length>n.length&&delete this._stacks,t.forEach((function(t,r){0===n.filter((function(e){return e===t._dataset})).length&&e._destroyDatasetMeta(r)}))}},{key:"buildOrUpdateControllers",value:function(){var e,t,n=[],r=this.data.datasets;for(this._removeUnreferencedMetasets(),e=0,t=r.length;e<t;e++){var a=r[e],i=this.getDatasetMeta(e),o=a.type||this.config.type;if(i.type&&i.type!==o&&(this._destroyDatasetMeta(e),i=this.getDatasetMeta(e)),i.type=o,i.indexAxis=a.indexAxis||cO(o,this.options),i.order=a.order||0,i.index=e,i.label=""+a.label,i.visible=this.isDatasetVisible(e),i.controller)i.controller.updateIndex(e),i.controller.linkScales();else{var s=iO.getController(o),u=rA.datasets[o],c=u.datasetElementType,l=u.dataElementType;Object.assign(s,{dataElementType:iO.getElement(l),datasetElementType:c&&iO.getElement(c)}),i.controller=new s(this,e),n.push(i.controller)}}return this._updateMetasets(),n}},{key:"_resetElements",value:function(){var e=this;VN(this.data.datasets,(function(t,n){e.getDatasetMeta(n).controller.reset()}),this)}},{key:"reset",value:function(){this._resetElements(),this.notifyPlugins("reset")}},{key:"update",value:function(e){var t=this.config;t.update();var n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1!==this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})){var a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");for(var i=0,o=0,s=this.data.datasets.length;o<s;o++){var u=this.getDatasetMeta(o).controller,c=!r&&-1===a.indexOf(u);u.buildOrUpdateElements(c),i=Math.max(+u.getMaxOverflow(),i)}i=this._minPadding=n.layout.autoPadding?i:0,this._updateLayout(i),r||VN(a,(function(e){e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(CO("z","_idx"));var l=this._active,h=this._lastEvent;h?this._eventHandler(h,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}}},{key:"_updateScales",value:function(){var e=this;VN(this.scales,(function(t){_M(e,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}},{key:"_checkEventBindings",value:function(){var e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);nD(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}},{key:"_updateHiddenIndices",value:function(){var e,t=this._hiddenIndices,n=this._getUniformDataChanges()||[],r=(0,C.Z)(n);try{for(r.s();!(e=r.n()).done;){var a=e.value,i=a.method,o=a.start,s=a.count;AO(t,o,"_removeElements"===i?-s:s)}}catch(u){r.e(u)}finally{r.f()}}},{key:"_getUniformDataChanges",value:function(){var e=this._dataChanges;if(e&&e.length){this._dataChanges=[];for(var t=this.data.datasets.length,n=function(t){return new Set(e.filter((function(e){return e[0]===t})).map((function(e,t){return t+","+e.splice(1).join(",")})))},r=n(0),a=1;a<t;a++)if(!nD(r,n(a)))return;return Array.from(r).map((function(e){return e.split(",")})).map((function(e){return{method:e[1],start:+e[2],count:+e[3]}}))}}},{key:"_updateLayout",value:function(e){var t=this;if(!1!==this.notifyPlugins("beforeLayout",{cancelable:!0})){EM(this,this.width,this.height,e);var n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],VN(this.boxes,(function(e){var n;r&&"chartArea"===e.position||(e.configure&&e.configure(),(n=t._layers).push.apply(n,d(e._layers())))}),this),this._layers.forEach((function(e,t){e._idx=t})),this.notifyPlugins("afterLayout")}}},{key:"_updateDatasets",value:function(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(var t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(var r=0,a=this.data.datasets.length;r<a;++r)this._updateDataset(r,tD(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}},{key:"_updateDataset",value:function(e,t){var n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}},{key:"render",value:function(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(SR.has(this)?this.attached&&!SR.running(this)&&SR.start(this):(this.draw(),_O({chart:this})))}},{key:"draw",value:function(){var e;if(this._resizeBeforeDraw){var t=this._resizeBeforeDraw,n=t.width,r=t.height;this._resize(n,r),this._resizeBeforeDraw=null}if(this.clear(),!(this.width<=0||this.height<=0)&&!1!==this.notifyPlugins("beforeDraw",{cancelable:!0})){var a=this._layers;for(e=0;e<a.length&&a[e].z<=0;++e)a[e].draw(this.chartArea);for(this._drawDatasets();e<a.length;++e)a[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}}},{key:"_getSortedDatasetMetas",value:function(e){var t,n,r=this._sortedMetasets,a=[];for(t=0,n=r.length;t<n;++t){var i=r[t];e&&!i.visible||a.push(i)}return a}},{key:"getSortedVisibleDatasetMetas",value:function(){return this._getSortedDatasetMetas(!0)}},{key:"_drawDatasets",value:function(){if(!1!==this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})){for(var e=this.getSortedVisibleDatasetMetas(),t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}}},{key:"_drawDataset",value:function(e){var t=this.ctx,n=e._clip,r=!n.disabled,a=function(e){var t=e.xScale,n=e.yScale;if(t&&n)return{left:t.left,right:t.right,top:n.top,bottom:n.bottom}}(e)||this.chartArea,i={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",i)&&(r&&hA(t,{left:!1===n.left?0:a.left-n.left,right:!1===n.right?this.width:a.right+n.right,top:!1===n.top?0:a.top-n.top,bottom:!1===n.bottom?this.height:a.bottom+n.bottom}),e.controller.draw(),r&&fA(t),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}},{key:"isPointInArea",value:function(e){return lA(e,this.chartArea,this._minPadding)}},{key:"getElementsAtEventForMode",value:function(e,t,n,r){var a=fM.modes[t];return"function"===typeof a?a(this,e,n,r):[]}},{key:"getDatasetMeta",value:function(e){var t=this.data.datasets[e],n=this._metasets,r=n.filter((function(e){return e&&e._dataset===t})).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}},{key:"getContext",value:function(){return this.$context||(this.$context=NA(null,{chart:this,type:"chart"}))}},{key:"getVisibleDatasetCount",value:function(){return this.getSortedVisibleDatasetMetas().length}},{key:"isDatasetVisible",value:function(e){var t=this.data.datasets[e];if(!t)return!1;var n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}},{key:"setDatasetVisibility",value:function(e,t){this.getDatasetMeta(e).hidden=!t}},{key:"toggleDataVisibility",value:function(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}},{key:"getDataVisibility",value:function(e){return!this._hiddenIndices[e]}},{key:"_updateVisibility",value:function(e,t,n){var r=n?"show":"hide",a=this.getDatasetMeta(e),i=a.controller._resolveAnimations(void 0,r);eD(t)?(a.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),i.update(a,{visible:n}),this.update((function(t){return t.datasetIndex===e?r:void 0})))}},{key:"hide",value:function(e,t){this._updateVisibility(e,t,!1)}},{key:"show",value:function(e,t){this._updateVisibility(e,t,!0)}},{key:"_destroyDatasetMeta",value:function(e){var t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}},{key:"_stop",value:function(){var e,t;for(this.stop(),SR.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}},{key:"destroy",value:function(){this.notifyPlugins("beforeDestroy");var e=this.canvas,t=this.ctx;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),sA(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete NO[this.id],this.notifyPlugins("afterDestroy")}},{key:"toBase64Image",value:function(){var e;return(e=this.canvas).toDataURL.apply(e,arguments)}},{key:"bindEvents",value:function(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}},{key:"bindUserEvents",value:function(){var e=this,t=this._listeners,n=this.platform,r=function(t,n,r){t.offsetX=n,t.offsetY=r,e._eventHandler(t)};VN(this.options.events,(function(a){return function(r,a){n.addEventListener(e,r,a),t[r]=a}(a,r)}))}},{key:"bindResponsiveEvents",value:function(){var e=this;this._responsiveListeners||(this._responsiveListeners={});var t,n=this._responsiveListeners,r=this.platform,a=function(t,a){r.addEventListener(e,t,a),n[t]=a},i=function(t,a){n[t]&&(r.removeEventListener(e,t,a),delete n[t])},o=function(t,n){e.canvas&&e.resize(t,n)},s=function n(){i("attach",n),e.attached=!0,e.resize(),a("resize",o),a("detach",t)};t=function(){e.attached=!1,i("resize",o),e._stop(),e._resize(0,0),a("attach",s)},r.isAttached(this.canvas)?s():t()}},{key:"unbindEvents",value:function(){var e=this;VN(this._listeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._listeners={},VN(this._responsiveListeners,(function(t,n){e.platform.removeEventListener(e,n,t)})),this._responsiveListeners=void 0}},{key:"updateHoverStyle",value:function(e,t,n){var r,a,i,o=n?"set":"remove";for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+o+"DatasetHoverStyle"](),a=0,i=e.length;a<i;++a){var s=(r=e[a])&&this.getDatasetMeta(r.datasetIndex).controller;s&&s[o+"HoverStyle"](r.element,r.datasetIndex,r.index)}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e){var t=this,n=this._active||[],r=e.map((function(e){var n=e.datasetIndex,r=e.index,a=t.getDatasetMeta(n);if(!a)throw new Error("No dataset found at index "+n);return{datasetIndex:n,element:a.data[r],index:r}}));!jN(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}},{key:"notifyPlugins",value:function(e,t,n){return this._plugins.notify(this,e,t,n)}},{key:"isPluginEnabled",value:function(e){return 1===this._plugins._cache.filter((function(t){return t.plugin.id===e})).length}},{key:"_updateHoverStyles",value:function(e,t,n){var r=this.options.hover,a=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.datasetIndex===t.datasetIndex&&e.index===t.index}))}))},i=a(t,e),o=n?e:a(e,t);i.length&&this.updateHoverStyle(i,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}},{key:"_eventHandler",value:function(e,t){var n=this,r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=function(t){return(t.options.events||n.options.events).includes(e.native.type)};if(!1!==this.notifyPlugins("beforeEvent",r,a)){var i=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(i||r.changed)&&this.render(),this}}},{key:"_handleEvent",value:function(e,t,n){var r=this._active,a=void 0===r?[]:r,i=this.options,o=t,s=this._getActiveElements(e,a,n,o),u=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),c=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,u);n&&(this._lastEvent=null,UN(i.onHover,[e,s,this],this),u&&UN(i.onClick,[e,s,this],this));var l=!jN(s,a);return(l||t)&&(this._active=s,this._updateHoverStyles(s,a,t)),this._lastEvent=c,l}},{key:"_getActiveElements",value:function(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;var a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}],[{key:"register",value:function(){iO.add.apply(iO,arguments),MO()}},{key:"unregister",value:function(){iO.remove.apply(iO,arguments),MO()}}]),e}();function MO(){return VN(RO.instances,(function(e){return e._plugins.invalidate()}))}function OO(e,t,n,r){var a=function(e){return IA(e,["outerStart","outerEnd","innerStart","innerEnd"])}(e.options.borderRadius),i=(n-t)/2,o=Math.min(i,r*t/2),s=function(e){var t=(n-Math.min(i,e))*r/2;return CD(e,0,Math.min(i,t))};return{outerStart:s(a.outerStart),outerEnd:s(a.outerEnd),innerStart:CD(a.innerStart,0,o),innerEnd:CD(a.innerEnd,0,o)}}function FO(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function PO(e,t,n,r,a,i){var o=t.x,s=t.y,u=t.startAngle,c=t.pixelMargin,l=t.innerRadius,h=Math.max(t.outerRadius+r+n-c,0),f=l>0?l+r+n+c:0,d=0,p=a-u;if(r){var v=((l>0?l-r:0)+(h>0?h-r:0))/2;d=(p-(0!==v?p*v/(v+r):p))/2}var g=(p-Math.max(.001,p*h-n/rD)/h)/2,m=u+g+d,y=a-g-d,b=OO(t,f,h,y-m),k=b.outerStart,x=b.outerEnd,w=b.innerStart,I=b.innerEnd,S=h-k,C=h-x,_=m+k/S,T=y-x/C,E=f+w,N=f+I,D=m+w/E,A=y-I/N;if(e.beginPath(),i){var R=(_+T)/2;if(e.arc(o,s,h,_,R),e.arc(o,s,h,R,T),x>0){var M=FO(C,T,o,s);e.arc(M.x,M.y,x,T,y+uD)}var O=FO(N,y,o,s);if(e.lineTo(O.x,O.y),I>0){var F=FO(N,A,o,s);e.arc(F.x,F.y,I,y+uD,A+Math.PI)}var P=(y-I/f+(m+w/f))/2;if(e.arc(o,s,f,y-I/f,P,!0),e.arc(o,s,f,P,m+w/f,!0),w>0){var L=FO(E,D,o,s);e.arc(L.x,L.y,w,D+Math.PI,m-uD)}var Z=FO(S,m,o,s);if(e.lineTo(Z.x,Z.y),k>0){var z=FO(S,_,o,s);e.arc(z.x,z.y,k,m-uD,_)}}else{e.moveTo(o,s);var B=Math.cos(_)*h+o,U=Math.sin(_)*h+s;e.lineTo(B,U);var V=Math.cos(T)*h+o,j=Math.sin(T)*h+s;e.lineTo(V,j)}e.closePath()}function LO(e,t,n,r,a){var i=t.fullCircles,o=t.startAngle,s=t.circumference,u=t.options,c=u.borderWidth,l=u.borderJoinStyle,h=u.borderDash,f=u.borderDashOffset,d="inner"===u.borderAlign;if(c){e.setLineDash(h||[]),e.lineDashOffset=f,d?(e.lineWidth=2*c,e.lineJoin=l||"round"):(e.lineWidth=c,e.lineJoin=l||"bevel");var p=t.endAngle;if(i){PO(e,t,n,r,p,a);for(var v=0;v<i;++v)e.stroke();isNaN(s)||(p=o+(s%aD||aD))}d&&function(e,t,n){var r=t.startAngle,a=t.pixelMargin,i=t.x,o=t.y,s=t.outerRadius,u=t.innerRadius,c=a/s;e.beginPath(),e.arc(i,o,s,r-c,n+c),u>a?(c=a/u,e.arc(i,o,u,n+c,r-c,!0)):e.arc(i,o,a,n+uD,r-uD),e.closePath(),e.clip()}(e,t,p),i||(PO(e,t,n,r,p,a),e.stroke())}}(0,Ye.Z)(RO,"defaults",rA),(0,Ye.Z)(RO,"instances",NO),(0,Ye.Z)(RO,"overrides",JD),(0,Ye.Z)(RO,"registry",iO),(0,Ye.Z)(RO,"version","4.3.0"),(0,Ye.Z)(RO,"getChart",DO);var ZO=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this),(0,Ye.Z)((0,Je.Z)(r),"circumference",void 0),(0,Ye.Z)((0,Je.Z)(r),"endAngle",void 0),(0,Ye.Z)((0,Je.Z)(r),"fullCircles",void 0),(0,Ye.Z)((0,Je.Z)(r),"innerRadius",void 0),(0,Ye.Z)((0,Je.Z)(r),"outerRadius",void 0),(0,Ye.Z)((0,Je.Z)(r),"pixelMargin",void 0),(0,Ye.Z)((0,Je.Z)(r),"startAngle",void 0),r.options=void 0,r.circumference=void 0,r.startAngle=void 0,r.endAngle=void 0,r.innerRadius=void 0,r.outerRadius=void 0,r.pixelMargin=0,r.fullCircles=0,e&&Object.assign((0,Je.Z)(r),e),r}return(0,v.Z)(n,[{key:"inRange",value:function(e,t,n){var r=kD(this.getProps(["x","y"],n),{x:e,y:t}),a=r.angle,i=r.distance,o=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),s=o.startAngle,u=o.endAngle,c=o.innerRadius,l=o.outerRadius,h=o.circumference,f=(this.options.spacing+this.options.borderWidth)/2,d=zN(h,u-s)>=aD||SD(a,s,u),p=_D(i,c+f,l+f);return d&&p}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),n=t.x,r=t.y,a=t.startAngle,i=t.endAngle,o=t.innerRadius,s=t.outerRadius,u=this.options,c=u.offset,l=(a+i)/2,h=(o+s+u.spacing+c)/2;return{x:n+Math.cos(l)*h,y:r+Math.sin(l)*h}}},{key:"tooltipPosition",value:function(e){return this.getCenterPoint(e)}},{key:"draw",value:function(e){var t=this.options,n=this.circumference,r=(t.offset||0)/4,a=(t.spacing||0)/2,i=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>aD?Math.floor(n/aD):0,!(0===n||this.innerRadius<0||this.outerRadius<0)){e.save();var o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*r,Math.sin(o)*r);var s=r*(1-Math.sin(Math.min(rD,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,a){var i=t.fullCircles,o=t.startAngle,s=t.circumference,u=t.endAngle;if(i){PO(e,t,n,r,u,a);for(var c=0;c<i;++c)e.fill();isNaN(s)||(u=o+(s%aD||aD))}PO(e,t,n,r,u,a),e.fill()}(e,this,s,a,i),LO(e,this,s,a,i),e.restore()}}}]),n}(GM);function zO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=zN(n.borderCapStyle,t.borderCapStyle),e.setLineDash(zN(n.borderDash,t.borderDash)),e.lineDashOffset=zN(n.borderDashOffset,t.borderDashOffset),e.lineJoin=zN(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=zN(n.borderWidth,t.borderWidth),e.strokeStyle=zN(n.borderColor,t.borderColor)}function BO(e,t,n){e.lineTo(n.x,n.y)}function UO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.length,a=n.start,i=void 0===a?0:a,o=n.end,s=void 0===o?r-1:o,u=t.start,c=t.end,l=Math.max(i,u),h=Math.min(s,c),f=i<u&&s<u||i>c&&s>c;return{count:r,start:l,loop:t.loop,ilen:h<l&&!f?r+h-l:h-l}}function VO(e,t,n,r){var a,i,o,s=t.points,u=t.options,c=UO(s,n,r),l=c.count,h=c.start,f=c.loop,d=c.ilen,p=function(e){return e.stepped?dA:e.tension||"monotone"===e.cubicInterpolationMode?pA:BO}(u),v=r||{},g=v.move,m=void 0===g||g,y=v.reverse;for(a=0;a<=d;++a)(i=s[(h+(y?d-a:a))%l]).skip||(m?(e.moveTo(i.x,i.y),m=!1):p(e,o,i,y,u.stepped),o=i);return f&&p(e,o,i=s[(h+(y?d:0))%l],y,u.stepped),!!f}function jO(e,t,n,r){var a,i,o,s,u,c,l=t.points,h=UO(l,n,r),f=h.count,d=h.start,p=h.ilen,v=r||{},g=v.move,m=void 0===g||g,y=v.reverse,b=0,k=0,x=function(e){return(d+(y?p-e:e))%f},w=function(){s!==u&&(e.lineTo(b,u),e.lineTo(b,s),e.lineTo(b,c))};for(m&&(i=l[x(0)],e.moveTo(i.x,i.y)),a=0;a<=p;++a)if(!(i=l[x(a)]).skip){var I=i.x,S=i.y,C=0|I;C===o?(S<s?s=S:S>u&&(u=S),b=(k*b+I)/++k):(w(),e.lineTo(I,S),o=C,k=0,s=u=S),c=S}w()}function WO(e){var t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?jO:VO}(0,Ye.Z)(ZO,"id","arc"),(0,Ye.Z)(ZO,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),(0,Ye.Z)(ZO,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,Ye.Z)(ZO,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e}});var HO="function"===typeof Path2D;function GO(e,t,n,r){HO&&!t.options.segment?function(e,t,n,r){var a=t._path;a||(a=t._path=new Path2D,t.path(a,n,r)&&a.closePath()),zO(e,t.options),e.stroke(a)}(e,t,n,r):function(e,t,n,r){var a,i=t.segments,o=t.options,s=WO(t),u=(0,C.Z)(i);try{for(u.s();!(a=u.n()).done;){var c=a.value;zO(e,o,c.style),e.beginPath(),s(e,t,c,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}}catch(l){u.e(l)}finally{u.f()}}(e,t,n,r)}var qO=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).animated=!0,r.options=void 0,r._chart=void 0,r._loop=void 0,r._fullLoop=void 0,r._path=void 0,r._points=void 0,r._segments=void 0,r._decimated=!1,r._pointsUpdated=!1,r._datasetIndex=void 0,e&&Object.assign((0,Je.Z)(r),e),r}return(0,v.Z)(n,[{key:"updateControlPoints",value:function(e,t){var n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){var r=n.spanGaps?this._loop:this._fullLoop;XA(this._points,n,e,r,t),this._pointsUpdated=!0}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}},{key:"segments",get:function(){return this._segments||(this._segments=function(e,t){var n=e.points,r=e.options.spanGaps,a=n.length;if(!a)return[];var i=!!e._loop,o=function(e,t,n,r){var a=0,i=t-1;if(n&&!r)for(;a<t&&!e[a].skip;)a++;for(;a<t&&e[a].skip;)a++;for(a%=t,n&&(i+=a);i>a&&e[i%t].skip;)i--;return{start:a,end:i%=t}}(n,a,i,r),s=o.start,u=o.end;return kR(e,!0===r?[{start:s,end:u,loop:i}]:function(e,t,n,r){var a,i=e.length,o=[],s=t,u=e[t];for(a=t+1;a<=n;++a){var c=e[a%i];c.skip||c.stop?u.skip||(r=!1,o.push({start:t%i,end:(a-1)%i,loop:r}),t=s=c.stop?a:null):(s=a,u.skip&&(t=a)),u=c}return null!==s&&o.push({start:t%i,end:s%i,loop:r}),o}(n,s,u<s?u+a:u,!!e._fullLoop&&0===s&&u===a-1),n,t)}(this,this.options.segment))}},{key:"first",value:function(){var e=this.segments,t=this.points;return e.length&&t[e[0].start]}},{key:"last",value:function(){var e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}},{key:"interpolate",value:function(e,t){var n=this.options,r=e[t],a=this.points,i=bR(this,{property:t,start:r,end:r});if(i.length){var o,s,u=[],c=function(e){return e.stepped?hR:e.tension||"monotone"===e.cubicInterpolationMode?fR:lR}(n);for(o=0,s=i.length;o<s;++o){var l=i[o],h=l.start,f=l.end,d=a[h],p=a[f];if(d!==p){var v=c(d,p,Math.abs((r-d[t])/(p[t]-d[t])),n.stepped);v[t]=e[t],u.push(v)}else u.push(d)}return 1===u.length?u[0]:u}}},{key:"pathSegment",value:function(e,t,n){return WO(this)(e,this,t,n)}},{key:"path",value:function(e,t,n){var r=this.segments,a=WO(this),i=this._loop;t=t||0,n=n||this.points.length-t;var o,s=(0,C.Z)(r);try{for(s.s();!(o=s.n()).done;){i&=a(e,this,o.value,{start:t,end:t+n-1})}}catch(u){s.e(u)}finally{s.f()}return!!i}},{key:"draw",value:function(e,t,n,r){var a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),GO(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}]),n}(GM);function KO(e,t,n,r){var a=e.options,i=e.getProps([n],r)[n];return Math.abs(t-i)<a.radius+a.hitRadius}(0,Ye.Z)(qO,"id","line"),(0,Ye.Z)(qO,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,Ye.Z)(qO,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,Ye.Z)(qO,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e&&"fill"!==e}});var YO=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this),(0,Ye.Z)((0,Je.Z)(r),"parsed",void 0),(0,Ye.Z)((0,Je.Z)(r),"skip",void 0),(0,Ye.Z)((0,Je.Z)(r),"stop",void 0),r.options=void 0,r.parsed=void 0,r.skip=void 0,r.stop=void 0,e&&Object.assign((0,Je.Z)(r),e),r}return(0,v.Z)(n,[{key:"inRange",value:function(e,t,n){var r=this.options,a=this.getProps(["x","y"],n),i=a.x,o=a.y;return Math.pow(e-i,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}},{key:"inXRange",value:function(e,t){return KO(this,e,"x",t)}},{key:"inYRange",value:function(e,t){return KO(this,e,"y",t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"size",value:function(e){var t=(e=e||this.options||{}).radius||0;return 2*((t=Math.max(t,t&&e.hoverRadius||0))+(t&&e.borderWidth||0))}},{key:"draw",value:function(e,t){var n=this.options;this.skip||n.radius<.1||!lA(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,uA(e,n,this.x,this.y))}},{key:"getRange",value:function(){var e=this.options||{};return e.radius+e.hitRadius}}]),n}(GM);function XO(e,t){var n,r,a,i,o,s=e.getProps(["x","y","base","width","height"],t),u=s.x,c=s.y,l=s.base,h=s.width,f=s.height;return e.horizontal?(o=f/2,n=Math.min(u,l),r=Math.max(u,l),a=c-o,i=c+o):(n=u-(o=h/2),r=u+o,a=Math.min(c,l),i=Math.max(c,l)),{left:n,top:a,right:r,bottom:i}}function QO(e,t,n,r){return e?0:CD(t,n,r)}function JO(e){var t=XO(e),n=t.right-t.left,r=t.bottom-t.top,a=function(e,t,n){var r=e.options.borderWidth,a=e.borderSkipped,i=SA(r);return{t:QO(a.top,i.top,0,n),r:QO(a.right,i.right,0,t),b:QO(a.bottom,i.bottom,0,n),l:QO(a.left,i.left,0,t)}}(e,n/2,r/2),i=function(e,t,n){var r=e.getProps(["enableBorderRadius"]).enableBorderRadius,a=e.options.borderRadius,i=CA(a),o=Math.min(t,n),s=e.borderSkipped,u=r||PN(a);return{topLeft:QO(!u||s.top||s.left,i.topLeft,0,o),topRight:QO(!u||s.top||s.right,i.topRight,0,o),bottomLeft:QO(!u||s.bottom||s.left,i.bottomLeft,0,o),bottomRight:QO(!u||s.bottom||s.right,i.bottomRight,0,o)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:i},inner:{x:t.left+a.l,y:t.top+a.t,w:n-a.l-a.r,h:r-a.t-a.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(a.t,a.l)),topRight:Math.max(0,i.topRight-Math.max(a.t,a.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(a.b,a.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(a.b,a.r))}}}}function $O(e,t,n,r){var a=null===t,i=null===n,o=e&&!(a&&i)&&XO(e,r);return o&&(a||_D(t,o.left,o.right))&&(i||_D(n,o.top,o.bottom))}function eF(e,t){e.rect(t.x,t.y,t.w,t.h)}function tF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.x!==n.x?-t:0,a=e.y!==n.y?-t:0,i=(e.x+e.w!==n.x+n.w?t:0)-r,o=(e.y+e.h!==n.y+n.h?t:0)-a;return{x:e.x+r,y:e.y+a,w:e.w+i,h:e.h+o,radius:e.radius}}(0,Ye.Z)(YO,"id","point"),(0,Ye.Z)(YO,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,Ye.Z)(YO,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var nF=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).options=void 0,r.horizontal=void 0,r.base=void 0,r.width=void 0,r.height=void 0,r.inflateAmount=void 0,e&&Object.assign((0,Je.Z)(r),e),r}return(0,v.Z)(n,[{key:"draw",value:function(e){var t,n=this.inflateAmount,r=this.options,a=r.borderColor,i=r.backgroundColor,o=JO(this),s=o.inner,u=o.outer,c=(t=u.radius).topLeft||t.topRight||t.bottomLeft||t.bottomRight?yA:eF;e.save(),u.w===s.w&&u.h===s.h||(e.beginPath(),c(e,tF(u,n,s)),e.clip(),c(e,tF(s,-n,u)),e.fillStyle=a,e.fill("evenodd")),e.beginPath(),c(e,tF(s,n)),e.fillStyle=i,e.fill(),e.restore()}},{key:"inRange",value:function(e,t,n){return $O(this,e,t,n)}},{key:"inXRange",value:function(e,t){return $O(this,e,null,t)}},{key:"inYRange",value:function(e,t){return $O(this,null,e,t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","base","horizontal"],e),n=t.x,r=t.y,a=t.base,i=t.horizontal;return{x:i?(n+a)/2:n,y:i?r:(r+a)/2}}},{key:"getRange",value:function(e){return"x"===e?this.width/2:this.height/2}}]),n}(GM);(0,Ye.Z)(nF,"id","bar"),(0,Ye.Z)(nF,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,Ye.Z)(nF,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var rF=Object.freeze({__proto__:null,ArcElement:ZO,BarElement:nF,LineElement:qO,PointElement:YO}),aF=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],iF=aF.map((function(e){return e.replace("rgb(","rgba(").replace(")",", 0.5)")}));function oF(e){return aF[e%aF.length]}function sF(e){return iF[e%iF.length]}function uF(e){var t=0;return function(n,r){var a=e.getDatasetMeta(r).controller;a instanceof QR?t=function(e,t){return e.backgroundColor=e.data.map((function(){return oF(t++)})),t}(n,t):a instanceof $R?t=function(e,t){return e.backgroundColor=e.data.map((function(){return sF(t++)})),t}(n,t):a&&(t=function(e,t){return e.borderColor=oF(t),e.backgroundColor=sF(t),++t}(n,t))}}function cF(e){var t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}var lF={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout:function(e,t,n){if(n.enabled){var r=e.config,a=r.data.datasets,i=r.options,o=i.elements;if(n.forceOverride||!(cF(a)||(s=i,s&&(s.borderColor||s.backgroundColor))||o&&cF(o))){var s,u=uF(e);a.forEach(u)}}}};function hF(e){if(e._decimated){var t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function fF(e){e.data.datasets.forEach((function(e){hF(e)}))}var dF={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:function(e,t,n){if(n.enabled){var r=e.width;e.data.datasets.forEach((function(t,a){var i=t._data,o=t.indexAxis,s=e.getDatasetMeta(a),u=i||t.data;if("y"!==EA([o,e.options.indexAxis])&&s.controller.supportsDecimation){var c=e.scales[s.xAxisID];if(("linear"===c.type||"time"===c.type)&&!e.options.parsing){var l=function(e,t){var n=t.length,r=0,a=e.iScale,i=a.getUserBounds(),o=i.min,s=i.max,u=i.minDefined,c=i.maxDefined;return u&&(r=CD(ED(t,a.axis,o).lo,0,n-1)),{start:r,count:c?CD(ED(t,a.axis,s).hi+1,r,n)-r:n-r}}(s,u),h=l.start,f=l.count;if(f<=(n.threshold||4*r))hF(t);else{var d;switch(ON(i)&&(t._data=u,delete t.data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(e){this._data=e}})),n.algorithm){case"lttb":d=function(e,t,n,r,a){var i=a.samples||r;if(i>=n)return e.slice(t,t+n);var o,s,u,c,l,h=[],f=(n-2)/(i-2),d=0,p=t+n-1,v=t;for(h[d++]=e[v],o=0;o<i-2;o++){var g=0,m=0,y=void 0,b=Math.floor((o+1)*f)+1+t,k=Math.min(Math.floor((o+2)*f)+1,n)+t,x=k-b;for(y=b;y<k;y++)g+=e[y].x,m+=e[y].y;g/=x,m/=x;var w=Math.floor(o*f)+1+t,I=Math.min(Math.floor((o+1)*f)+1,n)+t,S=e[v],C=S.x,_=S.y;for(u=c=-1,y=w;y<I;y++)(c=.5*Math.abs((C-g)*(e[y].y-_)-(C-e[y].x)*(m-_)))>u&&(u=c,s=e[y],l=y);h[d++]=s,v=l}return h[d++]=e[p],h}(u,h,f,r,n);break;case"min-max":d=function(e,t,n,r){var a,i,o,s,u,c,l,h,f,d,p=0,v=0,g=[],m=t+n-1,y=e[t].x,b=e[m].x-y;for(a=t;a<t+n;++a){o=((i=e[a]).x-y)/b*r,s=i.y;var k=0|o;if(k===u)s<f?(f=s,c=a):s>d&&(d=s,l=a),p=(v*p+i.x)/++v;else{var x=a-1;if(!ON(c)&&!ON(l)){var w=Math.min(c,l),I=Math.max(c,l);w!==h&&w!==x&&g.push(Qe(Qe({},e[w]),{},{x:p})),I!==h&&I!==x&&g.push(Qe(Qe({},e[I]),{},{x:p}))}a>0&&x!==h&&g.push(e[x]),g.push(i),u=k,v=0,f=d=s,c=l=h=a}}return g}(u,h,f,r);break;default:throw new Error("Unsupported decimation algorithm '".concat(n.algorithm,"'"))}t._decimated=d}}}}))}else fF(e)},destroy:function(e){fF(e)}};function pF(e,t,n,r){if(!r){var a=t[e],i=n[e];return"angle"===e&&(a=ID(a),i=ID(i)),{property:e,start:a,end:i}}}function vF(e,t,n){for(;t>e;t--){var r=n[t];if(!isNaN(r.x)&&!isNaN(r.y))break}return t}function gF(e,t,n,r){return e&&t?r(e[n],t[n]):e?e[n]:t?t[n]:0}function mF(e,t){var n=[],r=!1;return FN(e)?(r=!0,n=e):n=function(e,t){var n=e||{},r=n.x,a=void 0===r?null:r,i=n.y,o=void 0===i?null:i,s=t.points,u=[];return t.segments.forEach((function(e){var t=e.start,n=e.end;n=vF(t,n,s);var r=s[t],i=s[n];null!==o?(u.push({x:r.x,y:o}),u.push({x:i.x,y:o})):null!==a&&(u.push({x:a,y:r.y}),u.push({x:a,y:i.y}))})),u}(e,t),n.length?new qO({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function yF(e){return e&&!1!==e.fill}function bF(e,t,n){var r,a=e[t].fill,i=[t];if(!n)return a;for(;!1!==a&&-1===i.indexOf(a);){if(!LN(a))return a;if(!(r=e[a]))return!1;if(r.visible)return a;i.push(a),a=r.fill}return!1}function kF(e,t,n){var r=function(e){var t=e.options,n=t.fill,r=zN(n&&n.target,n);void 0===r&&(r=!!t.backgroundColor);if(!1===r||null===r)return!1;if(!0===r)return"origin";return r}(e);if(PN(r))return!isNaN(r.value)&&r;var a=parseFloat(r);return LN(a)&&Math.floor(a)===a?function(e,t,n,r){"-"!==e&&"+"!==e||(n=t+n);if(n===t||n<0||n>=r)return!1;return n}(r[0],t,a,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function xF(e,t,n){for(var r=[],a=0;a<n.length;a++){var i=wF(n[a],t,"x"),o=i.first,s=i.last,u=i.point;if(!(!u||o&&s))if(o)r.unshift(u);else if(e.push(u),!s)break}e.push.apply(e,r)}function wF(e,t,n){var r=e.interpolate(t,n);if(!r)return{};for(var a=r[n],i=e.segments,o=e.points,s=!1,u=!1,c=0;c<i.length;c++){var l=i[c],h=o[l.start][n],f=o[l.end][n];if(_D(a,h,f)){s=a===h,u=a===f;break}}return{first:s,last:u,point:r}}var IF=function(){function e(t){(0,p.Z)(this,e),this.x=t.x,this.y=t.y,this.radius=t.radius}return(0,v.Z)(e,[{key:"pathSegment",value:function(e,t,n){var r=this.x,a=this.y,i=this.radius;return t=t||{start:0,end:aD},e.arc(r,a,i,t.end,t.start,!0),!n.bounds}},{key:"interpolate",value:function(e){var t=this.x,n=this.y,r=this.radius,a=e.angle;return{x:t+Math.cos(a)*r,y:n+Math.sin(a)*r,angle:a}}}]),e}();function SF(e){var t=e.chart,n=e.fill,r=e.line;if(LN(n))return function(e,t){var n=e.getDatasetMeta(t),r=n&&e.isDatasetVisible(t);return r?n.dataset:null}(t,n);if("stack"===n)return function(e){var t=e.scale,n=e.index,r=e.line,a=[],i=r.segments,o=r.points,s=function(e,t){for(var n=[],r=e.getMatchingVisibleMetas("line"),a=0;a<r.length;a++){var i=r[a];if(i.index===t)break;i.hidden||n.unshift(i.dataset)}return n}(t,n);s.push(mF({x:null,y:t.bottom},r));for(var u=0;u<i.length;u++)for(var c=i[u],l=c.start;l<=c.end;l++)xF(a,o[l],s);return new qO({points:a,options:{}})}(e);if("shape"===n)return!0;var a=function(e){var t=e.scale||{};if(t.getPointPositionForValue)return function(e){var t=e.scale,n=e.fill,r=t.options,a=t.getLabels().length,i=r.reverse?t.max:t.min,o=function(e,t,n){return"start"===e?n:"end"===e?t.options.reverse?t.min:t.max:PN(e)?e.value:t.getBaseValue()}(n,t,i),s=[];if(r.grid.circular){var u=t.getPointPositionForValue(0,i);return new IF({x:u.x,y:u.y,radius:t.getDistanceFromCenterForValue(o)})}for(var c=0;c<a;++c)s.push(t.getPointPositionForValue(c,o));return s}(e);return function(e){var t=e.scale,n=void 0===t?{}:t,r=e.fill,a=function(e,t){var n=null;return"start"===e?n=t.bottom:"end"===e?n=t.top:PN(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}(r,n);if(LN(a)){var i=n.isHorizontal();return{x:i?a:null,y:i?null:a}}return null}(e)}(e);return a instanceof IF?a:mF(a,r)}function CF(e,t,n){var r=SF(t),a=t.line,i=t.scale,o=t.axis,s=a.options,u=s.fill,c=s.backgroundColor,l=u||{},h=l.above,f=void 0===h?c:h,d=l.below,p=void 0===d?c:d;r&&a.points.length&&(hA(e,n),function(e,t){var n=t.line,r=t.target,a=t.above,i=t.below,o=t.area,s=t.scale,u=n._loop?"angle":t.axis;e.save(),"x"===u&&i!==a&&(_F(e,r,o.top),TF(e,{line:n,target:r,color:a,scale:s,property:u}),e.restore(),e.save(),_F(e,r,o.bottom));TF(e,{line:n,target:r,color:i,scale:s,property:u}),e.restore()}(e,{line:a,target:r,above:f,below:p,area:n,scale:i,axis:o}),fA(e))}function _F(e,t,n){var r=t.segments,a=t.points,i=!0,o=!1;e.beginPath();var s,u=(0,C.Z)(r);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.start,h=c.end,f=a[l],d=a[vF(l,h,a)];i?(e.moveTo(f.x,f.y),i=!1):(e.lineTo(f.x,n),e.lineTo(f.x,f.y)),(o=!!t.pathSegment(e,c,{move:o}))?e.closePath():e.lineTo(d.x,n)}}catch(p){u.e(p)}finally{u.f()}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function TF(e,t){var n,r=t.line,a=t.target,i=t.property,o=t.color,s=t.scale,u=function(e,t,n){var r,a=e.segments,i=e.points,o=t.points,s=[],u=(0,C.Z)(a);try{for(u.s();!(r=u.n()).done;){var c=r.value,l=c.start,h=c.end;h=vF(l,h,i);var f=pF(n,i[l],i[h],c.loop);if(t.segments){var d,p=bR(t,f),v=(0,C.Z)(p);try{for(v.s();!(d=v.n()).done;){var g,m=d.value,y=pF(n,o[m.start],o[m.end],m.loop),b=yR(c,i,y),k=(0,C.Z)(b);try{for(k.s();!(g=k.n()).done;){var x=g.value;s.push({source:x,target:m,start:(0,Ye.Z)({},n,gF(f,y,"start",Math.max)),end:(0,Ye.Z)({},n,gF(f,y,"end",Math.min))})}}catch(w){k.e(w)}finally{k.f()}}}catch(w){v.e(w)}finally{v.f()}}else s.push({source:c,target:f,start:i[l],end:i[h]})}}catch(w){u.e(w)}finally{u.f()}return s}(r,a,i),c=(0,C.Z)(u);try{for(c.s();!(n=c.n()).done;){var l=n.value,h=l.source,f=l.target,d=l.start,p=l.end,v=h.style,g=(void 0===v?{}:v).backgroundColor,m=void 0===g?o:g,y=!0!==a;e.save(),e.fillStyle=m,EF(e,s,y&&pF(i,d,p)),e.beginPath();var b=!!r.pathSegment(e,h),k=void 0;if(y){b?e.closePath():NF(e,a,p,i);var x=!!a.pathSegment(e,f,{move:b,reverse:!0});(k=b&&x)||NF(e,a,d,i)}e.closePath(),e.fill(k?"evenodd":"nonzero"),e.restore()}}catch(w){c.e(w)}finally{c.f()}}function EF(e,t,n){var r=t.chart.chartArea,a=r.top,i=r.bottom,o=n||{},s=o.property,u=o.start,c=o.end;"x"===s&&(e.beginPath(),e.rect(u,a,c-u,i-a),e.clip())}function NF(e,t,n,r){var a=t.interpolate(n,r);a&&e.lineTo(a.x,a.y)}var DF={id:"filler",afterDatasetsUpdate:function(e,t,n){var r,a,i,o,s=(e.data.datasets||[]).length,u=[];for(a=0;a<s;++a)o=null,(i=(r=e.getDatasetMeta(a)).dataset)&&i.options&&i instanceof qO&&(o={visible:e.isDatasetVisible(a),index:a,fill:kF(i,a,s),chart:e,axis:r.controller.options.indexAxis,scale:r.vScale,line:i}),r.$filler=o,u.push(o);for(a=0;a<s;++a)(o=u[a])&&!1!==o.fill&&(o.fill=bF(u,a,n.propagate))},beforeDraw:function(e,t,n){for(var r="beforeDraw"===n.drawTime,a=e.getSortedVisibleDatasetMetas(),i=e.chartArea,o=a.length-1;o>=0;--o){var s=a[o].$filler;s&&(s.line.updateControlPoints(i,s.axis),r&&s.fill&&CF(e.ctx,s,i))}},beforeDatasetsDraw:function(e,t,n){if("beforeDatasetsDraw"===n.drawTime)for(var r=e.getSortedVisibleDatasetMetas(),a=r.length-1;a>=0;--a){var i=r[a].$filler;yF(i)&&CF(e.ctx,i,e.chartArea)}},beforeDatasetDraw:function(e,t,n){var r=t.meta.$filler;yF(r)&&"beforeDatasetDraw"===n.drawTime&&CF(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},AF=function(e,t){var n=e.boxHeight,r=void 0===n?t:n,a=e.boxWidth,i=void 0===a?t:a;return e.usePointStyle&&(r=Math.min(r,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:r,itemHeight:Math.max(t,r)}},RF=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this))._added=!1,r.legendHitBoxes=[],r._hoveredItem=null,r.doughnutMode=!1,r.chart=e.chart,r.options=e.options,r.ctx=e.ctx,r.legendItems=void 0,r.columnSizes=void 0,r.lineWidths=void 0,r.maxHeight=void 0,r.maxWidth=void 0,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.height=void 0,r.width=void 0,r._margins=void 0,r.position=void 0,r.weight=void 0,r.fullSize=void 0,r}return(0,v.Z)(n,[{key:"update",value:function(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}},{key:"buildLabels",value:function(){var e=this,t=this.options.labels||{},n=UN(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter((function(n){return t.filter(n,e.chart.data)}))),t.sort&&(n=n.sort((function(n,r){return t.sort(n,r,e.chart.data)}))),this.options.reverse&&n.reverse(),this.legendItems=n}},{key:"fit",value:function(){var e=this.options,t=this.ctx;if(e.display){var n,r,a=e.labels,i=TA(a.font),o=i.size,s=this._computeTitleHeight(),u=AF(a,o),c=u.boxWidth,l=u.itemHeight;t.font=i.string,this.isHorizontal()?(n=this.maxWidth,r=this._fitRows(s,o,c,l)+10):(r=this.maxHeight,n=this._fitCols(s,i,c,l)+10),this.width=Math.min(n,e.maxWidth||this.maxWidth),this.height=Math.min(r,e.maxHeight||this.maxHeight)}else this.width=this.height=0}},{key:"_fitRows",value:function(e,t,n,r){var a=this.ctx,i=this.maxWidth,o=this.options.labels.padding,s=this.legendHitBoxes=[],u=this.lineWidths=[0],c=r+o,l=e;a.textAlign="left",a.textBaseline="middle";var h=-1,f=-c;return this.legendItems.forEach((function(e,d){var p=n+t/2+a.measureText(e.text).width;(0===d||u[u.length-1]+p+2*o>i)&&(l+=c,u[u.length-(d>0?0:1)]=0,f+=c,h++),s[d]={left:0,top:f,row:h,width:p,height:r},u[u.length-1]+=p+o})),l}},{key:"_fitCols",value:function(e,t,n,r){var a=this.ctx,i=this.maxHeight,o=this.options.labels.padding,s=this.legendHitBoxes=[],u=this.columnSizes=[],c=i-e,l=o,h=0,f=0,d=0,p=0;return this.legendItems.forEach((function(e,i){var v=function(e,t,n,r,a){var i=function(e,t,n,r){var a=e.text;a&&"string"!==typeof a&&(a=a.reduce((function(e,t){return e.length>t.length?e:t})));return t+n.size/2+r.measureText(a).width}(r,e,t,n),o=function(e,t,n){var r=e;"string"!==typeof t.text&&(r=MF(t,n));return r}(a,r,t.lineHeight);return{itemWidth:i,itemHeight:o}}(n,t,a,e,r),g=v.itemWidth,m=v.itemHeight;i>0&&f+m+2*o>c&&(l+=h+o,u.push({width:h,height:f}),d+=h+o,p++,h=f=0),s[i]={left:d,top:f,col:p,width:g,height:m},h=Math.max(h,g),f+=m+o})),l+=h,u.push({width:h,height:f}),l}},{key:"adjustHitBoxes",value:function(){if(this.options.display){var e=this._computeTitleHeight(),t=this.legendHitBoxes,n=this.options,r=n.align,a=n.labels.padding,i=dR(n.rtl,this.left,this.width);if(this.isHorizontal()){var o,s=0,u=PD(r,this.left+a,this.right-this.lineWidths[s]),c=(0,C.Z)(t);try{for(c.s();!(o=c.n()).done;){var l=o.value;s!==l.row&&(s=l.row,u=PD(r,this.left+a,this.right-this.lineWidths[s])),l.top+=this.top+e+a,l.left=i.leftForLtr(i.x(u),l.width),u+=l.width+a}}catch(g){c.e(g)}finally{c.f()}}else{var h,f=0,d=PD(r,this.top+e+a,this.bottom-this.columnSizes[f].height),p=(0,C.Z)(t);try{for(p.s();!(h=p.n()).done;){var v=h.value;v.col!==f&&(f=v.col,d=PD(r,this.top+e+a,this.bottom-this.columnSizes[f].height)),v.top=d,v.left+=this.left+a,v.left=i.leftForLtr(i.x(v.left),v.width),d+=v.height+a}}catch(g){p.e(g)}finally{p.f()}}}}},{key:"isHorizontal",value:function(){return"top"===this.options.position||"bottom"===this.options.position}},{key:"draw",value:function(){if(this.options.display){var e=this.ctx;hA(e,this),this._draw(),fA(e)}}},{key:"_draw",value:function(){var e,t=this,n=this.options,r=this.columnSizes,a=this.lineWidths,i=this.ctx,o=n.align,s=n.labels,u=rA.color,c=dR(n.rtl,this.left,this.width),l=TA(s.font),h=s.padding,f=l.size,d=f/2;this.drawTitle(),i.textAlign=c.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;var p=AF(s,f),v=p.boxWidth,g=p.boxHeight,m=p.itemHeight,y=this.isHorizontal(),b=this._computeTitleHeight();e=y?{x:PD(o,this.left+h,this.right-a[0]),y:this.top+h+b,line:0}:{x:this.left+h,y:PD(o,this.top+b+h,this.bottom-r[0].height),line:0},pR(this.ctx,n.textDirection);var k=m+h;this.legendItems.forEach((function(p,x){i.strokeStyle=p.fontColor,i.fillStyle=p.fontColor;var w=i.measureText(p.text).width,I=c.textAlign(p.textAlign||(p.textAlign=s.textAlign)),S=v+d+w,C=e.x,_=e.y;if(c.setWidth(t.width),y?x>0&&C+S+h>t.right&&(_=e.y+=k,e.line++,C=e.x=PD(o,t.left+h,t.right-a[e.line])):x>0&&_+k>t.bottom&&(C=e.x=C+r[e.line].width+h,e.line++,_=e.y=PD(o,t.top+b+h,t.bottom-r[e.line].height)),function(e,t,n){if(!(isNaN(v)||v<=0||isNaN(g)||g<0)){i.save();var r=zN(n.lineWidth,1);if(i.fillStyle=zN(n.fillStyle,u),i.lineCap=zN(n.lineCap,"butt"),i.lineDashOffset=zN(n.lineDashOffset,0),i.lineJoin=zN(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=zN(n.strokeStyle,u),i.setLineDash(zN(n.lineDash,[])),s.usePointStyle){var a={radius:g*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},o=c.xPlus(e,v/2);cA(i,a,o,t+d,s.pointStyleWidth&&v)}else{var l=t+Math.max((f-g)/2,0),h=c.leftForLtr(e,v),p=CA(n.borderRadius);i.beginPath(),Object.values(p).some((function(e){return 0!==e}))?yA(i,{x:h,y:l,w:v,h:g,radius:p}):i.rect(h,l,v,g),i.fill(),0!==r&&i.stroke()}i.restore()}}(c.x(C),_,p),C=function(e,t,n,r){return e===(r?"left":"right")?n:"center"===e?(t+n)/2:t}(I,C+v+d,y?C+S:t.right,n.rtl),function(e,t,n){mA(i,n.text,e,t+m/2,l,{strikethrough:n.hidden,textAlign:c.textAlign(n.textAlign)})}(c.x(C),_,p),y)e.x+=S+h;else if("string"!==typeof p.text){var T=l.lineHeight;e.y+=MF(p,T)}else e.y+=k})),vR(this.ctx,n.textDirection)}},{key:"drawTitle",value:function(){var e=this.options,t=e.title,n=TA(t.font),r=_A(t.padding);if(t.display){var a,i=dR(e.rtl,this.left,this.width),o=this.ctx,s=t.position,u=n.size/2,c=r.top+u,l=this.left,h=this.width;if(this.isHorizontal())h=Math.max.apply(Math,d(this.lineWidths)),a=this.top+c,l=PD(e.align,l,this.right-h);else{var f=this.columnSizes.reduce((function(e,t){return Math.max(e,t.height)}),0);a=c+PD(e.align,this.top,this.bottom-f-e.labels.padding-this._computeTitleHeight())}var p=PD(s,l,l+h);o.textAlign=i.textAlign(FD(s)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,mA(o,t.text,p,a,n)}}},{key:"_computeTitleHeight",value:function(){var e=this.options.title,t=TA(e.font),n=_A(e.padding);return e.display?t.lineHeight+n.height:0}},{key:"_getLegendItemAt",value:function(e,t){var n,r,a;if(_D(e,this.left,this.right)&&_D(t,this.top,this.bottom))for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(_D(e,(r=a[n]).left,r.left+r.width)&&_D(t,r.top,r.top+r.height))return this.legendItems[n];return null}},{key:"handleEvent",value:function(e){var t=this.options;if(function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t)){var n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){var r=this._hoveredItem,a=function(e,t){return null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index}(r,n);r&&!a&&UN(t.onLeave,[e,r,this],this),this._hoveredItem=n,n&&!a&&UN(t.onHover,[e,n,this],this)}else n&&UN(t.onClick,[e,n,this],this)}}}]),n}(GM);function MF(e,t){return t*(e.text?e.text.length+.5:0)}var OF={id:"legend",_element:RF,start:function(e,t,n){var r=e.legend=new RF({ctx:e.ctx,options:n,chart:e});TM(e,r,n),CM(e,r)},stop:function(e){_M(e,e.legend),delete e.legend},beforeUpdate:function(e,t,n){var r=e.legend;TM(e,r,n),r.options=n},afterUpdate:function(e){var t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent:function(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick:function(e,t,n){var r=t.datasetIndex,a=n.chart;a.isDatasetVisible(r)?(a.hide(r),t.hidden=!0):(a.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:function(e){return e.chart.options.color},boxWidth:40,padding:10,generateLabels:function(e){var t=e.data.datasets,n=e.legend.options.labels,r=n.usePointStyle,a=n.pointStyle,i=n.textAlign,o=n.color,s=n.useBorderRadius,u=n.borderRadius;return e._getSortedDatasetMetas().map((function(e){var n=e.controller.getStyle(r?0:void 0),c=_A(n.borderWidth);return{text:t[e.index].label,fillStyle:n.backgroundColor,fontColor:o,hidden:!e.visible,lineCap:n.borderCapStyle,lineDash:n.borderDash,lineDashOffset:n.borderDashOffset,lineJoin:n.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:n.borderColor,pointStyle:a||n.pointStyle,rotation:n.rotation,textAlign:i||n.textAlign,borderRadius:s&&(u||n.borderRadius),datasetIndex:e.index}}),this)}},title:{color:function(e){return e.chart.options.color},display:!1,position:"center",text:""}},descriptors:{_scriptable:function(e){return!e.startsWith("on")},labels:{_scriptable:function(e){return!["generateLabels","filter","sort"].includes(e)}}}},FF=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).chart=e.chart,r.options=e.options,r.ctx=e.ctx,r._padding=void 0,r.top=void 0,r.bottom=void 0,r.left=void 0,r.right=void 0,r.width=void 0,r.height=void 0,r.position=void 0,r.weight=void 0,r.fullSize=void 0,r}return(0,v.Z)(n,[{key:"update",value:function(e,t){var n=this.options;if(this.left=0,this.top=0,n.display){this.width=this.right=e,this.height=this.bottom=t;var r=FN(n.text)?n.text.length:1;this._padding=_A(n.padding);var a=r*TA(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}else this.width=this.height=this.right=this.bottom=0}},{key:"isHorizontal",value:function(){var e=this.options.position;return"top"===e||"bottom"===e}},{key:"_drawArgs",value:function(e){var t,n,r,a=this.top,i=this.left,o=this.bottom,s=this.right,u=this.options,c=u.align,l=0;return this.isHorizontal()?(n=PD(c,i,s),r=a+e,t=s-i):("left"===u.position?(n=i+e,r=PD(c,o,a),l=-.5*rD):(n=s-e,r=PD(c,a,o),l=.5*rD),t=o-a),{titleX:n,titleY:r,maxWidth:t,rotation:l}}},{key:"draw",value:function(){var e=this.ctx,t=this.options;if(t.display){var n=TA(t.font),r=n.lineHeight/2+this._padding.top,a=this._drawArgs(r),i=a.titleX,o=a.titleY,s=a.maxWidth,u=a.rotation;mA(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:u,textAlign:FD(t.align),textBaseline:"middle",translation:[i,o]})}}}]),n}(GM);var PF={id:"title",_element:FF,start:function(e,t,n){!function(e,t){var n=new FF({ctx:e.ctx,options:t,chart:e});TM(e,n,t),CM(e,n),e.titleBlock=n}(e,n)},stop:function(e){var t=e.titleBlock;_M(e,t),delete e.titleBlock},beforeUpdate:function(e,t,n){var r=e.titleBlock;TM(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},LF=new WeakMap,ZF={id:"subtitle",start:function(e,t,n){var r=new FF({ctx:e.ctx,options:n,chart:e});TM(e,r,n),CM(e,r),LF.set(e,r)},stop:function(e){_M(e,LF.get(e)),LF.delete(e)},beforeUpdate:function(e,t,n){var r=LF.get(e);TM(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},zF={average:function(e){if(!e.length)return!1;var t,n,r=0,a=0,i=0;for(t=0,n=e.length;t<n;++t){var o=e[t].element;if(o&&o.hasValue()){var s=o.tooltipPosition();r+=s.x,a+=s.y,++i}}return{x:r/i,y:a/i}},nearest:function(e,t){if(!e.length)return!1;var n,r,a,i=t.x,o=t.y,s=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){var u=e[n].element;if(u&&u.hasValue()){var c=xD(t,u.getCenterPoint());c<s&&(s=c,a=u)}}if(a){var l=a.tooltipPosition();i=l.x,o=l.y}return{x:i,y:o}}};function BF(e,t){return t&&(FN(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function UF(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function VF(e,t){var n=t.element,r=t.datasetIndex,a=t.index,i=e.getDatasetMeta(r).controller,o=i.getLabelAndValue(a),s=o.label,u=o.value;return{chart:e,label:s,parsed:i.getParsed(a),raw:e.data.datasets[r].data[a],formattedValue:u,dataset:i.getDataset(),dataIndex:a,datasetIndex:r,element:n}}function jF(e,t){var n=e.chart.ctx,r=e.body,a=e.footer,i=e.title,o=t.boxWidth,s=t.boxHeight,u=TA(t.bodyFont),c=TA(t.titleFont),l=TA(t.footerFont),h=i.length,f=a.length,d=r.length,p=_A(t.padding),v=p.height,g=0,m=r.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0);(m+=e.beforeBody.length+e.afterBody.length,h&&(v+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),m)&&(v+=d*(t.displayColors?Math.max(s,u.lineHeight):u.lineHeight)+(m-d)*u.lineHeight+(m-1)*t.bodySpacing);f&&(v+=t.footerMarginTop+f*l.lineHeight+(f-1)*t.footerSpacing);var y=0,b=function(e){g=Math.max(g,n.measureText(e).width+y)};return n.save(),n.font=c.string,VN(e.title,b),n.font=u.string,VN(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?o+2+t.boxPadding:0,VN(r,(function(e){VN(e.before,b),VN(e.lines,b),VN(e.after,b)})),y=0,n.font=l.string,VN(e.footer,b),n.restore(),{width:g+=p.width,height:v}}function WF(e,t,n,r){var a=n.x,i=n.width,o=e.width,s=e.chartArea,u=s.left,c=s.right,l="center";return"center"===r?l=a<=(u+c)/2?"left":"right":a<=i/2?l="left":a>=o-i/2&&(l="right"),function(e,t,n,r){var a=r.x,i=r.width,o=n.caretSize+n.caretPadding;return"left"===e&&a+i+o>t.width||"right"===e&&a-i-o<0||void 0}(l,e,t,n)&&(l="center"),l}function HF(e,t,n){var r=n.yAlign||t.yAlign||function(e,t){var n=t.y,r=t.height;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||WF(e,t,n,r),yAlign:r}}function GF(e,t,n,r){var a=e.caretSize,i=e.caretPadding,o=e.cornerRadius,s=n.xAlign,u=n.yAlign,c=a+i,l=CA(o),h=l.topLeft,f=l.topRight,d=l.bottomLeft,p=l.bottomRight,v=function(e,t){var n=e.x,r=e.width;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,s),g=function(e,t,n){var r=e.y,a=e.height;return"top"===t?r+=n:r-="bottom"===t?a+n:a/2,r}(t,u,c);return"center"===u?"left"===s?v+=c:"right"===s&&(v-=c):"left"===s?v-=Math.max(h,d)+a:"right"===s&&(v+=Math.max(f,p)+a),{x:CD(v,0,r.width-t.width),y:CD(g,0,r.height-t.height)}}function qF(e,t,n){var r=_A(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function KF(e){return BF([],UF(e))}function YF(e,t){var n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}var XF={beforeTitle:RN,title:function(e){if(e.length>0){var t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:RN,beforeBody:RN,beforeLabel:RN,label:function(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;var t=e.dataset.label||"";t&&(t+=": ");var n=e.formattedValue;return ON(n)||(t+=n),t},labelColor:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor:function(){return this.options.bodyColor},labelPointStyle:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:RN,afterBody:RN,beforeFooter:RN,footer:RN,afterFooter:RN};function QF(e,t,n,r){var a=e[t].call(n,r);return"undefined"===typeof a?XF[t].call(n,r):a}var JF=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).opacity=0,r._active=[],r._eventPosition=void 0,r._size=void 0,r._cachedAnimations=void 0,r._tooltipItems=[],r.$animations=void 0,r.$context=void 0,r.chart=e.chart,r.options=e.options,r.dataPoints=void 0,r.title=void 0,r.beforeBody=void 0,r.body=void 0,r.afterBody=void 0,r.footer=void 0,r.xAlign=void 0,r.yAlign=void 0,r.x=void 0,r.y=void 0,r.height=void 0,r.width=void 0,r.caretX=void 0,r.caretY=void 0,r.labelColors=void 0,r.labelPointStyles=void 0,r.labelTextColors=void 0,r}return(0,v.Z)(n,[{key:"initialize",value:function(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}},{key:"_resolveAnimations",value:function(){var e=this._cachedAnimations;if(e)return e;var t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,a=new ER(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}},{key:"getContext",value:function(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,NA(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}},{key:"getTitle",value:function(e,t){var n=t.callbacks,r=QF(n,"beforeTitle",this,e),a=QF(n,"title",this,e),i=QF(n,"afterTitle",this,e),o=[];return o=BF(o,UF(r)),o=BF(o,UF(a)),o=BF(o,UF(i))}},{key:"getBeforeBody",value:function(e,t){return KF(QF(t.callbacks,"beforeBody",this,e))}},{key:"getBody",value:function(e,t){var n=this,r=t.callbacks,a=[];return VN(e,(function(e){var t={before:[],lines:[],after:[]},i=YF(r,e);BF(t.before,UF(QF(i,"beforeLabel",n,e))),BF(t.lines,QF(i,"label",n,e)),BF(t.after,UF(QF(i,"afterLabel",n,e))),a.push(t)})),a}},{key:"getAfterBody",value:function(e,t){return KF(QF(t.callbacks,"afterBody",this,e))}},{key:"getFooter",value:function(e,t){var n=t.callbacks,r=QF(n,"beforeFooter",this,e),a=QF(n,"footer",this,e),i=QF(n,"afterFooter",this,e),o=[];return o=BF(o,UF(r)),o=BF(o,UF(a)),o=BF(o,UF(i))}},{key:"_createItems",value:function(e){var t,n,r=this,a=this._active,i=this.chart.data,o=[],s=[],u=[],c=[];for(t=0,n=a.length;t<n;++t)c.push(VF(this.chart,a[t]));return e.filter&&(c=c.filter((function(t,n,r){return e.filter(t,n,r,i)}))),e.itemSort&&(c=c.sort((function(t,n){return e.itemSort(t,n,i)}))),VN(c,(function(t){var n=YF(e.callbacks,t);o.push(QF(n,"labelColor",r,t)),s.push(QF(n,"labelPointStyle",r,t)),u.push(QF(n,"labelTextColor",r,t))})),this.labelColors=o,this.labelPointStyles=s,this.labelTextColors=u,this.dataPoints=c,c}},{key:"update",value:function(e,t){var n,r=this.options.setContext(this.getContext()),a=this._active,i=[];if(a.length){var o=zF[r.position].call(this,a,this._eventPosition);i=this._createItems(r),this.title=this.getTitle(i,r),this.beforeBody=this.getBeforeBody(i,r),this.body=this.getBody(i,r),this.afterBody=this.getAfterBody(i,r),this.footer=this.getFooter(i,r);var s=this._size=jF(this,r),u=Object.assign({},o,s),c=HF(this.chart,r,u),l=GF(r,u,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,n={opacity:1,x:l.x,y:l.y,width:s.width,height:s.height,caretX:o.x,caretY:o.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=i,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}},{key:"drawCaret",value:function(e,t,n,r){var a=this.getCaretPosition(e,n,r);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}},{key:"getCaretPosition",value:function(e,t,n){var r,a,i,o,s,u,c=this.xAlign,l=this.yAlign,h=n.caretSize,f=CA(n.cornerRadius),d=f.topLeft,p=f.topRight,v=f.bottomLeft,g=f.bottomRight,m=e.x,y=e.y,b=t.width,k=t.height;return"center"===l?(s=y+k/2,"left"===c?(a=(r=m)-h,o=s+h,u=s-h):(a=(r=m+b)+h,o=s-h,u=s+h),i=r):(a="left"===c?m+Math.max(d,v)+h:"right"===c?m+b-Math.max(p,g)-h:this.caretX,"top"===l?(s=(o=y)-h,r=a-h,i=a+h):(s=(o=y+k)+h,r=a+h,i=a-h),u=o),{x1:r,x2:a,x3:i,y1:o,y2:s,y3:u}}},{key:"drawTitle",value:function(e,t,n){var r,a,i,o=this.title,s=o.length;if(s){var u=dR(n.rtl,this.x,this.width);for(e.x=qF(this,n.titleAlign,n),t.textAlign=u.textAlign(n.titleAlign),t.textBaseline="middle",r=TA(n.titleFont),a=n.titleSpacing,t.fillStyle=n.titleColor,t.font=r.string,i=0;i<s;++i)t.fillText(o[i],u.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+a,i+1===s&&(e.y+=n.titleMarginBottom-a)}}},{key:"_drawColorBox",value:function(e,t,n,r,a){var i=this.labelColors[n],o=this.labelPointStyles[n],s=a.boxHeight,u=a.boxWidth,c=TA(a.bodyFont),l=qF(this,"left",a),h=r.x(l),f=s<c.lineHeight?(c.lineHeight-s)/2:0,p=t.y+f;if(a.usePointStyle){var v={radius:Math.min(u,s)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},g=r.leftForLtr(h,u)+u/2,m=p+s/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,uA(e,v,g,m),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,uA(e,v,g,m)}else{e.lineWidth=PN(i.borderWidth)?Math.max.apply(Math,d(Object.values(i.borderWidth))):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;var y=r.leftForLtr(h,u),b=r.leftForLtr(r.xPlus(h,1),u-2),k=CA(i.borderRadius);Object.values(k).some((function(e){return 0!==e}))?(e.beginPath(),e.fillStyle=a.multiKeyBackground,yA(e,{x:y,y:p,w:u,h:s,radius:k}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),yA(e,{x:b,y:p+1,w:u-2,h:s-2,radius:k}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(y,p,u,s),e.strokeRect(y,p,u,s),e.fillStyle=i.backgroundColor,e.fillRect(b,p+1,u-2,s-2))}e.fillStyle=this.labelTextColors[n]}},{key:"drawBody",value:function(e,t,n){var r,a,i,o,s,u,c,l=this.body,h=n.bodySpacing,f=n.bodyAlign,d=n.displayColors,p=n.boxHeight,v=n.boxWidth,g=n.boxPadding,m=TA(n.bodyFont),y=m.lineHeight,b=0,k=dR(n.rtl,this.x,this.width),x=function(n){t.fillText(n,k.x(e.x+b),e.y+y/2),e.y+=y+h},w=k.textAlign(f);for(t.textAlign=f,t.textBaseline="middle",t.font=m.string,e.x=qF(this,w,n),t.fillStyle=n.bodyColor,VN(this.beforeBody,x),b=d&&"right"!==w?"center"===f?v/2+g:v+2+g:0,o=0,u=l.length;o<u;++o){for(r=l[o],a=this.labelTextColors[o],t.fillStyle=a,VN(r.before,x),i=r.lines,d&&i.length&&(this._drawColorBox(t,e,o,k,n),y=Math.max(m.lineHeight,p)),s=0,c=i.length;s<c;++s)x(i[s]),y=m.lineHeight;VN(r.after,x)}b=0,y=m.lineHeight,VN(this.afterBody,x),e.y-=h}},{key:"drawFooter",value:function(e,t,n){var r,a,i=this.footer,o=i.length;if(o){var s=dR(n.rtl,this.x,this.width);for(e.x=qF(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=s.textAlign(n.footerAlign),t.textBaseline="middle",r=TA(n.footerFont),t.fillStyle=n.footerColor,t.font=r.string,a=0;a<o;++a)t.fillText(i[a],s.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+n.footerSpacing}}},{key:"drawBackground",value:function(e,t,n,r){var a=this.xAlign,i=this.yAlign,o=e.x,s=e.y,u=n.width,c=n.height,l=CA(r.cornerRadius),h=l.topLeft,f=l.topRight,d=l.bottomLeft,p=l.bottomRight;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(o+h,s),"top"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+u-f,s),t.quadraticCurveTo(o+u,s,o+u,s+f),"center"===i&&"right"===a&&this.drawCaret(e,t,n,r),t.lineTo(o+u,s+c-p),t.quadraticCurveTo(o+u,s+c,o+u-p,s+c),"bottom"===i&&this.drawCaret(e,t,n,r),t.lineTo(o+d,s+c),t.quadraticCurveTo(o,s+c,o,s+c-d),"center"===i&&"left"===a&&this.drawCaret(e,t,n,r),t.lineTo(o,s+h),t.quadraticCurveTo(o,s,o+h,s),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}},{key:"_updateAnimationTarget",value:function(e){var t=this.chart,n=this.$animations,r=n&&n.x,a=n&&n.y;if(r||a){var i=zF[e.position].call(this,this._active,this._eventPosition);if(!i)return;var o=this._size=jF(this,e),s=Object.assign({},i,this._size),u=HF(t,e,s),c=GF(e,s,u,t);r._to===c.x&&a._to===c.y||(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=o.width,this.height=o.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,c))}}},{key:"_willRender",value:function(){return!!this.opacity}},{key:"draw",value:function(e){var t=this.options.setContext(this.getContext()),n=this.opacity;if(n){this._updateAnimationTarget(t);var r={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;var i=_A(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(a,e,r,t),pR(e,t.textDirection),a.y+=i.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),vR(e,t.textDirection),e.restore())}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e,t){var n=this,r=this._active,a=e.map((function(e){var t=e.datasetIndex,r=e.index,a=n.chart.getDatasetMeta(t);if(!a)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:a.data[r],index:r}})),i=!jN(r,a),o=this._positionChanged(a,t);(i||o)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}},{key:"handleEvent",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;var r=this.options,a=this._active||[],i=this._getActiveElements(e,a,t,n),o=this._positionChanged(i,e),s=t||!jN(i,a)||o;return s&&(this._active=i,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),s}},{key:"_getActiveElements",value:function(e,t,n,r){var a=this.options;if("mouseout"===e.type)return[];if(!r)return t;var i=this.chart.getElementsAtEventForMode(e,a.mode,a,n);return a.reverse&&i.reverse(),i}},{key:"_positionChanged",value:function(e,t){var n=this.caretX,r=this.caretY,a=this.options,i=zF[a.position].call(this,e,t);return!1!==i&&(n!==i.x||r!==i.y)}}]),n}(GM);(0,Ye.Z)(JF,"positioners",zF);var $F={id:"tooltip",_element:JF,positioners:zF,afterInit:function(e,t,n){n&&(e.tooltip=new JF({chart:e,options:n}))},beforeUpdate:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw:function(e){var t=e.tooltip;if(t&&t._willRender()){var n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",Qe(Qe({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent:function(e,t){if(e.tooltip){var n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:function(e,t){return t.bodyFont.size},boxWidth:function(e,t){return t.bodyFont.size},multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:XF},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:function(e){return"filter"!==e&&"itemSort"!==e&&"external"!==e},_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},eP=Object.freeze({__proto__:null,Colors:lF,Decimation:dF,Filler:DF,Legend:OF,SubTitle:ZF,Title:PF,Tooltip:$F});function tP(e,t,n,r){var a=e.indexOf(t);return-1===a?function(e,t,n,r){return"string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n}(e,t,n,r):a!==e.lastIndexOf(t)?n:a}function nP(e){var t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var rP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e))._startValue=void 0,r._valueRange=0,r._addedLabels=[],r}return(0,v.Z)(n,[{key:"init",value:function(e){var t=this._addedLabels;if(t.length){var r,a=this.getLabels(),i=(0,C.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.index,u=o.label;a[s]===u&&a.splice(s,1)}}catch(c){i.e(c)}finally{i.f()}this._addedLabels=[]}sr((0,y.Z)(n.prototype),"init",this).call(this,e)}},{key:"parse",value:function(e,t){if(ON(e))return null;var n=this.getLabels();return function(e,t){return null===e?null:CD(Math.round(e),0,t)}(t=isFinite(t)&&n[t]===e?t:tP(n,e,zN(t,e),this._addedLabels),n.length-1)}},{key:"determineDataLimits",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.getMinMax(!0),a=r.min,i=r.max;"ticks"===this.options.bounds&&(t||(a=0),n||(i=this.getLabels().length-1)),this.min=a,this.max=i}},{key:"buildTicks",value:function(){var e=this.min,t=this.max,n=this.options.offset,r=[],a=this.getLabels();a=0===e&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(var i=e;i<=t;i++)r.push({value:i});return r}},{key:"getLabelForValue",value:function(e){return nP.call(this,e)}},{key:"configure",value:function(){sr((0,y.Z)(n.prototype),"configure",this).call(this),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}},{key:"getPixelForValue",value:function(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getValueForPixel",value:function(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}},{key:"getBasePixel",value:function(){return this.bottom}}]),n}(nO);function aP(e,t){var n,r,a,i,o=[],s=e.bounds,u=e.step,c=e.min,l=e.max,h=e.precision,f=e.count,d=e.maxTicks,p=e.maxDigits,v=e.includeBounds,g=u||1,m=d-1,y=t.min,b=t.max,k=!ON(c),x=!ON(l),w=!ON(f),I=(b-y)/(p+1),S=pD((b-y)/m/g)*g;if(S<1e-14&&!k&&!x)return[{value:y},{value:b}];(i=Math.ceil(b/S)-Math.floor(y/S))>m&&(S=pD(i*S/m/g)*g),ON(h)||(n=Math.pow(10,h),S=Math.ceil(S*n)/n),"ticks"===s?(r=Math.floor(y/S)*S,a=Math.ceil(b/S)*S):(r=y,a=b),k&&x&&u&&function(e,t){var n=Math.round(e);return n-t<=e&&n+t>=e}((l-c)/u,S/1e3)?(S=(l-c)/(i=Math.round(Math.min((l-c)/S,d))),r=c,a=l):w?S=((a=x?l:a)-(r=k?c:r))/(i=f-1):i=dD(i=(a-r)/S,Math.round(i),S/1e3)?Math.round(i):Math.ceil(i);var C=Math.max(bD(S),bD(r));n=Math.pow(10,ON(h)?C:h),r=Math.round(r*n)/n,a=Math.round(a*n)/n;var _=0;for(k&&(v&&r!==c?(o.push({value:c}),r<c&&_++,dD(Math.round((r+_*S)*n)/n,c,iP(c,I,e))&&_++):r<c&&_++);_<i;++_){var T=Math.round((r+_*S)*n)/n;if(x&&T>l)break;o.push({value:T})}return x&&v&&a!==l?o.length&&dD(o[o.length-1].value,l,iP(l,I,e))?o[o.length-1].value=l:o.push({value:l}):x&&a!==l||o.push({value:a}),o}function iP(e,t,n){var r=n.horizontal,a=mD(n.minRotation),i=(r?Math.sin(a):Math.cos(a))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}(0,Ye.Z)(rP,"id","category"),(0,Ye.Z)(rP,"defaults",{ticks:{callback:nP}});var oP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).start=void 0,r.end=void 0,r._startValue=void 0,r._endValue=void 0,r._valueRange=0,r}return(0,v.Z)(n,[{key:"parse",value:function(e,t){return ON(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}},{key:"handleTickRangeOptions",value:function(){var e=this.options.beginAtZero,t=this.getUserBounds(),n=t.minDefined,r=t.maxDefined,a=this.min,i=this.max,o=function(e){return a=n?a:e},s=function(e){return i=r?i:e};if(e){var u=fD(a),c=fD(i);u<0&&c<0?s(0):u>0&&c>0&&o(0)}if(a===i){var l=0===i?1:Math.abs(.05*i);s(i+l),e||o(a-l)}this.min=a,this.max=i}},{key:"getTickLimit",value:function(){var e,t=this.options.ticks,n=t.maxTicksLimit,r=t.stepSize;return r?(e=Math.ceil(this.max/r)-Math.floor(this.min/r)+1)>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}},{key:"computeTickLimit",value:function(){return Number.POSITIVE_INFINITY}},{key:"buildTicks",value:function(){var e=this.options,t=e.ticks,n=this.getTickLimit(),r=aP({maxTicks:n=Math.max(2,n),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&gD(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}},{key:"configure",value:function(){var e=this.ticks,t=this.min,r=this.max;if(sr((0,y.Z)(n.prototype),"configure",this).call(this),this.options.offset&&e.length){var a=(r-t)/Math.max(e.length-1,1)/2;t-=a,r+=a}this._startValue=t,this._endValue=r,this._valueRange=r-t}},{key:"getLabelForValue",value:function(e){return YD(e,this.chart.options.locale,this.options.ticks.format)}}]),n}(nO),sP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=LN(t)?t:0,this.max=LN(n)?n:1,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){var e=this.isHorizontal(),t=e?this.width:this.height,n=mD(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/r))}},{key:"getPixelForValue",value:function(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}]),n}(oP);(0,Ye.Z)(sP,"id","linear"),(0,Ye.Z)(sP,"defaults",{ticks:{callback:QD.formatters.numeric}});var uP=function(e){return Math.floor(hD(e))},cP=function(e,t){return Math.pow(10,uP(e)+t)};function lP(e){return 1===e/Math.pow(10,uP(e))}function hP(e,t,n){var r=Math.pow(10,n),a=Math.floor(e/r);return Math.ceil(t/r)-a}function fP(e,t){var n=t.min,r=t.max;n=ZN(e.min,n);for(var a=[],i=uP(n),o=function(e,t){for(var n=uP(t-e);hP(e,t,n)>10;)n++;for(;hP(e,t,n)<10;)n--;return Math.min(n,uP(e))}(n,r),s=o<0?Math.pow(10,Math.abs(o)):1,u=Math.pow(10,o),c=i>o?Math.pow(10,i):0,l=Math.round((n-c)*s)/s,h=Math.floor((n-c)/u/10)*u*10,f=Math.floor((l-h)/Math.pow(10,o)),d=ZN(e.min,Math.round((c+h+f*Math.pow(10,o))*s)/s);d<r;)a.push({value:d,major:lP(d),significand:f}),f>=10?f=f<15?15:20:f++,f>=20&&(f=2,s=++o>=0?1:s),d=Math.round((c+h+f*Math.pow(10,o))*s)/s;var p=ZN(e.max,d);return a.push({value:p,major:lP(p),significand:f}),a}var dP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).start=void 0,r.end=void 0,r._startValue=void 0,r._valueRange=0,r}return(0,v.Z)(n,[{key:"parse",value:function(e,t){var n=oP.prototype.parse.apply(this,[e,t]);if(0!==n)return LN(n)&&n>0?n:null;this._zero=!0}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=LN(t)?Math.max(0,t):null,this.max=LN(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!LN(this._userMin)&&(this.min=t===cP(this.min,0)?cP(this.min,-1):cP(this.min,0)),this.handleTickRangeOptions()}},{key:"handleTickRangeOptions",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.min,a=this.max,i=function(e){return r=t?r:e},o=function(e){return a=n?a:e};r===a&&(r<=0?(i(1),o(10)):(i(cP(r,-1)),o(cP(a,1)))),r<=0&&i(cP(a,-1)),a<=0&&o(cP(r,1)),this.min=r,this.max=a}},{key:"buildTicks",value:function(){var e=this.options,t=fP({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&gD(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}},{key:"getLabelForValue",value:function(e){return void 0===e?"0":YD(e,this.chart.options.locale,this.options.ticks.format)}},{key:"configure",value:function(){var e=this.min;sr((0,y.Z)(n.prototype),"configure",this).call(this),this._startValue=hD(e),this._valueRange=hD(this.max)-hD(e)}},{key:"getPixelForValue",value:function(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(hD(e)-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){var t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}]),n}(nO);function pP(e){var t=e.ticks;if(t.display&&e.display){var n=_A(t.backdropPadding);return zN(t.font&&t.font.size,rA.font.size)+n.height}return 0}function vP(e,t,n,r,a){return e===r||e===a?{start:t-n/2,end:t+n/2}:e<r||e>a?{start:t-n,end:t}:{start:t,end:t+n}}function gP(e){for(var t,n,r,a={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},i=Object.assign({},a),o=[],s=[],u=e._pointLabels.length,c=e.options.pointLabels,l=c.centerPointLabels?rD/u:0,h=0;h<u;h++){var f=c.setContext(e.getPointLabelContext(h));s[h]=f.padding;var d=e.getPointPosition(h,e.drawingArea+s[h],l),p=TA(f.font),v=(t=e.ctx,n=p,r=FN(r=e._pointLabels[h])?r:[r],{w:iA(t,n.string,r),h:r.length*n.lineHeight});o[h]=v;var g=ID(e.getIndexAngle(h)+l),m=Math.round(yD(g));mP(i,a,g,vP(m,d.x,v.w,0,180),vP(m,d.y,v.h,90,270))}e.setCenterPoint(a.l-i.l,i.r-a.r,a.t-i.t,i.b-a.b),e._pointLabelItems=function(e,t,n){for(var r,a=[],i=e._pointLabels.length,o=e.options,s=o.pointLabels,u=s.centerPointLabels,c=s.display,l={extra:pP(o)/2,additionalAngle:u?rD/i:0},h=0;h<i;h++){l.padding=n[h],l.size=t[h];var f=yP(e,h,l);a.push(f),"auto"===c&&(f.visible=bP(f,r),f.visible&&(r=f))}return a}(e,o,s)}function mP(e,t,n,r,a){var i=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n)),s=0,u=0;r.start<t.l?(s=(t.l-r.start)/i,e.l=Math.min(e.l,t.l-s)):r.end>t.r&&(s=(r.end-t.r)/i,e.r=Math.max(e.r,t.r+s)),a.start<t.t?(u=(t.t-a.start)/o,e.t=Math.min(e.t,t.t-u)):a.end>t.b&&(u=(a.end-t.b)/o,e.b=Math.max(e.b,t.b+u))}function yP(e,t,n){var r=e.drawingArea,a=n.extra,i=n.additionalAngle,o=n.padding,s=n.size,u=e.getPointPosition(t,r+a+o,i),c=Math.round(yD(ID(u.angle+uD))),l=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(u.y,s.h,c),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),f=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(u.x,s.w,h);return{visible:!0,x:u.x,y:l,textAlign:h,left:f,top:l,right:f+s.w,bottom:l+s.h}}function bP(e,t){if(!t)return!0;var n=e.left,r=e.top,a=e.right,i=e.bottom;return!(lA({x:n,y:r},t)||lA({x:n,y:i},t)||lA({x:a,y:r},t)||lA({x:a,y:i},t))}function kP(e,t,n){var r=n.left,a=n.top,i=n.right,o=n.bottom,s=t.backdropColor;if(!ON(s)){var u=CA(t.borderRadius),c=_A(t.backdropPadding);e.fillStyle=s;var l=r-c.left,h=a-c.top,f=i-r+c.width,d=o-a+c.height;Object.values(u).some((function(e){return 0!==e}))?(e.beginPath(),yA(e,{x:l,y:h,w:f,h:d,radius:u}),e.fill()):e.fillRect(l,h,f,d)}}function xP(e,t,n,r){var a=e.ctx;if(n)a.arc(e.xCenter,e.yCenter,t,0,aD);else{var i=e.getPointPosition(0,t);a.moveTo(i.x,i.y);for(var o=1;o<r;o++)i=e.getPointPosition(o,t),a.lineTo(i.x,i.y)}}(0,Ye.Z)(dP,"id","logarithmic"),(0,Ye.Z)(dP,"defaults",{ticks:{callback:QD.formatters.logarithmic,major:{enabled:!0}}});var wP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).xCenter=void 0,r.yCenter=void 0,r.drawingArea=void 0,r._pointLabels=[],r._pointLabelItems=[],r}return(0,v.Z)(n,[{key:"setDimensions",value:function(){var e=this._padding=_A(pP(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!1),t=e.min,n=e.max;this.min=LN(t)&&!isNaN(t)?t:0,this.max=LN(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){return Math.ceil(this.drawingArea/pP(this.options))}},{key:"generateTickLabels",value:function(e){var t=this;oP.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((function(e,n){var r=UN(t.options.pointLabels.callback,[e,n],t);return r||0===r?r:""})).filter((function(e,n){return t.chart.getDataVisibility(n)}))}},{key:"fit",value:function(){var e=this.options;e.display&&e.pointLabels.display?gP(this):this.setCenterPoint(0,0,0,0)}},{key:"setCenterPoint",value:function(e,t,n,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,r))}},{key:"getIndexAngle",value:function(e){return ID(e*(aD/(this._pointLabels.length||1))+mD(this.options.startAngle||0))}},{key:"getDistanceFromCenterForValue",value:function(e){if(ON(e))return NaN;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}},{key:"getValueForDistanceFromCenter",value:function(e){if(ON(e))return NaN;var t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}},{key:"getPointLabelContext",value:function(e){var t=this._pointLabels||[];if(e>=0&&e<t.length){var n=t[e];return function(e,t,n){return NA(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}},{key:"getPointPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getIndexAngle(e)-uD+n;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}},{key:"getPointPositionForValue",value:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}},{key:"getBasePosition",value:function(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}},{key:"getPointLabelPosition",value:function(e){var t=this._pointLabelItems[e];return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"drawBackground",value:function(){var e=this.options,t=e.backgroundColor,n=e.grid.circular;if(t){var r=this.ctx;r.save(),r.beginPath(),xP(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}},{key:"drawGrid",value:function(){var e,t,n,r=this,a=this.ctx,i=this.options,o=i.angleLines,s=i.grid,u=i.border,c=this._pointLabels.length;if(i.pointLabels.display&&function(e,t){for(var n=e.ctx,r=e.options.pointLabels,a=t-1;a>=0;a--){var i=e._pointLabelItems[a];if(i.visible){var o=r.setContext(e.getPointLabelContext(a));kP(n,o,i);var s=TA(o.font),u=i.x,c=i.y,l=i.textAlign;mA(n,e._pointLabels[a],u,c+s.lineHeight/2,s,{color:o.color,textAlign:l,textBaseline:"middle"})}}}(this,c),s.display&&this.ticks.forEach((function(e,n){if(0!==n){t=r.getDistanceFromCenterForValue(e.value);var a=r.getContext(n),i=s.setContext(a),o=u.setContext(a);!function(e,t,n,r,a){var i=e.ctx,o=t.circular,s=t.color,u=t.lineWidth;!o&&!r||!s||!u||n<0||(i.save(),i.strokeStyle=s,i.lineWidth=u,i.setLineDash(a.dash),i.lineDashOffset=a.dashOffset,i.beginPath(),xP(e,n,o,r),i.closePath(),i.stroke(),i.restore())}(r,i,t,c,o)}})),o.display){for(a.save(),e=c-1;e>=0;e--){var l=o.setContext(this.getPointLabelContext(e)),h=l.color,f=l.lineWidth;f&&h&&(a.lineWidth=f,a.strokeStyle=h,a.setLineDash(l.borderDash),a.lineDashOffset=l.borderDashOffset,t=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),n=this.getPointPosition(e,t),a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(n.x,n.y),a.stroke())}a.restore()}}},{key:"drawBorder",value:function(){}},{key:"drawLabels",value:function(){var e=this,t=this.ctx,n=this.options,r=n.ticks;if(r.display){var a,i,o=this.getIndexAngle(0);t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(o),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((function(o,s){if(0!==s||n.reverse){var u=r.setContext(e.getContext(s)),c=TA(u.font);if(a=e.getDistanceFromCenterForValue(e.ticks[s].value),u.showLabelBackdrop){t.font=c.string,i=t.measureText(o.label).width,t.fillStyle=u.backdropColor;var l=_A(u.backdropPadding);t.fillRect(-i/2-l.left,-a-c.size/2-l.top,i+l.width,c.size+l.height)}mA(t,o.label,0,-a,c,{color:u.color})}})),t.restore()}}},{key:"drawTitle",value:function(){}}]),n}(oP);(0,Ye.Z)(wP,"id","radialLinear"),(0,Ye.Z)(wP,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:QD.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:function(e){return e},padding:5,centerPointLabels:!1}}),(0,Ye.Z)(wP,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,Ye.Z)(wP,"descriptors",{angleLines:{_fallback:"grid"}});var IP={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},SP=Object.keys(IP);function CP(e,t){return e-t}function _P(e,t){if(ON(t))return null;var n=e._adapter,r=e._parseOpts,a=r.parser,i=r.round,o=r.isoWeekday,s=t;return"function"===typeof a&&(s=a(s)),LN(s)||(s="string"===typeof a?n.parse(s,a):n.parse(s)),null===s?null:(i&&(s="week"!==i||!vD(o)&&!0!==o?n.startOf(s,i):n.startOf(s,"isoWeek",o)),+s)}function TP(e,t,n,r){for(var a=SP.length,i=SP.indexOf(e);i<a-1;++i){var o=IP[SP[i]],s=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(s*o.size))<=r)return SP[i]}return SP[a-1]}function EP(e,t,n){if(n){if(n.length){var r=TD(n,t),a=r.lo,i=r.hi;e[n[a]>=t?n[a]:n[i]]=!0}}else e[t]=!0}function NP(e,t,n){var r,a,i=[],o={},s=t.length;for(r=0;r<s;++r)o[a=t[r]]=r,i.push({value:a,major:!1});return 0!==s&&n?function(e,t,n,r){var a,i,o=e._adapter,s=+o.startOf(t[0].value,r),u=t[t.length-1].value;for(a=s;a<=u;a=+o.add(a,1,r))(i=n[a])>=0&&(t[i].major=!0);return t}(e,i,o,n):i}var DP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e))._cache={data:[],labels:[],all:[]},r._unit="day",r._majorUnit=void 0,r._offsets={},r._normalized=!1,r._parseOpts=void 0,r}return(0,v.Z)(n,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.time||(e.time={}),a=this._adapter=new iM._date(e.adapters.date);a.init(t),KN(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},sr((0,y.Z)(n.prototype),"init",this).call(this,e),this._normalized=t.normalized}},{key:"parse",value:function(e,t){return void 0===e?null:_P(this,e)}},{key:"beforeLayout",value:function(){sr((0,y.Z)(n.prototype),"beforeLayout",this).call(this),this._cache={data:[],labels:[],all:[]}}},{key:"determineDataLimits",value:function(){var e=this.options,t=this._adapter,n=e.time.unit||"day",r=this.getUserBounds(),a=r.min,i=r.max,o=r.minDefined,s=r.maxDefined;function u(e){o||isNaN(e.min)||(a=Math.min(a,e.min)),s||isNaN(e.max)||(i=Math.max(i,e.max))}o&&s||(u(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||u(this.getMinMax(!1))),a=LN(a)&&!isNaN(a)?a:+t.startOf(Date.now(),n),i=LN(i)&&!isNaN(i)?i:+t.endOf(Date.now(),n)+1,this.min=Math.min(a,i-1),this.max=Math.max(a+1,i)}},{key:"_getLabelBounds",value:function(){var e=this.getLabelTimestamps(),t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}},{key:"buildTicks",value:function(){var e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);var a=this.min,i=function(e,t,n){for(var r=0,a=e.length;r<a&&e[r]<t;)r++;for(;a>r&&e[a-1]>n;)a--;return r>0||a<e.length?e.slice(r,a):e}(r,a,this.max);return this._unit=t.unit||(n.autoSkip?TP(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):function(e,t,n,r,a){for(var i=SP.length-1;i>=SP.indexOf(n);i--){var o=SP[i];if(IP[o].common&&e._adapter.diff(a,r,o)>=t-1)return o}return SP[n?SP.indexOf(n):0]}(this,i.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(var t=SP.indexOf(e)+1,n=SP.length;t<n;++t)if(IP[SP[t]].common)return SP[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&i.reverse(),NP(this,i,this._majorUnit)}},{key:"afterAutoSkip",value:function(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((function(e){return+e.value})))}},{key:"initOffsets",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,a=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),a=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);var i=n.length<3?.5:.25;r=CD(r,0,i),a=CD(a,0,i),this._offsets={start:r,end:a,factor:1/(r+1+a)}}},{key:"_generate",value:function(){var e,t,n=this._adapter,r=this.min,a=this.max,i=this.options,o=i.time,s=o.unit||TP(o.minUnit,r,a,this._getLabelCapacity(r)),u=zN(i.ticks.stepSize,1),c="week"===s&&o.isoWeekday,l=vD(c)||!0===c,h={},f=r;if(l&&(f=+n.startOf(f,"isoWeek",c)),f=+n.startOf(f,l?"day":s),n.diff(a,r,s)>1e5*u)throw new Error(r+" and "+a+" are too far apart with stepSize of "+u+" "+s);var d="data"===i.ticks.source&&this.getDataTimestamps();for(e=f,t=0;e<a;e=+n.add(e,u,s),t++)EP(h,e,d);return e!==a&&"ticks"!==i.bounds&&1!==t||EP(h,e,d),Object.keys(h).sort((function(e,t){return e-t})).map((function(e){return+e}))}},{key:"getLabelForValue",value:function(e){var t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}},{key:"format",value:function(e,t){var n=this.options.time.displayFormats,r=this._unit,a=t||n[r];return this._adapter.format(e,a)}},{key:"_tickFormatFunction",value:function(e,t,n,r){var a=this.options,i=a.ticks.callback;if(i)return UN(i,[e,t,n],this);var o=a.time.displayFormats,s=this._unit,u=this._majorUnit,c=s&&o[s],l=u&&o[u],h=n[t],f=u&&l&&h&&h.major;return this._adapter.format(e,r||(f?l:c))}},{key:"generateTickLabels",value:function(e){var t,n,r;for(t=0,n=e.length;t<n;++t)(r=e[t]).label=this._tickFormatFunction(r.value,t,e)}},{key:"getDecimalForValue",value:function(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}},{key:"getPixelForValue",value:function(e){var t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}},{key:"_getLabelSize",value:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,r=mD(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(r),i=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:n*a+o*i,h:n*i+o*a}}},{key:"_getLabelCapacity",value:function(e){var t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,a=this._tickFormatFunction(e,0,NP(this,[e],this._majorUnit),r),i=this._getLabelSize(a),o=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return o>0?o:1}},{key:"getDataTimestamps",value:function(){var e,t,n=this._cache.data||[];if(n.length)return n;var r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}},{key:"getLabelTimestamps",value:function(){var e,t,n=this._cache.labels||[];if(n.length)return n;var r=this.getLabels();for(e=0,t=r.length;e<t;++e)n.push(_P(this,r[e]));return this._cache.labels=this._normalized?n:this.normalize(n)}},{key:"normalize",value:function(e){return RD(e.sort(CP))}}]),n}(nO);function AP(e,t,n){var r,a,i,o,s=0,u=e.length-1;if(n){if(t>=e[s].pos&&t<=e[u].pos){var c=ED(e,"pos",t);s=c.lo,u=c.hi}var l=e[s];r=l.pos,i=l.time;var h=e[u];a=h.pos,o=h.time}else{if(t>=e[s].time&&t<=e[u].time){var f=ED(e,"time",t);s=f.lo,u=f.hi}var d=e[s];r=d.time,i=d.pos;var p=e[u];a=p.time,o=p.pos}var v=a-r;return v?i+(o-i)*(t-r)/v:i}(0,Ye.Z)(DP,"id","time"),(0,Ye.Z)(DP,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});var RP=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e))._table=[],r._minPos=void 0,r._tableRange=void 0,r}return(0,v.Z)(n,[{key:"initOffsets",value:function(){var e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=AP(t,this.min),this._tableRange=AP(t,this.max)-this._minPos,sr((0,y.Z)(n.prototype),"initOffsets",this).call(this,e)}},{key:"buildLookupTable",value:function(e){var t,n,r,a,i,o=this.min,s=this.max,u=[],c=[];for(t=0,n=e.length;t<n;++t)(a=e[t])>=o&&a<=s&&u.push(a);if(u.length<2)return[{time:o,pos:0},{time:s,pos:1}];for(t=0,n=u.length;t<n;++t)i=u[t+1],r=u[t-1],a=u[t],Math.round((i+r)/2)!==a&&c.push({time:a,pos:t/(n-1)});return c}},{key:"_getTimestampsForTable",value:function(){var e=this._cache.all||[];if(e.length)return e;var t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e}},{key:"getDecimalForValue",value:function(e){return(AP(this._table,e)-this._minPos)/this._tableRange}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return AP(this._table,n*this._tableRange+this._minPos,!0)}}]),n}(DP);(0,Ye.Z)(RP,"id","timeseries"),(0,Ye.Z)(RP,"defaults",DP.defaults);var MP=[rM,rF,eP,Object.freeze({__proto__:null,CategoryScale:rP,LinearScale:sP,LogarithmicScale:dP,RadialLinearScale:wP,TimeScale:DP,TimeSeriesScale:RP})],OP=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],FP="label";function PP(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function LP(e,t){e.labels=t}function ZP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:FP,r=[];e.datasets=t.map((function(t){var a=e.datasets.find((function(e){return e[n]===t[n]}));return a&&t.data&&!r.includes(a)?(r.push(a),Object.assign(a,t),a):Qe({},t)}))}function zP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FP,n={labels:[],datasets:[]};return LP(n,e.labels),ZP(n,e.datasets,t),n}function BP(e,t){var n=e.height,a=void 0===n?150:n,i=e.width,o=void 0===i?300:i,s=e.redraw,u=void 0!==s&&s,c=e.datasetIdKey,l=e.type,h=e.data,f=e.options,d=e.plugins,p=void 0===d?[]:d,v=e.fallbackContent,g=e.updateMode,m=JE(e,OP),y=(0,r.useRef)(null),b=(0,r.useRef)(),k=function(){y.current&&(b.current=new RO(y.current,{type:l,data:zP(h,c),options:f&&Qe({},f),plugins:p}),PP(t,b.current))},x=function(){PP(t,null),b.current&&(b.current.destroy(),b.current=null)};return(0,r.useEffect)((function(){!u&&b.current&&f&&function(e,t){var n=e.options;n&&t&&Object.assign(n,t)}(b.current,f)}),[u,f]),(0,r.useEffect)((function(){!u&&b.current&&LP(b.current.config.data,h.labels)}),[u,h.labels]),(0,r.useEffect)((function(){!u&&b.current&&h.datasets&&ZP(b.current.config.data,h.datasets,c)}),[u,h.datasets]),(0,r.useEffect)((function(){b.current&&(u?(x(),setTimeout(k)):b.current.update(g))}),[u,f,h.labels,h.datasets,g]),(0,r.useEffect)((function(){b.current&&(x(),setTimeout(k))}),[l]),(0,r.useEffect)((function(){return k(),function(){return x()}}),[]),r.createElement("canvas",Object.assign({ref:y,role:"img",height:a,width:o},m),v)}var UP=(0,r.forwardRef)(BP);function VP(e,t){return RO.register(t),(0,r.forwardRef)((function(t,n){return r.createElement(UP,Object.assign({},t,{ref:n,type:e}))}))}var jP=VP("line",JR),WP=VP("pie",eM),HP=n(1951);function GP(){var e=CE().user,t=KE("users/".concat(e.uid,"/products")),n=t.documents,a=t.error,i=KE("users/".concat(e.uid,"/restockitems")),o=i.documents,s=i.error,u=KE("users/".concat(e.uid,"/salesitems")),c=u.documents,h=u.error,f=l((0,r.useState)(0),2),d=f[0],p=f[1],v=l((0,r.useState)(!0),2),g=v[0],m=v[1];return(0,r.useEffect)((function(){if(n&&o&&c){var e=function(e,t){var n=t.reduce((function(t,n){var r=e.find((function(e){return e.productId===n.productId}));return r?t+r.quantity*r.costPrice:t}),0);return n}(o,c),t=function(e){var t=e.reduce((function(e,t){var n=t.totalQuantity,r=t.batchDetails;if(r&&r.length>0){var a=r[r.length-1];if(a&&a.costPrice)return e+n*a.costPrice}return e}),0),n=t/e.length;return n}(n);if(t>0)p(e/t);else p(0);m(!1)}}),[n,o,c]),g?"Loading...":a||s||h?"Error":d.toFixed(2)}var qP=n(5719),KP=n(1104),YP=function(){function e(t,n){(0,p.Z)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return(0,v.Z)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),XP=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"refCount",value:function(e){return QP("refCount")}},{key:"incRef",value:function(e){return QP("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return QP("time")}},{key:"read",value:function(e){return QP("read")}},{key:"readSync",value:function(e){return QP("readSync")}},{key:"readToGPU",value:function(e,t){return QP("readToGPU")}},{key:"numDataIds",value:function(){return QP("numDataIds")}},{key:"disposeData",value:function(e,t){return QP("disposeData")}},{key:"write",value:function(e,t,n){return QP("write")}},{key:"move",value:function(e,t,n,r,a){return QP("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return QP("createTensorFromGPUData")}},{key:"memory",value:function(){return QP("memory")}},{key:"floatPrecision",value:function(){return QP("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return QP("dispose")}}]),e}();function QP(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function JP(e){for(var t=e.length,n=0;t>0;)n=Math.random()*t|0,tL(e,--t,n)}function $P(e,t,n){return Math.max(e,Math.min(t,n))}function eL(e){return e%2===0?e:e+1}function tL(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function nL(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function rL(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function aL(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";rL(sL(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function iL(e){rL(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function oL(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function sL(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function uL(e){return e%1===0}function cL(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function lL(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function hL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function s(){if(e())a();else{o++;var u=t(o);null!=n&&o>=n?i():null!=r?r(s,u):setTimeout(s,u)}}()}))}function fL(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function dL(e,t){var n=t.length;return rL((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),rL(e.every((function(e){return uL(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function pL(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:dL(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function vL(e,t){return gL(e,t)}function gL(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function mL(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function yL(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function bL(e){return"string"===typeof e||e instanceof String}function kL(e){return"number"===typeof e}function xL(e){return Array.isArray(e)?xL(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":kL(e)?"float32":bL(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function wL(e){return!!(e&&e.constructor&&e.call&&e.apply)}function IL(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function SL(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function CL(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var s=t[0],u=t.slice(1),c=u.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<s;l++)a[l]=CL(e+l*c,u,n,r);return a}function _L(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return CL(0,e,t,n)}function TL(e,t){for(var n=EL(e,t),r=0;r<n.length;r++)n[r]=1;return n}function EL(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function NL(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return _L(e,new Float32Array(n));if("int32"===t)return _L(e,new Int32Array(n));if("bool"===t)return _L(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function DL(e){e.forEach((function(t){rL(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function AL(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function RL(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function ML(e){return e&&e.then&&"function"===typeof e.then}var OL="tfjsflags",FL=function(){function e(t){(0,p.Z)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=PL,this.populateURLFlags()}return(0,v.Z)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(LL().getBool("IS_TEST")||LL().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];LL().getBool("IS_TEST")||LL().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(ML(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getString",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(OL in t)t[OL].split(",").forEach((function(t){var n=l(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){var n=t.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:t}(0,a)}))}}}]),e}();function PL(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,r[0],r[1]),r.join("=")})),t}function LL(){return zL}var ZL,zL=null;function BL(){if(null==ZL){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}ZL=e}return ZL}function UL(e,t){var n=function(){var e=BL();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var VL="Abs",jL="Acos",WL="Acosh",HL="Add",GL="AddN",qL="All",KL="Any",YL="ArgMax",XL="ArgMin",QL="Asin",JL="Asinh",$L="Atan",eZ="Atanh",tZ="Atan2",nZ="AvgPool",rZ="AvgPoolGrad",aZ="AvgPool3D",iZ="AvgPool3DGrad",oZ="BatchMatMul",sZ="BatchToSpaceND",uZ="Bincount",cZ="BitwiseAnd",lZ="BroadcastArgs",hZ="Cast",fZ="Ceil",dZ="ClipByValue",pZ="Complex",vZ="ComplexAbs",gZ="Concat",mZ="Conv2D",yZ="Conv2DBackpropFilter",bZ="Conv2DBackpropInput",kZ="Conv3D",xZ="Conv3DBackpropFilterV2",wZ="Conv3DBackpropInputV2",IZ="Cos",SZ="Cosh",CZ="Cumprod",_Z="Cumsum",TZ="CropAndResize",EZ="DenseBincount",NZ="DepthToSpace",DZ="DepthwiseConv2dNative",AZ="DepthwiseConv2dNativeBackpropFilter",RZ="DepthwiseConv2dNativeBackpropInput",MZ="Diag",OZ="Dilation2D",FZ="Dilation2DBackpropInput",PZ="Dilation2DBackpropFilter",LZ="RealDiv",ZZ="Einsum",zZ="Elu",BZ="EluGrad",UZ="Erf",VZ="Equal",jZ="Exp",WZ="ExpandDims",HZ="Expm1",GZ="FFT",qZ="Fill",KZ="FlipLeftRight",YZ="Floor",XZ="FloorDiv",QZ="FusedBatchNorm",JZ="GatherV2",$Z="GatherNd",ez="Greater",tz="GreaterEqual",nz="Identity",rz="IFFT",az="Imag",iz="IsFinite",oz="IsInf",sz="IsNan",uz="LeakyRelu",cz="Less",lz="LessEqual",hz="LinSpace",fz="Log",dz="Log1p",pz="LogicalAnd",vz="LogicalNot",gz="LogicalOr",mz="LRN",yz="LRNGrad",bz="Max",kz="Maximum",xz="MaxPool",wz="MaxPoolGrad",Iz="MaxPool3D",Sz="MaxPool3DGrad",Cz="MaxPoolWithArgmax",_z="Mean",Tz="Min",Ez="Minimum",Nz="MirrorPad",Dz="Mod",Az="Multinomial",Rz="Multiply",Mz="Neg",Oz="NotEqual",Fz="NonMaxSuppressionV3",Pz="NonMaxSuppressionV4",Lz="NonMaxSuppressionV5",Zz="OnesLike",zz="OneHot",Bz="Pack",Uz="PadV2",Vz="Pow",jz="Prelu",Wz="Prod",Hz="RaggedGather",Gz="RaggedRange",qz="RaggedTensorToTensor",Kz="Range",Yz="Real",Xz="Reciprocal",Qz="Relu",Jz="Reshape",$z="ResizeNearestNeighbor",eB="ResizeNearestNeighborGrad",tB="ResizeBilinear",nB="ResizeBilinearGrad",rB="Relu6",aB="Reverse",iB="Round",oB="Rsqrt",sB="ScatterNd",uB="TensorScatterUpdate",cB="SearchSorted",lB="Select",hB="Selu",fB="Slice",dB="Sin",pB="Sinh",vB="Sign",gB="Sigmoid",mB="Softplus",yB="Sqrt",bB="Sum",kB="SpaceToBatchND",xB="SplitV",wB="Softmax",IB="SparseFillEmptyRows",SB="SparseReshape",CB="SparseSegmentMean",_B="SparseSegmentSum",TB="SparseToDense",EB="SquaredDifference",NB="Square",DB="StaticRegexReplace",AB="StridedSlice",RB="StringNGrams",MB="StringSplit",OB="StringToHashBucketFast",FB="Sub",PB="Tan",LB="Tanh",ZB="Tile",zB="TopK",BB="Transform",UB="Transpose",VB="Unique",jB="Unpack",WB="UnsortedSegmentSum",HB="ZerosLike",GB="Step",qB="RotateWithOffset",KB="_FusedMatMul",YB="FusedConv2D",XB="FusedDepthwiseConv2D";function QB(){var e;LL().getBool("IS_TEST")||LL().getBool("PROD")||(e=console).warn.apply(e,arguments)}var JB=UL("kernelRegistry",(function(){return new Map})),$B=UL("gradRegistry",(function(){return new Map}));function eU(e,t){var n=iU(e,t);return JB.get(n)}function tU(e){return $B.get(e)}function nU(e){for(var t=JB.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=l(i,2),s=o[0],u=o[1];l(s.split("_"),1)[0]===e&&n.push(u)}return n}function rU(e){var t=e.kernelName,n=e.backendName,r=iU(t,n);JB.has(r)&&QB("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),JB.set(r,e)}function aU(e){var t=e.kernelName;$B.has(t)&&LL().getBool("DEBUG")&&QB("Overriding the gradient for '".concat(t,"'")),$B.set(t,e)}function iU(e,t){return"".concat(t,"_").concat(e)}function oU(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var sU=n(8987),uU=n.n(sU)()||sU;function cU(e){return uU.fromString(e,!0,16)}var lU=cU("c3a5c85c97cb3127"),hU=cU("b492b66fbe98f273"),fU=cU("9ae16a3b2f90404f");function dU(e){return e.xor(e.shru(47))}function pU(e,t,n){var r=e.slice(t,t+n);return uU.fromBytes(Array.from(r),!0,!0)}function vU(e,t){return pU(e,t,8)}function gU(e,t){return pU(e,t,4)}function mU(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function yU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cU("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function bU(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=mU(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(mU(a,44)),[a.add(r),i.add(o)]}(vU(e,t),vU(e,t+8),vU(e,t+16),vU(e,t+24),n,r)}function kU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=uU.fromNumber(81,!0);if(t<=32)return t<=16?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=fU.add(2*t),r=vU(e,0).add(fU),a=vU(e,t-8);return yU(mU(a,37).mul(n).add(r),mU(r,25).add(a).mul(n),n)}if(t>=4){var i=fU.add(2*t);return yU(gU(e,0).shl(3).add(t),gU(e,t-4),i)}if(t>0){var o=e[0]+(e[t>>1]<<8),s=t+(e[t-1]<<2);return dU(fU.mul(o).xor(lU.mul(s))).mul(fU)}return fU}(e,t):function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=fU.add(2*t),r=vU(e,0).mul(hU),a=vU(e,8),i=vU(e,t-8).mul(n),o=vU(e,t-16).mul(fU);return yU(mU(r.add(a),43).add(mU(i,30)).add(o),r.add(mU(a.add(fU),18)).add(i),n)}(e,t);if(t<=64)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=fU.add(2*t),r=vU(e,0).mul(fU),a=vU(e,8),i=vU(e,t-8).mul(n),o=vU(e,t-16).mul(fU),s=mU(r.add(a),43).add(mU(i,30)).add(o),u=yU(s,r.add(mU(a.add(fU),18)).add(i),n),c=vU(e,16).mul(n),l=vU(e,24),h=s.add(vU(e,t-32)).mul(n),f=u.add(vU(e,t-24)).mul(n);return yU(mU(c.add(l),43).add(mU(h,30)).add(f),c.add(mU(l.add(r),18)).add(h),n)}(e,t);var r=n,a=n.mul(hU).add(113),i=dU(a.mul(fU).add(113)).mul(fU),o=[uU.UZERO,uU.UZERO],s=[uU.UZERO,uU.UZERO];r=r.mul(fU).add(vU(e,0));var u=0,c=64*(t-1>>6),l=c+(t-1&63)-63;do{r=mU(r.add(a).add(o[0]).add(vU(e,u+8)),37).mul(hU),a=mU(a.add(o[1]).add(vU(e,u+48)),42).mul(hU),r=r.xor(s[1]),a=a.add(o[0]).add(vU(e,u+40)),i=mU(i.add(s[0]),33).mul(hU),o=bU(e,u,o[1].mul(hU),r.add(s[0])),s=bU(e,u+32,i.add(s[1]),a.add(vU(e,u+16)));var h=[r,i];i=h[0],r=h[1],u+=64}while(u!==c);var f=hU.add(i.and(255).shl(1));u=l,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=mU(r.add(a).add(o[0]).add(vU(e,u+8)),37).mul(f),a=mU(a.add(o[1]).add(vU(e,u+48)),42).mul(f),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(vU(e,u+40))),i=mU(i.add(s[0]),33).mul(f),o=bU(e,u,o[1].mul(f),r.add(s[0])),s=bU(e,u+32,i.add(s[1]),a.add(vU(e,u+16)));var d=[r,i];return i=d[0],r=d[1],yU(yU(o[0],s[0],f).add(dU(a).mul(lU)).add(i),yU(o[1],s[1],f).add(r),f)}function xU(e,t){return"string"===t?SU(e):wU([e],t)}function wU(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=TU(e)),LL().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function IU(){return LL().platform.now()}function SU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",LL().platform.encode(e,t)}function CU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",LL().platform.decode(e,t)}function _U(e){return null!=LL().platform.isTypedArray?LL().platform.isTypedArray(e):oU(e)}function TU(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||ML(e)||null==e||_U(e)&&n)t.push(e);else if(Array.isArray(e)||_U(e))for(var r=0;r<e.length;++r)TU(e[r],t,n);else{for(var a=-1,i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];/^([1-9]+[0-9]*|0)$/.test(s)&&(a=Math.max(a,Number(s)))}for(var u=0;u<=a;u++)TU(e[u],t,n)}return t}var EU=function(){function e(t,n){(0,p.Z)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new NU)}return(0,v.Z)(e,[{key:"profileKernel",value:function(e,t,n){var r,a,i=function(){r=n()},o=IU();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();var s,u=(0,C.Z)(r);try{for(u.s();!(s=u.n()).done;){s.value.dataSync()}}catch(h){u.e(h)}finally{u.f()}a=Promise.resolve({kernelMs:IU()-o})}if(LL().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var c=function(){var t=r[l];t.data().then((function(n){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(n,t.dtype,e)}))},l=0;l<r.length;l++)c();return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var NU=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?lL("".concat(r,"ms"),9):r.error,s=lL(e,25),u=t.rank,c=t.size,l=lL(t.shape.toString(),14),h="";for(var f in a){var d=a[f];if(null!=d){var p=d.shape||t.shape,v=p.length;h+="".concat(f,": ").concat(v,"D ").concat(v>0?p:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();var DU=20,AU=3,RU=7;function MU(e,t,n,r){var a=SL(t),i=function(e,t,n,r){var a=oL(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?LU(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,h=0;h<i;h++)o[h]=Math.max(o[h],OU(u[l+h],0,n).length);return o}(e,t,n,a),o=t.length,s=PU(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function OU(e,t,n){return lL(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(RU))," + ")+"".concat(parseFloat(e[1].toFixed(RU)),"j"):bL(e)?"'".concat(e,"'"):"bool"===n?FU(e):parseFloat(e.toFixed(RU)).toString(),t)}function FU(e){return 0===e?"false":"true"}function PU(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u)return"complex64"===n?[OU(LU(e)[0],0,n)]:"bool"===n?[FU(e[0])]:[e[0].toString()];if(1===u){if(s>DU){var c=AU*o,l=Array.from(e.slice(0,c)),h=Array.from(e.slice((s-AU)*o,s*o));return"complex64"===n&&(l=LU(l),h=LU(h)),["["+l.map((function(e,t){return OU(e,a[t],n)})).join(", ")+", ..., "+h.map((function(e,t){return OU(e,a[s-AU+t],n)})).join(", ")+"]"]}return["["+("complex64"===n?LU(e):Array.from(e)).map((function(e,t){return OU(e,a[t],n)})).join(", ")+"]"]}var f=t.slice(1),p=r.slice(1),v=r[0]*o,g=[];if(s>DU){for(var m=0;m<AU;m++){var y=m*v,b=y+v;g.push.apply(g,d(PU(e.slice(y,b),f,n,p,a,!1)))}g.push("...");for(var k=s-AU;k<s;k++){var x=k*v,w=x+v;g.push.apply(g,d(PU(e.slice(x,w),f,n,p,a,k===s-1)))}}else for(var I=0;I<s;I++){var S=I*v,C=S+v;g.push.apply(g,d(PU(e.slice(S,C),f,n,p,a,I===s-1)))}var _=2===u?",":"";g[0]="["+(s>0?g[0]+_:"");for(var T=1;T<g.length-1;T++)g[T]=" "+g[T]+_;for(var E=",\n",N=2;N<u;N++)E+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(i?"":E),g}function LU(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var ZU=function(){function e(t,n,r){var a=this;if((0,p.Z)(this,e),this.dtype=n,this.shape=t.slice(),this.size=oL(t),null!=r){var i=r.length;rL(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||gL(n,this.size),this.strides=SL(t)}return(0,v.Z)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),rL(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return zU().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),zU=null,BU=null;var UU=function(){function e(t,n,r,a){(0,p.Z)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=oL(t),this.strides=SL(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return(0,v.Z)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",BU.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return BU.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",_L(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return _L(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=zU().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return CU(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),zU().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=zU().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return CU(e)}))}catch(zm){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,zU().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(zU().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return BU.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),BU.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return MU(this.dataSync(),this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),BU.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),zU().makeVariable(this,e,t,n)}}]),e}();function VU(){return UL("Tensor",(function(){return UU}))}Object.defineProperty(UU,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),VU();var jU,WU,HU,GU,qU,KU=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a,i){var o;return(0,p.Z)(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return(0,v.Z)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!sL(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));zU().disposeTensor(this),this.dataId=e.dataId,zU().incRef(this,null)}},{key:"dispose",value:function(){zU().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(UU);Object.defineProperty(KU,Symbol.hasInstance,{value:function(e){return e instanceof UU&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(jU||(jU={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(WU||(WU={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(HU||(HU={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(GU||(GU={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(qU||(qU={}));var YU={float32:GU,int32:WU,bool:HU,complex64:qU};function XU(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return YU[e][t]}function QU(e){return XU(e,"int32")}function JU(e){return null!=e&&"object"===typeof e&&"texture"in e&&e.texture instanceof WebGLTexture}function $U(e){return"undefined"!==typeof GPUBuffer&&null!=e&&"object"===typeof e&&"buffer"in e&&e.buffer instanceof GPUBuffer}function eV(e,t){if(e.dtype===t.dtype)return[e,t];var n=XU(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function tV(e,t){return t.some((function(t){return t.id===e.id}))}function nV(e){var t=[];return rV(e,t,new Set),t}function rV(e,t,n){if(null!=e)if(e instanceof UU)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),rV(o,t,n))}}}function aV(e){return null!=e.kernelName}var iV=function(){function e(){(0,p.Z)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return(0,v.Z)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),oV=function(){function e(t){(0,p.Z)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new iV}return(0,v.Z)(e,[{key:"ready",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(QB("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new EU(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;nU(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;nU(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof XP||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,QB("Initialization of backend ".concat(e," failed")),QB(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return QB("Initialization of backend ".concat(e," failed")),QB(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=cV.runKernel(nz,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return cV.runKernel(hZ,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=eU(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=aV(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(aV(e)){var l=e.kernelName,h=e.inputs,f=e.attrs;null==this.backendName&&this.backend;var d=eU(l,this.backendName);rL(null!=d,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=d.kernelFunc({inputs:h,attrs:f,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var s=a.getTensorsForGradient(l,h,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var p=e.forwardFunc,v=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return p(a.backend,v)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var g,m=e.inputs,y=e.attrs,b=aV(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(g=a.profiler.profileKernel(c,m,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(g),t=g.outputs):t=n()})),o&&this.addTapeNode(c,m,t,b,i,y),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(m).map((function(e){return null!=m[e]?m[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=tU(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(rL(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&bL(e[0])&&(a=e.map((function(e){return SU(e)})));var i=r.write(a,t,n),o=new UU(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new UU(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new KU(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*yL(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof KU||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*yL(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,d(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=(0,C.Z)(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=tU(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=EL(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=nV(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(rL(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));rL(i instanceof UU,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],h=!1,f=0;f<t.length;f++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var d={};d[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var g=e[v],m=g.inputs,y=0;y<g.outputs.length;y++)if(d[g.outputs[y].id]){for(var b in m)d[m[b].id]=!0,p[g.id]=!0;break}for(var k=[],x=0;x<e.length;x++){var w=e[x];if(a[w.id]&&p[w.id]){var I={};for(var S in w.inputs){var C=w.inputs[S];r[C.id]&&(I[S]=C)}var _=Object.assign({},w);_.inputs=I,_.outputs=w.outputs,k.push(_)}}return k}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?function(e){var t=TL(oL(e),"float32");return cV.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(var a=function(){var a=t[i],o=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var s=a.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var i=n((function(){return s[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[t];if(!sL(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var u=e[o.id];e[o.id]=r(u,i),u.dispose()}};for(var c in a.inputs)u(c)},i=t.length-1;i>=0;i--)a()}(e,o,(function(e){return r.tidy(e)}),lV);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=(0,C.Z)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return rL(wL(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;rL(r.every((function(e){return e instanceof UU})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));return t.runKernelFunc({forwardFunc:function(t,n){return rL((i=e.apply(void 0,[].concat(r,[n]))).value instanceof UU,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),rL(wL(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},backwardsFunc:function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];rL(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),rL(a.every((function(e){return e instanceof UU})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o},inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=IU(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=IU()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new iV,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function sV(){var e=BL();if(null==e._tfengine){var t=new FL(e);e._tfengine=new oV(t)}return function(e){zL=e}(e._tfengine.ENV),function(e){zU=e}((function(){return e._tfengine})),e._tfengine}oV.nextTensorId=0,oV.nextVariableId=0;var uV,cV=sV();function lV(e,t){var n={a:e,b:t};return cV.runKernel(HL,n)}function hV(e){if(void 0!==uV)return uV;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function fV(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var dV=LL();function pV(e,t){var n=e;if(_U(e))return"string"===t?[]:[e.length];if(JU(e)){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if($U(e))return[e.buffer.size/(null==t?4:yL(t))];if(!Array.isArray(e))return[];for(var a=[];Array.isArray(n)||_U(n)&&"string"!==t;)a.push(n.length),n=n[0];return Array.isArray(e)&&LL().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&vV(e,a,[]),a}function vV(e,t,n){if(n=n||[],Array.isArray(e)||_U(e)){rL(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),rL(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)vV(e[a],r,n.concat(a))}else rL(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function gV(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function mV(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof UU)return gV(r,e.dtype,t,n),e;var a=xL(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),gV(r,a,t,n),null==e||!_U(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=pV(e,a);_U(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?wU(e,a):TU(e,[],!0);return cV.makeTensor(s,o,a)}function yV(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((function(e,a){return mV(e,"".concat(t,"[").concat(a,"]"),n,r)}))}dV.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),dV.registerFlag("IS_BROWSER",(function(){return fV()})),dV.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),dV.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),dV.registerFlag("IS_SAFARI",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)})),dV.registerFlag("PROD",(function(){return!1})),dV.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return dV.getBool("DEBUG")})),dV.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),dV.registerFlag("IS_TEST",(function(){return!1})),dV.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return dV.getBool("DEBUG")})),dV.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),dV.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),dV.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));function bV(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var a=function(){cV.startScope(n);try{var e=r.apply(void 0,arguments);return ML(e)&&console.error("Cannot return a Promise inside of tidy."),cV.endScope(e),e}catch(t){throw cV.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var kV=bV({complex_:function(e,t){var n=mV(e,"real","complex"),r=mV(t,"imag","complex");aL(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return cV.runKernel(pZ,a)}});function xV(e,t,n,r){if(null==r)r=xL(e);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if($U(e)||JU(e)){if("float32"!==r&&"int32"!==r)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(r,"."));return cV.backend.createTensorFromGPUData(e,t||n,r)}if(!_U(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){DL(t);var a=oL(t),i=oL(n);rL(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==oL(t.slice(o));rL(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return _U(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?wU(e,r):TU(e,[],!0),cV.makeTensor(e,t,r)}function wV(e,t,n){return xV(e,t,pV(e,n),n)}var IV={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},SV=function(){function e(t){if((0,p.Z)(this,e),this.shards=[],this.previousShardIndex=0,null!=t&&(t instanceof Array||(t=[t]),0!==(t=t.map((function(e){return _U(e)?e.buffer:e}))).length)){this.bufferUniformSize=t[0].byteLength;for(var n=0,r=0;r<t.length;r++){var a=t[r];r!==t.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);var i=n+a.byteLength;this.shards.push({buffer:a,start:n,end:i}),n=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}}return(0,v.Z)(e,[{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),(t=Math.min(this.byteLength,t))<=e)return new ArrayBuffer(0);var n=this.findShardForByte(e);if(-1===n)throw new Error("Could not find start shard for byte ".concat(e));for(var r=new ArrayBuffer(t-e),a=new Uint8Array(r),i=0,o=n;o<this.shards.length;o++){var s=this.shards[o],u=e+i-s.start,c=i,l=Math.min(t,s.end)-s.start,h=new Uint8Array(s.buffer,u,l-u);if(a.set(h,c),i+=h.length,t<s.end)break}return r}},{key:"findShardForByte",value:function(e){if(0===this.shards.length||e<0||e>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(0===t(this.shards[this.previousShardIndex]))return this.previousShardIndex;var n=function(e,t){var n=0,r=e.length;for(;n<=r;){var a=Math.floor((r-n)/2)+n,i=t(e[a]);if(0===i)return a;i<0?r=a:n=a+1}return-1}(this.shards,t);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}],[{key:"join",value:function(t){return new e(t).slice()}}]),e}();var CV=4;function _V(e,t){return TV.apply(this,arguments)}function TV(){return TV=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=Dt().mark((function e(){var o,u,c,l;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i[s],"float32"===(u=Array.isArray(t)?t[s].tensor:t[o]).dtype||"int32"===u.dtype||"bool"===u.dtype||"string"===u.dtype||"complex64"===u.dtype){e.next=4;break}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(u.dtype));case 4:c={name:o,shape:u.shape,dtype:u.dtype},"string"===u.dtype?(l=new Promise(function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+CV*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)s=n[o],c=new Uint8Array(new Uint32Array([s.length]).buffer),a.set(c,i),i+=CV,a.set(s,i),i+=s.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.push(l)):a.push(u.data()),null!=n&&(c.group=n),r.push(c);case 8:case"end":return e.stop()}}),e)})),s=0;case 5:if(!(s<i.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:++s,e.next=5;break;case 10:return e.next=12,Promise.all(a);case 12:return u=e.sent,e.abrupt("return",{data:NV(u),specs:r});case 14:case"end":return e.stop()}}),e)}))),TV.apply(this,arguments)}function EV(e,t){var n,r,a=new SV(e),i={},o=0,s=(0,C.Z)(t);try{for(s.s();!(r=s.n()).done;){var u=r.value,c=u.name,l=u.dtype,h=u.shape,f=oL(h),d=void 0;if("quantization"in u){var p=u.quantization;if("uint8"===p.dtype||"uint16"===p.dtype){if(!("min"in p)||!("scale"in p))throw new Error("Weight ".concat(u.name," with quantization ").concat(p.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==p.dtype)throw new Error("Weight ".concat(u.name," has unknown ")+"quantization dtype ".concat(p.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==l)throw new Error("Weight ".concat(u.name," is quantized with ").concat(p.dtype," ")+"which only supports weights of type float32 not ".concat(l,"."))}var v=IV[p.dtype],g=a.slice(o,o+f*v),m="uint8"===p.dtype?new Uint8Array(g):new Uint16Array(g);if("float32"===l)if("uint8"===p.dtype||"uint16"===p.dtype){d=new Float32Array(m.length);for(var y=0;y<m.length;y++){var b=m[y];d[y]=b*p.scale+p.min}}else{if("float16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type float32.");void 0===n&&(n=VV()),d=n(m)}else{if("int32"!==l)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(l));if("uint8"!==p.dtype&&"uint16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type int32.");d=new Int32Array(m.length);for(var k=0;k<m.length;k++){var x=m[k];d[k]=Math.round(x*p.scale+p.min)}}o+=f*v}else if("string"===l){var w=oL(u.shape);d=[];for(var I=0;I<w;I++){var S=new Uint32Array(a.slice(o,o+CV))[0];o+=CV;var _=new Uint8Array(a.slice(o,o+S));d.push(_),o+=S}}else{var T=IV[l],E=a.slice(o,o+f*T);if("float32"===l)d=new Float32Array(E);else if("int32"===l)d=new Int32Array(E);else if("bool"===l)d=new Uint8Array(E);else{if("complex64"!==l)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(l));d=new Float32Array(E);for(var N=new Float32Array(d.length/2),D=new Float32Array(d.length/2),A=0;A<N.length;A++)N[A]=d[2*A],D[A]=d[2*A+1];var R=wV(N,h,"float32"),M=wV(D,h,"float32");i[c]=kV(R,M),R.dispose(),M.dispose()}o+=f*T}"complex64"!==l&&(i[c]=wV(d,h,l))}}catch(O){s.e(O)}finally{s.f()}return i}function NV(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var DV="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function AV(e){return DV?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function RV(e){if(DV)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function MV(e){if(DV){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function OV(e){return SV.join(e)}function FV(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function PV(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function LV(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function ZV(e,t){return zV.apply(this,arguments)}function zV(){return zV=Rt(Dt().mark((function e(t,n){var r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:i=e.sent,o=l(i,2),r=o[0],a=o[1];case 7:return e.abrupt("return",LV(t,r,a));case 8:case"end":return e.stop()}}),e)}))),zV.apply(this,arguments)}function BV(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:AV(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:AV(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:new SV(e.weightData).byteLength}}function UV(e){var t,n=[],r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push.apply(n,d(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function VV(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var jV=function(){function e(){(0,p.Z)(this,e),this.saveRouters=[],this.loadRouters=[]}return(0,v.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),WV=function(e){return jV.registerSaveRouter(e)},HV=function(e){return jV.registerLoadRouter(e)},GV=function(e){return jV.getSaveHandlers(e)},qV=function(e,t){return jV.getLoadHandlers(e,t)},KV="tensorflowjs",YV="models_store",XV="model_info_store";function QV(){if(!LL().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function JV(e){var t=e.result;t.createObjectStore(YV,{keyPath:"modelPath"}),t.createObjectStore(XV,{keyPath:"modelPath"})}var $V=function(){function e(t){if((0,p.Z)(this,e),this.indexedDB=QV(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return(0,v.Z)(e,[{key:"save",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(KV,1);a.onupgradeneeded=function(){return JV(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(YV,"readonly"),s=o.objectStore(YV).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{t.weightData=SV.join(t.weightData);var u,c,l=BV(t),h=i.transaction(XV,"readwrite"),f=h.objectStore(XV);try{u=f.put({modelPath:n.modelPath,modelArtifactsInfo:l})}catch(d){return r(d)}u.onsuccess=function(){var a,o=(c=i.transaction(YV,"readwrite")).objectStore(YV);try{a=o.put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:l})}catch(d){return r(d)}a.onsuccess=function(){return e({modelArtifactsInfo:l})},a.onerror=function(e){var t=(f=h.objectStore(XV)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},u.onerror=function(e){return i.close(),r(u.error)},h.oncomplete=function(){null==c?i.close():c.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();$V.URL_SCHEME="indexeddb://";var ej=function(e){return LL().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith($V.URL_SCHEME)?(t=e.slice($V.URL_SCHEME.length),new $V(t)):null;var t};jV.registerSaveRouter(ej),jV.registerLoadRouter(ej);var tj=function(){function e(){(0,p.Z)(this,e),this.indexedDB=QV()}return(0,v.Z)(e,[{key:"listModels",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(KV,1);r.onupgradeneeded=function(){return JV(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(XV,"readonly"),i=a.objectStore(XV).getAll();i.onsuccess=function(){var t,n={},r=(0,C.Z)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Rt(Dt().mark((function e(t){var n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith($V.URL_SCHEME)?r.slice($V.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(KV,1);a.onupgradeneeded=function(){return JV(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(XV,"readwrite"),s=o.objectStore(XV),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(YV,"readwrite")).objectStore(YV).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),nj="/",rj="tensorflowjs_models",aj="info",ij="model_topology",oj="weight_specs",sj="weight_data",uj="model_metadata";function cj(e){return{info:[rj,e,aj].join(nj),topology:[rj,e,ij].join(nj),weightSpecs:[rj,e,oj].join(nj),weightData:[rj,e,sj].join(nj),modelMetadata:[rj,e,uj].join(nj)}}function lj(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function hj(e){var t=e.split(nj);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(nj)}var fj=function(){function e(t){if((0,p.Z)(this,e),!LL().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=cj(this.modelPath)}return(0,v.Z)(e,[{key:"save",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=BV(t),i=SV.join(t.weightData),e.prev=8,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,RV(i)),o={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),e.abrupt("return",{modelArtifactsInfo:a});case 18:throw e.prev=18,e.t0=e.catch(8),lj(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 22:case"end":return e.stop()}}),e,this,[[8,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=MV(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();fj.URL_SCHEME="localstorage://";var dj=function(e){return LL().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(fj.URL_SCHEME)?(t=e.slice(fj.URL_SCHEME.length),new fj(t)):null;var t};jV.registerSaveRouter(dj),jV.registerLoadRouter(dj);var pj=function(){function e(){(0,p.Z)(this,e),rL(LL().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),rL("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return(0,v.Z)(e,[{key:"listModels",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=rj+nj,r=nj+aj,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=hj(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(fj.URL_SCHEME)?a.slice(fj.URL_SCHEME.length):a,n=cj(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),lj(n),e.abrupt("return",r);case 7:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),vj="://",gj=function(){function e(){(0,p.Z)(this,e),this.managers={}}return(0,v.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){rL(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(vj)&&(t=t.slice(0,t.indexOf(vj))),rL(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();rL(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function mj(e){if(-1===e.indexOf(vj))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(gj.getSchemes().join(",")));return{scheme:e.split(vj)[0],path:e.split(vj)[1]}}function yj(e,t){return bj.apply(this,arguments)}function bj(){return bj=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]&&d[2],rL(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),rL((a=jV.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),rL(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],rL((o=jV.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),rL(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=mj(t).scheme,c=mj(t).path,l=u===mj(t).scheme,e.next=15,i.load();case 15:if(h=e.sent,!r||!l){e.next=19;break}return e.next=19,gj.getManager(u).removeModel(c);case 19:return e.next=21,s.save(h);case 21:if(f=e.sent,!r||l){e.next=25;break}return e.next=25,gj.getManager(u).removeModel(c);case 25:return e.abrupt("return",f.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),bj.apply(this,arguments)}function kj(){return xj.apply(this,arguments)}function xj(){return(xj=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=gj.getSchemes(),n={},r=(0,C.Z)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,gj.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+vj+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function wj(e){return Ij.apply(this,arguments)}function Ij(){return(Ij=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=mj(t),r=gj.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sj(e,t){return Cj.apply(this,arguments)}function Cj(){return(Cj=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",yj(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _j(e,t){return Tj.apply(this,arguments)}function Tj(){return(Tj=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",yj(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ej=function(){function e(){(0,p.Z)(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return(0,v.Z)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&LL().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return oU(e)}}]),e}();if(LL().get("IS_BROWSER")){LL().setPlatform("browser",new Ej);try{gj.registerManager(fj.URL_SCHEME,new pj)}catch(kve){}try{gj.registerManager($V.URL_SCHEME,new tj)}catch(kve){}}var Nj,Dj=function(){return n(5410)};var Aj=function(){function e(){(0,p.Z)(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return(0,v.Z)(e,[{key:"fetch",value:function(e,t){return null!=LL().global.fetch?LL().global.fetch(e,t):(null==Nj&&(Nj=Dj()),Nj(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();function Rj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",DL(e),new ZU(e,t,n)}LL().get("IS_NODE")&&!LL().get("IS_BROWSER")&&LL().setPlatform("node",new Aj);var Mj=bV({cast_:function(e,t){var n=mV(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return cV.runKernel(hZ,r,a)}});var Oj=bV({clone_:function(e){var t={x:mV(e,"x","clone","string_or_numeric")};return cV.runKernel(nz,t)}});sV();var Fj={buffer:Rj,cast:Mj,clone:Oj,print:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};function Pj(){return cV}function Lj(){return cV.memory()}function Zj(e,t){return cV.tidy(e,t)}function zj(e){nV(e).forEach((function(e){return e.dispose()}))}function Bj(e){return cV.keep(e)}function Uj(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return cV.registerBackend(e,t,n)}BU=Fj,function(e){e}((function(e){LL().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}));var Vj=bV({add_:function(e,t){var n=mV(e,"a","add"),r=mV(t,"b","add"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(HL,i)}});var jj=bV({floorDiv_:function(e,t){var n=mV(e,"a","floorDiv"),r=mV(t,"b","floorDiv"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(XZ,i)}});var Wj=bV({div_:function(e,t){var n=mV(e,"a","div"),r=mV(t,"b","div"),a=l(eV(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return jj(n,r);var i={a:n,b:r};return cV.runKernel(LZ,i,{})}});var Hj=bV({mul_:function(e,t){var n=mV(e,"a","mul"),r=mV(t,"b","mul"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(Rz,i)}});var Gj=bV({sqrt_:function(e){var t={x:mV(e,"x","sqrt","float32")};return cV.runKernel(yB,t)}});var qj=bV({square_:function(e){var t=mV(e,"x","square");return cV.runKernel("Square",{x:t},{})}});var Kj=bV({zerosLike_:function(e){var t={x:mV(e,"x","zerosLike")};return cV.runKernel(HB,t)}});function Yj(e){return cV.customGrad(e)}function Xj(e,t){if((_U(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&_U(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return xV(e,[],[],t)}var Qj=new Map,Jj=new Map,$j=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),eW=function(){function e(){(0,p.Z)(this,e),this.classNameMap={}}return(0,v.Z)(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function tW(e,t,n){rL(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),rL("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),rL(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),"undefined"===typeof t&&(t="Custom"),"undefined"===typeof n&&(n=e.className);var r=t+">"+n;return eW.register(e),Qj.set(r,e),Jj.set(e,r),e}var nW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return zj(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){rL(wL(e),(function(){return"The f passed in variableGrads(f) must be a function"})),rL(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof KU})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],cV.registeredVariables)t.push(cV.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),rL(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=cV.gradients(e,t,null,!0),s=o.value,u=o.grads;rL(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),rL(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&zj(this.iterations_)}},{key:"saveIterations",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:Xj(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}($j);Object.defineProperty(nW,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var rW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,p.Z)(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=cV.backend.epsilon()),a}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=cV.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Zj((function(){return Kj(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Zj((function(){return Kj(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Zj((function(){var e=Vj(Hj(o,t.rho),Hj(qj(i),1-t.rho)),n=Hj(Wj(Gj(Vj(s,t.epsilon)),Gj(Vj(o,t.epsilon))),i),r=Vj(Hj(s,t.rho),Hj(qj(n),1-t.rho));o.assign(e),s.assign(r);var u=Vj(Hj(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(zj(this.accumulatedGrads.map((function(e){return e.variable}))),zj(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(d(this.accumulatedGrads),d(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(nW);function aW(e,t,n){DL(e);var r={shape:e,value:t,dtype:n=n||xL(t)};return cV.runKernel(qZ,{},r)}var iW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return(0,p.Z)(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=cV.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Zj((function(){return aW(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Zj((function(){var e=Vj(o,qj(i));o.assign(e);var n=Vj(Hj(Wj(i,Gj(Vj(e,cV.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&zj(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(nW);var oW=bV({pow_:function(e,t){var n=mV(e,"base","pow"),r=mV(t,"exp","pow"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(Vz,i)}});var sW=bV({sub_:function(e,t){var n=mV(e,"a","sub"),r=mV(t,"b","sub"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(FB,i)}}),uW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,p.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Zj((function(){i.accBeta1=Xj(r).variable(),i.accBeta2=Xj(a).variable()})),null==o&&(i.epsilon=cV.backend.epsilon()),i}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Zj((function(){var r=sW(1,t.accBeta1),a=sW(1,t.accBeta2);n.forEach((function(n,i){var o=cV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Zj((function(){return Kj(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:Zj((function(){return Kj(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=Vj(Hj(u,t.beta1),Hj(s,1-t.beta1)),h=Vj(Hj(c,t.beta2),Hj(qj(s),1-t.beta2)),f=Wj(l,r),d=Wj(h,a);u.assign(l),c.assign(h);var p=Vj(Hj(Wj(f,Vj(Gj(d),t.epsilon)),-t.learningRate),o);o.assign(p)}})),t.accBeta1.assign(Hj(t.accBeta1,t.beta1)),t.accBeta2.assign(Hj(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&zj(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&zj(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(d(this.accumulatedFirstMoment),d(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){var n,r=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Zj((function(){r.accBeta1.assign(oW(r.beta1,r.iterations_+1)),r.accBeta2.assign(oW(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(nW);var cW=bV({abs_:function(e){var t=mV(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return cV.runKernel(vZ,n)}var r={x:t};return cV.runKernel(VL,r)}});function lW(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function hW(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function fW(e,t){for(var n=Math.max(e.length,t.length),r=new Array(n),a=0;a<n;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)r[n-a-1]=o;else if(1===o)r[n-a-1]=i;else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}r[n-a-1]=i}}return r}var dW=bV({maximum_:function(e,t){var n=mV(e,"a","maximum"),r=mV(t,"b","maximum"),a=l(eV(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Mj(n,"int32"),r=Mj(r,"int32")),fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(kz,i)}}),pW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,p.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Zj((function(){i.iteration=Xj(0).variable(),i.accBeta1=Xj(r).variable()})),null==o&&(i.epsilon=cV.backend.epsilon()),i}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Zj((function(){var r=sW(1,t.accBeta1),a=Wj(-t.learningRate,Vj(Hj(t.iteration,t.decay),1));n.forEach((function(n,i){var o=cV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Kj(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:Kj(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=Vj(Hj(u,t.beta1),Hj(s,1-t.beta1)),h=Hj(c,t.beta2),f=cW(s),d=dW(h,f);u.assign(l),c.assign(d);var p=Vj(Hj(Wj(a,r),Wj(l,Vj(d,t.epsilon))),o);o.assign(p)}})),t.iteration.assign(Vj(t.iteration,1)),t.accBeta1.assign(Hj(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&zj(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&zj(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(nW),vW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);n.forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=cV.registeredVariables[n];Zj((function(){var e=Vj(Hj(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Bj(Xj(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(nW),gW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,p.Z)(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Xj(a.momentum),a}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=cV.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Zj((function(){return Kj(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Zj((function(){var e,n=Vj(Hj(t.m,i),o);e=t.useNesterov?Vj(Hj(t.c,Vj(o,Hj(n,t.m))),a):Vj(Hj(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&zj(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(vW),mW=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,p.Z)(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=cV.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return(0,v.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=cV.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Zj((function(){return Kj(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Zj((function(){return Kj(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Zj((function(){return Kj(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;Zj((function(){var e=Vj(Hj(s,t.decay),Hj(qj(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Vj(Hj(n,t.decay),Hj(o,1-t.decay)),c=Wj(Hj(o,t.learningRate),Gj(sW(e,Vj(qj(i),t.epsilon)))),l=Vj(Hj(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var h=sW(a,l);a.assign(h)}else{var f=Vj(Hj(s,t.decay),Hj(qj(o),1-t.decay)),d=Vj(Hj(u,t.momentum),Wj(Hj(o,t.learningRate),Gj(Vj(f,t.epsilon))));s.assign(f),u.assign(d);var p=sW(a,d);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&zj(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&zj(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&zj(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(d(this.accumulatedMeanSquares),d(this.accumulatedMoments)),this.centered&&t.push.apply(t,d(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(nW),yW=[rW,iW,uW,pW,gW,mW,vW];function bW(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var kW=function(){function e(t){if((0,p.Z)(this,e),!LL().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return(0,v.Z)(e,[{key:"save",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=SV.join(t.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=8;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 8:return a=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i=PV(t,a),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(s=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,s.href=o,e.next=16,bW((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 16:if(null==t.weightData){e.next=22;break}return(u=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=r,e.next=22,bW((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 22:return e.abrupt("return",{modelArtifactsInfo:BV(t)});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();kW.URL_SCHEME="downloads://";var xW=function(){function e(t){if((0,p.Z)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return(0,v.Z)(e,[{key:"load",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=ZV(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=(0,C.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,d(o.weights)),a.push.apply(a,d(o.paths))}}catch(kve){i.e(kve)}finally{i.f()}var s=this.checkManifestAndWeightFiles(e),u=a.map((function(e){return n.loadWeightsFile(e,s[e])}));return Promise.all(u).then((function(e){return[r,e]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return FV(e.name)})),i={},o=(0,C.Z)(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=FV(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(kve){o.e(kve)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function wW(e){return new xW(e)}function IW(e,t,n,r){!function(e){rL(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){rL(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),rL(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),rL(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function SW(e,t){return CW.apply(this,arguments)}function CW(){return(CW=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l,h;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?LL().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,IW(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,IW(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return h=e.t1,e.abrupt("return",h);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _W(e){return TW.apply(this,arguments)}function TW(){return TW=Rt(Dt().mark((function e(t){var n,r,a,i,o=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=EW((function(e){return SW(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),TW.apply(this,arguments)}function EW(e){return function(){var t=Rt(Dt().mark((function t(n){var r,a,i,o,s,u,c,l,h,f,d,p,v=arguments;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=IV[r]*oL(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=15,e(h);case 15:return f=t.sent,d={},p=0,l.forEach((function(e){var t=n[e].paths.length,r=new SV(f.slice(p,p+t));o[e].forEach((function(e){var t=EV(r.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]})),p+=t})),t.abrupt("return",d);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}jV.registerSaveRouter((function(e){return LL().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(kW.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new kW(e)}(e.slice(kW.URL_SCHEME.length)):null}));var NW=function(){function e(t,n){if((0,p.Z)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(rL("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=LL().platform.fetch,rL(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&rL(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return(0,v.Z)(e,[{key:"save",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=PV(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&(i=SV.join(t.weightData),n.body.append("model.weights.bin",new Blob([i],{type:"application/octet-stream"}),"model.weights.bin")),e.next=10,this.fetch(this.path,n);case 10:if(!(o=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:BV(t),responses:[o]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",ZV(n,(function(e){return o.loadWeights(e)})));case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u,c,h,f,p,v,g,m,y,b;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=DW(n),a=l(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=UV(t),c=[],h=[],f=(0,C.Z)(t);try{for(f.s();!(p=f.n()).done;){v=p.value,g=(0,C.Z)(v.paths);try{for(g.s();!(m=g.n()).done;)y=m.value,null!=this.weightUrlConverter?h.push(this.weightUrlConverter(y)):c.push(s+y+o)}catch(kve){g.e(kve)}finally{g.f()}}}catch(kve){f.e(kve)}finally{f.f()}if(!this.weightUrlConverter){e.next=17;break}return e.t0=c.push,e.t1=c,e.t2=d,e.next=14,Promise.all(h);case 14:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 17:return e.next=19,SW(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return b=e.sent,e.abrupt("return",[u,b]);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function DW(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function AW(e){return null!=e.match(NW.URL_SCHEME_REGEX)}NW.URL_SCHEME_REGEX=/^https?:\/\//;var RW=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return AW(e)})):AW(e))?MW(e,t):null};function MW(e,t){return new NW(e,t)}function OW(e,t){return MW(e,t)}jV.registerSaveRouter(RW),jV.registerLoadRouter(RW);var FW=function(){function e(t){(0,p.Z)(this,e),this.modelArtifacts=t}return(0,v.Z)(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),PW=function(){function e(t){(0,p.Z)(this,e),this.saveHandler=t}return(0,v.Z)(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),LW=(0,v.Z)((function e(t){(0,p.Z)(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function ZW(e,t,n,r){var a=arguments;return new LW(zW.apply(void 0,d(a)))}function zW(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new FW(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new FW({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new FW({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function BW(e){return new PW(e)}function UW(e){return new PW(e)}var VW=-2,jW=-1;function WW(e,t,n){var r=e.shape.length;rL(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),rL(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){rL(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function HW(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function GW(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function qW(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function KW(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(d(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){rL(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(d(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(rL(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function YW(e,t,n,r,a,i,o,s,u){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,h={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u},f=0;f<h.dims;f++)l&&0!==(1<<f&s)&&h.numAddAxisAfterEllipsis++,1<<f&o&&(l=!0);l||(h.ellipsisMask|=1<<h.dims,h.dims++);var d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(VW),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(jW),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(h,d);for(var p=!0,v=!0,g=!0,m=[],y=[],b=0;b<e.length;++b){if(0===d.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var k=!!(d.shrinkAxisMask&1<<b),x=e[b];if(-1!==x){var w=[d.beginMask&1<<b,d.endMask&1<<b],I=[d.strides[b]>0?0:-1,d.strides[b]>0?x:x-1];if(k&&d.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===d.strides[b];var S=!!(d.beginMask&1<<b&&d.endMask&1<<b);if(d.beginValid&&d.endValid){if(k){var C=d.begin[b]<0?x+d.begin[b]:d.begin[b];if(d.begin[b]=C,d.end[b]=d.begin[b]+1,C<0||C>=x)throw Error("slice index ".concat(d.begin[b]," of dimension ").concat(b," out of bounds."))}else d.begin[b]=XW(d.begin[b],0,d.strides[b],x,w,I),d.end[b]=XW(d.end[b],1,d.strides[b],x,w,I);var _=1===d.strides[b]&&0===d.begin[b]&&d.end[b]===x;p=p&&_,v=v&&(0===b&&1===d.strides[b]||_)}else p=p&&1===d.strides[b]&&S,v=v&&(0===b&&1===d.strides[b]||S);var T=void 0,E=!1;if(d.beginValid&&d.endValid?(T=d.end[b]-d.begin[b],E=!0):k?(T=1,E=!0):S&&x>=0&&(T=d.strides[b]<0?-x:x,E=!0),E){var N=void 0;N=0===T||T<0!==d.strides[b]<0?0:Math.trunc(T/d.strides[b])+(T%d.strides[b]!==0?1:0),m.push(N)}else m.push(-1)}else m.push(k?1:-1)}for(var D=0;D<d.finalShapeGatherIndices.length;++D){var A=d.finalShapeGatherIndices[D];A>=0?y.push(m[A]):A===VW&&y.push(1)}var R=y.filter((function(e,t){return d.finalShapeGatherIndices[t]!==VW}));return{finalShapeSparse:R,finalShape:y,isIdentity:p,sliceDim0:v,isSimpleSlice:g,begin:d.begin,end:d.end,strides:d.strides}}function XW(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}var QW=bV({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:mV(e,"x","all","bool")},a={axis:t,keepDims:n};return cV.runKernel(qL,r,a)}});var JW=bV({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:mV(e,"x","any","bool")},a={axis:t,keepDims:n};return cV.runKernel(KL,r,a)}});var $W=bV({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:mV(e,"x","argMax")},r={axis:t};return cV.runKernel(YL,n,r)}});function eH(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3];return rH(e,[].concat(d(t),[o]),n,i,r,null,null,dH(a))}function tH(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=l(oH(t),2),c=u[0],h=u[1];if("channelsLast"===s)o=[c,h,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[c,h,e[1],e[1]]}return rH(e,o,n,r,a,i,!1,s)}function nH(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=l(sH(t),3),h=c[0],f=c[1],d=c[2];if("NDHWC"===u)s="channelsLast",o=[h,f,d,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,f,d,e[1],e[1]]}return aH(e,o,n,r,a,!1,s,i)}function rH(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,h=-1,f=-1;if("channelsLast"===s){var d=l(e,4);u=d[0],c=d[1],h=d[2],f=d[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var p=l(e,4);u=p[0],f=p[1],c=p[2],h=p[3]}var v,g=l(t,4),m=g[0],y=g[1],b=g[3],k=l(oH(n),2),x=k[0],w=k[1],I=l(oH(r),2),S=I[0],C=I[1],_=uH(m,S),T=uH(y,C),E=function(e,t,n,r,a,i,o,s,u){var c,l,h;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=iH(e,t,n));var i=e[0],o=e[1],s=cH((i-t+2*r)/n+1,a),u=cH((o-t+2*r)/n+1,a);return[s,u]}([t,n],i,r,e,s);l=f[0],h=f[1]}else if("same"===e){l=Math.ceil(t/r),h=Math.ceil(n/a);var d=Math.max(0,(l-1)*r+i-t),p=Math.max(0,(h-1)*a+o-n),v=Math.floor(d/2),g=d-v,m=Math.floor(p/2);c={top:v,bottom:g,left:m,right:p-m,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],k="channelsLast"===u?e[2][0]:e[3][0],x="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:k,right:x,type:0===y&&0===b&&0===k&&0===x?"VALID":"EXPLICIT"},l=cH((t-i+y+b)/r+1,s),h=cH((n-o+k+x)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}(a,c,h,x,w,_,T,i,s),N=E.padInfo,D=E.outHeight,A=E.outWidth,R=o?b*f:b;return"channelsFirst"===s?v=[u,R,D,A]:"channelsLast"===s&&(v=[u,D,A,R]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:h,inChannels:f,outHeight:D,outWidth:A,outChannels:R,padInfo:N,strideHeight:x,strideWidth:w,filterHeight:m,filterWidth:y,effectiveFilterHeight:_,effectiveFilterWidth:T,dilationHeight:S,dilationWidth:C,inShape:e,outShape:v,filterShape:t}}function aH(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,h=-1,f=-1,d=-1;if("channelsLast"===o){var p=l(e,5);u=p[0],c=p[1],h=p[2],f=p[3],d=p[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var v=l(e,5);u=v[0],d=v[1],c=v[2],h=v[3],f=v[4]}var g,m=l(t,5),y=m[0],b=m[1],k=m[2],x=m[4],w=l(sH(n),3),I=w[0],S=w[1],C=w[2],_=l(sH(r),3),T=_[0],E=_[1],N=_[2],D=uH(y,T),A=uH(b,E),R=uH(k,N),M=function(e,t,n,r,a,i,o,s,u,c,l){var h,f,d,p;"valid"===e&&(e=0);if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=iH(e,t[0],r[0]));for(var o=[0,0,0,n],s=0;s<3;s++)e[s]+2*a>=t[s]&&(o[s]=cH((e[s]-t[s]+2*a)/r[s]+1,i));return o}([t,n,r,1],[s,u,c],1,[a,i,o],e,l);f=v[0],d=v[1],p=v[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var g=((f=Math.ceil(t/a))-1)*a+s-t,m=((d=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(g/2),k=g-b,x=Math.floor(m/2),w=m-x,I=Math.floor(y/2);h={top:x,bottom:w,left:I,right:y-I,front:b,back:k,type:"SAME"}}return{padInfo:h,outDepth:f,outHeight:d,outWidth:p}}(a,c,h,f,I,S,C,D,A,R,s),O=M.padInfo,F=M.outDepth,P=M.outHeight,L=M.outWidth,Z=i?x*d:x;return"channelsFirst"===o?g=[u,Z,F,P,L]:"channelsLast"===o&&(g=[u,F,P,L,Z]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:h,inWidth:f,inChannels:d,outDepth:F,outHeight:P,outWidth:L,outChannels:Z,padInfo:O,strideDepth:I,strideHeight:S,strideWidth:C,filterDepth:y,filterHeight:b,filterWidth:k,effectiveFilterDepth:D,effectiveFilterHeight:A,effectiveFilterWidth:R,dilationDepth:T,dilationHeight:E,dilationWidth:N,inShape:e,outShape:g,filterShape:t}}function iH(e,t,n){var r=uH(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)}function oH(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function sH(e){return"number"===typeof e?[e,e,e]:e}function uH(e,t){return t<=1?e:e+(e-1)*(t-1)}function cH(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function lH(e){var t=l(oH(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function hH(e,t){return lH(e)||lH(t)}function fH(e){return oH(e).every((function(e){return e>0}))}function dH(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function pH(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)rL(uL(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){rL(uL(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}var vH=bV({reshape_:function(e,t){var n={x:mV(e,"x","reshape","string_or_numeric")},r={shape:t};return cV.runKernel(Jz,n,r)}});var gH=bV({avgPool_:function(e,t,n,r,a){var i=mV(e,"x","avgPool","float32");rL(hH(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=vH(i,[1,i.shape[0],i.shape[1],i.shape[2]])),rL(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),pH("avgPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=cV.runKernel(nZ,u,c);return l=Mj(l,i.dtype),s?vH(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var mH=bV({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=mV(e,"x","avgPool3d","float32"),s=o,u=!1;4===o.rank&&(u=!0,s=vH(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),rL(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),rL("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),rL("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),pH("avgPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=cV.runKernel(aZ,c,l);return h=Mj(h,s.dtype),u?vH(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var yH=bV({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=mV(e,"x","batchNorm"),c=mV(t,"mean","batchNorm"),l=mV(n,"variance","batchNorm");null!=a&&(o=mV(a,"scale","batchNorm")),null!=r&&(s=mV(r,"offset","batchNorm")),rL(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),rL(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),rL(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(e){return 0===e.rank||1===e.rank?vH(e,[1,1,1,e.size]):2===e.rank?vH(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?vH(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),f={x:h,scale:o,offset:s,mean:c,variance:l},d={varianceEpsilon:i},p=cV.runKernel(QZ,f,d);return vH(p,u.shape)}});var bH=bV({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=mV(e,"x","batchNorm"),c=mV(t,"mean","batchNorm"),l=mV(n,"variance","batchNorm");return null!=a&&(o=mV(a,"scale","batchNorm")),null!=r&&(s=mV(r,"offset","batchNorm")),rL(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),rL(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),rL(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&rL(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&rL(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),yH(u,c,l,s,o,i)}});var kH=bV({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=mV(e,"x","batchNorm"),c=mV(t,"mean","batchNorm"),l=mV(n,"variance","batchNorm");return null!=a&&(o=mV(a,"scale","batchNorm")),null!=r&&(s=mV(r,"offset","batchNorm")),rL(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),rL(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),rL(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&rL(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&rL(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),yH(u,c,l,s,o,i)}});var xH=bV({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=mV(e,"x","batchNorm"),c=mV(t,"mean","batchNorm"),l=mV(n,"variance","batchNorm");return null!=a&&(o=mV(a,"scale","batchNorm")),null!=r&&(s=mV(r,"offset","batchNorm")),rL(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),rL(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),rL(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&rL(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&rL(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),yH(u,c,l,s,o,i)}});var wH=bV({broadcastTo_:function(e,t){var n=mV(e,"broadcastTo","x"),r=n.shape;if(DL(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=vH(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));if(0===o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return Oj(n);var u={x:n},c={reps:o};return cV.runKernel(ZB,u,c)}});var IH=bV({clipByValue_:function(e,t,n){var r=mV(e,"x","clipByValue");if(rL(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return aW(r.shape,t,r.dtype);var a={x:r},i={clipValueMin:t,clipValueMax:n};return cV.runKernel(dZ,a,i)}});var SH=bV({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;rL(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=yV(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Oj(n[0]);var r=n,a={axis:t};return cV.runKernel(gZ,r,a)}});var CH=bV({concat1d_:function(e){return SH(e,0)}});var _H=bV({concat2d_:function(e,t){return SH(e,t)}});var TH=bV({concat3d_:function(e,t){return SH(e,t)}});var EH=bV({concat4d_:function(e,t){return SH(e,t)}});var NH=bV({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=mV(e,"x","conv2d","float32"),u=mV(t,"filter","conv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=vH(s,[1,s.shape[0],s.shape[1],s.shape[2]])),rL(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),rL(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),pH("conv2d",r,o);var h="NHWC"===a?c.shape[3]:c.shape[1];rL(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),rL(hH(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),rL(fH(i),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),rL(fH(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var f={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=cV.runKernel(mZ,f,d);return l?vH(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var DH=bV({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=mV(e,"x","conv1d"),u=mV(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=vH(s,[1,s.shape[0],s.shape[1]])),rL(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),rL(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),pH("conv1d",r,o),rL(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),rL(hH(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),rL(fH(i),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),rL(fH(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),rL("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=vH(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=vH(c,[c.shape[0],1,c.shape[1],c.shape[2]]),d=NH(f,h,[1,n],r,"NHWC",[1,i],o);return vH(d,l?[d.shape[2],d.shape[3]]:[d.shape[0],d.shape[2],d.shape[3]])}});var AH=bV({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;rL(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=vH(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),rL(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),rL(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),rL(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],h="NHWC"===i?u.shape[3]:u.shape[1];rL(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),rL(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),pH("conv2dDerInput",a,o);var f={dy:u,filter:n},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},p=cV.runKernel(bZ,f,d);return c?vH(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var RH=bV({conv2dTranspose_:function(e,t,n,r,a,i){var o=mV(e,"x","conv2dTranspose"),s=mV(t,"filter","conv2dTranspose");return AH(n,o,s,r,a,"NHWC",i)}});var MH=bV({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=mV(e,"x","conv3d"),s=mV(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=vH(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),rL(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),rL(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),rL(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),rL(hH(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),rL("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),rL(fH(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),rL(fH(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:u,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},f=cV.runKernel(kZ,l,h);return c?vH(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var OH=bV({conv3DBackpropInput_:function(e,t,n,r,a){rL(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=vH(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];rL(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),rL(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),rL(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),rL(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),rL(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},f=cV.runKernel(wZ,l,h);return s?vH(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var FH=bV({conv3dTranspose_:function(e,t,n,r,a){var i=mV(e,"x","conv3dTranspose"),o=mV(t,"filter","conv3dTranspose");return OH(n,i,o,r,a)}});var PH=bV({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=mV(e,"x","denseBincount"),i=mV(t,"weights","denseBincount");rL("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),rL(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),rL(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),rL(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},s={size:n,binaryOutput:r};return cV.runKernel(EZ,o,s)}});var LH=bV({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=mV(e,"x","depthwiseConv2d","float32"),u=mV(t,"filter","depthwiseConv2d","float32"),c=s,l=!1;3===s.rank&&(l=!0,c=vH(s,[1,s.shape[0],s.shape[1],s.shape[2]])),rL(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),rL(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")}));var h="NHWC"===a?c.shape[3]:c.shape[1];rL(h===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),pH("depthwiseConv2d",r,o);var f={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=cV.runKernel(DZ,f,d);return l?vH(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var ZH=bV({elu_:function(e){var t={x:mV(e,"x","elu","float32")};return cV.runKernel(zZ,t)}});var zH=bV({equal_:function(e,t){var n=mV(e,"a","equal","string_or_numeric"),r=mV(t,"b","equal","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(VZ,i)}});var BH=bV({exp_:function(e){var t={x:mV(e,"x","exp")};return cV.runKernel(jZ,t)}});var UH=bV({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=mV(e,"x","expandDims","string_or_numeric");rL(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return cV.runKernel(WZ,r,a)}});var VH=bV({tile_:function(e,t){var n=mV(e,"x","tile","string_or_numeric");rL(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return cV.runKernel(ZB,r,a)}});var jH=bV({eye_:function(e,t,n){null==t&&(t=e);for(var r=Rj([e,t],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=e<=t?e:t,i=0;i<a;++i)r.set(1,i,i);var o=vH(r.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return VH(UH(o,0),[n[0],1,1]);if(2===n.length)return VH(UH(UH(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return VH(UH(UH(UH(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var WH=bV({floor_:function(e){var t={x:mV(e,"x","floor","float32")};return cV.runKernel(YZ,t)}});var HH=bV({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a={x:mV(e,"x","gather"),indices:mV(t,"indices","gather","int32")},i={axis:n,batchDims:r};return cV.runKernel(JZ,a,i)}});var GH=bV({greater_:function(e,t){var n=mV(e,"a","greater","string_or_numeric"),r=mV(t,"b","greater","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(ez,i)}});var qH=bV({greaterEqual_:function(e,t){var n=mV(e,"a","greaterEqual","string_or_numeric"),r=mV(t,"b","greaterEqual","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(tz,i)}});var KH=bV({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n={x:mV(e,"x","leakyRelu")},r={alpha:t};return cV.runKernel(uz,n,r)}});var YH=bV({log_:function(e){var t={x:mV(e,"x","log","float32")};return cV.runKernel(fz,t)}});var XH=bV({log1p_:function(e){var t={x:mV(e,"x","log1p")};return cV.runKernel(dz,t)}});var QH=bV({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:mV(e,"x","max")},a={reductionIndices:t,keepDims:n};return cV.runKernel(bz,r,a)}});var JH=bV({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=mV(e,"x","sum");"bool"===r.dtype&&(r=Mj(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return cV.runKernel(bB,a,i)}});var $H=bV({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=mV(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=Yj((function(e,n){var r=QH(e,t,!0),a=sW(e,r),i=sW(Mj(a,"float32"),YH(JH(BH(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=l(n,1)[0],a=BH(r);return sW(e,Hj(JH(e,t,!0),a))}}}));return r(n)}});var eG=bV({logicalAnd_:function(e,t){var n=mV(e,"a","logicalAnd","bool"),r=mV(t,"b","logicalAnd","bool");fW(n.shape,r.shape);var a={a:n,b:r};return cV.runKernel(pz,a)}});var tG=bV({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=mV(e,"a","matMul"),i=mV(t,"b","matMul"),o=l(eV(a,i),2),s={a:a=o[0],b:i=o[1]},u={transposeA:n,transposeB:r};return cV.runKernel(oZ,s,u)}});var nG=bV({maxPool_:function(e,t,n,r,a){var i=mV(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=vH(i,[1,i.shape[0],i.shape[1],i.shape[2]])),rL(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),rL(hH(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),pH("maxPool",r,a);var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=cV.runKernel(xz,u,c);return s?vH(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var rG=bV({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=mV(e,"x","maxPool3d"),s=o,u=!1;4===o.rank&&(u=!0,s=vH(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),rL(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),rL("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),pH("maxPool3d",r,a);var c={x:s},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=cV.runKernel(Iz,c,l);return u?vH(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var aG=bV({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:mV(e,"x","mean")},a={axis:t,keepDims:n};return cV.runKernel(_z,r,a)}});var iG=bV({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={x:mV(e,"x","min")},a={axis:t,keepDims:n};return cV.runKernel(Tz,r,a)}});var oG=bV({minimum_:function(e,t){var n=mV(e,"a","minimum"),r=mV(t,"b","minimum"),a=l(eV(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Mj(n,"int32"),r=Mj(r,"int32")),fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(Ez,i)}});function sG(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function uG(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function cG(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function lG(e,t,n){rL(sG(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function hG(e,t){if(sG(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function fG(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function dG(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var pG=bV({moments_:function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=dL(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(e=mV(e,"x","moments")).shape),r=aG(e,n,t),a=r.shape;t||(a=cG(r.shape,n));var i=qj(sW(Mj(e,"float32"),vH(r,a)));return{mean:r,variance:aG(i,n,t)}}});var vG=bV({neg_:function(e){var t={x:mV(e,"x","neg")};return cV.runKernel(Mz,t)}});var gG=bV({notEqual_:function(e,t){var n=mV(e,"a","notEqual","string_or_numeric"),r=mV(t,"b","notEqual","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(Oz,i)}});var mG=bV({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var i={indices:mV(e,"indices","oneHot","int32")},o={dtype:a,depth:t,onValue:n,offValue:r};return cV.runKernel(zz,i,o)}});function yG(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(DL(e),"complex64"===t){var n=yG(e,"float32"),r=yG(e,"float32");return kV(n,r)}var a=EL(oL(e),t);return cV.makeTensor(a,e,t)}function bG(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if(DL(e),"complex64"===t){var n=bG(e,"float32"),r=yG(e,"float32");return kV(n,r)}var a=TL(oL(e),t);return cV.makeTensor(a,e,t)}var kG=bV({onesLike_:function(e){var t={x:mV(e,"x","onesLike")};return cV.runKernel(Zz,t)}});var xG=bV({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=mV(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return cV.runKernel(Uz,i,a)}});var wG=bV({prelu_:function(e,t){var n={x:mV(e,"x","prelu"),alpha:mV(t,"alpha","prelu")};return cV.runKernel(jz,n)}}),IG=n(6699),SG=function(){function e(t,n,r,a,i){(0,p.Z)(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=IG.alea(o.toString())}return(0,v.Z)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),CG=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if((0,p.Z)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=IG.alea(i)}return(0,v.Z)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var _G=bV({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(DL(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new SG(t,n,r,!1,a),o=Rj(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var TG=bV({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;DL(e);for(var i=Rj(e,r),o=new CG(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});function EG(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return cV.runKernel(Kz,{},a)}var NG=bV({relu_:function(e){var t={x:mV(e,"x","relu")};return cV.runKernel(Qz,t)}});var DG=bV({reverse_:function(e,t){var n={x:mV(e,"x","reverse")},r={dims:t};return cV.runKernel(aB,n,r)}});var AG=bV({selu_:function(e){var t={x:mV(e,"x","selu")};return cV.runKernel(hB,t)}});var RG=bV({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=mV(e,"x","separableConv2d"),u=mV(t,"depthwiseFilter","separableConv2d"),c=mV(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=vH(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");rL(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),rL(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),rL(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),rL(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),rL(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var f=u.shape[2],d=u.shape[3];rL(c.shape[2]===f*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(f*d,", ")+"but got ".concat(c.shape[2],".")}));var p=LH(l,u,r,a,o,i),v=NH(p,c,1,"valid",o);return h?vH(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});var MG=bV({sigmoid_:function(e){var t={x:mV(e,"x","sigmoid","float32")};return cV.runKernel(gB,t)}});var OG=bV({slice_:function(e,t,n){var r=mV(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return cV.runKernel(fB,a,i)}});var FG=bV({slice1d_:function(e,t,n){var r=mV(e,"x","slice1d");return rL(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),OG(r,[t],[n])}});var PG=bV({slice2d_:function(e,t,n){var r=mV(e,"x","slice2d");return rL(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),OG(r,t,n)}});var LG=bV({slice3d_:function(e,t,n){var r=mV(e,"x","slice3d");return rL(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),OG(r,t,n)}});var ZG=bV({slice4d_:function(e,t,n){var r=mV(e,"x","slice4d");return rL(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),OG(r,t,n)}});var zG=bV({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=mV(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return cV.runKernel(wB,r,a)}});var BG=bV({softplus_:function(e){var t={x:mV(e,"x","softplus")};return cV.runKernel(mB,t)}});var UG=bV({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r={x:mV(e,"x","split")},a={numOrSizeSplits:t,axis:n};return cV.runKernel(xB,r,a)}});var VG=bV({squeeze_:function(e,t){var n=mV(e,"x","squeeze","string_or_numeric");return vH(n,pL(n.shape,t).newShape)}});var jG=bV({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=yV(e,"tensors","stack","string_or_numeric");rL(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&rL(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return cV.runKernel(Bz,r,a)}});var WG=bV({tanh_:function(e){var t={x:mV(e,"x","tanh","float32")};return cV.runKernel(LB,t)}});function HG(e,t){iL(e);var n=pV(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return xV(e,null,n,t)}function GG(e,t,n){if(iL(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=pV(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return xV(e,t,r,n)}var qG=bV({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(DL(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new SG(t,n,r,!0,a),o=Rj(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var KG=bV({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=mV(e,"x","unstack","string_or_numeric");rL(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return cV.runKernel(jB,r,a)}});var YG=bV({where_:function(e,t,n){var r=mV(t,"a","where"),a=mV(n,"b","where"),i=mV(e,"condition","where","bool"),o=fW(fW(i.shape,r.shape),a.shape),s={condition:wH(i,o),t:wH(r,o),e:wH(a,o)};return cV.runKernel(lB,s)}});var XG=bV({imag_:function(e){var t={input:mV(e,"input","imag")};return cV.runKernel(az,t)}});var QG=bV({real_:function(e){var t={input:mV(e,"input","real")};return cV.runKernel(Yz,t)}});var JG=bV({transpose_:function(e,t,n){var r=mV(e,"x","transpose");if(null==t&&(t=r.shape.map((function(e,t){return t})).reverse()),rL(r.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){rL(e>=0&&e<r.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(t)}))})),r.rank<=1)return r.clone();var a={x:r},i={perm:t};return"complex64"===r.dtype?Zj((function(){var e=QG(r),t=XG(r);return e=cV.runKernel(UB,{x:e},i),t=cV.runKernel(UB,{x:t},i),n&&(t=vG(t)),kV(e,t)})):cV.runKernel(UB,a,i)}});var $G=bV({dropout_:function(e,t,n,r){var a=mV(e,"x","dropout");if(rL("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),rL(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof UU?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(sL(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=Wj(WH(Vj(TG(i,0,1,"float32",r),o)),o);return Hj(a,s)}});var eq=bV({fft_:function(e){rL("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return cV.runKernel(GZ,t)}});var tq=bV({rfft_:function(e,t){rL("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=OG(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=SH([e,yG(s)],e.shape.length-1),r=t}else n=e;var u=Kj(n),c=vH(kV(n,u),[a,r]),l=eq(c),h=Math.floor(r/2)+1,f=QG(l),d=XG(l),p=UG(f,[h,r-h],f.shape.length-1),v=UG(d,[h,r-h],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,vH(kV(p[0],v[0]),g)}});var nq=bV({ifft_:function(e){rL("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return cV.runKernel(rz,t)}});var rq=bV({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=vH(e,[r,n]);t=nq(a)}else{var i=[r,2*(n-1)],o=vH(QG(e),[r,n]),s=vH(XG(e),[r,n]),u=DG(OG(o,[0,1],[r,n-2]),1),c=Hj(DG(OG(s,[0,1],[r,n-2]),1),Xj(-1)),l=SH([o,u],1),h=SH([s,c],1),f=vH(kV(l,h),[i[0],i[1]]);t=nq(f)}if(t=QG(t),3===e.rank&&0!==e.shape[0]){var d=t,p=e.shape[0];t=vH(t,[p,t.shape[0]/p,t.shape[1]]),d.dispose()}return t}});var aq=bV({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=vH(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=vH(t,[1,t.shape[0],t.shape[1],t.shape[2]])),rL(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),rL(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),rL(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];rL(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),rL(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),pH("conv2dDerFilter",a,o);var h={x:s,dy:u},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return cV.runKernel(yZ,h,f)}});var iq=bV({relu6_:function(e){var t={x:mV(e,"x","relu6")};return cV.runKernel(rB,t)}});var oq=bV({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:mV(e,"x","step")},r={alpha:t};return cV.runKernel(GB,n,r)}});function sq(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Hj(e,oq(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function uq(e,t){var n=t,r=hW(e.shape,t.shape);return r.length>0&&(n=JH(n,r)),vH(n,e.shape)}function cq(e,t,n,r){if("linear"===t)return e;if("relu"===t)return NG(e);if("elu"===t)return ZH(e);if("relu6"===t)return iq(e);if("prelu"===t)return wG(e,n);if("leakyrelu"===t)return KH(e,r);if("sigmoid"===t)return MG(e);throw new Error("Unknown fused activation ".concat(t,"."))}var lq=function(e,t){return!(e>0)||"linear"===t};var hq=bV({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,h=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights,v=e.leakyreluAlpha;if(d=d||"linear",!1===lq(cV.state.gradientDepth,d)){rL("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var g=NH(t,n,r,a,o,u,c);return null!=h&&(g=Vj(g,h)),cq(g,d,p,v)}var m=mV(t,"x","conv2d","float32"),y=mV(n,"filter","conv2d","float32"),b=m,k=!1;3===m.rank&&(k=!0,b=vH(m,[1,m.shape[0],m.shape[1],m.shape[2]])),rL(4===b.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(b.rank,".")})),rL(4===y.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(y.rank,".")})),pH("fused conv2d",a,c);var x="NHWC"===o?b.shape[3]:b.shape[1];rL(y.shape[2]===x,(function(){return"Error in conv2d: depth of input (".concat(x,") must match ")+"input depth for filter ".concat(y.shape[2],".")})),rL(hH(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")}));var w,I,S=rH(b.shape,y.shape,r,u,a,c);if(null!=h){var C=l(eV(w=mV(h,"bias","fused conv2d"),m),1);w=C[0],"NHWC"===o?fW(S.outShape,w.shape):(rL(w.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(w.shape.length,".")})),rL(0===w.shape.length||w.shape[0]===S.outChannels||1===w.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(w.shape,") is not ")+"compatible with the number of output channels "+"(".concat(S.outChannels,")")})))}if(null!=p){var _=p.shape;if(rL(_.length<=1||3===_.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(_.length,".")})),1===_.length)rL(1===_[0]||_[0]===S.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(_,") is not compatible with the number of output ")+"channels (".concat(S.outChannels,").")}));else if(3===_.length)try{fW(_,S.outShape)}catch(M){var T="Error in fused conv2d: PReLU activation weights (".concat(_,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(S.outShape,").");throw Error(T)}I=mV(p,"prelu weights","fused conv2d")}var E=function(e,t){rL("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=l(t,4),i=n[0],s=n[1],c=n[2],h=n[3],f=sq(e,c,d);rL(lH(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var p=[AH(s.shape,f,i,r,a),aq(s,f,i.shape,r,a)];if(null!=h){var v=uq(h,f);p.push(v)}return p},N={x:b,filter:y,bias:w,preluActivationWeights:I},D={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:d,leakyreluAlpha:v};if(null==h){var A=Yj((function(e,t,n){var r=cV.runKernel(YB,N,D);return n([t,e,r]),k&&(r=vH(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:E}}));return A(b,y)}var R=Yj((function(e,t,n,r){var a=cV.runKernel(YB,N,D);return r([t,e,a,n]),k&&(a=vH(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:E}}));return R(b,y,w)}});var fq=bV({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=vH(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=vH(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return cV.runKernel(AZ,c,l)}});var dq=bV({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=vH(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},h=cV.runKernel(RZ,c,l);return u?vH(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var pq=bV({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,c=void 0===u?"linear":u,h=e.preluActivationWeights,f=e.leakyreluAlpha,d=void 0===f?.2:f;if(!1===lq(cV.state.gradientDepth,c)){var p=tG(t,n,a,o);return null!=s&&(p=Vj(p,s)),cq(p,c,h,d)}var v=mV(t,"a","fused matMul"),g=mV(n,"b","fused matMul"),m=l(eV(v,g),2);v=m[0],g=m[1];var y=a?v.shape[v.rank-2]:v.shape[v.rank-1],b=o?g.shape[g.rank-1]:g.shape[g.rank-2],k=a?v.shape[v.rank-1]:v.shape[v.rank-2],x=o?g.shape[g.rank-2]:g.shape[g.rank-1],w=v.shape.slice(0,-2),I=g.shape.slice(0,-2),S=oL(w),C=oL(I);rL(y===b,(function(){return"Error in fused matMul: inner shapes (".concat(y,") and (")+"".concat(b,") of Tensors with shapes ").concat(v.shape," and ")+"".concat(g.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var _,T,E=fW(v.shape.slice(0,-2),g.shape.slice(0,-2)).concat([k,x]),N=vH(v,a?[S,y,k]:[S,k,y]),D=vH(g,o?[C,x,b]:[C,b,x]);null!=s&&(_=l(eV(_=mV(s,"bias","fused matMul"),v),1)[0],fW(E,_.shape)),null!=h&&(T=mV(h,"prelu weights","fused matMul"));var A=function(e,t){var n,r,i=l(t,4),u=i[0],h=i[1],f=i[2],d=i[3],p=sq(vH(e,f.shape),f,c);return a||o?!a&&o?(n=tG(p,h,!1,!1),r=tG(p,u,!0,!1)):a&&!o?(n=tG(h,p,!1,!0),r=tG(u,p,!1,!1)):(n=tG(h,p,!0,!0),r=tG(p,u,!0,!0)):(n=tG(p,h,!1,!0),r=tG(u,p,!0,!1)),null!=s?[n,r,uq(d,p)]:[n,r]},R={a:N,b:D,bias:_,preluActivationWeights:T},M={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:d};if(null==s){var O=Yj((function(e,t,n){var r=cV.runKernel(KB,R,M);return n([e,t,r]),{value:vH(r,E),gradFunc:A}}));return O(N,D)}var F=Yj((function(e,t,n,r){var a=cV.runKernel(KB,R,M);return r([e,t,a,n]),{value:vH(a,E),gradFunc:A}}));return F(N,D,_)}});var vq=bV({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=mV(e,"image","cropAndResize"),s=mV(t,"boxes","cropAndResize","float32"),u=mV(n,"boxInd","cropAndResize","int32"),c=s.shape[0];rL(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),rL(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),rL(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),rL(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),rL(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),rL("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},h={method:a,extrapolationValue:i,cropSize:r};return cV.runKernel(TZ,l,h)}});var gq=bV({flipLeftRight_:function(e){var t=mV(e,"image","flipLeftRight","float32");rL(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return cV.runKernel(KZ,n,{})}});var mq=bV({grayscaleToRGB_:function(e){var t=mV(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];rL(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),rL(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,VH(t,a)}});var yq=bV({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=mV(e,"image","rotateWithOffset","float32");rL(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r};return cV.runKernel(qB,i,o)}});function bq(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),rL(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),rL(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),rL(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),rL(1===t.rank,(function(){return"scores must be a 1D tensor"})),rL(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),rL(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var kq=bV({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=mV(e,"boxes","nonMaxSuppression","float32"),o=mV(t,"scores","nonMaxSuppression","float32"),s=bq(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return cV.runKernel(Fz,{boxes:i,scores:o},u)}});function xq(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||wq)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function wq(e,t){return e>t?1:e<t?-1:0}function Iq(e,t,n,r,a){return _q(e,t,n,r,a,0)}function Sq(e,t,n,r,a,i){return _q(e,t,n,r,a,0,!1,i,!0)}function Cq(e,t,n,r,a,i){return _q(e,t,n,r,a,i,!0)}function _q(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(Nq);for(var h=i>0?-.5/i:0,f=[],p=[];f.length<n&&c.length>0;){var v=c.pop(),g=v.score,m=v.boxIndex,y=v.suppressBeginIndex;if(g<a)break;for(var b=!1,k=f.length-1;k>=y;--k){var x=Tq(e,m,f[k]);if(x>=r){b=!0;break}if(v.score=v.score*Eq(r,h,x),v.score<=a)break}v.suppressBeginIndex=f.length,b||(v.score===g?(f.push(m),p.push(v.score)):v.score>a&&xq(c,v,Nq))}var w=f.length,I=n-w;s&&I>0&&(f.push.apply(f,d(new Array(I).fill(0))),p.push.apply(p,d(new Array(I).fill(0))));var S={selectedIndices:f};return o&&(S.selectedScores=p),u&&(S.validOutputs=w),S}function Tq(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),d=(s-i)*(u-o),p=(h-c)*(f-l);if(d<=0||p<=0)return 0;var v=Math.max(i,c),g=Math.max(o,l),m=Math.min(s,h),y=Math.min(u,f),b=Math.max(m-v,0)*Math.max(y-g,0);return b/(d+p-b)}function Eq(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Nq(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Dq(){return Dq=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=mV(t,"boxes","nonMaxSuppressionAsync"),s=mV(n,"scores","nonMaxSuppressionAsync"),u=bq(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return c=e.sent,l=c[0],h=c[1],f=Iq(l,h,r,a,i),d=f.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",HG(d,"int32"));case 17:case"end":return e.stop()}}),e)}))),Dq.apply(this,arguments)}var Aq=function(e,t,n){return Dq.apply(this,arguments)};var Rq=bV({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=mV(e,"boxes","nonMaxSuppression"),s=mV(t,"scores","nonMaxSuppression"),u=bq(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},h=cV.runKernel(Lz,c,l);return{selectedIndices:h[0],selectedScores:h[1]}}});function Mq(){return Mq=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p,v,g=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.length>3&&void 0!==g[3]?g[3]:.5,i=g.length>4&&void 0!==g[4]?g[4]:Number.NEGATIVE_INFINITY,o=g.length>5&&void 0!==g[5]?g[5]:0,s=mV(t,"boxes","nonMaxSuppressionAsync"),u=mV(n,"scores","nonMaxSuppressionAsync"),c=bq(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return l=e.sent,h=l[0],f=l[1],d=Cq(h,f,r,a,i,o),p=d.selectedIndices,v=d.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:HG(p,"int32"),selectedScores:HG(v)});case 19:case"end":return e.stop()}}),e)}))),Mq.apply(this,arguments)}var Oq=function(e,t,n){return Mq.apply(this,arguments)};var Fq=bV({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=mV(e,"boxes","nonMaxSuppression"),s=mV(t,"scores","nonMaxSuppression"),u=bq(o,s,n,r,a,null),c={boxes:o,scores:s},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i},h=cV.runKernel(Pz,c,l);return{selectedIndices:h[0],validOutputs:h[1]}}});function Pq(){return Pq=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,h,f,d,p,v,g,m,y,b,k,x=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],s=mV(t,"boxes","nonMaxSuppressionAsync"),u=mV(n,"scores","nonMaxSuppressionAsync"),c=bq(s,u,r,a,i,null),h=c.maxOutputSize,f=c.iouThreshold,d=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return p=e.sent,v=l(p,2),g=v[0],m=v[1],y=Sq(g,m,h,f,d,o),b=y.selectedIndices,k=y.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:HG(b,"int32"),validOutputs:Xj(k,"int32")});case 19:case"end":return e.stop()}}),e)}))),Pq.apply(this,arguments)}var Lq=function(e,t,n){return Pq.apply(this,arguments)};var Zq=bV({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=mV(e,"images","resizeBilinear");rL(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),rL(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),rL(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=vH(a,[1,a.shape[0],a.shape[1],a.shape[2]])),l(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=cV.runKernel(tB,s,u);return o?vH(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var zq=bV({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=mV(e,"images","resizeNearestNeighbor");rL(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),rL(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),rL("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),rL(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=vH(a,[1,a.shape[0],a.shape[1],a.shape[2]])),l(t,0);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=cV.runKernel($z,s,u);return o?vH(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var Bq=bV({bincount_:function(e,t,n){var r=mV(e,"x","bincount"),a=mV(t,"weights","bincount");rL("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),rL(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),rL(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return cV.runKernel(uZ,i,o)}});var Uq=bV({lessEqual_:function(e,t){var n=mV(e,"a","lessEqual","string_or_numeric"),r=mV(t,"b","lessEqual","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(lz,i)}});var Vq=bV({round_:function(e){var t={x:mV(e,"x","round")};return cV.runKernel(iB,t)}});var jq=bV({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,u=mV(e,"image","threshold"),c=u.shape[0]*u.shape[1],h=Hj(HG([s]),255);if(rL(3===u.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(u.rank,".")})),rL(3===u.shape[2]||1===u.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(u.shape[2],".")})),rL("int32"===u.dtype||"float32"===u.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(u.dtype,".")})),rL("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===u.shape[2]){var f=l(UG(u,[1,1,1],-1),3);t=f[0],n=f[1],r=f[2];var d=Hj(t,.2989),p=Hj(n,.587),v=Hj(r,.114);a=Vj(Vj(d,p),v)}else a=e;"otsu"===i&&(h=function(e,t){for(var n,r,a,i,o,s,u=HG([-1]),c=HG([0]),l=HG([0]),h=0;h<e.size-1;h++){n=OG(e,0,h+1),r=OG(e,h+1),o=Wj(JH(n),t),s=Wj(JH(r),t);var f=JH(Hj(n,EG(0,n.size)));a=Wj(f,JH(n));var d=aW(r.shape,n.size),p=Vj(EG(0,r.size),d),v=Hj(r,p);i=Wj(JH(v),JH(r));var g=sW(a,i),m=sW(a,i),y=Hj(o,s);l=Hj(Hj(y,g),m);var b=GH(l,c);c=YG(b,l,c),u=YG(b,HG([h]),u)}return u}(Bq(Mj(Vq(a),"int32"),wV([]),256),c));var g=o?Uq(a,h):GH(a,h);return Mj(Hj(g,255),"int32")}});var Wq=bV({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=mV(e,"image","transform","float32"),s=mV(t,"transforms","transform","float32");rL(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),rL(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),rL(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return cV.runKernel(BB,u,c)}});var Hq=bV({less_:function(e,t){var n=mV(e,"a","less","string_or_numeric"),r=mV(t,"b","less","string_or_numeric"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(cz,i)}});var Gq=bV({bandPart_:function(e,t,n){var r=mV(e,"a","bandPart");rL(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a,i,o=r.shape,s=l(r.shape.slice(-2),2),u=s[0],c=s[1];"number"===typeof t?(rL(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),rL(t<=u,(function(){return"bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(u,").")})),a=mV(t<0?u:t,"numLower","bandPart")):(rL("int32"===t.dtype,(function(){return"bandPart(): numLower's dtype must be an int32."})),a=YG(Hq(t,0),u,oG(t,u))),"number"===typeof n?(rL(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")})),rL(n<=c,(function(){return"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,").")})),i=mV(n<0?c:n,"numUpper","bandPart")):(rL("int32"===n.dtype,(function(){return"bandPart(): numUpper's dtype must be an int32."})),i=YG(Hq(n,0),c,oG(n,c)));var h=vH(EG(0,u,1,"int32"),[-1,1]),f=EG(0,c,1,"int32"),d=sW(h,f),p=eG(Uq(d,a),qH(d,vG(i))),v=yG([u,c],r.dtype);return vH(jG(KG(vH(r,[-1,u,c])).map((function(e){return YG(p,e,v)}))),o)}});function qq(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return cW(e);if(1!==e.rank&&null===n)return qq(vH(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return JH(cW(e),n);if(t===1/0)return QH(cW(e),n);if(t===-1/0)return iG(cW(e),n);if("euclidean"===t||2===t)return Gj(JH(oW(cW(e),Xj(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return QH(JH(cW(e),n[0]),n[1]-1);if(t===1/0)return QH(JH(cW(e),n[1]),n[0]);if(t===-1/0)return iG(JH(cW(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Gj(JH(qj(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var Kq=bV({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=qq(e=mV(e,"x","norm"),t,n),i=a.shape;if(r){var o=dL(n,e.shape);i=cG(a.shape,o)}return vH(a,i)}});var Yq=bV({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,rL(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){rL(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}else t=!0,e=UG(e,e.shape[0],0).map((function(e){return VG(e,[0])}));rL(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var i=[],o=e,s=function(e){i.push(cV.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=Hj(JH(Hj(i[n],t)),i[n]);t=sW(t,r)}return Wj(t,Kq(t,"euclidean"))})))},u=0;u<e.length;++u)s(u);return t?jG(i,0):i}});function Xq(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return cV.tidy((function(){rL(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=jH(n),i=Oj(e),o=GG([[1]],[1,1]),s=Oj(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,h=l(cV.tidy((function(){var t=OG(i,[e,e],[n-e,1]),u=Kq(t),c=OG(i,[e,e],[1,1]),l=YG(GH(c,0),GG([[-1]]),GG([[1]])),h=sW(c,Hj(l,u)),f=Wj(t,h);s=1===f.shape[0]?Oj(o):SH([o,OG(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);var d=vG(Wj(tG(l,h),u)),p=OG(i,[e,0],[n-e,r]),v=Hj(d,s),g=JG(s);if(0===e)i=sW(p,tG(v,tG(g,p)));else{var m=sW(p,tG(v,tG(g,p)));i=SH([OG(i,[0,0],[e,r]),m],0)}var y=JG(v),b=OG(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=sW(b,tG(tG(b,s),y));else{var k=sW(b,tG(tG(b,s),y));a=SH([OG(a,[0,0],[n,e]),k],1)}return[s,i,a]})),3);s=h[0],i=h[1],a=h[2],zj([t,u,c])},h=0;h<u;++h)c(h);return!t&&n>r&&(a=OG(a,[0,0],[n,r]),i=OG(i,[0,0],[r,r])),[a,i]}))}var Qq,Jq=bV({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(rL(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return Xq(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=KG(vH(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=l(Xq(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)})),[vH(jG(a,0),e.shape),vH(jG(i,0),e.shape)]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Qq||(Qq={}));var $q=bV({squaredDifference_:function(e,t){var n=mV(e,"a","squaredDifference"),r=mV(t,"b","squaredDifference"),a=l(eV(n,r),2);n=a[0],r=a[1],fW(n.shape,r.shape);var i={a:n,b:r};return cV.runKernel(EB,i,{})}});var eK=bV({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=mV(e,"x","logSumExp"),a=dL(t,r.shape),i=QH(r,a,!0),o=sW(r,i),s=BH(o),u=JH(s,a),c=YH(u),l=Vj(vH(i,c.shape),c);if(n){var h=cG(l.shape,a);return vH(l,h)}return l}});var tK,nK={flipLeftRight:gq,grayscaleToRGB:mq,resizeNearestNeighbor:zq,resizeBilinear:Zq,rotateWithOffset:yq,cropAndResize:vq,nonMaxSuppression:kq,nonMaxSuppressionAsync:Aq,nonMaxSuppressionWithScore:Rq,nonMaxSuppressionWithScoreAsync:Oq,nonMaxSuppressionPadded:Fq,nonMaxSuppressionPaddedAsync:Lq,threshold:jq,transform:Wq},rK={bandPart:Gq,gramSchmidt:Yq,qr:Jq},aK=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"sgd",value:function(e){return new vW(e)}},{key:"momentum",value:function(e,t){return new gW(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}},{key:"rmsprop",value:function(e){return new mW(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}},{key:"adam",value:function(){return new uW(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}},{key:"adadelta",value:function(){return new rW(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"adamax",value:function(){return new pW(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}},{key:"adagrad",value:function(e){return new iW(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}]),e}(),iK=aK,oK="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function sK(){return new Promise((function(e){return oK((function(){return e()}))}))}function uK(e,t){var n=e[0].length;e.forEach((function(e,t){rL(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),rL(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)rL(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function cK(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(tK||(tK={}));var lK=30;function hK(e){return e<=lK?e:IL(e,Math.floor(Math.sqrt(e)))}function fK(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function dK(e,t,n){var r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])(r=r.concat(t.slice(0))).push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);for(var a=t.length,i=0;i<a;++i)r=r.concat([e[i+1]/t[i],t[i]]);r=r.concat(e.slice(a+1))}return r}function pK(e,t){var n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(t);for(var r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{for(var a=[],i=[],o=1;o<e;++o)o>=2*t+1||o%2===1?i.push(o):a.push(o);n.push.apply(n,a),n.push(0),n.push.apply(n,i)}return n}function vK(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function gK(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function mK(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function yK(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===oL(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,h=i;h<n;++h)l*=u[h],c.push(u[h]);var f=[].concat(d(SL(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,f]}function bK(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:oL(t.shape)/u,sliceSize:o,strides:[].concat(d(SL(n.slice(0,a))),[1]),outputSize:oL(n)}}var kK=1.7580993408473768,xK=1.0507009873554805,wK=.3275911,IK=.254829592,SK=-.284496736,CK=1.421413741,_K=-1.453152027,TK=1.061405429;function EK(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function NK(e,t){return{real:e[2*t],imag:e[2*t+1]}}function DK(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function AK(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var RK="->",MK=/->/g,OK=",",FK="...";function PK(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(MK,"").length)/RK.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(RK,'").'));var r=l(e.split(RK),2),a=r[0],i=r[1];rL(-1===a.indexOf(FK),(function(){return'The ellipsis notation ("'.concat(FK,'") is not supported yet.')}));var o=a.split(OK),s=o.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var u=[],c=function(){var e=i[h];if(!o.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===u.indexOf(e)&&u.push(e)},h=0;h<i.length;++h)c();for(var f=0;f<a.length;++f){var d=a[f];-1===u.indexOf(d)&&d!==OK&&u.push(d)}for(var p=new Array(o.length),v=0;v<s;++v){if(new Set(o[v].split("")).size!==o[v].length)throw new Error("Found duplicate axes in input component ".concat(o[v],". ")+"Support for duplicate axes in input is not implemented yet.");p[v]=[];for(var g=0;g<o[v].length;++g)p[v].push(u.indexOf(o[v][g]))}for(var m=u.length,y=[],b=i.length;b<m;++b)y.push(b);return{allDims:u,summedDims:y,idDims:p}}function LK(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function ZK(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:rL(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function zK(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=UK(t,r[s]),l=(0,C.Z)(c);try{for(l.s();!(u=l.n()).done;){var h=u.value;-1===o.indexOf(h)&&(a[s].push(h),o.push(h))}}catch(kve){l.e(kve)}finally{l.f()}}return{path:r,steps:a}}function BK(e){return e.every((function(e,t){return e===t}))}function UK(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function VK(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)rL(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);rL(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}rL(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function jK(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function WK(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function HK(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function GK(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function qK(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function KK(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,h=1,f=0;f<r;++f)u.push(e.shape[f]),c*=e.shape[f];for(var d=r;d<n;d++)u.push(e.shape[d]),l*=e.shape[d];for(var p=r;p<a;p++)u.push(t.shape[p]);for(var v=n+1;v<i;v++)u.push(e.shape[v]),h*=e.shape[v];return{batchSize:c,sliceSize:h,outerSize:l,dimSize:s,outputShape:u}}function YK(e){try{return e.map((function(e){return CU(e)}))}catch(kve){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(kve))}}function XK(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=Rj(e,"int32"),i=Rj([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}!function(){var e,t=(0,C.Z)(yW);try{for(t.s();!(e=t.n()).done;){tW(e.value)}}catch(kve){t.e(kve)}finally{t.f()}}();var QK={kernelName:VL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,oq(Mj(n,"float32"),-1))}}}},JK={kernelName:jL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){var t=qj(Mj(n,"float32")),r=Gj(sW(Xj(1),t));return vG(Wj(e,r))}}}},$K={kernelName:WL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){var t=Gj(sW(qj(Mj(n,"float32")),1));return Wj(e,t)}}}},eY={kernelName:HL,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=e,n=hW(r.shape,i);return n.length>0&&(t=JH(t,n)),vH(t,r.shape)},b:function(){var t=e,n=hW(a.shape,i);return n.length>0&&(t=JH(t,n)),vH(t,a.shape)}}}},tY={kernelName:GL,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},nY={kernelName:YL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Kj(n)}}}},rY={kernelName:XL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Kj(n)}}}},aY={kernelName:QL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,Gj(sW(Xj(1),qj(Mj(n,"float32")))))}}}},iY={kernelName:JL,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){var t=Gj(Vj(Xj(1),qj(Mj(n,"float32"))));return Wj(e,t)}}}},oY={kernelName:tZ,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=Vj(qj(r),qj(a)),n=Hj(e,Wj(a,t)),o=hW(r.shape,i);return o.length>0&&(n=JH(n,o)),vH(n,r.shape)},b:function(){var t=Vj(qj(r),qj(a)),n=vG(Hj(e,Wj(r,t))),o=hW(a.shape,i);return o.length>0&&(n=JH(n,o)),vH(n,a.shape)}}}},sY={kernelName:$L,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,Vj(qj(Mj(n,"float32")),1))}}}},uY={kernelName:eZ,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,sW(Xj(1),qj(Mj(n,"float32"))))}}}};var cY=bV({avgPool3dGrad_:function(e,t,n,r,a,i){var o=mV(e,"dy","avgPool3dGrad"),s=mV(t,"input","avgPool3dGrad"),u=o,c=s,l=!1;4===s.rank&&(l=!0,u=vH(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=vH(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),rL(5===u.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")})),rL(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),pH("avgPool3dGrad",a,i);var h={dy:u,input:c},f={filterSize:n,strides:r,pad:a,dimRoundingMode:i},d=cV.runKernel(iZ,h,f);return l?vH(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),lY={kernelName:aZ,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad,s=n.dimRoundingMode;return{x:function(){return cY(e,r,a,i,o,s)}}}};var hY=bV({avgPoolGrad_:function(e,t,n,r,a){var i=mV(e,"dy","avgPoolGrad"),o=mV(t,"input","avgPoolGrad");rL(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=vH(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=vH(i,[1,i.shape[0],i.shape[1],i.shape[2]])),rL(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),rL(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l={dy:u,input:s},h={filterSize:n,strides:r,pad:a},f=cV.runKernel(rZ,l,h);return c?vH(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),fY={kernelName:nZ,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return hY(e,r,a,i,o)}}}},dY={kernelName:oZ,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return tG(e,i,!1,!1)},b:function(){return tG(e,a,!0,!1)}}:o&&!s?{a:function(){return tG(i,e,!1,!0)},b:function(){return tG(a,e,!1,!1)}}:{a:function(){return tG(i,e,!0,!0)},b:function(){return tG(e,a,!0,!0)}}:{a:function(){return tG(e,i,!1,!0)},b:function(){return tG(a,e,!0,!1)}}}};var pY=bV({spaceToBatchND_:function(e,t,n){var r=mV(e,"x","spaceToBatchND");rL(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),rL(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),rL(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return cV.runKernel(kB,a,i)}}),vY={kernelName:sZ,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return pY(e,r,a)}}}},gY={kernelName:"BroadcastTo",gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],c=0;c<o.length;c++)o[c]>1&&u.push(c);return{x:function(){return JH(e,u,!0)}}}},mY={kernelName:hZ,gradFunc:function(e){return{x:function(){return e.clone()}}}},yY={kernelName:fZ,gradFunc:function(e){return{x:function(){return Kj(e)}}}},bY={kernelName:dZ,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return YG(eG(qH(r,a),Uq(r,i)),e,Kj(e))}}}},kY={kernelName:vZ,inputsToSave:["x"],gradFunc:QK.gradFunc},xY={kernelName:gZ,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=dL(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return UG(e,i,a).map((function(e){return function(){return e}}))}},wY={kernelName:mZ,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return rL(lH(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return AH(a.shape,e,i,s,u,c)},filter:function(){return aq(a,e,i.shape,s,u,c)}}}},IY={kernelName:bZ,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return NH(e,i,o,s,u,1,c)},filter:function(){return aq(e,a,i.shape,o,s,u,c)}}}};var SY=bV({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=vH(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=vH(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),rL(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),rL(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),rL(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),rL(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),rL(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return cV.runKernel(xZ,s,u)}}),CY={kernelName:kZ,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;rL(lH(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=l(t,2),s=o[0],u=o[1];return{x:function(){return OH(s.shape,e,u,a,i)},filter:function(){return SY(s,e,u.shape,a,i)}}}};var _Y=bV({sin_:function(e){var t={x:mV(e,"x","sin","float32")};return cV.runKernel(dB,t)}}),TY={kernelName:IZ,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(vG(_Y(Mj(n,"float32"))),e)}}}};var EY=bV({sinh_:function(e){var t={x:mV(e,"x","sinh")};return cV.runKernel(pB,t)}}),NY={kernelName:SZ,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(EY(Mj(n,"float32")),e)}}}};var DY=bV({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:mV(e,"x","cumsum")},i={axis:t,exclusive:n,reverse:r};return cV.runKernel(_Z,a,i)}}),AY={kernelName:_Z,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=hG([a],r.rank),n=DY(e,a,i,!o);return null!=t&&(n=JG(n,t)),n}}}},RY={kernelName:DZ,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;rL(lH(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=l(t,2),c=u[0],h=u[1];return rL(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),rL(4===h.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(h.rank,".")})),rL(c.shape[3]===h.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(h.shape[2],".")})),rL(hH(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),pH("depthwiseConv2d",i,o),{x:function(){return dq(c.shape,e,h,a,i,s,o)},filter:function(){return fq(c,e,h.shape,a,i,s,o)}}}},MY={kernelName:OZ,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return cV.runKernel(FZ,o,n)},filter:function(){return cV.runKernel(PZ,s,n)}}}},OY={kernelName:zZ,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:l(t,1)[0]};return{x:function(){return cV.runKernel(BZ,n)}}}},FY={kernelName:UZ,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0],r=Hj(BH(vG(qj(n))),2/Math.sqrt(Math.PI));return{x:function(){return Hj(e,r)}}}},PY={kernelName:jZ,outputsToSave:[!0],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,n)}}}},LY={kernelName:WZ,inputsToSave:["input"],gradFunc:function(e,t){var n=l(t,1)[0];return{input:function(){return vH(e,n.shape)}}}},ZY={kernelName:HZ,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,BH(n))}}}},zY={kernelName:YZ,gradFunc:function(e){return{x:function(){return Kj(e)}}}},BY={kernelName:XZ,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=Wj(e,Mj(a,"float32")),n=hW(r.shape,i);return n.length>0?vH(JH(t,n),r.shape):t},b:function(){var t=Hj(e,Mj(r,"float32")),n=hW(a.shape,i);n.length>0&&(t=vH(JH(t,n),a.shape));var o=qj(a);return vG(Wj(t,Mj(o,"float32")))}}}};var UY=bV({rsqrt_:function(e){var t={x:mV(e,"x","rsqrt","float32")};return cV.runKernel(oB,t)}}),VY={kernelName:QZ,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=l(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?Xj(1):u,h=hW(o.shape,i.shape),f=[];if(1===o.rank){for(var d=0;d<i.shape.length-1;++d)f.push(i.shape[d]);f.push(1)}var p=sW(i,o),v=Hj(e,c),g=UY(Vj(s,Xj(r))),m=Hj(Hj(Hj(g,g),g),Xj(-.5));return{x:function(){return 1===o.rank?vH(Hj(Hj(e,VH(vH(g,[1,1,1,o.shape[0]]),f)),c),i.shape):vH(Hj(Hj(e,g),c),i.shape)},mean:function(){var e=Hj(Hj(g,Xj(-1)),v);return 1===o.rank&&(e=JH(e,h)),vH(e,o.shape)},variance:function(){var e=Hj(Hj(m,p),v);return 1===o.rank&&(e=JH(e,h)),vH(e,o.shape)},scale:function(){var t=Hj(p,g),n=Hj(e,t);return 1===o.rank&&(n=JH(n,h)),vH(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=JH(t,h)),vH(t,o.shape)}}}};var jY=bV({unsortedSegmentSum_:function(e,t,n){var r=mV(e,"x","unsortedSegmentSum"),a=mV(t,"segmentIds","unsortedSegmentSum","int32");rL(uL(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return cV.runKernel(WB,i,o)}}),WY={kernelName:JZ,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.axis,s=dL(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,c=t.slice(o,t.length).slice(1),l=c.length,h=HY(0,u),f=HY(u+1,u+1+l),d=GY([r,[n],c]),p=vH(e,d),v=vH(i,[n]),g=GY([[u],h,f]),m=JG(p,g),y=jY(m,v,a.shape[s]),b=fG(g);return y=JG(y,b)},indices:function(){return i}}}};function HY(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function GY(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var qY={kernelName:tz,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1];return{a:function(){return Kj(r)},b:function(){return Kj(a)}}}},KY={kernelName:nz,gradFunc:function(e){return{x:function(){return Mj(e,"float32")}}}},YY={kernelName:iz,gradFunc:function(e){return{x:function(){return Kj(e)}}}},XY={kernelName:oz,gradFunc:function(e){return{x:function(){return Kj(e)}}}},QY={kernelName:sz,gradFunc:function(e){return{x:function(){return Kj(e)}}}},JY={kernelName:uz,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.alpha,i=GH(r,0);return{x:function(){return YG(i,e,Hj(e,a))}}}},$Y={kernelName:dz,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,Vj(n,1))}}}},eX={kernelName:fz,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,Mj(n,"float32"))}}}},tX={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.axis;return{logits:function(){var t=BH(r);return sW(e,Hj(JH(e,a,!0),t))}}}};var nX=bV({localResponseNormalizationBackprop_:function(e,t,n){var r={x:e,y:t,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return cV.runKernel(yz,r,a)}}),rX={kernelName:mz,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return nX(a,i,e,o,s,u,c)}}}};function aX(e,t,n,r){return t.rank<n.rank&&(t=vH(t,cG(t.shape,r))),e.rank<n.rank&&(e=vH(e,cG(e.shape,r))),{x:function(){return Hj(e,Mj(zH(n,t),e.dtype))}}}var iX={kernelName:bz,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=aX(e,t[1],a,dL(r,a.shape));return{x:function(){return i.x()}}}},oX={kernelName:kz,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1];return{a:function(){return Hj(e,Mj(qH(r,a),"float32"))},b:function(){return Hj(e,Mj(Hq(r,a),"float32"))}}}};var sX=bV({maxPool3dGrad_:function(e,t,n,r,a,i,o){var s=mV(e,"dy","maxPool3dGrad"),u=mV(t,"input","maxPool3dGrad"),c=mV(n,"output","maxPool3dGrad"),l=s,h=u,f=c,d=!1;4===u.rank&&(d=!0,l=vH(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=vH(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=vH(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),rL(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),rL(5===h.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")})),rL(5===f.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(f.rank,".")})),pH("maxPool3dGrad",i,o);var p={dy:l,input:h,output:f},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=cV.runKernel(Sz,p,v);return d?vH(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),uX={kernelName:Iz,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad,c=n.dimRoundingMode;return{x:function(){return sX(e,a,i,o,s,u,c)}}}};var cX=bV({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=mV(e,"dy","maxPoolGrad"),u=mV(t,"input","maxPoolGrad"),c=mV(n,"output","maxPoolGrad");rL(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),rL(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),rL(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),pH("maxPoolGrad",i,o);var l={dy:s,input:u,output:c},h={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return cV.runKernel(wz,l,h)}}),lX={kernelName:xz,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=l(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return cX(e,a,i,o,s,u)}}}},hX={kernelName:_z,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=dL(n.axis,r.shape),i=oL(uG(r.shape,a)[1]);return{x:function(){var t=r.shape.slice();a.forEach((function(e){t[e]=1}));var n=vH(e,t);return Wj(Hj(n,bG(r.shape,"float32")),i)}}}},fX={kernelName:Tz,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=l(t,2),i=a[0],o=aX(e,a[1],i,dL(r,i.shape));return{x:function(){return o.x()}}}},dX={kernelName:Ez,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1];return{a:function(){return Hj(e,Mj(Uq(r,a),"float32"))},b:function(){return Hj(e,Mj(GH(r,a),"float32"))}}}},pX={kernelName:Nz,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return OG(e,a,r.shape)}}}},vX={kernelName:Dz,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=hW(r.shape,i);return t.length>0?vH(JH(e,t),r.shape):e},b:function(){var t=Hj(e,vG(WH(Wj(r,a)))),n=hW(a.shape,i);return n.length>0?vH(JH(t,n),a.shape):t}}}},gX={kernelName:Rz,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=Hj(e,Mj(a,"float32")),n=hW(r.shape,i);return n.length>0?vH(JH(t,n),r.shape):t},b:function(){var t=Hj(e,Mj(r,"float32")),n=hW(a.shape,i);return n.length>0?vH(JH(t,n),a.shape):t}}}},mX={kernelName:Mz,gradFunc:function(e){return{x:function(){return vG(e)}}}},yX={kernelName:zz,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return yG(n.shape,"float32")}}}},bX={kernelName:Zz,gradFunc:function(e){return{x:function(){return Kj(e)}}}},kX={kernelName:Bz,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return KG(e,r).map((function(e){return function(){return e}}))}},xX={kernelName:Uz,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return OG(e,a,r.shape)}}}},wX={kernelName:Vz,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=l(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=fW(o.shape,s.shape);return{a:function(){var t=Mj(s,"float32"),n=Hj(e,Hj(t,oW(o,sW(t,Xj(1))))),r=hW(o.shape,u);return r.length>0&&(n=JH(n,r)),vH(n,o.shape)},b:function(){var t=GH(o,0),n=YG(t,YH(o),Kj(o)),r=Hj(e,Hj(i,n)),a=hW(s.shape,u);return a.length>0&&(r=JH(r,a)),vH(r,s.shape)}}}},IX={kernelName:jz,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=GH(r,0);return{x:function(){return YG(i,e,Hj(e,a))},alpha:function(){var t=YG(i,Kj(e),Hj(e,r)),n=hW(a.shape,e.shape);return n.length>0&&(t=JH(t,n)),vH(t,a.shape)}}}};var SX=bV({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={x:mV(e,"x","cumprod")},i={axis:t,exclusive:n,reverse:r};return cV.runKernel(CZ,a,i)}});function CX(e,t,n){var r=e.shape.length,a=r-n.length,i=hG(n,r),o=e;null!=i&&(o=JG(e,i));var s=o.shape.slice(),u=s.splice(r-n.length,n.length).reduce((function(e,t){return e*t}),1);s.push(u);var c=function(e,t,n){var r=e.shape.slice();r[n]=1;var a=vH(t,r),i=SX(e,n,!0,!1),o=SX(e,n,!0,!0),s=Hj(i,o);return Hj(a,s)}(o.reshape(s),t,a);if(c=c.reshape(o.shape),null!=i){var l=fG(i);c=JG(c,l)}return c}var _X={kernelName:Wz,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.axis,i=[];return i=void 0===a||null===a?r.shape.map((function(e,t){return t})):"number"===typeof a?[a]:a,{x:function(){return CX(r,e,i)}}}},TX={kernelName:LZ,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=Wj(e,Mj(a,"float32")),n=hW(r.shape,i);return n.length>0?vH(JH(t,n),r.shape):t},b:function(){var t=Hj(e,Mj(r,"float32")),n=hW(a.shape,i);n.length>0&&(t=vH(JH(t,n),a.shape));var o=qj(a);return vG(Wj(t,Mj(o,"float32")))}}}},EX={kernelName:Xz,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,vG(qj(n)))}}}},NX={kernelName:rB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0],r=Hj(Uq(n,6),oq(n));return{x:function(){return Hj(e,Mj(r,"float32"))}}}},DX={kernelName:Qz,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,Mj(oq(n),"float32"))}}}},AX={kernelName:Jz,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return vH(e,n.shape)}}}},RX={kernelName:tB,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:l(t,1)[0]};return{images:function(){return cV.runKernel(nB,r,n)}}}},MX={kernelName:$z,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:l(t,1)[0]};return{images:function(){return cV.runKernel(eB,r,n)}}}},OX={kernelName:aB,gradFunc:function(e,t,n){var r=dL(n.dims,e.shape);return{x:function(){return DG(e,r)}}}},FX={kernelName:iB,gradFunc:function(e){return{x:function(){return Kj(e)}}}},PX={kernelName:oB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return vG(Wj(e,Hj(oW(n,1.5),2)))}}}};var LX=bV({logicalNot_:function(e){var t={x:mV(e,"x","logicalNot","bool")};return cV.runKernel(vz,t)}}),ZX={kernelName:lB,inputsToSave:["condition"],gradFunc:function(e,t){var n=l(t,1)[0];return{condition:function(){return Mj(Kj(n),"float32")},t:function(){return Hj(e,Mj(n,e.dtype))},e:function(){return Hj(e,Mj(LX(n),e.dtype))}}}},zX={kernelName:hB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){var t=GH(n,Xj(0)),r=Xj(kK),a=Xj(xK),i=Hj(e,a),o=Hj(Hj(e,r),BH(Mj(n,"float32")));return YG(t,i,o)}}}},BX={kernelName:gB,outputsToSave:[!0],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,Hj(n,sW(Xj(1),n)))}}}},UX={kernelName:vB,gradFunc:function(e){return{x:function(){return Kj(e)}}}};var VX=bV({cos_:function(e){var t={x:mV(e,"x","cos","float32")};return cV.runKernel(IZ,t)}}),jX={kernelName:dB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(VX(Mj(n,"float32")),e)}}}};var WX=bV({cosh_:function(e){var t={x:mV(e,"x","cosh","float32")};return cV.runKernel(SZ,t)}}),HX={kernelName:pB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(WX(Mj(n,"float32")),e)}}}},GX={kernelName:fB,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=l(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=l(KW(r,a,i),2),u=s[0],c=s[1],h=[],f=0;f<e.rank;f++)h.push([u[f],o[f]-u[f]-c[f]]);return{x:function(){return xG(e,h)}}}},qX={kernelName:wB,outputsToSave:[!0],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.dim,i=Hj(e,r);return{logits:function(){return sW(i,Hj(JH(i,[a],true),r))}}}},KX={kernelName:mB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,MG(n))}}}};var YX=bV({batchToSpaceND_:function(e,t,n){var r=mV(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));rL(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),rL(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),rL(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return cV.runKernel(sZ,i,o)}}),XX={kernelName:kB,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return YX(e,r,a)}}}},QX={kernelName:xB,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return SH(e,r)}}}},JX={kernelName:EB,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=Xj(2);return{a:function(){return Hj(e,Hj(i,sW(r,a)))},b:function(){return Hj(e,Hj(i,sW(a,r)))}}}},$X={kernelName:FB,inputsToSave:["a","b"],gradFunc:function(e,t){var n=l(t,2),r=n[0],a=n[1],i=fW(r.shape,a.shape);return{a:function(){var t=e,n=hW(r.shape,i);return n.length>0&&(t=JH(t,n)),vH(t,r.shape)},b:function(){var t=e,n=hW(a.shape,i);return n.length>0&&(t=JH(t,n)),vH(vG(t),a.shape)}}}},eQ={kernelName:bB,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=r.shape.slice();dL(n.axis,r.shape).forEach((function(e){a[e]=1}));var i=vH(e,a),o=Hj(i,bG(r.shape,"float32"));return{x:function(){return o}}}},tQ={kernelName:LB,outputsToSave:[!0],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(sW(Xj(1),qj(n)),e)}}}},nQ={kernelName:ZB,inputsToSave:["x"],gradFunc:function(e,t,n){var r=l(t,1)[0],a=n.reps;return{x:function(){var t=Kj(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Vj(t,OG(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Vj(t,OG(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=Vj(t,OG(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var h=0;h<a[1];++h)for(var f=0;f<a[2];++f)for(var d=0;d<a[3];++d)t=Vj(t,OG(e,[l*r.shape[0],h*r.shape[1],f*r.shape[2],d*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},rQ={kernelName:WB,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return function(e,t){for(var n=dW(t,Kj(t)),r=HH(e,n),a=qH(t,Xj(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=UH(a,o+1);a=eG(a,bG(r.shape,"bool"));var s=Kj(r);return YG(a,r,s)}(e,n)}}}};for(var aQ=0,iQ=[QK,JK,$K,eY,tY,nY,rY,aY,iY,oY,sY,uY,lY,fY,dY,vY,gY,mY,yY,bY,kY,xY,IY,wY,CY,TY,NY,AY,RY,MY,TX,OY,FY,PY,LY,ZY,BY,zY,VY,WY,qY,KY,YY,XY,QY,JY,$Y,eX,tX,rX,iX,iX,oX,uX,lX,hX,fX,dX,pX,vX,gX,mX,yX,bX,kX,xX,xX,wX,IX,_X,EX,NX,DX,AX,RX,MX,OX,FX,PX,ZX,zX,BX,UX,jX,HX,GX,qX,KX,XX,XX,QX,QX,{kernelName:yB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,Hj(Gj(Mj(n,"float32")),2))}}}},JX,{kernelName:NB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Hj(e,Hj(Mj(n,"float32"),2))}}}},{kernelName:GB,gradFunc:function(e){return{x:function(){return Kj(e)}}}},$X,eQ,{kernelName:PB,inputsToSave:["x"],gradFunc:function(e,t){var n=l(t,1)[0];return{x:function(){return Wj(e,qj(VX(n)))}}}},tQ,nQ,{kernelName:UB,gradFunc:function(e,t,n){var r=fG(n.perm);return{x:function(){return JG(e,r)}}}},{kernelName:jB,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return jG(e,r)}}}},rQ,{kernelName:HB,gradFunc:function(e){return{x:function(){return Kj(e)}}}}];aQ<iQ.length;aQ++){aU(iQ[aQ])}VU().prototype.abs=function(){return this.throwIfDisposed(),cW(this)};var oQ=bV({acos_:function(e){var t={x:mV(e,"x","acos")};return cV.runKernel(jL,t)}});VU().prototype.acos=function(){return this.throwIfDisposed(),oQ(this)};var sQ=bV({acosh_:function(e){var t={x:mV(e,"x","acosh")};return cV.runKernel(WL,t)}});VU().prototype.acosh=function(){return this.throwIfDisposed(),sQ(this)},VU().prototype.add=function(e){return this.throwIfDisposed(),Vj(this,e)},VU().prototype.all=function(e,t){return this.throwIfDisposed(),QW(this,e,t)},VU().prototype.any=function(e,t){return this.throwIfDisposed(),JW(this,e,t)},VU().prototype.argMax=function(e){return this.throwIfDisposed(),$W(this,e)};var uQ=bV({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n={x:mV(e,"x","argMin")},r={axis:t};return cV.runKernel(XL,n,r)}});VU().prototype.argMin=function(e){return this.throwIfDisposed(),uQ(this,e)},VU().prototype.asScalar=function(){return this.throwIfDisposed(),rL(1===this.size,(function(){return"The array must have only 1 element."})),vH(this,[])},VU().prototype.asType=function(e){return this.throwIfDisposed(),Mj(this,e)},VU().prototype.as1D=function(){return this.throwIfDisposed(),vH(this,[this.size])},VU().prototype.as2D=function(e,t){return this.throwIfDisposed(),vH(this,[e,t])},VU().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),vH(this,[e,t,n])},VU().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),vH(this,[e,t,n,r])},VU().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),vH(this,[e,t,n,r,a])};var cQ=bV({asin_:function(e){var t={x:mV(e,"x","asin")};return cV.runKernel(QL,t)}});VU().prototype.asin=function(){return this.throwIfDisposed(),cQ(this)};var lQ=bV({asinh_:function(e){var t={x:mV(e,"x","asinh")};return cV.runKernel(JL,t)}});VU().prototype.asinh=function(){return this.throwIfDisposed(),lQ(this)};var hQ=bV({atan_:function(e){var t={x:mV(e,"x","atan")};return cV.runKernel($L,t)}});VU().prototype.atan=function(){return this.throwIfDisposed(),hQ(this)};var fQ=bV({atan2_:function(e,t){var n=mV(e,"a","atan2"),r=mV(t,"b","atan2"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(tZ,i)}});VU().prototype.atan2=function(e){return this.throwIfDisposed(),fQ(this,e)};var dQ=bV({atanh_:function(e){var t={x:mV(e,"x","atanh")};return cV.runKernel(eZ,t)}});VU().prototype.atanh=function(){return this.throwIfDisposed(),dQ(this)},VU().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),gH(this,e,t,n,r)},VU().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),YX(this,e,t)},VU().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),yH(this,e,t,n,r,a)},VU().prototype.broadcastTo=function(e){return this.throwIfDisposed(),wH(this,e)},VU().prototype.cast=function(e){return this.throwIfDisposed(),Mj(this,e)};var pQ=bV({ceil_:function(e){var t={x:mV(e,"x","ceil","float32")};return cV.runKernel(fZ,t)}});VU().prototype.ceil=function(){return this.throwIfDisposed(),pQ(this)},VU().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),IH(this,e,t)},VU().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof UU&&(e=[e]),SH([this].concat(d(e)),t)},VU().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),DH(this,e,t,n,r,a,i)},VU().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),RH(this,e,t,n,r,a)},VU().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),NH(this,e,t,n,r,a,i)},VU().prototype.cos=function(){return this.throwIfDisposed(),VX(this)},VU().prototype.cosh=function(){return this.throwIfDisposed(),WX(this)},VU().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),SX(this,e,t,n)},VU().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),DY(this,e,t,n)};var vQ=bV({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=mV(e,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];rL(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),rL(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),rL(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),rL(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return cV.runKernel(NZ,s,u)}});VU().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),vQ(this,e,t)},VU().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),LH(this,e,t,n,r,a,i)};var gQ=bV({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=mV(e,"x","dilation2d"),s=mV(t,"filter","dilation2d");rL(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),rL(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),rL("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,c=!1;3===o.rank&&(u=vH(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),rL(u.shape[3]===s.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(u.shape[3]," vs ").concat(s.shape[2])}));var l={x:u,filter:s},h={strides:n,pad:r,dilations:a},f=cV.runKernel(OZ,l,h);return c?vH(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});VU().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),gQ(this,e,t,n,r,a)};var mQ=bV({divNoNan_:function(e,t){var n=mV(e,"a","div"),r=mV(t,"b","div"),a=l(eV(n,r),2);n=a[0],r=a[1];var i=Wj(n,r),o=Kj(i),s=zH(r,o);return YG(s,o,i)}});VU().prototype.divNoNan=function(e){return this.throwIfDisposed(),mQ(this,e)},VU().prototype.div=function(e){return this.throwIfDisposed(),Wj(this,e)};var yQ=bV({dot_:function(e,t){var n=mV(e,"t1","dot"),r=mV(t,"t2","dot");rL((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(rL(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=vH(n,[1,-1]),s=vH(r,[-1,1]),u=tG(o,s);return vH(u,[])}if(1===n.rank&&2===r.rank){var c=vH(n,[1,-1]),l=vH(r,[r.shape[0],r.shape[1]]),h=tG(c,l);return vH(h,[h.size])}if(2===n.rank&&1===r.rank){var f=vH(r,[-1,1]),d=tG(n,f);return vH(d,[d.size])}var p=vH(r,[r.shape[0],r.shape[1]]);return tG(n,p)}});VU().prototype.dot=function(e){return this.throwIfDisposed(),yQ(this,e)},VU().prototype.elu=function(){return this.throwIfDisposed(),ZH(this)},VU().prototype.equal=function(e){return this.throwIfDisposed(),zH(this,e)};var bQ=bV({erf_:function(e){var t=mV(e,"x","erf");rL("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Mj(t,"float32"));var n={x:t};return cV.runKernel(UZ,n)}});VU().prototype.erf=function(){return this.throwIfDisposed(),bQ(this)};var kQ=bV({euclideanNorm_:function(e){return Kq(e,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});VU().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),kQ(this,e,t)},VU().prototype.exp=function(){return this.throwIfDisposed(),BH(this)},VU().prototype.expandDims=function(e){return this.throwIfDisposed(),UH(this,e)};var xQ=bV({expm1_:function(e){var t={x:mV(e,"x","expm1")};return cV.runKernel(HZ,t)}});VU().prototype.expm1=function(){return this.throwIfDisposed(),xQ(this)},VU().prototype.fft=function(){return this.throwIfDisposed(),eq(this)},VU().prototype.flatten=function(){return this.throwIfDisposed(),vH(this,[this.size])},VU().prototype.floor=function(){return this.throwIfDisposed(),WH(this)},VU().prototype.floorDiv=function(e){return this.throwIfDisposed(),jj(this,e)},VU().prototype.gather=function(e,t,n){return this.throwIfDisposed(),HH(this,e,t,n)},VU().prototype.greaterEqual=function(e){return this.throwIfDisposed(),qH(this,e)},VU().prototype.greater=function(e){return this.throwIfDisposed(),GH(this,e)},VU().prototype.ifft=function(){return this.throwIfDisposed(),nq(this)},VU().prototype.irfft=function(){return this.throwIfDisposed(),rq(this)};var wQ=bV({isFinite_:function(e){var t={x:mV(e,"x","isFinite")};return cV.runKernel(iz,t)}});VU().prototype.isFinite=function(){return this.throwIfDisposed(),wQ(this)};var IQ=bV({isInf_:function(e){var t={x:mV(e,"x","isInf")};return cV.runKernel(oz,t)}});VU().prototype.isInf=function(){return this.throwIfDisposed(),IQ(this)};var SQ=bV({isNaN_:function(e){var t={x:mV(e,"x","isNaN")};return cV.runKernel(sz,t)}});VU().prototype.isNaN=function(){return this.throwIfDisposed(),SQ(this)},VU().prototype.leakyRelu=function(e){return this.throwIfDisposed(),KH(this,e)},VU().prototype.lessEqual=function(e){return this.throwIfDisposed(),Uq(this,e)},VU().prototype.less=function(e){return this.throwIfDisposed(),Hq(this,e)};var CQ=bV({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=mV(e,"x","localResponseNormalization");rL(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),rL(uL(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=vH(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=cV.runKernel(mz,u,c);return s?vH(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});VU().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),CQ(this,e,t,n,r)};var _Q=bV({logSigmoid_:function(e){var t=mV(e,"x","logSigmoid"),n=Yj((function(e){return{value:vG(BG(vG(e))),gradFunc:function(t){return Hj(t,MG(vG(e)))}}}));return n(t)}});VU().prototype.logSigmoid=function(){return this.throwIfDisposed(),_Q(this)},VU().prototype.logSoftmax=function(e){return this.throwIfDisposed(),$H(this,e)},VU().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),eK(this,e,t)},VU().prototype.log=function(){return this.throwIfDisposed(),YH(this)},VU().prototype.log1p=function(){return this.throwIfDisposed(),XH(this)},VU().prototype.logicalAnd=function(e){return this.throwIfDisposed(),eG(this,e)},VU().prototype.logicalNot=function(){return this.throwIfDisposed(),LX(this)};var TQ=bV({logicalOr_:function(e,t){var n=mV(e,"a","logicalOr","bool"),r=mV(t,"b","logicalOr","bool");fW(n.shape,r.shape);var a={a:n,b:r};return cV.runKernel(gz,a)}});VU().prototype.logicalOr=function(e){return this.throwIfDisposed(),TQ(this,e)};var EQ=bV({logicalXor_:function(e,t){var n=mV(e,"a","logicalXor","bool"),r=mV(t,"b","logicalXor","bool");return fW(n.shape,r.shape),eG(TQ(e,t),LX(eG(e,t)))}});VU().prototype.logicalXor=function(e){return this.throwIfDisposed(),EQ(this,e)},VU().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),tG(this,e,t,n)},VU().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),nG(this,e,t,n,r)},VU().prototype.max=function(e,t){return this.throwIfDisposed(),QH(this,e,t)},VU().prototype.maximum=function(e){return this.throwIfDisposed(),dW(this,e)},VU().prototype.mean=function(e,t){return this.throwIfDisposed(),aG(this,e,t)},VU().prototype.min=function(e,t){return this.throwIfDisposed(),iG(this,e,t)},VU().prototype.minimum=function(e){return this.throwIfDisposed(),oG(this,e)};var NQ=bV({mirrorPad_:function(e,t,n){rL("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=mV(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");rL(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){rL(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),rL(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return cV.runKernel(Nz,u,s)}});VU().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),NQ(this,e,t)};var DQ=bV({mod_:function(e,t){var n=mV(e,"a","mod"),r=mV(t,"b","mod"),a=l(eV(n,r),2),i={a:n=a[0],b:r=a[1]};return cV.runKernel(Dz,i)}});VU().prototype.mod=function(e){return this.throwIfDisposed(),DQ(this,e)},VU().prototype.mul=function(e){return this.throwIfDisposed(),Hj(this,e)},VU().prototype.neg=function(){return this.throwIfDisposed(),vG(this)},VU().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Kq(this,e,t,n)},VU().prototype.notEqual=function(e){return this.throwIfDisposed(),gG(this,e)},VU().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),mG(this,e,t,n)},VU().prototype.onesLike=function(){return this.throwIfDisposed(),kG(this)},VU().prototype.pad=function(e,t){return this.throwIfDisposed(),xG(this,e,t)};var AQ=bV({pool_:function(e,t,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var s=mV(e,"x","maxPool"),u=s,c=!1;3===s.rank&&(c=!0,u=vH(s,[1,s.shape[0],s.shape[1],s.shape[2]])),rL(hH(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var h,f=tH(u.shape,t,i,a,r),d=[f.dilationHeight,f.dilationWidth];h="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})),r=n.map((function(e){return e-1})),a=r.map((function(e){return Math.floor(e/2)})),i=r.map((function(e,t){return e-a[t]}));return r.map((function(e,t){return[a[t],i[t]]}))}([f.filterHeight,f.filterWidth],d):[[0,0],[0,0]];var p=1===d[0]&&1===d[1],v=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([f.inHeight,f.inWidth],d,h),g=l(v,2),m=g[0],y=g[1],b=p?r:"valid",k=p?u:pY(u,d,m),x=("avg"===n?function(){return gH(k,t,i,b,o)}:function(){return nG(k,t,i,b,o)})(),w=p?x:YX(x,d,y);return c?vH(w,[w.shape[1],w.shape[2],w.shape[3]]):w}});VU().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),AQ(this,e,t,n,r,a,i)},VU().prototype.pow=function(e){return this.throwIfDisposed(),oW(this,e)},VU().prototype.prelu=function(e){return this.throwIfDisposed(),wG(this,e)};var RQ=bV({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=mV(e,"x","prod");"bool"===r.dtype&&(r=Mj(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return cV.runKernel(Wz,a,i)}});VU().prototype.prod=function(e,t){return this.throwIfDisposed(),RQ(this,e,t)};var MQ=bV({reciprocal_:function(e){var t={x:mV(e,"x","reciprocal")};return cV.runKernel(Xz,t)}});VU().prototype.reciprocal=function(){return this.throwIfDisposed(),MQ(this)},VU().prototype.relu=function(){return this.throwIfDisposed(),NG(this)},VU().prototype.relu6=function(){return this.throwIfDisposed(),iq(this)},VU().prototype.reshapeAs=function(e){return this.throwIfDisposed(),vH(this,e.shape)},VU().prototype.reshape=function(e){return this.throwIfDisposed(),vH(this,e)},VU().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Zq(this,e,t,n)},VU().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),zq(this,e,t,n)},VU().prototype.reverse=function(e){return this.throwIfDisposed(),DG(this,e)},VU().prototype.rfft=function(){return this.throwIfDisposed(),tq(this)},VU().prototype.round=function(){return this.throwIfDisposed(),Vq(this)},VU().prototype.rsqrt=function(){return this.throwIfDisposed(),UY(this)},VU().prototype.selu=function(){return this.throwIfDisposed(),AG(this)},VU().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),RG(this,e,t,n,r,a,i)},VU().prototype.sigmoid=function(){return this.throwIfDisposed(),MG(this)};var OQ=bV({sign_:function(e){var t={x:mV(e,"x","sign")};return cV.runKernel(vB,t)}});VU().prototype.sign=function(){return this.throwIfDisposed(),OQ(this)},VU().prototype.sin=function(){return this.throwIfDisposed(),_Y(this)},VU().prototype.sinh=function(){return this.throwIfDisposed(),EY(this)},VU().prototype.slice=function(e,t){return this.throwIfDisposed(),OG(this,e,t)},VU().prototype.softmax=function(e){return this.throwIfDisposed(),zG(this,e)},VU().prototype.softplus=function(){return this.throwIfDisposed(),BG(this)},VU().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),pY(this,e,t)},VU().prototype.split=function(e,t){return this.throwIfDisposed(),UG(this,e,t)},VU().prototype.sqrt=function(){return this.throwIfDisposed(),Gj(this)},VU().prototype.square=function(){return this.throwIfDisposed(),qj(this)},VU().prototype.squaredDifference=function(e){return this.throwIfDisposed(),$q(this,e)},VU().prototype.squeeze=function(e){return this.throwIfDisposed(),VG(this,e)},VU().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof UU?[this,e]:[this].concat(d(e));return jG(n,t)},VU().prototype.step=function(e){return this.throwIfDisposed(),oq(this,e)};var FQ=bV({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c={x:mV(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return cV.runKernel(AB,c,l)}});VU().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),FQ(this,e,t,n,r,a,i,o,s)},VU().prototype.sub=function(e){return this.throwIfDisposed(),sW(this,e)},VU().prototype.sum=function(e,t){return this.throwIfDisposed(),JH(this,e,t)};var PQ=bV({tan_:function(e){var t={x:mV(e,"x","tan","float32")};return cV.runKernel(PB,t)}});VU().prototype.tan=function(){return this.throwIfDisposed(),PQ(this)},VU().prototype.tanh=function(){return this.throwIfDisposed(),WG(this)},VU().prototype.tile=function(e){return this.throwIfDisposed(),VH(this,e)},VU().prototype.toBool=function(){return this.throwIfDisposed(),Mj(this,"bool")},VU().prototype.toFloat=function(){return this.throwIfDisposed(),Mj(this,"float32")},VU().prototype.toInt=function(){return this.throwIfDisposed(),Mj(this,"int32")};var LQ=bV({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=mV(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=l(cV.runKernel(zB,i,o),2);return{values:s[0],indices:s[1]}}});VU().prototype.topk=function(e,t){return this.throwIfDisposed(),LQ(this,e,t)},VU().prototype.transpose=function(e){return this.throwIfDisposed(),JG(this,e)};var ZQ=bV({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=mV(e,"x","unique","string_or_numeric");rL(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=l(cV.runKernel(VB,r,a),2);return{values:i[0],indices:i[1]}}});VU().prototype.unique=function(e){return this.throwIfDisposed(),ZQ(this,e)},VU().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),jY(this,e,t)},VU().prototype.unstack=function(e){return this.throwIfDisposed(),KG(this,e)},VU().prototype.where=function(e,t){return this.throwIfDisposed(),YG(e,this,t)},VU().prototype.zerosLike=function(){return this.throwIfDisposed(),Kj(this)};var zQ=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Je.Z)(r),n.prototype),r}return(0,v.Z)(n)}(w(Error)),BQ=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Je.Z)(r),n.prototype),r}return(0,v.Z)(n)}(w(Error)),UQ=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Je.Z)(r),n.prototype),r}return(0,v.Z)(n)}(w(Error)),VQ=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Je.Z)(r),n.prototype),r}return(0,v.Z)(n)}(w(Error)),jQ=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,Je.Z)(r),n.prototype),r}return(0,v.Z)(n)}(w(Error)),WQ=function(){function e(t){(0,p.Z)(this,e),this.maxEntries=t||100,this.cache=new Map}return(0,v.Z)(e,[{key:"get",value:function(e){var t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}},{key:"put",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"getMaxEntries",value:function(){return this.maxEntries}},{key:"setMaxEntries",value:function(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(var t=0;t<this.maxEntries-e;t++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}]),e}();function HQ(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function GQ(e,t){if(!e)throw new jQ(t)}function qQ(e,t){var n,r=0,a=(0,C.Z)(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(kve){a.e(kve)}finally{a.f()}return r}function KQ(e){return 1===e.length?e[0]:e}function YQ(e){return Array.isArray(e)?e:[e]}function XQ(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function QQ(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var JQ={};function $Q(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function eJ(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return eJ(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?eJ(a):e[r]=a.value)}}function tJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in JQ)i=JQ[o];else if(null==(i=t[o]))throw new UQ("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s=e;if(null==s.className||null==s.config)throw new UQ("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var u,c,h=s.className;if(h in n){var f=l(n[h],2);u=f[0],c=f[1]}else if(h in JQ){var d=l(JQ.className,2);u=d[0],c=d[1]}else if(h in t){var p=l(t[h],2);u=p[0],c=p[1]}if(null==u)throw new UQ("Unknown ".concat(r,": ").concat(h,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){for(var v={},g=0,m=Object.keys(JQ);g<m.length;g++){var y=m[g];v[y]=JQ[y]}for(var b=0,k=Object.keys(n);b<k.length;b++){var x=k[b];v[x]=n[x]}s.config.customObjects=v;for(var w=Object.assign({},JQ),I=0,S=Object.keys(n);I<S.length;I++){var C=S[I];JQ[C]=n[C]}eJ(s.config);var _=c(u,s.config,n,a);return JQ=Object.assign({},w),_}for(var T=Object.assign({},JQ),E=0,N=Object.keys(n);E<N.length;E++){var D=N[E];JQ[D]=n[D]}var A=new u(s.config);return JQ=Object.assign({},T),A}function nJ(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function rJ(e){if(null==e)return e;var t,n=[],r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(kve){r.e(kve)}finally{r.f()}return n}function aJ(e){if(null==e)throw new UQ("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function iJ(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new UQ("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function oJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return GQ(n>=0),GQ(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function sJ(e,t){Array.isArray(e)?(rL(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return sJ(e,"element ".concat(n+1," of ").concat(t))}))):rL(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(uJ(e),".")}))}function uJ(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return uJ(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function cJ(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var lJ=0;function hJ(){return lJ++}var fJ={};function dJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in fJ||(fJ[e]=0),fJ[e]+=1,e+fJ[e].toString()}var pJ=["channelsFirst","channelsLast"],vJ=["nearest","bilinear"],gJ=["valid","same","causal"],mJ=["max","avg"],yJ=["sum","mul","concat","ave"],bJ=new Map;function kJ(e){iJ(pJ,"DataFormat",e)}function xJ(e){iJ(gJ,"PaddingMode",e)}function wJ(e){iJ(mJ,"PoolMode",e)}var IJ=[],SJ="/";function CJ(e,t){IJ.push(e);try{var n=t();return IJ.pop(),n}catch(r){throw IJ.pop(),r}}function _J(e){if(!DJ(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===IJ.length?"":IJ.join(SJ)+SJ)+e}function TJ(e){if(!DJ(e))throw new Error("Not a valid tensor name: '"+e+"'");bJ.has(e)||bJ.set(e,0);var t=bJ.get(e);if(bJ.set(e,bJ.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return bJ.set(n,1),n}return e}var EJ,NJ=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function DJ(e){return!!e.match(NJ)}function AJ(e){return e===parseInt(e.toString(),10)}function RJ(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function MJ(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function OJ(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function FJ(e,t){if(t<e)throw new UQ("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function PJ(){return null==EJ&&(EJ=cV.backend.epsilon()),EJ}function LJ(e,t){return Mj(e,t)}function ZJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),vH(e,n)}function zJ(e,t,n){return Zj((function(){switch(e.rank){case 1:return FG(e,t,n);case 2:return PG(e,[t,0],[n,e.shape[1]]);case 3:return LG(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ZG(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return OG(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return OG(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new UQ("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function BJ(e,t,n){return Zj((function(){switch(e.rank){case 1:return FG(e,t,n);case 2:return PG(e,[0,t],[e.shape[0],n]);case 3:return LG(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ZG(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new UQ("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function UJ(e,t,n,r){return Zj((function(){switch(e.rank){case 1:return FG(e,t,n);case 2:switch(r){case 1:return zJ(e,t,n);case 2:return BJ(e,t,n);default:throw new UQ("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return zJ(e,t,n);case 2:return LG(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return BJ(e,t,n);default:throw new UQ("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return zJ(e,t,n);case 2:return ZG(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ZG(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return BJ(e,t,n);default:throw new UQ("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new UQ("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function VJ(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),SH(e,n)}function jJ(e,t){switch(e.rank){case 1:return CH([e,t]);case 2:return _H([e,t],0);case 3:return TH([e,t],0);case 4:return EH([e,t],0);default:throw new UQ("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function WJ(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new UQ("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return VH(e,t)}function HJ(e){return _G(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function GJ(e,t,n,r){if(e.rank<2||t.rank<2)throw new VQ("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new VQ("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return pq({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YJ(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=vH(e,[-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(d(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=vH(JG(t,l),[u,-1]);var h=[].concat(d(a),d(c));return vH(pq({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YJ(e.rank,r,"channelsLast"):null,activation:n}),h)}function qJ(e,t,n){return Zj((function(){return t=Array.isArray(t)?HG(t,"int32"):Mj(t,"int32"),HH(e,t,n)}))}function KJ(e){return Hj(e,e)}function YJ(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new UQ("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?vH(t,[1,r[0],1,1,1]):vH(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?vH(t,[1,1,1,1,r[0]]):vH(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?vH(t,[1,r[0],1,1]):vH(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?vH(t,[1,1,1,r[0]]):vH(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?vH(t,[1,r[0],1]):vH(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?vH(t,[1,1,r[0]]):vH(t,[1].concat(r))}else if(e<3)return t;throw new UQ("Unsupported input rank by biasAdd: ".concat(t.rank))}function XJ(e,t,n){return Zj((function(){return null==n&&(n="channelsLast"),kJ(n),Vj(e,YJ(e.rank,t,n))}))}function QJ(e,t,n,r){return Zj((function(){return $G(e,t,n,r)}))}function JJ(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e():t()}var $J=["fanIn","fanOut","fanAvg"],e$=["normal","uniform","truncatedNormal"];var t$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}($j),n$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e,t){return yG(e,t)}}]),n}(t$);n$.className="Zeros",tW(n$);var r$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e,t){return bG(e,t)}}]),n}(t$);r$.className="Ones",tW(r$);var a$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),r=t.call(this),"object"!==typeof e)throw new UQ("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new UQ("config must have value set but got ".concat(e));return r.value=e.value,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){var n=this;return Zj((function(){return Hj(Xj(n.value),bG(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(t$);a$.className="Constant",tW(a$);var i$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){return TG(e,this.minval,this.maxval,t,this.seed)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(t$);i$.className="RandomUniform",tW(i$);var o$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new VQ("randomNormal does not support dType ".concat(t,"."));return HJ(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(t$);o$.className="RandomNormal",tW(o$);var s$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new VQ("truncatedNormal does not support dType ".concat(t,"."));return qG(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(t$);s$.className="TruncatedNormal",tW(s$);var u$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){var n=this;return Zj((function(){if(2!==e.length||e[0]!==e[1])throw new UQ("Identity matrix initializer can only be used for 2D square matrices.");return Hj(n.gain,jH(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(t$);u$.className="Identity",tW(u$);var c$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),r=t.call(this),e.scale<0)throw new UQ("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,function(e){iJ($J,"FanMode",e)}(r.mode),r.distribution=null==e.distribution?"normal":e.distribution,function(e){iJ(e$,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(kJ(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=RJ(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=RJ(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=RJ(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new VQ("".concat(this.getClassName()," does not support dType ").concat(t,"."));return qG(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return TG(e,-s,s,t,this.seed)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(t$);c$.className="VarianceScaling",tW(c$);var l$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);l$.className="GlorotUniform",tW(l$);var h$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);h$.className="GlorotNormal",tW(h$);var f$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);f$.className="HeNormal",tW(f$);var d$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);d$.className="HeUniform",tW(d$);var p$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);p$.className="LeCunNormal",tW(p$);var v$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,v.Z)(n,[{key:"getClassName",value:function(){return c$.className}}]),n}(c$);v$.className="LeCunUniform",tW(v$);var g$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.ELEMENTS_WARN_SLOW=2e3,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){var n=this;return Zj((function(){if(e.length<2)throw new VQ("Shape must be at least 2D.");if("int32"!==t&&"float32"!==t&&void 0!==t)throw new TypeError("Unsupported data type ".concat(t,"."));var r=oL(e.slice(0,-1)),a=e[e.length-1],i=r*a;i>n.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(n.ELEMENTS_WARN_SLOW," (").concat(i,") elements: ")+"Slowness may result.");var o=HJ([Math.max(a,r),Math.min(a,r)],0,1,t,n.seed),s=rK.qr(o,!1),u=s[0],c=s[1].flatten().stridedSlice([0],[Math.min(a,r)*Math.min(a,r)],[Math.min(a,r)+1]);return u=Hj(u,c.sign()),r<a&&(u=u.transpose()),Hj(Xj(n.gain),u.reshape(e))}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(t$);g$.className="Orthogonal",tW(g$);var m$={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function y$(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tJ(e,eW.getMap().classNameMap,t,"initializer")}function b$(e){return $Q(e)}function k$(e){if("string"===typeof e){var t=e in m$?m$[e]:e;if("GlorotNormal"===t)return new h$;if("GlorotUniform"===t)return new l$;if("HeNormal"===t)return new f$;if("HeUniform"===t)return new d$;if("LeCunNormal"===t)return new p$;if("LeCunUniform"===t)return new v$;var n={};return n.className=t,n.config={},y$(n)}return e instanceof t$?e:y$(e)}function x$(e){return Array.isArray(e)&&Array.isArray(e[0])}function w$(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function I$(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new UQ("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function S$(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new UQ("Expected exactly 1 Shape; got ".concat(e.length))}return e}function C$(e){var t,n=0,r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(kve){r.e(kve)}finally{r.f()}return n}var _$="Variable",T$=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_$,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,p.Z)(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=hJ(),r=null==r?_$:r,this.originalName=_J(r),this.name=TJ(this.originalName),this.trainable_=a,this.constraint=i,this.val=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return cV.makeVariable(e,t,n,r)}(t,this.trainable_,this.name,this.dtype)}return(0,v.Z)(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function E$(e){return e.map((function(e){return e.read()}))}function N$(e){e.forEach((function(e){e[0].write(e[1])}))}var D$=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),A$=(0,v.Z)((function e(t,n,r,a,i,o,s){(0,p.Z)(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=hJ(),null!=o&&(this.originalName=_J(o),this.name=TJ(this.originalName)),this.rank=n.length})),R$=0,M$=function(){function e(t,n){(0,p.Z)(this,e),this.callArgs=n,this.id=R$++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=(0,C.Z)(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(kve){a.e(kve)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return(0,v.Z)(e,[{key:"getConfig",value:function(){var e,t=[],n=(0,C.Z)(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(kve){n.e(kve)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),O$=0,F$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,p.Z)(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=O$++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=XQ(i)+"_"+dJ(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return(0,v.Z)(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new BQ("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new UQ("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return KQ(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return KQ(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new zQ("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new zQ("Layer ".concat(this.name)+" is not connected, no input to return.");return KQ(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new zQ("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new zQ("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return KQ(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=YQ(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=YQ(this.inputSpec);if(e.length!==t.length)throw new UQ("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new UQ("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new UQ("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new UQ("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new UQ("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new UQ("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var h=0;h<a.shape.length;++h){var f=a.shape[h],d=r.shape[h];if(null!=f&&null!=d&&f!==d)throw new UQ("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=YQ(e),i=!0,o=(0,C.Z)(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof A$)){i=!1;break}}}catch(kve){o.e(kve)}finally{o.f()}var s,u=!0,c=(0,C.Z)(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof A$){u=!1;break}}}catch(kve){c.e(kve)}finally{c.f()}if(i===u)throw new UQ("Arguments to apply() must be all SymbolicTensors or all Tensors");return CJ(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=(0,C.Z)(YQ(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(kve){o.e(kve)}finally{o.f()}n.build(KQ(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,l=n.call(e,t),h=YQ(l),f=[],d=(0,C.Z)(h);try{for(d.s();!(c=d.n()).done;){var p=c.value;-1!==a.indexOf(p)&&(p=p.clone()),f.push(p)}}catch(kve){d.e(kve)}finally{d.f()}if(l=KQ(f),null!=n.activityRegularizer)throw new VQ("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}var v,g=function(e){e=YQ(e);var t,n=[],r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(kve){r.e(kve)}finally{r.f()}return KQ(n)}(e),m=n.computeOutputShape(g),y="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?g[0]:g),v=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((function(r,a){return new A$(y,r,n,YQ(e),t,n.name,a)})):new A$(y,m,n,YQ(e),t,n.name),n.addInboundNode(e,v,null,null,g,m,t),n._refCount++,null!=n.activityRegularizer)throw new VQ("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return v}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new zQ("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=(0,C.Z)(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(kve){n.e(kve)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new zQ("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new BQ("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return C$(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){return E$(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Zj((function(){var n=t.weights;if(n.length!==e.length)throw new UQ('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=E$(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!sL(o.shape,u.shape))throw new UQ("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(u.shape));r.push([s,u])}N$(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(e))throw new UQ("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():k$("zeros"));var u=r.apply(t,n),c=new T$(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=YQ(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,d(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=YQ(e);t=YQ(t),n=YQ(n),r=YQ(r),a=w$(a),i=w$(i);var u,c=[],l=[],h=[],f=(0,C.Z)(s);try{for(f.s();!(u=f.n()).done;){var d=u.value;c.push(d.sourceLayer),l.push(d.nodeIndex),h.push(d.tensorIndex)}}catch(kve){f.e(kve)}finally{f.f()}new M$({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:h,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}($j);function P$(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=P$(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),u=(0,C.Z)(s);try{for(u.s();!(o=u.n()).done;){var c=o.value;-1===a.indexOf(c)&&a.push(c)}}catch(kve){u.e(kve)}finally{u.f()}}return a}var L$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:dJ("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new UQ("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new UQ("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new UQ("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new A$(r.dtype,r.batchInputShape,(0,Je.Z)(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new M$({outboundLayer:(0,Je.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return(0,v.Z)(n,[{key:"apply",value:function(e,t){throw new UQ("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(F$);function Z$(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new UQ("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new L$({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}L$.className="InputLayer",tW(L$);var z$=function(){function e(t){if((0,p.Z)(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=(0,C.Z)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(kve){a.e(kve)}finally{a.f()}}}return(0,v.Z)(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new UQ("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Mj(t,e.dtype)}catch(kve){throw new UQ("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof A$){if(null==this.id2Value[e.id])throw new UQ("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new UQ("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof A$){if(null==this.id2Value[e.id])throw new UQ("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new UQ("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&zj(this.id2Mask)}}]),e}(),B$=new WQ,U$=new WQ;function V$(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),c=[],l=t.names(),h=(0,C.Z)(u);try{for(h.s();!(a=h.n()).done;){var f=a.value;-1!==l.indexOf(f)?c.push(t.getValue(f)):c.push(null)}}catch(kve){h.e(kve)}finally{h.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var d,p=u.join(",")+"|"+t.names().sort().join(","),v=B$.get(p);if(null==v){var g=function(e,t){rL(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=W$(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=(0,C.Z)(e);try{for(s.s();!(i=s.n()).done;){var u,c=W$(i.value,t),l=c.sorted,h=c.recipientMap,f=(0,C.Z)(l);try{for(f.s();!(u=f.n()).done;){var d=u.value;o.has(d.name)||(n.push(d),o.add(d.name))}}catch(kve){f.e(kve)}finally{f.f()}var p=function(e){null==r[e]&&(r[e]=new Set),h[e].forEach((function(t){return r[e].add(t)}))};for(var v in h)p(v)}}catch(kve){s.e(kve)}finally{s.f()}}return{sorted:n,recipientCounts:j$(r)}}(s,t);v=g.sorted,d=g.recipientCounts,B$.put(p,v),U$.put(p,d)}d={},i||Object.assign(d,U$.get(p));for(var m=new z$(t),y=0;y<v.length;++y){if(null!=r){var b=Lj().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var k=v[y],x=k.sourceLayer;if(!(x instanceof L$)){var w,I=[],S=[],_=[],T=!1,E=(0,C.Z)(k.inputs);try{for(E.s();!(w=E.n()).done;){var N=w.value,D=m.getValue(N),A=m.getMask(N);I.push(D),S.push(A),null!=A&&(T=!0),i||(d[N.name]--,0!==d[N.name]||t.hasKey(N)||-1!==u.indexOf(N.name)||D.isDisposed||!0===N.sourceLayer.stateful||_.push(D))}}catch(kve){E.e(kve)}finally{E.f()}T&&((n=n||{}).mask=S[0]);var R=YQ(x.apply(I,n)),M=null;x.supportsMasking&&(M=x.computeMask(I,S));for(var O=H$(k),F=Array.isArray(O)?O:[O],P=0;P<F.length;++P){m.hasKey(F[P])||m.add(F[P],R[P],Array.isArray(M)?M[0]:M);var L=u.indexOf(F[P].name);-1!==L&&(c[L]=R[P])}i||zj(_)}}return m.disposeMasks(),o?c:c[0]}function j$(e){var t={};for(var n in e)t[n]=e[n].size;return t}function W$(e,t){var n,r=new Set,a=[],i={},o=(0,C.Z)(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(kve){o.e(kve)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var h=c[c.length-1]===u.length-1;if(0===l.inputs.length||h)u.pop(),a.push(l),r.add(l.name),h&&c.pop();else{c.push(u.length-1);var f,d=(0,C.Z)(l.inputs);try{for(d.s();!(f=d.n()).done;){var p=f.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||u.push(p)}}catch(kve){d.e(kve)}finally{d.f()}}}}return{sorted:a,recipientMap:i}}function H$(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=(0,C.Z)(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(kve){i.e(kve)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function G$(e,t){return Zj((function(){return Gj(JH(Hj(e,e),t,!0))}))}LL().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(e){null!=B$&&B$.setMaxEntries(e),null!=U$&&U$.setMaxEntries(e)}));var q$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}($j),K$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,v.Z)(n,[{key:"apply",value:function(e){var t=this;return Zj((function(){var n=G$(e,t.axis),r=IH(n,0,t.maxValue);return Hj(e,Wj(r,Vj(PJ(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(q$);K$.className="MaxNorm",tW(K$);var Y$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,v.Z)(n,[{key:"apply",value:function(e){var t=this;return Zj((function(){return Wj(e,Vj(PJ(),G$(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(q$);Y$.className="UnitNorm",tW(Y$);var X$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return NG(e)}}]),n}(q$);X$.className="NonNeg",tW(X$);var Q$=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,v.Z)(n,[{key:"apply",value:function(e){var t=this;return Zj((function(){var n=G$(e,t.axis),r=Vj(Hj(t.rate,IH(n,t.minValue,t.maxValue)),Hj(1-t.rate,n));return Hj(e,Wj(r,Vj(PJ(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(q$);Q$.className="MinMaxNorm",tW(Q$);var J$,$$={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function e0(e){return $Q(e)}function t0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tJ(e,eW.getMap().classNameMap,t,"constraint")}function n0(e){return null==e?null:"string"===typeof e?t0({className:e in $$?$$[e]:e,config:{}}):e instanceof q$?e:t0(e)}function r0(e){return a0.apply(this,arguments)}function a0(){return a0=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];zj(a);case 12:case"end":return e.stop()}}),e)}))),a0.apply(this,arguments)}function i0(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(J$||(J$={}));var o0=function(){function e(){(0,p.Z)(this,e),this.validationData=null}return(0,v.Z)(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),s0=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;(0,p.Z)(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return(0,v.Z)(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=(0,C.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(kve){n.e(kve)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=(0,C.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(kve){n.e(kve)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,C.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,C.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,C.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,C.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,C.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,C.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),u0=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this)}return(0,v.Z)(n,[{key:"onEpochBegin",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=Dt().mark((function e(t){var a,i,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"number"===typeof(a=n[t])?(o.totals.hasOwnProperty(t)||(o.totals[t]=0),o.totals[t]=o.totals[t]+a*r):(t in o.totals?i=o.totals[t]:o.totals[t]=0,s=Zj((function(){return Vj(o.totals[t],Hj(a,r))})),o.totals[t]=s,null!=i&&i.dispose());case 2:case"end":return e.stop()}}),e)})),e.t0=Dt().keys(n);case 5:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,e.delegateYield(a(i),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=20;break}r=(0,C.Z)(this.params.metrics),e.prev=2,i=Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,null!=o.totals[t]){e.next=3;break}return e.abrupt("return","continue");case 3:"number"===typeof o.totals[t]?n[t]=o.totals[t]/o.seen:Zj((function(){var e=Hj(Wj(1,o.seen),o.totals[t]);n[t]=e,o.totals[t].dispose(),Bj(n[t])}));case 4:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",7);case 7:if("continue"!==e.t0){e.next=10;break}return e.abrupt("continue",10);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(2),r.e(e.t1);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(o0),c0=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"onTrainBegin",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s,u,c;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,c=0;c<u.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=u[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(o0),l0=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;if((0,p.Z)(this,n),(a=t.call(this)).currentEpoch=0,a.nowFunc=e.nowFunc,a.nextFrameFunc=e.nextFrameFunc||sK,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return kL(a.yieldEvery)&&(a.maybeWait=function(e,t,n){var r,a=null!=n?n():IU();return function(){var i=null!=n?n():IU();return i-a<t?r:(a=i,r=e.apply(void 0,arguments))}}(a.maybeWait.bind((0,Je.Z)(a)),a.yieldEvery,a.nowFunc)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return(0,v.Z)(n,[{key:"maybeWait",value:function(){var e=Rt(Dt().mark((function e(t,n,r){var a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,r0(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(this.nextFrameFunc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,r0(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,r0(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(this.nextFrameFunc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,r0(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Rt(Dt().mark((function e(t,n){var r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,r0(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(this.nextFrameFunc()):kL(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,r0(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,r0(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(o0);function h0(e,t){return null==e&&(e={}),e instanceof o0?[e]:Array.isArray(e)&&e[0]instanceof o0?e:YQ(e).map((function(e){return new l0(e,t)}))}var f0=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,null,[{key:"registerCallbackConstructor",value:function(t,n){rL(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new UQ("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,d(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function d0(e,t,n,r,a,i,o,s,u){var c=new c0,l=[new u0].concat(d(f0.createCallbacks(t)));null!=e&&l.push.apply(l,d(e)),l.push(c);var h=new s0(l);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:h,history:c}}function p0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tJ(e,eW.getMap().classNameMap,t,"layer",n)}function v0(e,t){return Zj((function(){"float32"!==e.dtype&&(e=Mj(e,"float32"));var n=JH(KJ(e),t,!0),r=aW(n.shape,PJ()),a=Gj(dW(n,r));return Wj(e,a)}))}function g0(e,t){return Zj((function(){return aG(KJ(sW(t,e)),-1)}))}function m0(e,t){return Zj((function(){return aG(cW(sW(t,e)),-1)}))}function y0(e,t){return Zj((function(){var n=sW(e,t),r=IH(cW(e),PJ(),Number.MAX_VALUE),a=cW(Wj(n,r));return Hj(100,aG(a,-1))}))}function b0(e,t){return Zj((function(){var n=IH(t,PJ(),Number.MAX_VALUE),r=YH(Vj(1,n)),a=IH(e,PJ(),Number.MAX_VALUE),i=YH(Vj(1,a));return aG(KJ(sW(r,i)),-1)}))}function k0(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Zj((function(){if(n)t=zG(t);else{var r=JH(t,t.shape.length-1,!0);t=Wj(t,r)}return t=IH(t,PJ(),1-PJ()),vG(JH(Hj(Mj(e,"float32"),YH(t)),t.shape.length-1))}))}function x0(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Zj((function(){var r=Mj(WH(function(e){var t=[RJ(e.shape)];return vH(e,t)}(e)),"int32"),a=(t=IH(t,PJ(),1-PJ())).shape;return k0(vH(mG(r,a[a.length-1]),a),t,n)}))}function w0(e,t){return Zj((function(){var n;return n=IH(t,PJ(),1-PJ()),n=YH(Wj(n,sW(1,n))),aG(function(e,t){if(!sL(e.shape,t.shape))throw new UQ("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Zj((function(){var n=NG(t),r=vG(cW(t));return Vj(sW(n,Hj(t,e)),XH(BH(r)))}))}(e,n),-1)}))}function I0(e,t){return Zj((function(){var n=IH(e,PJ(),1),r=IH(t,PJ(),1);return JH(Hj(e,YH(Wj(n,r))),-1)}))}function S0(e,t){return Zj((function(){var n=v0(e,-1),r=v0(t,-1),a=Hj(n,r);return vG(JH(a,-1))}))}f0.constructors={};var C0={meanSquaredError:g0,meanAbsoluteError:m0,meanAbsolutePercentageError:y0,meanSquaredLogarithmicError:b0,squaredHinge:function(e,t){return Zj((function(){var n=dW(0,sW(1,Hj(e,t)));return aG(KJ(n),-1)}))},hinge:function(e,t){return Zj((function(){var n=dW(0,sW(1,Hj(e,t)));return aG(n,-1)}))},categoricalHinge:function(e,t){return Zj((function(){var n=JH(Hj(e,t),-1),r=QH(Hj(sW(1,e),t),-1);return dW(0,Vj(1,sW(r,n)))}))},logcosh:function(e,t){return Zj((function(){var n=Math.log(2),r=sW(t,e),a=sW(Vj(r,BG(Hj(-2,r))),n);return aG(a,-1)}))},categoricalCrossentropy:k0,sparseCategoricalCrossentropy:x0,binaryCrossentropy:w0,kullbackLeiblerDivergence:I0,poisson:function(e,t){return Zj((function(){var n=YH(Vj(PJ(),t));return aG(sW(t,Hj(e,n)),-1)}))},cosineProximity:S0};function _0(e){if("string"===typeof e){if(e in C0)return C0[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new UQ(t)}return e}function T0(e,t){return Zj((function(){var n=Hj(.5,kG(t)),r=LJ(GH(t,n),e.dtype);return aG(zH(e,r),-1)}))}function E0(e,t){return Zj((function(){return LJ(zH($W(e,-1),$W(t,-1)),"float32")}))}function N0(e,t){return Zj((function(){return Mj(JH(eG(zH(e,1),zH(t,1))),"float32")}))}function D0(e,t){return w0(e,t)}function A0(e,t){return e.rank===t.rank&&(e=VG(e,[e.rank-1])),(t=$W(t,-1)).dtype!==e.dtype&&(t=Mj(t,e.dtype)),Mj(zH(e,t),"float32")}var R0=k0,M0=x0,O0={binaryAccuracy:T0,categoricalAccuracy:E0,precision:function(e,t){return Zj((function(){var n=N0(e,t),r=function(e,t){return Zj((function(){return Mj(JH(eG(zH(e,0),zH(t,1))),"float32")}))}(e,t),a=Vj(n,r);return Mj(YG(GH(a,0),Wj(n,a),0),"float32")}))},categoricalCrossentropy:R0,sparseCategoricalCrossentropy:M0,mse:g0,MSE:g0,mae:m0,MAE:m0,mape:y0,MAPE:y0,cosine:S0};function F0(e){if(GQ(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(C0);n<r.length;n++){var a=r[n];if(C0[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(O0);i<o.length;i++){var s=o[i];if(O0[s]===e){t=s;break}}return void 0!==t?t:e.name}var P0=1048576;function L0(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!Z0(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>P0&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(P0,"."))}}function Z0(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!Z0(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=(0,C.Z)(e);try{for(i.s();!(a=i.n()).done;){if(!Z0(a.value))return!1}}catch(kve){i.e(kve)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function z0(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,d(s))}if(t){var u,c=(0,C.Z)(e.layers);try{for(c.s();!(u=c.n()).done;){var l,h=u.value,f=!1,p=(0,C.Z)(h.inboundNodes);try{for(p.s();!(l=p.n()).done;){var v=l.value;if(-1!==r.indexOf(v)){if(f){t=!1;break}f=!0}}}catch(kve){p.e(kve)}finally{p.f()}if(!t)break}}catch(kve){c.e(kve)}finally{c.f()}}return t}(e),o=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,d(e.nodesByDepth[s]))}a("_".repeat(t)),B0(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?U0(c[l],n,a):V0(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var h=function(e){var t;t=null!=e.collectedTrainableWeights?C$(e.collectedTrainableWeights):C$(e.trainableWeights);return t}(e),f=C$(e.nonTrainableWeights);a("Total params: ".concat(h+f)),a("Trainable params: ".concat(h)),a("Non-trainable params: ".concat(f)),a("_".repeat(t))}function B0(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function U0(e,t,n){var r,a;try{a=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(kve){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(kve){r="multiple"}var i=e.name,o=e.getClassName();B0(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function V0(e,t,n,r){var a,i;try{i=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(kve){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(kve){a="multiple"}var o,s=[],u=(0,C.Z)(e.inboundNodes);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var l=0;l<c.inboundLayers.length;++l){var h=c.inboundLayers[l].name,f=c.nodeIndices[l],d=c.tensorIndices[l];s.push("".concat(h,"[").concat(f,"][").concat(d,"]"))}}}catch(kve){u.e(kve)}finally{u.f()}var p=e.name,v=e.getClassName(),g=0===s.length?"":s[0];B0(["".concat(p," (").concat(v,")"),i,a,e.countParams().toString(),g],t,r);for(var m=1;m<s.length;++m)B0(["","","","",s[m]],t,r)}function j0(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function W0(e,t){if(null===e)return null;if("string"===typeof e)return QQ(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];j0(t,a,i)?n.push(i):n.push(W0(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var h=QQ(c);o[h]=W0(l,h)}}return o}function H0(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return XQ(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];j0(t,a,i)?n.push(i):n.push(H0(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c],h=XQ(c);o[h]="name"!==c&&"className"!==c||"string"!==typeof l?H0(l,c):l}return o}var G0="4.8.0",q0=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=dJ(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],rJ(r.inputs).length!==r.inputs.length)throw new UQ("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));rJ(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=(0,C.Z)(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.sourceLayer,c=s.nodeIndex,l=s.tensorIndex;r.outputLayers.push(u),r.outputLayersNodeIndices.push(c),r.outputLayersTensorIndices.push(l)}}catch(kve){o.e(kve)}finally{o.f()}var h,f=(0,C.Z)(r.inputs);try{for(f.s();!(h=f.n()).done;){var d=h.value,v=d.sourceLayer,g=d.nodeIndex,m=d.tensorIndex;GQ(0===g,"input layer has >1 nodes"),GQ(0===m,"input layer has >1 tensors"),r.inputLayers.push(v),r.inputLayersNodeIndices.push(g),r.inputLayersTensorIndices.push(m)}}catch(kve){f.e(kve)}finally{f.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var y=0;y<r.inputLayers.length;y++){var b=r.inputLayers[y];if(!(b instanceof L$))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(y," (0-based) originates ")+"from layer type ".concat(b.getClassName(),"."));r.inputNames.push(b.name),r.feedInputShapes.push(b.batchInputShape),r.feedInputNames.push(b.name)}var k,x=(0,C.Z)(r.outputLayers);try{for(x.s();!(k=x.n()).done;){var w=k.value;r.outputNames.push(w.name)}}catch(kve){x.e(kve)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var I,S={},_={},T={},E={},N={},D=[],A=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new BQ("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in N||(N[o.id]=Object.keys(N).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,h=0;h<l;h++){e(c.inputTensors[h],a,i,c.inboundLayers[h],c.nodeIndices[h],c.tensorIndices[h])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);D.push(c)}},R=[],M=[],O=(0,C.Z)(r.outputs);try{for(O.s();!(I=O.n()).done;){A(I.value,R,M)}}catch(kve){O.e(kve)}finally{O.f()}var F,P=D.slice().reverse(),L=(0,C.Z)(P);try{for(L.s();!(F=L.n()).done;){var Z=F.value;_[Z.id]=Z,Z.id in S||(S[Z.id]=0);var z=S[Z.id],B=null==T[Z.outboundLayer.id]?0:T[Z.outboundLayer.id];z=Math.max(z,B),T[Z.outboundLayer.id]=z,E[Z.outboundLayer.id]=Z.outboundLayer,S[Z.id]=z;for(var U=0;U<Z.inboundLayers.length;U++){var V=Z.inboundLayers[U],j=Z.nodeIndices[U],W=V.inboundNodes[j],H=null==S[W.id]?0:S[W.id];S[W.id]=Math.max(z+1,H),_[W.id]=W}}}catch(kve){L.e(kve)}finally{L.f()}var G={};for(var q in S){var K=S[q];K in G||(G[K]=[]),G[K].push(_[q])}var Y={};for(var X in T){var Q=T[X];Q in Y||(Y[Q]=[]),Y[Q].push(E[X])}var J=Object.keys(Y).map((function(e){return parseInt(e,10)})).sort(nJ);r.layers=[];var $,ee=(0,C.Z)(J);try{for(ee.s();!($=ee.n()).done;){var te=Y[$.value];te.sort((function(e,t){var n=N[e.id],r=N[t.id];return n<r?-1:n>r?1:0}));var ne,re=(0,C.Z)(te);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value;ae instanceof n&&r.internalContainerRefs.push(ae),r.layers.push(ae)}}catch(kve){re.e(kve)}finally{re.f()}}}catch(kve){ee.e(kve)}finally{ee.f()}r.layersByDepth=Y,J=Object.keys(G).map((function(e){return parseInt(e,10)})).sort(nJ);var ie,oe=r.inputs.slice(),se=[],ue=(0,C.Z)(J);try{for(ue.s();!(ie=ue.n()).done;){var ce,le=ie.value,he=(0,C.Z)(G[le]);try{for(he.s();!(ce=he.n()).done;){var fe=ce.value,de=fe.outboundLayer;if(null!=de){var pe,ve=(0,C.Z)(fe.inputTensors);try{for(ve.s();!(pe=ve.n()).done;){var ge=pe.value;if(-1===oe.indexOf(ge))throw new BQ("Graph disconnected: cannot obtain value for tensor ".concat(ge)+' at layer "'.concat(de.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(se))}}catch(kve){ve.e(kve)}finally{ve.f()}var me,ye=(0,C.Z)(fe.outputTensors);try{for(ye.s();!(me=ye.n()).done;){var be=me.value;oe.push(be)}}catch(kve){ye.e(kve)}finally{ye.f()}se.push(de.name)}}}catch(kve){he.e(kve)}finally{he.f()}}}catch(kve){ue.e(kve)}finally{ue.f()}r.nodesByDepth=G;var ke,xe=r.layers.map((function(e){return e.name})),we=(0,C.Z)(xe);try{var Ie=function(){var e=ke.value,t=xe.filter((function(t){return t===e})).length;if(1!==t)throw new BQ('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(xe))};for(we.s();!(ke=we.n()).done;)Ie()}catch(kve){we.e(kve)}finally{we.f()}return r.outboundNodes=[],r.inboundNodes=[],new M$({outboundLayer:(0,Je.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return(0,v.Z)(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=(0,C.Z)(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(kve){n.e(kve)}finally{n.f()}var a,i=(0,C.Z)(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(kve){i.e(kve)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new UQ("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=(0,C.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(kve){n.e(kve)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,C.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,d(r.nonTrainableWeights))}}catch(kve){n.e(kve)}finally{n.f()}if(!this.trainable){var a,i=[],o=(0,C.Z)(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,d(s.trainableWeights))}}catch(kve){o.e(kve)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=(0,C.Z)(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=(0,C.Z)(s.weights);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new UQ("Duplicate weight name: ".concat(c.originalName));r[c.originalName]=c,a++}}catch(kve){u.e(kve)}finally{u.f()}}}catch(kve){i.e(kve)}finally{i.f()}var l=[];for(var h in e){var f=h;if(null==r[h]){var d=h.split("/");f=d.slice(0,-2).concat([d[d.length-1]]).join("/")}if(null!=r[f])l.push([r[f],e[h]]);else if(n)throw new UQ("Provided weight data has no target variable: ".concat(h));delete r[f]}if(n){var p=[];for(var v in r)p.push(v);if(p.length>0)throw new UQ("".concat(p.length," of ").concat(a," weights are not set: ")+"".concat(p))}N$(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(G0),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=H0(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Zj((function(){e=YQ(e);for(var r=new z$,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return V$(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Zj((function(){var r;return e=YQ(e),r=null==t?HQ(null,e.length):YQ(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=w$(e);if(t.length!==this.inputLayers.length)throw new UQ("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nJ);if(o.length>1){var s,u=(0,C.Z)(o);try{for(u.s();!(s=u.n()).done;){var c,l=s.value,h=this.nodesByDepth[l],f=(0,C.Z)(h);try{for(f.s();!(c=f.n()).done;){var d=c.value,p=d.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(p.id)){for(var v=[],g=0;g<d.inboundLayers.length;g++){var m=d.inboundLayers[g],y=d.nodeIndices[g],b=d.tensorIndices[g],k=n["".concat(m.name,"_").concat(y,"_").concat(b)];v.push(k)}for(var x=w$(p.computeOutputShape(KQ(v))),w=p.inboundNodes.indexOf(d),I=0;I<x.length;I++){n["".concat(p.name,"_").concat(w,"_").concat(I)]=x[I]}}}}catch(kve){f.e(kve)}finally{f.f()}}}catch(kve){u.e(kve)}finally{u.f()}}for(var S=[],_=[],T=0;T<this.outputLayers.length;T++){var E=this.outputLayers[T],N=this.outputLayersNodeIndices[T],D=this.outputLayersTensorIndices[T],A="".concat(E.name,"_").concat(N,"_").concat(D);_.push(A)}for(var R=0;R<_.length;R++){var M=_[R];GQ(M in n),S.push(n[M])}return KQ(S)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=HQ(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var s,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nJ),c=(0,C.Z)(u);try{for(c.s();!(s=c.n()).done;){var h,f=s.value,d=this.nodesByDepth[f],p=(0,C.Z)(d);try{for(p.s();!(h=p.n()).done;){var v,g=h.value,m=g.outboundLayer,y=g.inputTensors,b=g.outputTensors,k=new Array,x=(0,C.Z)(y);try{for(x.s();!(v=x.n()).done;){var w=v.value;w.id in n&&k.push(n[w.id])}}catch(kve){x.e(kve)}finally{x.f()}if(k.length===y.length){var I={},S=void 0,_=void 0,T=void 0,E=void 0;if(null!=g.callArgs&&(I=g.callArgs),1===k.length){var N=l(k[0],2),D=N[0],A=N[1];null==I.mask&&(I.mask=A),T=YQ(m.call(D,I)),E=YQ(m.computeMask(D,A)),S=[D],_=[A]}else S=k.map((function(e){return e[0]})),_=k.map((function(e){return e[1]})),null==I.mask&&(I.mask=_),T=YQ(m.call(S,I)),E=YQ(m.computeMask(S,_));if(m.activityRegularizer)throw new VQ("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var R=0;R<b.length;++R){var M=b[R],O=T[R],F=E[R];n[M.id]=[O,F]}}}}catch(kve){p.e(kve)}finally{p.f()}}}catch(kve){c.e(kve)}finally{c.f()}var P,L=[],Z=[],z=[],B=(0,C.Z)(this.outputs);try{for(B.s();!(P=B.n()).done;){var U=P.value;GQ(U.id in n,"Could not compute output ".concat(U.name," : ").concat(U.id));var V=l(n[U.id],2),j=V[0],W=V[1];z.push(j.shape),L.push(j),Z.push(W)}}catch(kve){B.e(kve)}finally{B.f()}return[L,Z,z]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=(0,C.Z)(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(kve){i.e(kve)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t)return this.findLayer(t);if(null==e)throw new UQ("Provide either a layer name or layer index");if("number"===typeof e)return this.findLayer(e);var n,r=(0,C.Z)(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(kve){r.e(kve)}finally{r.f()}throw new UQ("No such layer: ".concat(e))}},{key:"findLayer",value:function(e){if(this.layers.length<=e)throw new UQ("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}},{key:"calculateLosses",value:function(){var e=this;return Zj((function(){var t,r=[],a=(0,C.Z)(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,d(i.calculateLosses()))}}catch(kve){a.e(kve)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=(0,C.Z)(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var h=o.inboundNodes[l],f=n.nodeKey(o,l),d={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),d=h.callArgs}catch(kve){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),d={}}if(h.inboundLayers.length>0){for(var p=[],v=0;v<h.inboundLayers.length;v++){var g=h.inboundLayers[v],m=h.nodeIndices[v],y=h.tensorIndices[v],b=r[n.nodeKey(g,m)];null==b&&(b=0),p.push([g.name,b,y,d])}c.push(p)}}}var k={};k.name=o.name,k.className=s,k.config=u,k.inboundNodes=c,a.push(k)}}catch(kve){i.e(kve)}finally{i.f()}t.layers=a;for(var x=[],w=0;w<this.inputLayers.length;w++){var I=this.inputLayers[w],S=this.inputLayersNodeIndices[w],_=n.nodeKey(I,S);if(this.containerNodes.has(_)){var T=r[_];null!==T&&void 0!==T||(T=0);var E=this.inputLayersTensorIndices[w];x.push([I.name,T,E])}}t.inputLayers=x;for(var N=[],D=0;D<this.outputLayers.length;D++){var A=this.outputLayers[D],R=this.outputLayersNodeIndices[D],M=n.nodeKey(A,R);if(this.containerNodes.has(M)){var O=r[M];null!==O&&void 0!==O||(O=0);var F=this.outputLayersTensorIndices[D];N.push([A.name,O,F])}}return t.outputLayers=N,t}},{key:"stateful",get:function(){if(this._stateful)throw new UQ("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=(0,C.Z)(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(kve){t.e(kve)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Zj((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=(0,C.Z)(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var f=r[c];if(f.inboundNodes.length<=l)return void i(e,t);var d=f.inboundNodes[l];o.push(d.outputTensors[h])}}catch(kve){s.e(kve)}finally{s.f()}o.length>0&&e.apply(KQ(o),n)}function s(e){var a=e.name,o=p0(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new UQ("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,h=(0,C.Z)(l);try{for(h.s();!(u=h.n()).done;){s(u.value)}}catch(kve){h.e(kve)}finally{h.f()}for(;!aJ(a);){var f,d=(0,C.Z)(l);try{for(d.s();!(f=d.n()).done;){var p=f.value,v=r[p.name];if(v.name in a){var g=a[v.name];delete a[v.name];var m,y=(0,C.Z)(g);try{for(y.s();!(m=y.n()).done;){o(v,m.value)}}catch(kve){y.e(kve)}finally{y.f()}}}}catch(kve){d.e(kve)}finally{d.f()}}var b,k=[],x=[],w=t.inputLayers,I=(0,C.Z)(w);try{for(I.s();!(b=I.n()).done;){var S=b.value,_=S[0],T=S[1],E=S[2];GQ(_ in r);var N=r[_].inboundNodes[T].outputTensors;k.push(N[E])}}catch(kve){I.e(kve)}finally{I.f()}var D,A=t.outputLayers,R=(0,C.Z)(A);try{for(R.s();!(D=R.n()).done;){var M=D.value,O=M[0],F=M[1],P=M[2];GQ(O in r);var L=r[O].inboundNodes[F].outputTensors;x.push(L[P])}}catch(kve){R.e(kve)}finally{R.f()}return new e({inputs:k,outputs:x,name:c})}}]),n}(F$);function K0(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function Y0(e,t){return K0(e,t,"classWeight")}function X0(e,t,n,r){return Q0.apply(this,arguments)}function Q0(){return Q0=Rt(Dt().mark((function e(t,n,r,a){var i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=Zj((function(){if(1===t.shape.length)return Oj(t);if(2===t.shape.length){if(t.shape[1]>1){return $W(t,1)}if(1===t.shape[1])return vH(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),zj(i),s=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),e.abrupt("return",HG(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)}))),Q0.apply(this,arguments)}function J0(e,t){return Hj(e,t)}var $0=32;function e1(e,t){var n,r,a=t;n=a.xs,r=a.ys,rL(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=t1("input",e.inputNames,n),o=t1("output",e.outputNames,r),s=i[0].shape[0];rL(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),rL(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){rL(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)u(c);for(var l=function(t){rL(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},h=0;h<o.length;h++)l(h);return{xs:i,ys:o}}function t1(e,t,n){if(n instanceof UU)return[n];if(Array.isArray(n))return rL(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=(0,C.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new UQ("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(kve){i.e(kve)}finally{i.f()}return a}function n1(e){if(3===e.length)throw new VQ("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function r1(e,t,n){return a1.apply(this,arguments)}function a1(){return a1=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p,v,g,m,y,b,k,x,w,I,S,C,_,T,E,N,D,A,R,M,O,F,P;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,rL(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),rL(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),rL(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),rL(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),rL(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(o1(r.validationData)?rL(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(u=n1(r.validationData),o=u.xs,s=u.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),h=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),f=h0(r.callbacks,r.yieldEvery),d=null==r.verbose?1:r.verbose,p=d0(f,d,r.epochs,null,null,i1(n,r),null,i,h),v=p.callbackList,g=p.history,v.setModel(t),t.history=g,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,m=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(m<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(m);case 31:if(k=0,x=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(k<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(k," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return I=e1(t,w.value),S=I.xs,C=I.ys,(_={}).batch=x,_.size=S[0].shape[0],e.next=51,v.onBatchBegin(x,_);case 51:if(T=[],null==r.classWeight){e.next=64;break}E=Y0(r.classWeight,t.outputNames),N=0;case 55:if(!(N<E.length)){e.next=64;break}return e.t0=T,e.next=59,X0(C[N],null,E[N]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++N,e.next=55;break;case 64:for(D=S.concat(C).concat(T),A=c(D),zj(D),R=0;R<l.length;++R)M=l[R],O=A[R],_[M]=O,Bj(O);return e.next=70,v.onBatchEnd(x,_);case 70:i0(_),x++,k++;case 73:if(!(a?k>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!i){e.next=86;break}if(F=void 0,!o1(r.validationData)){e.next=84;break}return e.t2=YQ,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,F=(0,e.t2)(e.t3),e.next=85;break;case 84:F=YQ(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?$0:r.validationBatchSize,verbose:0}));case 85:for(P=0;P<t.metricsNames.length;++P)b["val_".concat(t.metricsNames[P])]=F[P];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(m,b);case 93:if(m++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),a1.apply(this,arguments)}function i1(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function o1(e){return"function"===typeof e.iterator}function s1(e,t,n){return u1.apply(this,arguments)}function u1(){return u1=Rt(Dt().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new VQ("Verbose mode is not implemented yet.");case 6:if(rL(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),"function"!==typeof n.next){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,u=0,c=0,l=Dt().mark((function e(){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=Zj((function(){if(n.value){var e=e1(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),l=Zj((function(){return i(s)}));if(zj(s),0===c)for(var h=0;h<l.length;++h)o.push(Xj(0));for(var f=s[0].shape[0],d=function(e){var t=l[e],n=o[e];o[e]=Zj((function(){return Vj(o[e],Hj(f,t))})),c>0&&zj(n)},p=0;p<l.length;++p)d(p);zj(l),u+=f,++c}return o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(h=0;h<o.length;++h)f=o[h],o[h]=Wj(o[h],u),zj(f);return e.abrupt("return",KQ(o));case 27:case"end":return e.stop()}}),e)}))),u1.apply(this,arguments)}function c1(e){rL(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function l1(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return zJ(e,t,n-t)})):zJ(e,t,n-t)}function h1(e,t){return Zj((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return h1(e,t)})):qJ(e,"int32"===t.dtype?t:Mj(t,"int32"))}))}function f1(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function d1(e){var t=[];e instanceof UU&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(ZJ(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function p1(e,t){if(null!=e){var n=[];if(t instanceof UU)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof UU)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var s=e[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function v1(e){return Array.isArray(e)}function g1(e){return!function(e){return e instanceof UU}(e)&&!v1(e)}function m1(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(v1(e)&&e.length>0)o=!0;else if(g1(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new UQ("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(g1(e)){r=[];var u,c=(0,C.Z)(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new UQ('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(kve){c.e(kve)}finally{c.f()}}else if(v1(e)){if(e.length!==t.length)throw new UQ("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new UQ("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=d1(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var f=r[h];if(f.shape.length!==n[h].length)throw new UQ("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(f.shape));for(var d=0;d<n[h].length;++d)if(0!==d||a){var p=f.shape[d],v=n[h][d];if(null!=v&&v>=0&&p!==v)throw new UQ("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[h].slice(1,n[h].length),"] ")+"(i.e.,tensor shape [*,".concat(n[h].slice(1,n[h].length),"])")+" but the ".concat(i," received an input with ").concat(f.shape[0])+" examples, each with shape [".concat(f.shape.slice(1,f.shape.length),"]")+" (tensor shape [".concat(f.shape,"])"))}}return r}function y1(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new UQ("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new UQ("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new UQ("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new UQ("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var b1=function(e){(0,g.Z)(r,e);var n=(0,m.Z)(r);function r(e){var t;return(0,p.Z)(this,r),(t=n.call(this,e)).isTraining=!1,t}return(0,v.Z)(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new UQ("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");z0(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return iK.adagrad(.01)},Adadelta:function(){return iK.adadelta(1,.95,PJ())},Adam:function(){return iK.adam(.001,.9,.999,PJ())},Adamax:function(){return iK.adamax(.002,.9,.999,PJ(),0)},RMSProp:function(){return iK.rmsprop(.001,.9,0,PJ())},SGD:function(){return iK.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new UQ("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof nW))throw new UQ("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new UQ("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return _0(e)}))}else{var a=_0(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new UQ('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,s=(0,C.Z)(this.outputNames);try{for(s.s();!(o=s.n()).done;){var u=o.value;null==e.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),n.push(_0(e.loss[u]))}}catch(kve){s.e(kve)}finally{s.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],h=this.outputNames[c];this.feedOutputNames.push(h),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var f=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],CJ("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===f.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var d=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=(0,C.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(kve){i.e(kve)}finally{i.f()}return a}(e.metrics,this.outputNames);CJ("metric",(function(){for(var e=function(e){if(-1!==f.indexOf(e))return"continue";!function(n){var r,a,i,o,s=(0,C.Z)(n);try{var u=function(){var n,s=o.value;if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){var u,c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===w0?-1!==["accuracy","acc"].indexOf(s)?a=T0:-1!==["crossentropy","ce"].indexOf(s)&&(a=D0):t.lossFunctions[e]===x0?-1!==["accuracy","acc"].indexOf(s)?a=A0:-1!==["crossentropy","ce"].indexOf(s)&&(a=M0):-1!==["accuracy","acc"].indexOf(s)?a=E0:-1!==["crossentropy","ce"].indexOf(s)&&(a=R0),-1!==["accuracy","acc"].indexOf(s)?u="acc":-1!==["crossentropy","ce"].indexOf(s)&&(u="ce"),i=a,r=""+u}else{var l=function(e){if("string"===typeof e&&e in O0)return O0[e];if("string"!==typeof e&&null!=e)return e;throw new UQ("Unknown metric ".concat(e))}(s);i=l,r=""+F0(s)}CJ(r,(function(){n=i})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,r,n)};for(s.s();!(o=s.n()).done;)u()}catch(kve){s.e(kve)}finally{s.f()}}(d[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;c1(r);var a=this.standardizeUserDataXY(e,t,!0,r);try{var i=a[0].concat(a[1]);this.makeTestFunction();var o=this.testFunction;return KQ(this.testLoop(o,i,r,n.verbose,n.steps))}finally{p1(a[0],e),p1(a[1],t)}}},{key:"evaluateDataset",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",s1(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new UQ("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new UQ("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new UQ("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new z$;if(e instanceof UU&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new UQ("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var s,u=(0,C.Z)(this.inputs);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e[c.name];if(null==l)throw new UQ("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(kve){u.e(kve)}finally{u.f()}}var h=V$(a,i);return n?h:h[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=HQ(null,e.length),r=e.length,a=(0,C.Z)(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(kve){a.e(kve)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new UQ("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Zj((function(){var a=t.checkNumSamples(e);if(r)throw new VQ("Verbose predictLoop() is not implemented yet.");for(var i=f1(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){Zj((function(){var r=i[n][0],a=i[n][1],o=l1(e,r,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:t.inputs[u],value:o[u]});else s.push({key:t.inputs[0],value:o});var c=new z$(s);return V$(t.outputs,c)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return KQ(o.map((function(e){return SH(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=d1(e);y1(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return c1(r),this.predictLoop(n,r)}finally{p1(n,e)}}},{key:"predictOnBatch",value:function(e){y1(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new BQ("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a];this.feedLossFns[a]===x0?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(function(e,t,n){var r=rJ(e.map((function(e){return e.shape[0]})));r.sort();var a=rJ(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new UQ("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new UQ("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!sL(r,a))throw new UQ("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(e=m1(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=m1(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){for(var r=[g0,w0,k0],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===k0&&1===i.shape[i.shape.length-1])throw new UQ("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var h=u[l],f=c[l];if(null!=f&&h!==f)throw new UQ("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new UQ("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a){var i,o,s,u,c,h,f,d,p,v=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(v.length>4&&void 0!==v[4])||v[4],o=v.length>5?v[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=l(s,2),c=u[0],h=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(f=null,null==a){e.next=19;break}d=Y0(a,this.outputNames),f=[],p=0;case 10:if(!(p<d.length)){e.next=19;break}return e.t0=f,e.next=14,X0(h[p],null,d[p]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++p,e.next=10;break;case 19:return e.abrupt("return",[c,h,f]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return Zj((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new VQ("Verbose mode is not implemented yet.");if(null!=i)throw new VQ("steps mode in testLoop() is not implemented yet");for(var u=f1(o,n),c=HG(FJ(0,o)),l=0;l<u.length;++l){var h=u[l][0],f=u[l][1],d=zJ(c,h,f-h),p=h1(t,d),v=e(p);if(0===l)for(var g=0;g<v.length;++g)s.push(Xj(0));for(var m=0;m<v.length;++m){var y=v[m];s[m]=Vj(s[m],Hj(f-h,y))}}for(var b=0;b<s.length;++b)s[b]=Wj(s[b],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(qQ(e,r)>1){var i=qQ(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new z$(t),l=V$(e.outputs,c,{training:!0}),h=0;h<e.lossFunctions.length;++h){var f=(0,e.lossFunctions[h])(a[h],l[h]);null!=i[h]&&(f=J0(f,i[h]));var d=aG(f);n.push(d),u=0===h?f:Vj(u,f)}for(var p=0;p<e.metricsTensors.length;++p){var v=void 0;if(e.outputs.length>1&&p<e.outputs.length)v=n[p];else{var g=e.metricsTensors[p][0],m=e.metricsTensors[p][1];v=aG(g(a[m],l[m]))}Bj(v),o.push(v)}return u=aG(u),e.calculateLosses().forEach((function(e){u=Vj(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return Zj((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new z$(o),c=V$(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var h=e.lossFunctions[l],f=aG(h(i[l],c[l]));n=0===l?f:Vj(n,f),r.push(n)}for(var d=0;d<e.metricsTensors.length;++d){var p=e.metricsTensors[d][0],v=e.metricsTensors[d][1],g=aG(p(i[v],c[v]));r.push(g)}return r}))}}},{key:"fit",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d,p,v,g,m,y,b,k,x,w,I,S,C,_,T=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=T.length>2&&void 0!==T[2]?T[2]:{},!this.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return this.isTraining=!0,e.prev=4,c1(d=null==r.batchSize?32:r.batchSize),!1,e.next=10,this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,false,d);case 10:if(p=e.sent,a=p[0],i=p[1],f=p[2],v=!1,!(null!=r.validationData&&r.validationData.length>0)){e.next=36;break}if(v=!0,2!==r.validationData.length){e.next=22;break}u=r.validationData[0],c=r.validationData[1],e.next=27;break;case 22:if(3!==r.validationData.length){e.next=26;break}throw new VQ("validationData including sample weights is not supported yet.");case 26:throw new UQ("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(r.validationData," is invalid."));case 27:return!0,e.next=30,this.standardizeUserData(u,c,null,null,true,d);case 30:m=e.sent,l=m[0],h=m[1],g=l.concat(h),e.next=37;break;case 36:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(v=!0,y=Math.floor(a[0].shape[0]*(1-r.validationSplit)),b=a[0].shape[0],l=l1(a,y,b),o=a,a=l1(a,0,y),h=l1(i,y,b),s=i,i=l1(i,0,y),g=l.concat(h)):null!=r.validationSteps&&(v=!0);case 37:return k=a.concat(i).concat(f),this.checkTrainableWeightsConsistency(),x=this.makeTrainFunction(),w=this.getDedupedMetricsNames(),v?(this.makeTestFunction(),I=this.testFunction,S=w.slice().concat(w.map((function(e){return"val_"+e})))):(I=null,g=[],S=w.slice()),C=h0(r.callbacks,r.yieldEvery),e.next=45,this.fitLoop(x,k,w,d,r.epochs,r.verbose,C,I,g,r.shuffle,S,r.initialEpoch,null,null);case 45:return _=e.sent,e.abrupt("return",_);case 47:return e.prev=47,this.isTraining=!1,p1(a,t),p1(i,n),p1(o,t),p1(s,n),p1(l,u),p1(h,c),null!=f&&zj(f),e.finish(47);case 57:case"end":return e.stop()}}),e,this,[[4,,47,57]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitLoop",value:function(){var e=Rt(Dt().mark((function e(t,n,r,a,i,o,s,u,c,l,h,f,d,p){var v,g,m,y,b,k,x,w,I=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==f&&(f=0),v=!1,null!=u&&null!=c&&(v=!0),null==p){e.next=10;break}if(v=!0,null!=d){e.next=10;break}throw new UQ("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=this.checkNumSamples(n,a,d,"steps_per_epoch"))&&(m=FJ(0,g)),null==o&&(o=1),y=d0(s,o,i,f,g,d,a,v,h),b=y.callbackList,k=y.history,b.setModel(this),this.history=k,e.next=18,b.onTrainBegin();case 18:this.stopTraining_=!1,x=Dt().mark((function e(){var i,o,s,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.onEpochBegin(w);case 2:if(i={},null==d){e.next=7;break}throw new VQ("stepsPerEpoch mode is not implemented yet.");case 7:if("batch"!==l){e.next=11;break}throw new VQ("batch shuffling is not implemneted yet");case 11:l&&JP(m);case 12:o=HG(m),s=f1(g,a),h=Dt().mark((function e(l){var h;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h={},e.next=3,b.onBatchBegin(l,h);case 3:return Zj((function(){var e=s[l][0],f=s[l][1],d=zJ(o,e,f-e);h.batch=l,h.size=f-e;for(var p=h1(n,d),g=t(p),m=0;m<r.length;++m){var y=r[m],b=g[m];h[y]=b,Bj(b)}if(l===s.length-1&&v)for(var k=I.testLoop(u,c,a),x=0;x<r.length;++x){var w=r[x],S=k[x];Bj(S),i["val_"+w]=S}})),e.next=6,b.onBatchEnd(l,h);case 6:if(i0(h),!I.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),f=0;case 16:if(!(f<s.length)){e.next=24;break}return e.delegateYield(h(f),"t0",18);case 18:if("break"!==e.t0){e.next=21;break}return e.abrupt("break",24);case 21:++f,e.next=16;break;case 24:o.dispose();case 25:return e.next=27,b.onEpochEnd(w,i);case 27:if(!I.stopTraining_){e.next=29;break}return e.abrupt("return","break");case 29:case"end":return e.stop()}}),e)})),w=f;case 21:if(!(w<i)){e.next=29;break}return e.delegateYield(x(),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++w,e.next=21;break;case 29:return e.next=31,b.onTrainEnd();case 31:return e.next=33,this.history.syncData();case 33:return e.abrupt("return",this.history);case 34:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,o,s,u,c,l,h,f,d,p){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r1(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),s=o(a.concat(i)),u=[],c=(0,C.Z)(s),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return h=l.value,e.next=15,h.data();case 15:f=e.sent,u.push(f[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return zj(s),p1(r[0],t),p1(r[1],n),e.abrupt("return",KQ(u));case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=sr((0,y.Z)(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=Lj().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Lj().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=XQ(this.loss);else if(Array.isArray(this.loss)){var t,n=(0,C.Z)(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(kve){n.e(kve)}finally{n.f()}e=this.loss.map((function(e){return XQ(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=XQ(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[XQ(F0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return XQ(F0(e))}));var e={};for(var t in this.metrics)e[t]=XQ(F0(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=p0(W0(e.optimizer_config));if("string"===typeof e.loss)t=QQ(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return QQ(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=QQ(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return QQ(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=QQ(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var e=Rt(Dt().mark((function e(n,r){var a,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof n){e.next=9;break}if(0!==(a=GV(n)).length){e.next=6;break}throw new UQ("Cannot find any save handlers for URL '".concat(n,"'"));case 6:if(!(a.length>1)){e.next=8;break}throw new UQ("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(n,"'"));case 8:n=a[0];case 9:if(null!=n.save){e.next=11;break}throw new UQ("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.next=13,_V(this.getNamedWeights(r));case 13:if(i=e.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(G0),convertedBy:null},!(null!=r&&r.includeOptimizer)||null==this.optimizer){e.next=34;break}return s.trainingConfig=this.getTrainingConfig(),c="optimizer",e.t0=t,e.next=25,this.optimizer.getWeights();case 25:return e.t1=e.sent,e.t2=c,e.next=29,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 29:l=e.sent,h=l.data,f=l.specs,(u=i.specs).push.apply(u,d(f)),i.data=OV([i.data,h]);case 34:return null!=this.userDefinedMetadata&&(!0,L0(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=i.data,s.weightSpecs=i.specs,e.abrupt("return",n.save(s));case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){L0(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}(q0);b1.className="Model",tW(b1);var k1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(b1);k1.className="Functional",tW(k1);var x1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:dJ("sequential_"),null!=e.layers){var a,i=(0,C.Z)(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(kve){i.e(kve)}finally{i.f()}}return r}return(0,v.Z)(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new UQ("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof b1;if(r){if(1!==(t=e).outputs.length)throw new UQ("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new UQ("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new UQ("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=Z$({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new UQ("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new UQ("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=P$(this.outputs[0])}this.inboundNodes=[],new M$({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:HQ(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(S$(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new b1({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),sr((0,y.Z)(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),sr((0,y.Z)(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new BQ("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new BQ("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=Rt(Dt().mark((function e(t,n){var r,a=arguments;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new BQ("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new BQ("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Rt(Dt().mark((function e(t,n){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new UQ("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new UQ("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=(0,C.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(kve){n.e(kve)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new UQ("Legacy serialization format not supported yet.");r=t}else rL(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new VQ("Sequential.fromConfig called on non-Sequential input: ".concat(o));var s,u=(0,C.Z)(r);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=p0(c,undefined,a);a&&l.setFastWeightInitDuringBuild(!0),o.add(l)}}catch(kve){u.e(kve)}finally{u.f()}return o}}]),n}(b1);x1.className="Sequential",tW(x1);var w1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}($j),I1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new VQ("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return ZH(e)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}]),n}(w1);I1.className="elu",tW(I1);var S1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return AG(e)}}]),n}(w1);S1.className="selu",tW(S1);var C1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return NG(e)}}]),n}(w1);C1.className="relu",tW(C1);var _1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return Zj((function(){return oG(6,NG(e))}))}}]),n}(w1);_1.className="relu6",tW(_1);var T1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return e}}]),n}(w1);T1.className="linear",tW(T1);var E1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return MG(e)}}]),n}(w1);E1.className="sigmoid",tW(E1);var N1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return function(e){return Zj((function(){var t=Vj(.5,Hj(.2,e));return IH(t,0,1)}))}(e)}}]),n}(w1);N1.className="hardSigmoid",tW(N1);var D1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return BG(e)}}]),n}(w1);D1.className="softplus",tW(D1);var A1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return function(e){return Zj((function(){return Wj(e,Vj(cW(e),1))}))}(e)}}]),n}(w1);A1.className="softsign",tW(A1);var R1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return WG(e)}}]),n}(w1);R1.className="tanh",tW(R1);var M1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return zG(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(w1);M1.className="softmax",tW(M1);var O1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return $H(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}]),n}(w1);O1.className="logSoftmax",tW(O1);var F1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Zj((function(){return Hj(MG(Hj(e,t)),e)}))}}]),n}(w1);F1.className="swish",tW(F1);var P1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e){return Zj((function(){return Hj(e,WG(BG(e)))}))}}]),n}(w1);function L1(e){return e.getClassName()}function Z1(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tJ(e,eW.getMap().classNameMap,t,"activation")}function z1(e){if(null==e){var t={className:"linear",config:{}};return Z1(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},Z1(n)}return e instanceof w1?e:Z1(e)}function B1(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}P1.className="mish",tW(P1);var U1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}($j),V1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this),B1(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return(0,v.Z)(n,[{key:"apply",value:function(e){var t=this;return Zj((function(){var n=yG([1]);return t.hasL1&&(n=Vj(n,JH(Hj(t.l1,cW(e))))),t.hasL2&&(n=Vj(n,JH(Hj(t.l2,KJ(e))))),vH(n,[])}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(U1);V1.className="L1L2",tW(V1);var j1={l1l2:"L1L2"};function W1(e){return $Q(e)}function H1(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tJ(e,eW.getMap().classNameMap,t,"regularizer")}function G1(e){return null==e?null:"string"===typeof e?H1({className:e in j1?j1[e]:e,config:{}}):e instanceof U1?e:H1(e)}var q1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return(0,v.Z)(n,[{key:"call",value:function(e,t){e=I$(e);var n=NG(e);return null!=this.maxValue&&(n=IH(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);q1.className="ReLU",tW(q1);var K1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=I$(e);return KH(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);K1.className="LeakyReLU",tW(K1);var Y1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=k$(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=G1(e.alphaRegularizer),r.alphaConstraint=n0(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new UQ("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return(0,v.Z)(n,[{key:"build",value:function(e){var t=(e=S$(e)).slice(1);if(null!=this.sharedAxes){var n,r=(0,C.Z)(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(kve){r.e(kve)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new D$({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=I$(e),wG(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:b$(this.alphaInitializer),alphaRegularizer:W1(this.alphaRegularizer),alphaConstraint:e0(this.alphaConstraint),sharedAxes:this.sharedAxes},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);Y1.className="PReLU",tW(Y1);var X1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new VQ("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=I$(e);return ZH(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);X1.className="ELU",tW(X1);var Q1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=I$(e);return Hj(n,Mj(GH(n,this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);Q1.className="ThresholdedReLU",tW(Q1);var J1=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new M1).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=I$(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);function $1(e,t,n){if("number"===typeof e)return HQ(e,t);if(e.length!==t)throw new UQ("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if(!AJ(a))throw new UQ("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e}function e2(e,t,n,r){var a;return null==e?e:(a="same"===n?e:e-(t+(t-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r))}function t2(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+OJ([n-t,0]);else{if("same"!==r)throw new UQ("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function n2(e,t){return Zj((function(){return kJ(t),"channelsFirst"===t?JG(e,[0,2,3,1]):e}))}function r2(e,t){return Zj((function(){return kJ(t),"channelsFirst"===t?JG(e,[0,2,3,4,1]):e}))}function a2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Zj((function(){if(null==i&&(i="channelsLast"),kJ(i),3!==e.shape.length)throw new UQ("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new UQ("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new UQ("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=JG(e,[0,2,1])),"causal"===a)throw new VQ("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=DH(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=XJ(s,n)),s}))}function i2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Zj((function(){if(null==i&&(i="channelsLast"),kJ(i),3!==e.rank&&4!==e.rank)throw new UQ("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new UQ("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=n2(e,i);if("causal"===a)throw new VQ("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=hq({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=JG(u,[0,3,1,2])),u}))}function o2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return Zj((function(){if(null==i&&(i="channelsLast"),kJ(i),4!==e.rank&&5!==e.rank)throw new UQ("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new UQ("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=r2(e,i);if("causal"===a)throw new VQ("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=MH(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=XJ(s,n)),"channelsFirst"===i&&(s=JG(s,[0,4,1,2,3])),s}))}J1.className="Softmax",tW(J1);var s2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;if((0,p.Z)(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,sJ(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new VQ("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=$1(r.kernelSize,e,"kernelSize"),a.strides=$1(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,xJ(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,kJ(a.dataFormat),a.activation=z1(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=k$(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=n0(r.biasConstraint),a.biasRegularizer=G1(r.biasRegularizer),a.activityRegularizer=G1(r.activityRegularizer),a.dilationRate=$1(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new UQ("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new UQ("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new UQ("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:L1(this.activation),useBias:this.useBias,biasInitializer:b$(this.biasInitializer),biasRegularizer:W1(this.biasRegularizer),activityRegularizer:W1(this.activityRegularizer),biasConstraint:e0(this.biasConstraint)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(GQ("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!oJ(e.kernelSize,"number",1,3))throw new UQ("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(F$),u2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,sJ(a.filters,"filters"),a.kernelInitializer=k$(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=n0(r.kernelConstraint),a.kernelRegularizer=G1(r.kernelRegularizer),a}return(0,v.Z)(n,[{key:"build",value:function(e){e=S$(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new UQ("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(0,Ye.Z)({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t;e=I$(e);var r=null==n.bias?null:n.bias.read(),a=cJ(n.activation.getClassName());if(null!=a&&2===n.rank)t=i2(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=a2(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=i2(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new VQ("convolutions greater than 3D are not implemented yet.");t=o2(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=S$(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=e2(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:b$(this.kernelInitializer),kernelRegularizer:W1(this.kernelRegularizer),kernelConstraint:e0(this.kernelConstraint)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new UQ("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(s2),c2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!oJ(e.kernelSize,"number",1,2))throw new UQ("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(u2);c2.className="Conv2D",tW(c2);var l2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new UQ("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(u2);l2.className="Conv3D",tW(l2);var h2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).inputSpec=[new D$({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new UQ("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,v.Z)(n,[{key:"build",value:function(e){if(4!==(e=S$(e)).length)throw new UQ("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new UQ("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new D$({ndim:4,axes:(0,Ye.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e);if(4!==t.shape.length)throw new UQ("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],c=n.kernelSize[0],l=n.kernelSize[1],h=n.strides[0],f=n.strides[1],d=[o,t2(s,h,c,n.padding),t2(u,f,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=JG(t,[0,2,3,1]));var p=RH(t,n.kernel.read(),d,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(p=JG(p,[0,3,1,2])),null!=n.bias&&(p=XJ(p,n.bias.read(),n.dataFormat)),null!=n.activation&&(p=n.activation.apply(p)),p}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=S$(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=t2(a[n],s,i,this.padding),a[r]=t2(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(c2);h2.className="Conv2DTranspose",tW(h2);var f2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).inputSpec=[new D$({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new UQ("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,v.Z)(n,[{key:"build",value:function(e){if(5!==(e=S$(e)).length)throw new UQ("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new UQ("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new D$({ndim:5,axes:(0,Ye.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e);if(5!==t.shape.length)throw new UQ("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i,o=t.shape,s=o[0];"channelsFirst"===n.dataFormat?(i=2,r=3,a=4):(i=1,r=2,a=3);var u=o[i],c=o[r],l=o[a],h=n.kernelSize[0],f=n.kernelSize[1],d=n.kernelSize[2],p=n.strides[0],v=n.strides[1],g=n.strides[2],m=[s,t2(u,p,h,n.padding),t2(c,v,f,n.padding),t2(l,g,d,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=JG(t,[0,2,3,4,1]));var y=FH(t,n.kernel.read(),m,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=JG(y,[0,4,1,2,3])),null!==n.bias&&(y=XJ(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=S$(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],h=this.strides[2];return i[t]=this.filters,i[n]=t2(i[n],c,o,this.padding),i[r]=t2(i[r],l,s,this.padding),i[a]=t2(i[a],h,u,this.padding),i}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(l2);f2.className="Conv3DTranspose",tW(f2);var d2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;if((0,p.Z)(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new UQ("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new UQ("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new UQ("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=k$(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=G1(r.depthwiseRegularizer),a.depthwiseConstraint=n0(r.depthwiseConstraint),a.pointwiseInitializer=k$(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=G1(r.pointwiseRegularizer),a.pointwiseConstraint=n0(r.pointwiseConstraint),a}return(0,v.Z)(n,[{key:"build",value:function(e){if((e=S$(e)).length<this.rank+2)throw new UQ("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new UQ("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new D$({ndim:this.rank+2,axes:(0,Ye.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t;if(e=I$(e),1===n.rank)throw new VQ("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=JG(e,[0,2,3,1])),t=RG(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=XJ(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=JG(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=b$(this.depthwiseInitializer),e.pointwiseInitializer=b$(this.pointwiseInitializer),e.depthwiseRegularizer=W1(this.depthwiseRegularizer),e.pointwiseRegularizer=W1(this.pointwiseRegularizer),e.depthwiseConstraint=e0(this.depthwiseConstraint),e.pointwiseConstraint=e0(this.pointwiseConstraint),e}}]),n}(u2);d2.className="SeparableConv";var p2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,2,e)}return(0,v.Z)(n)}(d2);p2.className="SeparableConv2D",tW(p2);var v2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!oJ(e.kernelSize,"number",1,1))throw new UQ("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(u2);v2.className="Conv1D",tW(v2);var g2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(e=I$(e),"channelsLast"===n.dataFormat){var t=UJ(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return UJ(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=UJ(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return UJ(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);g2.className="Cropping2D",tW(g2);var m2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kJ(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,function(e){iJ(vJ,"InterpolationFormat",e)}(r.interpolation),r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=JG(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?nK.resizeNearestNeighbor(t,[a,i]):nK.resizeBilinear(t,[a,i]);return JG(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?nK.resizeNearestNeighbor(t,[s,u]):nK.resizeBilinear(t,[s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);m2.className="UpSampling2D",tW(m2);var y2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=k$(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=n0(e.depthwiseConstraint),r.depthwiseRegularizer=G1(e.depthwiseRegularizer),r}return(0,v.Z)(n,[{key:"build",value:function(e){if((e=S$(e)).length<4)throw new UQ("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new UQ("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return Zj((function(){null==a&&(a="channelsLast"),kJ(a);var o=n2(e,a);if(4!==e.rank)throw new UQ("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new UQ("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=LH(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=JG(o,[0,3,1,2])),o}))}(e=I$(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=XJ(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=S$(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=e2(t,this.kernelSize[0],this.padding,this.strides[0]),i=e2(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=b$(this.depthwiseInitializer),e.depthwiseRegularizer=W1(this.depthwiseRegularizer),e.depthwiseConstraint=e0(this.depthwiseRegularizer),e}}]),n}(s2);function b2(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new UQ("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function k2(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Zj((function(){var u=t.shape.length;if(u<3)throw new UQ("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(FJ(2,u));if(t=JG(t,c),null!=i)throw new VQ("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=Mj(Mj(a,"bool"),"float32")).rank===u-1&&(a=UH(a,-1)),a=JG(a,c)),r&&(t=DG(t,0),null!=a&&(a=DG(a,0)));var l,h,f=[],d=n,p=t.shape[0],v=KG(t);null!=a&&(h=KG(a));for(var g,m=function(t){var n=v[t],r=Zj((function(){return e(n,d)}));if(null==a)l=r[0],d=r[1];else{var i=Zj((function(){var e=h[t],n=sW(kG(e),e);return{output:Vj(Hj(r[0],e),Hj(d[0],n)),newStates:d.map((function(t,a){return Vj(Hj(r[1][a],e),Hj(t,n))}))}}));l=i.output,d=i.newStates}s&&f.push(l)},y=0;y<p;++y)m(y);if(s){g=jG(f,1)}return[l,g,d]}))}y2.className="DepthwiseConv2D",tW(y2);var x2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r,a;if((0,p.Z)(this,n),r=t.call(this,e),null==e.cell)throw new UQ("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new N2({cells:e.cell}):e.cell).stateSize)throw new UQ("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new D$({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return(0,v.Z)(n,[{key:"getStates",value:function(){return null==this.states_?FJ(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){x$(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=(0,C.Z)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(kve){o.e(kve)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return Zj((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new VQ("Constants support is not implemented in RNN yet.");x$(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new D$({shape:[t,null].concat(d(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!sL(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new UQ("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new D$({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Zj((function(){if(!t.stateful)throw new zQ("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new UQ("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return yG([r,e])})):t.states_=[yG([r,t.cell.stateSize])];else if(null==e)zj(t.states_),null!=t.keptStates&&(zj(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return yG([r,e])})):t.states_[0]=yG([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new UQ("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):zj(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!sL(i.shape,s))throw new UQ("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return Bj(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=b2(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=(0,C.Z)(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new D$({shape:l.shape}))}}catch(kve){c.e(kve)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof A$){var h=[e].concat(o),f=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=f;var p=sr((0,y.Z)(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=d,p}return sr((0,y.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=I$(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new UQ("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=k2((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],h=u[2];n.stateful&&n.resetStates(h,a);var f=n.returnSequences?l:c;return n.returnState?[f].concat(h):f}))}},{key:"getInitialState",value:function(e){var t=this;return Zj((function(){var n=yG(e.shape);return n=ZJ(n=JH(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?WJ(n,[1,e]):n})):t.cell.stateSize>1?[WJ(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){sr((0,y.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=p0(t.cell,n);return new e(Object.assign(t,{cell:r}))}}]),n}(F$);x2.className="RNN",tW(x2);var w2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n)}(F$),I2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sJ(r.units,"units"),r.activation=z1(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=k$(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=k$(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=k$(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=G1(e.kernelRegularizer),r.recurrentRegularizer=G1(e.recurrentRegularizer),r.biasRegularizer=G1(e.biasRegularizer),r.kernelConstraint=n0(e.kernelConstraint),r.recurrentConstraint=n0(e.recurrentConstraint),r.biasConstraint=n0(e.biasConstraint),r.dropout=MJ([1,OJ([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MJ([1,OJ([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,v.Z)(n,[{key:"build",value:function(e){e=S$(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(2!==e.length)throw new UQ("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=D2({ones:function(){return kG(e)},rate:n.dropout,training:i,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=D2({ones:function(){return kG(r)},rate:n.recurrentDropout,training:i,dropoutFunc:n.dropoutFunc}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=GJ(null!=o?Hj(e,o):e,n.kernel.read()),null!=n.bias&&(a=XJ(a,n.bias.read())),null!=s&&(r=Hj(r,s));var u=Vj(a,GJ(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:L1(this.activation),useBias:this.useBias,kernelInitializer:b$(this.kernelInitializer),recurrentInitializer:b$(this.recurrentInitializer),biasInitializer:b$(this.biasInitializer),kernelRegularizer:W1(this.kernelRegularizer),recurrentRegularizer:W1(this.recurrentRegularizer),biasRegularizer:W1(this.biasRegularizer),activityRegularizer:W1(this.activityRegularizer),kernelConstraint:e0(this.kernelConstraint),recurrentConstraint:e0(this.recurrentConstraint),biasConstraint:e0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}]),n}(w2);I2.className="SimpleRNNCell",tW(I2);var S2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),e.cell=new I2(e),t.call(this,e)}return(0,v.Z)(n,[{key:"call",value:function(e,t){var r=this;return Zj((function(){null!=r.cell.dropoutMask&&(zj(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(zj(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return sr((0,y.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(x2);S2.className="SimpleRNN",tW(S2);var C2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new UQ("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,sJ(r.units,"units"),r.activation=z1(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=z1(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=k$(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=k$(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=k$(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=G1(e.kernelRegularizer),r.recurrentRegularizer=G1(e.recurrentRegularizer),r.biasRegularizer=G1(e.biasRegularizer),r.kernelConstraint=n0(e.kernelConstraint),r.recurrentConstraint=n0(e.recurrentConstraint),r.biasConstraint=n0(e.biasConstraint),r.dropout=MJ([1,OJ([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MJ([1,OJ([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,v.Z)(n,[{key:"build",value:function(e){var t=(e=S$(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(2!==e.length)throw new UQ("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=D2({ones:function(){return kG(e)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=D2({ones:function(){return kG(a)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var i,o,s,u=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Hj(e,u[0]));var h=GJ(e,n.kernel.read());n.useBias&&(h=XJ(h,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Hj(a,c[0]));var f=n.recurrentKernel.read(),d=l(UG(f,[2*n.units,n.units],f.rank-1),2),p=d[0],v=d[1],g=GJ(a,p),m=l(UG(h,3,h.rank-1),3),y=m[0],b=m[1],k=m[2],x=l(UG(g,2,g.rank-1),2),w=x[0],I=x[1];i=n.recurrentActivation.apply(Vj(y,w)),o=n.recurrentActivation.apply(Vj(b,I));var S=GJ(Hj(o,a),v);s=n.activation.apply(Vj(k,S));var C=Vj(Hj(i,a),Hj(Vj(1,vG(i)),s));return[C,C]}))}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:L1(this.activation),recurrentActivation:L1(this.recurrentActivation),useBias:this.useBias,kernelInitializer:b$(this.kernelInitializer),recurrentInitializer:b$(this.recurrentInitializer),biasInitializer:b$(this.biasInitializer),kernelRegularizer:W1(this.kernelRegularizer),recurrentRegularizer:W1(this.recurrentRegularizer),biasRegularizer:W1(this.biasRegularizer),activityRegularizer:W1(this.activityRegularizer),kernelConstraint:e0(this.kernelConstraint),recurrentConstraint:e0(this.recurrentConstraint),biasConstraint:e0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}]),n}(w2);C2.className="GRUCell",tW(C2);var _2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new C2(e),t.call(this,e)}return(0,v.Z)(n,[{key:"call",value:function(e,t){var r=this;return Zj((function(){null!=r.cell.dropoutMask&&(zj(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(zj(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return sr((0,y.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(x2);_2.className="GRU",tW(_2);var T2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sJ(r.units,"units"),r.activation=z1(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=z1(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=k$(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=k$(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=k$(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=G1(e.kernelRegularizer),r.recurrentRegularizer=G1(e.recurrentRegularizer),r.biasRegularizer=G1(e.biasRegularizer),r.kernelConstraint=n0(e.kernelConstraint),r.recurrentConstraint=n0(e.recurrentConstraint),r.biasConstraint=n0(e.biasConstraint),r.dropout=MJ([1,OJ([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MJ([1,OJ([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,v.Z)(n,[{key:"build",value:function(e){var t,n,r=(e=S$(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new r$).apply([i]),o=a.apply([2*i]);return jJ(jJ(n,r),o)}}]),n}(t$),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new UQ("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=D2({ones:function(){return kG(e)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=D2({ones:function(){return kG(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var o,s,u,c,h=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Hj(e,h[0]));var d=GJ(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Hj(a,f[0])),d=Vj(d,GJ(a,n.recurrentKernel.read())),n.useBias&&(d=XJ(d,n.bias.read()));var p=l(UG(d,4,d.rank-1),4),v=p[0],g=p[1],m=p[2],y=p[3];o=n.recurrentActivation.apply(v),s=n.recurrentActivation.apply(g),u=Vj(Hj(s,i),Hj(o,n.activation.apply(m))),c=n.recurrentActivation.apply(y);var b=Hj(c,n.activation.apply(u));return[b,b,u]}))}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:L1(this.activation),recurrentActivation:L1(this.recurrentActivation),useBias:this.useBias,kernelInitializer:b$(this.kernelInitializer),recurrentInitializer:b$(this.recurrentInitializer),biasInitializer:b$(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:W1(this.kernelRegularizer),recurrentRegularizer:W1(this.recurrentRegularizer),biasRegularizer:W1(this.biasRegularizer),activityRegularizer:W1(this.activityRegularizer),kernelConstraint:e0(this.kernelConstraint),recurrentConstraint:e0(this.recurrentConstraint),biasConstraint:e0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}]),n}(w2);T2.className="LSTMCell",tW(T2);var E2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new T2(e),t.call(this,e)}return(0,v.Z)(n,[{key:"call",value:function(e,t){var r=this;return Zj((function(){null!=r.cell.dropoutMask&&(zj(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(zj(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return sr((0,y.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(x2);E2.className="LSTM",tW(E2);var N2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).cells=e.cells,r}return(0,v.Z)(n,[{key:"stateSize",get:function(){var e,t=[],n=(0,C.Z)(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,d(r.stateSize)):t.push(r.stateSize)}}catch(kve){n.e(kve)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r,a=e.slice(1),i=[],o=(0,C.Z)(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(kve){o.e(kve)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var h=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=h.call(u,t),c.push(u.slice(1))}a=[];var f,p=(0,C.Z)(c.slice().reverse());try{for(p.s();!(f=p.n()).done;){var v,g=f.value;(v=a).push.apply(v,d(g))}}catch(kve){p.e(kve)}finally{p.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;x$(e)&&(e=e[0]),this.cells.forEach((function(n,r){CJ("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign(Object.assign({},e),t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=(0,C.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,d(r.trainableWeights))}}catch(kve){n.e(kve)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,C.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,d(r.nonTrainableWeights))}}catch(kve){n.e(kve)}finally{n.f()}if(!this.trainable){var a,i=[],o=(0,C.Z)(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,d(s.trainableWeights))}}catch(kve){o.e(kve)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=(0,C.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,d(r.weights))}}catch(kve){n.e(kve)}finally{n.f()}return E$(t)}},{key:"setWeights",value:function(e){var t,n=[],r=(0,C.Z)(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch(kve){r.e(kve)}finally{r.f()}N$(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=(0,C.Z)(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(p0(o,r))}}catch(kve){i.e(kve)}finally{i.f()}return new e({cells:a})}}]),n}(w2);function D2(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=e.dropoutFunc,u=function(){return null!=s?s(t(),n):QJ(t(),n)},c=function(){return JJ(u,t,a)};return!o||o<=1?Bj(c().clone()):Array(o).fill(void 0).map(c).map((function(e){return Bj(e.clone())}))}N2.className="StackedRNNCells",tW(N2);var A2=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},R2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),e.unroll)throw new VQ("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new VQ("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new D$({ndim:5})],r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var r=this;return Zj((function(){if(null!=r.cell.dropoutMask&&(zj(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(zj(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new UQ("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return sr((0,y.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(d(t.slice(2)))),this.returnState&&(t=[t].concat(d(Array(2).fill([e[0]].concat(d(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return Zj((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=yG([a[0]].concat(d(a.slice(2))));return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Zj((function(){if(!t.stateful)throw new zQ("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(d(a.slice(2)));if(null==r[0])throw new UQ("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return yG(i)})):t.states_=[yG(i)];else if(null==e)zj(t.states_),null!=t.keptStates&&(zj(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return yG(i)})):t.states_[0]=yG(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new UQ("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):zj(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!sL(s.shape,u))throw new UQ("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return Bj(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?3:2],l=e[u?4:3],h=e2(c,a[0],i,o[0],s[0]),f=e2(l,a[1],i,o[1],s[1]);return[].concat(d(e.slice(0,2)),d(u?[r,h,f]:[h,f,r]))}}]),n}(x2);R2.className="ConvRNN2D";var M2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;(0,p.Z)(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign(Object.assign({},e),{units:a}))).filters=a,sJ(r.filters,"filters"),r.kernelSize=$1(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return sJ(e,"kernelSize")})),r.strides=$1(o||1,2,"strides"),r.strides.forEach((function(e){return sJ(e,"strides")})),r.padding=s||"valid",xJ(r.padding),r.dataFormat=u||"channelsLast",kJ(r.dataFormat),r.dilationRate=$1(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return sJ(e,"dilationRate")})),r}return(0,v.Z)(n,[{key:"build",value:function(e){var t;e=S$(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new UQ("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var s=this.biasInitializer,u=this.filters;o=new(t=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"apply",value:function(e,t){return VJ([s.apply([u]),bG([u]),s.apply([2*u])])}}]),n}(t$),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(3!==e.length)throw new UQ("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=D2({ones:function(){return kG(a)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?Hj(t[n],e):e},c=u(a,s,0),h=u(a,s,1),f=u(a,s,2),d=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=D2({ones:function(){return kG(i)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var p=n.recurrentDropoutMask,v=u(i,p,0),g=u(i,p,1),m=u(i,p,2),y=u(i,p,3),b=l(UG(n.kernel.read(),4,3),4),k=b[0],x=b[1],w=b[2],I=b[3],S=l(n.useBias?UG(n.bias.read(),4):[null,null,null,null],4),C=S[0],_=S[1],T=S[2],E=S[3];c=n.inputConv(c,k,C,n.padding),h=n.inputConv(h,x,_,n.padding),f=n.inputConv(f,w,T,n.padding),d=n.inputConv(d,I,E,n.padding);var N=l(UG(n.recurrentKernel.read(),4,3),4),D=N[0],A=N[1],R=N[2],M=N[3];v=n.recurrentConv(v,D),g=n.recurrentConv(g,A),m=n.recurrentConv(m,R),y=n.recurrentConv(y,M);var O=n.recurrentActivation.apply(Vj(c,v)),F=n.recurrentActivation.apply(Vj(h,g)),P=Vj(Hj(F,o),Hj(O,n.activation.apply(Vj(f,m)))),L=Hj(n.recurrentActivation.apply(Vj(d,y)),n.activation.apply(P));return[L,L,P]}))}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t=(e.units,A2(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}},{key:"inputConv",value:function(e,t,n,r){var a=NH(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?XJ(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return NH(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(T2);M2.className="ConvLSTM2DCell",tW(M2);var O2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){(0,p.Z)(this,n);var r=new M2(e);return t.call(this,Object.assign(Object.assign({},e),{cell:r}))}return(0,v.Z)(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(R2);O2.className="ConvLSTM2D",tW(O2);var F2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return(0,v.Z)(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return JJ((function(){return QJ(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return sr((0,y.Z)(n.prototype),"dispose",this).call(this)}}]),n}(F$);F2.className="Dropout",tW(F2);var P2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return(0,v.Z)(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(F2);P2.className="SpatialDropout1D",tW(P2);var L2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,sJ(r.units,"units"),r.activation=z1(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=k$(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=k$(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=n0(e.kernelConstraint),r.biasConstraint=n0(e.biasConstraint),r.kernelRegularizer=G1(e.kernelRegularizer),r.biasRegularizer=G1(e.biasRegularizer),r.activityRegularizer=G1(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return(0,v.Z)(n,[{key:"build",value:function(e){var t=(e=S$(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(0,Ye.Z)({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=S$(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r,a=I$(e),i=cJ(n.activation.getClassName());return null!=i?r=GJ(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=GJ(a,n.kernel.read()),null!=n.bias&&(r=XJ(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:L1(this.activation),useBias:this.useBias,kernelInitializer:b$(this.kernelInitializer),biasInitializer:b$(this.biasInitializer),kernelRegularizer:W1(this.kernelRegularizer),biasRegularizer:W1(this.biasRegularizer),activityRegularizer:W1(this.activityRegularizer),kernelConstraint:e0(this.kernelConstraint),biasConstraint:e0(this.biasConstraint)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);L2.className="Dense",tW(L2);var Z2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){e=S$(e);var t,n=(0,C.Z)(e.slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new UQ('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(kve){n.e(kve)}finally{n.f()}return[e[0],RJ(e,1)]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=JG(r,a)}return function(e){if(e.rank<=1)throw new UQ("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],RJ(e.shape,1)];return vH(e,t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);Z2.className="Flatten",tW(Z2);var z2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=z1(e.activation),r}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:L1(this.activation)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);z2.className="Activation",tW(z2);var B2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return function(e,t){return Zj((function(){if(2!==e.shape.length)throw new UQ("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return WJ(ZJ(e,1),[1,t,1])}))}(e=I$(e),n.n)}))}},{key:"getConfig",value:function(){var e={n:this.n},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);B2.className="RepeatVector",tW(B2);var U2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;(0,p.Z)(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return(0,v.Z)(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new UQ("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=RJ(e);if(null!==i){if(0===a||u%a!==0)throw new UQ(n);r[i]=u/a}else if(u!==a)throw new UQ(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return vH(r,i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);U2.className="Reshape",tW(U2);var V2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=FJ(1,e.dims.length+1);if(!sL(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new D$({ndim:r.dims.length+1})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=S$(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return JG(I$(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);V2.className="Permute",tW(V2);var j2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=I$(e);return JW(gG(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e),a=JW(gG(r,n.maskValue),-1,!0);return Hj(r,Mj(a,r.dtype))}))}}]),n}(F$);j2.className="Masking",tW(j2);var W2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(YQ(e.inputLength))}return r.inputDim=e.inputDim,sJ(r.inputDim,"inputDim"),r.outputDim=e.outputDim,sJ(r.outputDim,"outputDim"),r.embeddingsInitializer=k$(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=G1(e.embeddingsRegularizer),r.activityRegularizer=G1(e.activityRegularizer),r.embeddingsConstraint=n0(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return(0,v.Z)(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Zj((function(){return n.maskZero?(e=I$(e),gG(e,Kj(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=S$(e),null==this.inputLength)return[].concat(d(e),[this.outputDim]);var t=YQ(this.inputLength);if(t.length!==e.length-1)throw new UQ('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new UQ('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(d(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);"int32"!==r.dtype&&(r=LJ(r,"int32"));var a=qJ(n.embeddings.read(),vH(r,[r.size]));return vH(a,S$(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:b$(this.embeddingsInitializer),embeddingsRegularizer:W1(this.embeddingsRegularizer),activityRegularizer:W1(this.activityRegularizer),embeddingsConstraint:e0(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);W2.className="Embedding",tW(W2);var H2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){throw new VQ}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new UQ("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[S$(e)]),e.length<2)throw new UQ("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(kve){r.e(kve)}finally{r.f()}if((n=rJ(n)).length>1)throw new UQ("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===rJ(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=OJ(r),o=(0,C.Z)(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=ZJ(s,1);t.push(s)}}catch(kve){o.e(kve)}finally{o.f()}return n.mergeFunction(t)}var l,h=!1,f=(0,C.Z)(e);try{for(f.s();!(l=f.n()).done;){var d=l.value,p=d.rank;if(null==p){var v=d.shape,g=v[0],m=v.slice(1).concat([g]),y=vH(d,[g].concat(RJ(v.slice(1))));y=JG(y,[1,0]),y=vH(y,m),t.push(y),h=!0}else if(p>1){var b=FJ(1,p).concat([0]);t.push(JG(d,b)),h=!0}else t.push(d)}}catch(kve){f.e(kve)}finally{f.f()}var k=n.mergeFunction(t),x=k.rank;if(h)if(null==x){var w=k.shape,I=w[w.length-1],S=[I].concat(w.slice(0,w.length-1));k=vH(JG(vH(k,[-1,I]),[1,0]),S)}else if(x>1){var _=[x-1].concat(FJ(0,x-1));k=JG(k,_)}return k}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=(0,C.Z)(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(kve){o.e(kve)}finally{o.f()}return t=1===(i=rJ(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return Zj((function(){if(null==t)return null;if(!Array.isArray(t))throw new UQ("`mask` should be an Array");if(!Array.isArray(e))throw new UQ("`inputs` should be an Array");if(t.length!==e.length)throw new UQ("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:UH(e,0)})))[0],r=1;r<t.length-1;++r)n=eG(n,t[r]);return n}))}}]),n}(F$),G2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){return Zj((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Vj(t,e[n]);return t}))}}]),n}(H2);G2.className="Add",tW(G2);var q2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){return Zj((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Hj(t,e[n]);return t}))}}]),n}(H2);q2.className="Multiply",tW(q2);var K2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){return Zj((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Vj(t,e[n]);return Hj(1/e.length,t)}))}}]),n}(H2);K2.className="Average",tW(K2);var Y2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){return Zj((function(){for(var t=e[0],n=1;n<e.length;++n)t=dW(t,e[n]);return t}))}}]),n}(H2);Y2.className="Maximum",tW(Y2);var X2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"mergeFunction",value:function(e){return Zj((function(){for(var t=e[0],n=1;n<e.length;++n)t=oG(t,e[n]);return t}))}}]),n}(H2);X2.className="Minimum",tW(X2);var Q2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,v.Z)(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new UQ("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(kve){r.e(kve)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,c=(0,C.Z)(a);try{for(c.s();!(s=c.n()).done;){if(sL(s.value,o)){u=!0;break}}}catch(kve){c.e(kve)}finally{c.f()}u||a.push(o)}if(a.length>1)throw new UQ("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Zj((function(){return VJ(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new UQ("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=(0,C.Z)(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(kve){i.e(kve)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new UQ("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new UQ("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new UQ("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return Zj((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(Mj(kG(e[i]),"bool")):t[i].rank<e[i].rank?a.push(UH(t[i],-1)):a.push(t[i]);var o=SH(a,n.axis);return QW(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(H2);function J2(e,t){for(;e<0;)e+=t;return e}Q2.className="Concatenate",tW(Q2);var $2=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,v.Z)(n,[{key:"build",value:function(e){rL(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new VQ("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new UQ("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new UQ("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return J2(t,e[n].shape.length)})):[J2(this.axes,n.shape.length),J2(this.axes,r.shape.length)],this.normalize&&(n=v0(n,t[0]),r=v0(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new VQ("batchDot is not implemented for tensors of 4D or higher rank yet");if(rL(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),rL(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new VQ("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return Zj((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=vH(t,t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=vH(e,e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?JH(Hj(e,t),i[0]):JH(Hj(JG(e,[1,0]),t),i[1]);else{var h=i[0]!==e.shape.length-1,f=i[1]===t.shape.length-1;o=tG(e,t,h,f)}if(n>0){for(var d,p=[],v=d=r>a?r+a-3:r-1;v<d+n;++v)p.push(v);o=VG(o,p)}return 1===o.shape.length&&(o=UH(o,1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[J2(this.axes,e.length),J2(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){rL(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new VQ("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(H2);$2.className="Dot",tW($2);var e3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);return JJ((function(){return Vj(HJ(r.shape,0,n.stddev),r)}),(function(){return r}),t.training||!1)}))}}]),n}(F$);e3.className="GaussianNoise",tW(e3);var t3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t);var r=I$(e);if(n.rate>0&&n.rate<1){return JJ((function(){var e=Math.sqrt(n.rate/(1-n.rate));return Hj(r,HJ(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(F$);t3.className="GaussianDropout",tW(t3);var n3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return(0,v.Z)(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||I$(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=sr((0,y.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Zj((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return JJ((function(){var t=I$(e),a=-1.7580993408473766,i=qH(TG(r),n.rate);i=LJ(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate,u=Vj(Hj(t,i),Hj(Vj(i,-1),a));return Vj(Hj(u,o),s)}),(function(){return I$(e)}),t.training||!1)}return e}))}}]),n}(F$);function r3(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=bH(e,t,n,r,a,o);else if(3===e.rank)i=kH(e,t,n,r,a,o);else{if(4!==e.rank)throw new VQ("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=xH(e,t,n,r,a,o)}return i}function a3(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return sL(r.slice().sort(),FJ(0,e.rank-1))?function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Zj((function(){var i=pG(e,r),o=i.mean,s=i.variance;return[r3(e,o,s,n,t,a),o,s]}))}(e,t,n,r,a):function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Zj((function(){var i,o=pG(e,r),s=o.mean,u=o.variance,c=[],l=(0,C.Z)(FJ(0,e.rank));try{for(l.s();!(i=l.n()).done;){var h=i.value;-1!==r.indexOf(h)?c.push(1):c.push(e.shape[h])}}catch(kve){l.e(kve)}finally{l.f()}var f=vH(s,c),d=vH(u,c),p=null==t?null:vH(t,c),v=null==n?null:vH(n,c);return[r3(e,f,d,v,p,a),s,u]}))}(e,t,n,r,a)}n3.className="AlphaDropout",tW(n3);var i3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=k$(e.betaInitializer||"zeros"),r.gammaInitializer=k$(e.gammaInitializer||"ones"),r.movingMeanInitializer=k$(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=k$(e.movingVarianceInitializer||"ones"),r.betaConstraint=n0(e.betaConstraint),r.gammaConstraint=n0(e.gammaConstraint),r.betaRegularizer=G1(e.betaRegularizer),r.gammaRegularizer=G1(e.gammaRegularizer),r}return(0,v.Z)(n,[{key:"build",value:function(e){e=S$(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new UQ("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new D$({ndim:e.length,axes:(0,Ye.Z)({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r=null!=t.training&&t.training,a=I$(e),i=a.shape,o=i.length,s=FJ(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=HQ(1,o);c[u]=i[u];var h=s.slice();h.sort();var f=!sL(h,FJ(0,o).slice(0,o-1));if(!r)return function(){if(f){var e=vH(n.movingMean.read(),c),t=vH(n.movingVariance.read(),c),r=n.center?vH(n.beta.read(),c):null,i=n.scale?vH(n.gamma.read(),c):null;return r3(a,e,t,r,i,n.epsilon)}return r3(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var d=l(a3(a,n.gamma.read(),n.beta.read(),s,n.epsilon),3),p=d[0],v=d[1],g=d[2],m=function(e,t,n){Zj((function(){var r=1-n,a=e.read(),i=Hj(sW(a,t),r);e.write(sW(a,i))}))};return m(n.movingMean,v,n.momentum),m(n.movingVariance,g,n.momentum),p}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:b$(this.betaInitializer),gammaInitializer:b$(this.gammaInitializer),movingMeanInitializer:b$(this.movingMeanInitializer),movingVarianceInitializer:b$(this.movingVarianceInitializer),betaRegularizer:W1(this.betaRegularizer),gammaRegularizer:W1(this.gammaRegularizer),betaConstraint:e0(this.betaConstraint),gammaConstraint:e0(this.gammaConstraint)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);i3.className="BatchNormalization",tW(i3);var o3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=(0,C.Z)(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(kve){i.e(kve)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=k$(e.betaInitializer||"zeros"),r.gammaInitializer=k$(e.gammaInitializer||"ones"),r.betaRegularizer=G1(e.betaRegularizer),r.gammaRegularizer=G1(e.gammaRegularizer),r.supportsMasking=!0,r}return(0,v.Z)(n,[{key:"build",value:function(e){var t=(e=S$(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=(0,C.Z)(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(kve){a.e(kve)}finally{a.f()}if(this.axis.length!==rJ(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=I$(e),a=r.shape,i=a.length;return Zj((function(){var e,t=pG(r,n.axis,!0),o=t.mean,s=t.variance,u=HQ(1,i),c=(0,C.Z)(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(kve){c.e(kve)}finally{c.f()}for(var h=function(e){return null!=e&&e.shape.length!==i?vH(e,u):e},f=n.scale?h(n.gamma.read()):null,d=n.center?h(n.beta.read()):null,p=[],v=[],g=0;g<i;++g)-1!==n.axis.indexOf(g)?(p.push(a[g]),v.push(1)):(p.push(1),v.push(a[g]));return o=VH(o,p),s=VH(s,p),null!=f&&(f=VH(f,v)),null!=d&&(d=VH(d,v)),r3(r,o,s,d,f,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:b$(this.betaInitializer),gammaInitializer:b$(this.gammaInitializer),betaRegularizer:W1(this.betaRegularizer),gammaRegularizer:W1(this.gammaRegularizer)},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);o3.className="LayerNormalization",tW(o3);var s3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new UQ("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new UQ("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new UQ("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new D$({ndim:4})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=S$(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return function(e,t,n){return Zj((function(){if(4!==e.rank)throw new UQ("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new UQ("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new UQ("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],xG(e,r)}))}(I$(e),n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);function u3(e,t,n,r,a,i){return Zj((function(){var o;kJ(a),wJ(i),xJ(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=n2(e,a);var s="same"===r?"same":"valid";return o="max"===i?nG(e,t,n,s):gH(e,t,n,s),"channelsFirst"===a&&(o=JG(o,[0,3,1,2])),o}))}function c3(e,t,n,r,a,i){return Zj((function(){var o;kJ(a),wJ(i),xJ(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=r2(e,a);var s="same"===r?"same":"valid";return o="max"===i?rG(e,t,n,s):mH(e,t,n,s),"channelsFirst"===a&&(o=JG(o,[0,4,1,2,3])),o}))}s3.className="ZeroPadding2D",tW(s3);var l3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new UQ("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(sJ(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new UQ("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return sJ(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,xJ(r.padding),r.inputSpec=[new D$({ndim:3})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){var t=e2((e=S$(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){n.invokeCallHook(e,t),e=ZJ(I$(e),2);var r=n.poolingFunction(I$(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return VG(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$),h3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),u3(e,t,n,r,a,"max")}}]),n}(l3);h3.className="MaxPooling1D",tW(h3);var f3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),u3(e,t,n,r,a,"avg")}}]),n}(l3);f3.className="AveragePooling1D",tW(f3);var d3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new UQ("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return sJ(r.poolSize,"poolSize"),sJ(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kJ(r.dataFormat),xJ(r.padding),r.inputSpec=[new D$({ndim:4})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){e=S$(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=e2(t,this.poolSize[0],this.padding,this.strides[0]),n=e2(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return n.invokeCallHook(e,t),n.poolingFunction(I$(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$),p3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),u3(e,t,n,r,a,"max")}}]),n}(d3);p3.className="MaxPooling2D",tW(p3);var v3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),u3(e,t,n,r,a,"avg")}}]),n}(d3);v3.className="AveragePooling2D",tW(v3);var g3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new UQ("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return sJ(r.poolSize,"poolSize"),sJ(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kJ(r.dataFormat),xJ(r.padding),r.inputSpec=[new D$({ndim:5})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){e=S$(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=e2(t,this.poolSize[0],this.padding,this.strides[0]),n=e2(n,this.poolSize[1],this.padding,this.strides[1]),r=e2(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return n.invokeCallHook(e,t),n.poolingFunction(I$(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$),m3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),c3(e,t,n,r,a,"max")}}]),n}(g3);m3.className="MaxPooling3D",tW(m3);var y3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e)}return(0,v.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return kJ(a),xJ(r),c3(e,t,n,r,a,"avg")}}]),n}(g3);y3.className="AveragePooling3D",tW(y3);var b3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).inputSpec=[new D$({ndim:3})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new VQ}}]),n}(F$),k3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e||{})}return(0,v.Z)(n,[{key:"call",value:function(e,t){return Zj((function(){var t=I$(e);return aG(t,1)}))}}]),n}(b3);k3.className="GlobalAveragePooling1D",tW(k3);var x3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){return(0,p.Z)(this,n),t.call(this,e||{})}return(0,v.Z)(n,[{key:"call",value:function(e,t){return Zj((function(){var t=I$(e);return QH(t,1)}))}}]),n}(b3);x3.className="GlobalMaxPooling1D",tW(x3);var w3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,kJ(r.dataFormat),r.inputSpec=[new D$({ndim:4})],r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new VQ}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$),I3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e);return"channelsLast"===n.dataFormat?aG(t,[1,2]):aG(t,[2,3])}))}}]),n}(w3);I3.className="GlobalAveragePooling2D",tW(I3);var S3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.apply(this,arguments)}return(0,v.Z)(n,[{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e);return"channelsLast"===n.dataFormat?QH(t,[1,2]):QH(t,[2,3])}))}}]),n}(w3);S3.className="GlobalMaxPooling2D",tW(S3);var C3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).layer=e.layer,r}return(0,v.Z)(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){sr((0,y.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=p0(t.layer,n);delete t.layer;var a={layer:r};return Object.assign(a,t),new e(a)}}]),n}(F$),_3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return(0,v.Z)(n,[{key:"build",value:function(e){if((e=S$(e)).length<3)throw new UQ("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),sr((0,y.Z)(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=S$(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return k2((function(e,r){return[I$(n.layer.call(e,t)),[]]}),e=I$(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(C3);_3.className="TimeDistributed",tW(_3);var T3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;(0,p.Z)(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=p0(i),a.goBackwards=!0!==a.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=a,r.backwardLayer=p0(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){iJ(yJ,"BidirectionalMergeMode",e)}(r.mergeMode),e.weights)throw new VQ("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return(0,v.Z)(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):KQ(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=b2(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return sr((0,y.Z)(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new UQ("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,d(r));var c=r.map((function(e){return new D$({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,d(c))}if(null!=a)throw new VQ("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof A$,h=0,f=o;h<f.length;h++){if(f[h]instanceof A$!==l)throw new UQ("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var p=[e].concat(o),v=this.inputSpec.concat(s),g=this.inputSpec;this.inputSpec=v;var m=sr((0,y.Z)(n.prototype),"apply",this).call(this,p,t);return this.inputSpec=g,m}return sr((0,y.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=DG(a,1)),"concat"===n.mergeMode?o=VJ([r,a]):"sum"===n.mergeMode?o=Vj(r,a):"ave"===n.mergeMode?o=Hj(.5,Vj(r,a)):"mul"===n.mergeMode?o=Hj(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;CJ(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),CJ(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){sr((0,y.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=p0(t.layer);if(delete t.layer,null!=t.numConstants)throw new VQ("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(C3);T3.className="Bidirectional",tW(T3);var E3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).scale=e.scale,e.offset?r.offset=e.offset:r.offset=0,r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e={scale:this.scale,offset:this.offset},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return Zj((function(){return"float32"!==(e=I$(e)).dtype&&(e=LJ(e,"float32")),Vj(Hj(e,n.scale),n.offset)}))}}]),n}(F$);E3.className="Rescaling",tW(E3);var N3=nK.resizeBilinear,D3=nK.cropAndResize,A3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,r}return(0,v.Z)(n,[{key:"centerCrop",value:function(e,t,n,r,a,i,o,s){return Zj((function(){var u,c=!1,l=[t/i,n/o,(r+t)/i,(a+n)/o],h=[];3===e.rank?(c=!0,u=jG([e])):u=e;for(var f=0;f<u.shape[0];f++)h.push(l);var d=wV(h,[h.length,4]),p=EG(0,h.length,1,"int32"),v=D3(u,d,p,[r,a],"nearest");return LJ(c?I$(KG(v)):v,s)}))}},{key:"upsize",value:function(e,t,n,r){return Zj((function(){return LJ(N3(e,[t,n]),r)}))}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e),r=t.dtype,a=t.shape,i=a[a.length-3],o=a[a.length-2],s=0;i!==n.height&&(s=Math.floor((i-n.height)/2));var u=0;return o!==n.width&&0===(u=Math.floor((o-n.width)/2))&&(u=1),s>=0&&u>=0?n.centerCrop(t,s,u,n.height,n.width,i,o,r):n.upsize(e,n.height,n.width,r)}))}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=S$(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}]),n}(F$);A3.className="CenterCrop",tW(A3);var R3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).numTokens=e.numTokens,e.outputMode?r.outputMode=e.outputMode:r.outputMode="multiHot",r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){return null==(e=S$(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var r;if("int32"!==(e=I$(e)).dtype&&(e=LJ(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==n.outputMode)throw new UQ("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));r=I$(t.countWeights)}var a=QH(e),i=iG(e),o=GH(n.numTokens,a).bufferSync().get(0),s=qH(i,0).bufferSync().get(0);if(!o||!s)throw new UQ("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(e,t,n,r){var a=I$(e);if("int32"!==a.dtype&&(a=LJ(a,"int32")),"int"===t)return a;var i=a.shape;if(0===a.rank&&(a=UH(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=UH(a,-1)),a.rank>2)throw new UQ("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));var o,s=["multiHot","oneHot"].includes(t),u=a;if(o=PH(u,"undefined"!==typeof r&&"count"===t?r:[],n,s),"tfIdf"!==t)return o;if(r)return Hj(o,r);throw new UQ("When outputMode is 'tfIdf', weights must be provided.")}(e,n.outputMode,n.numTokens,r)}))}}]),n}(F$);R3.className="CategoryEncoding",tW(R3);var M3=new Set(["bilinear","nearest"]),O3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;if((0,p.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,e.interpolation){if(!M3.has(e.interpolation))throw new UQ("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));r.interpolation=e.interpolation}else r.interpolation="bilinear";return r.cropToAspectRatio=Boolean(e.cropToAspectRatio),r}return(0,v.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=S$(e))[2];return[this.height,this.width,t]}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=[n.height,n.width];if("bilinear"===n.interpolation)return nK.resizeBilinear(e,t,!n.cropToAspectRatio);if("nearest"===n.interpolation)return nK.resizeNearestNeighbor(e,t,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat(d(M3)," are supported"))}))}}]),n}(F$);O3.className="Resizing",tW(O3);var F3=function(){function e(t){(0,p.Z)(this,e),this.seed=t}return(0,v.Z)(e,[{key:"next",value:function(){if(void 0!==this.seed)return this.seed++}}]),e}();F3.className="RandomSeed";var P3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this,e)).randomGenerator=new F3(e.seed),r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e={seed:this.randomGenerator.seed},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(F$);P3.className="BaseRandomLayer";var L3=new Set(["bilinear","nearest"]),Z3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;(0,p.Z)(this,n),r=t.call(this,e);var a=e.factor,i=e.interpolation,o=void 0===i?"bilinear":i;if(r.factor=a,Array.isArray(r.factor)&&2===r.factor.length)r.widthLower=r.factor[0],r.widthUpper=r.factor[1];else{if(Array.isArray(r.factor)||!(r.factor>0))throw new UQ("Invalid factor: ".concat(r.factor,". Must be positive number or tuple of 2 numbers"));r.widthLower=-r.factor,r.widthUpper=r.factor}if(r.widthLower<-1||r.widthUpper<-1)throw new UQ("factor must have values larger than -1. Got: ".concat(r.factor));if(r.widthUpper<r.widthLower)throw new UQ("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(r.widthUpper,".\n        Got lower bound: ").concat(r.widthLower,"\n      "));if(o){if(!L3.has(o))throw new UQ("Invalid interpolation parameter: ".concat(o," is not implemented"));r.interpolation=o}return r}return(0,v.Z)(n,[{key:"getConfig",value:function(){var e={factor:this.factor,interpolation:this.interpolation},t=sr((0,y.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=S$(e))[2];return[this.imgHeight,-1,t]}},{key:"call",value:function(e,t){var n=this;return Zj((function(){var t=I$(e);n.imgHeight=t.shape[t.shape.length-3];var r=t.shape[t.shape.length-2];n.widthFactor=TG([1],1+n.widthLower,1+n.widthUpper,"float32",n.randomGenerator.next());var a=n.widthFactor.dataSync()[0]*r;a=Math.round(a);var i=[n.imgHeight,a];switch(n.interpolation){case"bilinear":return nK.resizeBilinear(e,i);case"nearest":return nK.resizeNearestNeighbor(e,i);default:throw new Error("Interpolation is ".concat(n.interpolation,"\n          but only ").concat(d(L3)," are supported"))}}))}}]),n}(P3);Z3.className="RandomWidth",tW(Z3);var z3,B3;LL().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(z3||(z3={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(B3||(B3={}));new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function U3(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(H3(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=U3(e[o],t,n,r);i[o]=s}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function V3(e){return j3(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:W3)}function j3(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(H3(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=e.map((function(e){return e[r]})),o=j3(a,t,n);i[r]=o};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function W3(e){return null===e?null:H3(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function H3(e){var t=!1;LL().get("IS_BROWSER")?t=e instanceof TextDecoder:t=e instanceof n(4977).StringDecoder;return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof UU)&&!(e instanceof Promise)&&!t)}function G3(e){return function(e,t){return U3(e,t)}(e,q3)}function q3(e){return e instanceof UU?{value:e.clone(),recurse:!1}:H3(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var K3=function(){function e(t){if((0,p.Z)(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return(0,v.Z)(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=(0,C.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(kve){n.e(kve)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),Y3=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){return(0,p.Z)(this,n),t.call(this,n.INITIAL_CAPACITY)}return(0,v.Z)(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){sr((0,y.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),sr((0,y.Z)(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){sr((0,y.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),sr((0,y.Z)(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(K3);function X3(e){return new t4(e)}function Q3(e,t){return new f4(e,t)}Y3.INITIAL_CAPACITY=32;var J3,$3=function(){function e(){(0,p.Z)(this,e)}return(0,v.Z)(e,[{key:"toArray",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new u4(this,e)}},{key:"filter",value:function(e){return new o4(this,e)}},{key:"map",value:function(e){return new s4(this,e)}},{key:"mapAsync",value:function(e){return new c4(this,e)}},{key:"serialMapAsync",value:function(e){return new c4(this,e).serial()}},{key:"flatmap",value:function(e){return new h4(this,e)}},{key:"forEachAsync",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){return new i4(this,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W3;return this.rowMajorBatch(e,t).map((function(e){return V3(e,n)}))}},{key:"concatenate",value:function(e,t){return new f4(new e4([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new a4(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new r4(this,e)}},{key:"prefetch",value:function(e){return new d4(this,e)}},{key:"shuffle",value:function(e,t){return new p4(this,e,t)}},{key:"serial",value:function(){return new n4(this)}}]),e}(),e4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).items=e,r.trav=0,r}return(0,v.Z)(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:G3(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),t4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).nextFn=e,r}return(0,v.Z)(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}($3),n4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r;return(0,p.Z)(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),r4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:zj(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),a4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),i4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),o4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){var t;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:zj(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),s4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=nV(t.value),r=this.transform(t.value),a=nV(r),i=(0,C.Z)(n);try{for(i.s();!(o=i.n()).done;)tV(s=o.value,a)||s.dispose()}catch(kve){i.e(kve)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),u4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}($3),c4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=nV(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=nV(r),i=(0,C.Z)(n);try{for(i.s();!(o=i.n()).done;)tV(s=o.value,a)||s.dispose()}catch(kve){i.e(kve)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),l4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this)).outputQueue=new Y3,e.lastRead=Promise.resolve({value:null,done:!1}),e}return(0,v.Z)(n,[{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}($3),h4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=nV(t.value),r=this.transform(t.value),a=nV(r),this.outputQueue.pushAll(r),i=(0,C.Z)(n);try{for(i.s();!(o=i.n()).done;)tV(s=o.value,a)||s.dispose()}catch(kve){i.e(kve)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(l4),f4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}($3);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(J3||(J3={}));var d4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var a;return(0,p.Z)(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new K3(r),a}return(0,v.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}($3),p4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e,r,a){var i;return(0,p.Z)(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=IG.alea(a||IU().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return(0,v.Z)(n,[{key:"next",value:function(){var e=Rt(Dt().mark((function e(){var t=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=Rt(Dt().mark((function e(){var t,n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d4),v4=function(){function e(){(0,p.Z)(this,e),this.size=null}return(0,v.Z)(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return rL(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),g4(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,m4));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,g4(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,g4(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return Zj((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return g4(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return Zj((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return g4(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return g4(Rt(Dt().mark((function n(){return Dt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,g4(Rt(Dt().mark((function t(){var r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=X3(Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Q3(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,g4(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=IG.alea(t||IU().toString());return g4(Rt(Dt().mark((function t(){var i;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,g4(Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function g4(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){(0,g.Z)(a,n);var r=(0,m.Z)(a);function a(){var e;return(0,p.Z)(this,a),(e=r.apply(this,arguments)).size=t,e}return(0,v.Z)(a,[{key:"iterator",value:function(){var t=Rt(Dt().mark((function t(){return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(v4))}function m4(e){if(null===e)return null;var t,n=e[0];return null==(t=n)||function(e){return null===e||"object"!==typeof e&&"function"!==typeof e}(t)||Array.isArray(t)||"object"===typeof t&&t instanceof UU||_U(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof UU?jG(e):wV(e)}(e),recurse:!1}:{value:null,recurse:!0}}v4.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function y4(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&rL("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var b4=XK,k4=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new YP((0,Je.Z)(e),Pj()),e}return(0,v.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,LL().get("IS_NODE")&&QB("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&bL(n[0])){var a=n.map((function(e){return SU(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;return"complex64"===n?EK(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):function(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}(this.data.get(e).values,n)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return CU(e)}));return Rj(e.shape,e.dtype,n)}catch(zm){throw new Error("Failed to decode encoded string bytes into utf-8")}return Rj(e.shape,e.dtype,t)}},{key:"makeOutput",value:function(e,t,n){return Pj().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e).complexTensorInfos;null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=Rt(Dt().mark((function e(t){var n,r;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=IU(),t(),r=IU()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){y4([e],"where");var t=this.readSync(e.dataId);return b4(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return sr((0,y.Z)(n.prototype),"epsilon",this).call(this)}}]),n}(XP);k4.nextDataId=0;function x4(e){return function(t,n,r){for(var a=gL(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function w4(e,t,n){return I4(e,x4(t),n)}function I4(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;y4(s,e);var u,c=o,l=c.data.get(s.dataId).values;if("string"===s.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=YK(l)}else u=l;var h=n||s.dtype,f=t(u,h,i);return c.makeTensorInfo(s.shape,h,f)}}Uj("cpu",(function(){return new k4}),1);var S4=w4(zZ,(function(e){return e>=0?e:Math.exp(e)-1})),C4={kernelName:zZ,backendName:"cpu",kernelFunc:S4};function _4(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var T4={kernelName:nz,backendName:"cpu",kernelFunc:_4};function E4(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;y4([a],"leakyRelu");for(var o=oL(a.shape),s=n.data.get(a.dataId).values,u=vL("float32",o),c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}var N4={kernelName:uz,backendName:"cpu",kernelFunc:E4};function D4(e){return function(t,n,r,a,i){var o=fW(t,n),s=o.length,u=SL(o),c=vL(i,oL(o)),l=t.length,h=n.length,f=SL(t),d=SL(n),p=lW(t,o),v=lW(n,o);if(p.length+v.length===0)for(var g=0;g<c.length;++g)c[g]=e(r[g%r.length],a[g%a.length]);else for(var m=function(){var t=RL(y,s,u),n=t.slice(-l);p.forEach((function(e){return n[e]=0}));var i=AL(n,l,f),o=t.slice(-h);v.forEach((function(e){return o[e]=0}));var g=AL(o,h,d);c[y]=e(r[i],a[g])},y=0;y<c.length;++y)m();return[c,o]}}var A4=D4((function(e,t){return e<0?t*e:e}));function R4(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;y4([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=l(A4(r.shape,a.shape,i,o,"float32"),2),u=s[0],c=s[1];return n.makeTensorInfo(c,"float32",u)}var M4={kernelName:jz,backendName:"cpu",kernelFunc:R4},O4=w4(Qz,(function(e){return Math.max(0,e)})),F4={kernelName:Qz,backendName:"cpu",kernelFunc:O4},P4=w4(rB,(function(e){return Math.min(Math.max(0,e),6)})),L4={kernelName:rB,backendName:"cpu",kernelFunc:P4},Z4=x4((function(e){return 1/(1+Math.exp(-e))})),z4=w4(gB,(function(e){return 1/(1+Math.exp(-e))})),B4={kernelName:gB,backendName:"cpu",kernelFunc:z4};function U4(e,t,n,r,a){if("linear"===n)return _4({inputs:{x:t},backend:e});if("relu"===n)return O4({inputs:{x:t},backend:e});if("elu"===n)return S4({inputs:{x:t},backend:e});if("relu6"===n)return P4({inputs:{x:t},backend:e});if("prelu"===n)return R4({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return E4({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return z4({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function V4(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var j4={kernelName:pZ,backendName:"cpu",kernelFunc:V4};function W4(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return V4({inputs:{real:W4(e,t,"float32"),imag:W4(e,t,"float32")},backend:e});var r=EL(oL(t),n);return e.makeTensorInfo(t,n,r)}function H4(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var G4={kernelName:Yz,backendName:"cpu",kernelFunc:H4};function q4(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=wU([0],n),i=D4((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),o=l(i,2),s=o[0];return[o[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function K4(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return _4({inputs:{x:a},backend:n});var o=W4(n,a.shape,a.dtype),s=K4({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=V4({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=H4({inputs:{input:a},backend:n}),h=K4({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),h}if(!mL(a.dtype,i)){var f=_4({inputs:{x:a},backend:n});return{dataId:f.dataId,shape:f.shape,dtype:i}}var d=l(q4(n.data.get(a.dataId).values,a.shape,a.dtype,i),3),p=d[0],v=d[1],g=d[2];return n.makeTensorInfo(p,v,g)}var Y4={kernelName:hZ,backendName:"cpu",kernelFunc:K4};function X4(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;y4([o,s],e);var c=u.data.get(o.dataId).values,h=u.data.get(s.dataId).values,f="string"===o.dtype?YK(c):c,d="string"===o.dtype?YK(h):h,p=r||o.dtype,v=l(t(o.shape,s.shape,f,d,p),2),g=v[0],m=v[1];return u.makeTensorInfo(m,p,g)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=K4({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),h=u.data.get(c.dataId),f=h.complexTensorInfos.real,d=h.complexTensorInfos.imag,p=u.data.get(f.dataId).values,v=u.data.get(d.dataId).values,g=K4({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),m=u.data.get(g.dataId),y=m.complexTensorInfos.real,b=m.complexTensorInfos.imag,k=u.data.get(y.dataId).values,x=u.data.get(b.dataId).values,w=l(n(o.shape,s.shape,p,v,k,x),3),I=w[0],S=w[1],C=w[2],_=u.makeTensorInfo(C,"float32",I),T=u.makeTensorInfo(C,"float32",S),E=V4({inputs:{real:_,imag:T},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(_),u.disposeIntermediateTensorInfo(T),E}var N=u.data.get(o.dataId).values,D=u.data.get(s.dataId).values,A=r||o.dtype,R=l(t(o.shape,s.shape,N,D,A),2),M=R[0],O=R[1];return u.makeTensorInfo(O,A,M)}}function Q4(e){return function(t,n,r,a,i,o){var s=fW(t,n),u=oL(s),c=s.length,l=SL(s),h=vL("float32",u),f=vL("float32",u),d=lW(t,s),p=lW(n,s),v=EK(r,a),g=EK(i,o),m=t.length,y=SL(t),b=n.length,k=SL(n);if(d.length+p.length===0)for(var x=0;x<h.length;x++){var w=x%v.length,I=x%g.length,S=e(v[2*w],v[2*w+1],g[2*I],g[2*I+1]);h[x]=S.real,f[x]=S.imag}else for(var C=function(){var t=RL(_,c,l),n=t.slice(-m);d.forEach((function(e){return n[e]=0}));var r=AL(n,m,y),a=t.slice(-b);p.forEach((function(e){return a[e]=0}));var i=AL(a,b,k),o=e(v[2*r],v[2*r+1],g[2*i],g[2*i+1]);h[_]=o.real,f[_]=o.imag},_=0;_<h.length;_++)C();return[h,f,s]}}var J4=D4((function(e,t){return e+t})),$4=Q4((function(e,t,n,r){return{real:e+n,imag:t+r}})),e5=X4(HL,J4,$4),t5={kernelName:HL,backendName:"cpu",kernelFunc:e5};function n5(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=oL(a.shape),s=fL(i,o),u=oL(s);rL(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;l.shape=s,h.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var r5={kernelName:Jz,backendName:"cpu",kernelFunc:n5};function a5(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;y4([a,i],"matMul");var u=a.shape.length,c=i.shape.length,h=o?a.shape[u-2]:a.shape[u-1],f=s?i.shape[c-1]:i.shape[c-2],d=o?a.shape[u-1]:a.shape[u-2],p=s?i.shape[c-2]:i.shape[c-1],v=a.shape.slice(0,-2),g=i.shape.slice(0,-2),m=oL(v),y=oL(g),b=fW(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,p]);rL(h===f,(function(){return"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));for(var k=s?[y,p,f]:[y,f,p],x=n5({inputs:{x:a},backend:n,attrs:{shape:o?[m,h,d]:[m,d,h]}}),w=n5({inputs:{x:i},backend:n,attrs:{shape:k}}),I=o?x.shape[1]:x.shape[2],S=o?x.shape[2]:x.shape[1],C=s?w.shape[1]:w.shape[2],_=Math.max(m,y),T=n.data.get(x.dataId).values,E=n.data.get(w.dataId).values,N=SL(x.shape),D=SL(w.shape),A=l(o?[N[0],1,N[1]]:[N[0],N[1],1],3),R=A[0],M=A[1],O=A[2],F=l(s?[1,D[1],D[0]]:[D[1],1,D[0]],3),P=F[0],L=F[1],Z=F[2],z=S*C,B=Rj([_,S,C],x.dtype),U=B.values,V=n.blockSize,j=0;j<_;j++)for(var W=j%m,H=j%y,G=0;G<S;G+=V)for(var q=Math.min(G+V,S),K=0;K<C;K+=V)for(var Y=Math.min(K+V,C),X=0;X<I;X+=V)for(var Q=Math.min(X+V,I),J=G;J<q;J++)for(var $=K;$<Y;$++){for(var ee=0,te=X;te<Q;te++){ee+=T[W*R+J*M+te*O]*E[te*P+$*L+H*Z]}U[j*z+(J*C+$)]+=ee}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(b,B.dtype,B.values)}var i5={kernelName:oZ,backendName:"cpu",kernelFunc:a5};var o5={kernelName:KB,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,h=o.transposeA,f=o.transposeB,d=o.activation,p=o.leakyreluAlpha,v=[];t=a5({inputs:{a:s,b:u},attrs:{transposeA:h,transposeB:f},backend:i}),c&&(n=e5({inputs:{a:t,b:c},backend:i}),v.push(t),t=n),d&&(r=U4(i,t,d,l,p),v.push(t),t=r);for(var g=0,m=v;g<m.length;g++){var y=m[g];i.disposeIntermediateTensorInfo(y)}return t}};function s5(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var u5={kernelName:VL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;y4(t,"abs");var r=new Float32Array(oL(t.shape));return r=s5(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},c5=w4(jL,(function(e){return Math.acos(e)})),l5={kernelName:jL,backendName:"cpu",kernelFunc:c5},h5=w4(WL,(function(e){return Math.acosh(e)})),f5={kernelName:WL,backendName:"cpu",kernelFunc:h5};var d5={kernelName:GL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;y4(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=Rj(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],c=0;c<o.length;c++)o[c]+=u[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function p5(e,t,n,r,a){for(var i=t.length,o=oL(t),s=SL(t),u=SL(a),c=vL(n,oL(a)),l=0;l<o;++l){for(var h=RL(l,i,s),f=new Array(h.length),d=0;d<f.length;d++)f[d]=h[r[d]];c[AL(f,i,u)]=e[l]}return c}function v5(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;y4(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=p5(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}var g5={kernelName:UB,backendName:"cpu",kernelFunc:v5};var m5={kernelName:qL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;y4(a,"all");var s=dL(i,a.shape),u=s,c=hG(u,a.shape.length),h=a;null!=c&&(h=v5({inputs:{x:a},backend:n,attrs:{perm:c}}),u=dG(u.length,a.shape.length)),lG("all",u,h.shape.length);for(var f=l(uG(h.shape,u),2),d=f[0],p=oL(f[1]),v=EL(oL(d),h.dtype),g=n.data.get(h.dataId).values,m=0;m<v.length;++m){for(var y=m*p,b=g[y],k=0;k<p;++k){var x=g[y+k];b=b&&x}v[m]=b}null!=c&&n.disposeIntermediateTensorInfo(h);var w=n.makeTensorInfo(d,h.dtype,v);if(o){var I=n5({inputs:{x:w},backend:n,attrs:{shape:cG(d,s)}});return n.disposeIntermediateTensorInfo(w),I}return w}};var y5={kernelName:KL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;y4(a,"any");var s=dL(i,a.shape),u=s,c=hG(u,a.shape.length),h=a;null!=c&&(h=v5({inputs:{x:a},backend:n,attrs:{perm:c}}),u=dG(u.length,a.shape.length)),lG("any",u,h.shape.length);for(var f=l(uG(h.shape,u),2),d=f[0],p=oL(f[1]),v=EL(oL(d),h.dtype),g=n.data.get(h.dataId).values,m=0;m<v.length;++m){for(var y=m*p,b=g[y],k=0;k<p;++k){var x=g[y+k];b=b||x}v[m]=b}null!=c&&n.disposeIntermediateTensorInfo(h);var w=n.makeTensorInfo(d,h.dtype,v);if(o){var I=n5({inputs:{x:w},backend:n,attrs:{shape:cG(d,s)}});return n.disposeIntermediateTensorInfo(w),I}return w}};var b5={kernelName:YL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;y4(a,"argMax");var o=dL(i,a.shape),s=hG(o,a.shape.length),u=a,c=[];null!=s&&(u=v5({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=dG(o.length,u.shape.length)),lG("argMax",o=[o[0]],u.shape.length);for(var h=l(uG(u.shape,o),2),f=h[0],d=h[1],p=EL(oL(f),"int32"),v=oL(d),g=n.data.get(u.dataId).values,m=0;m<p.length;++m){for(var y=m*v,b=g[y],k=0,x=0;x<v;++x){var w=g[y+x];w>b&&(b=w,k=x)}p[m]=k}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",p)}};var k5={kernelName:XL,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;y4(a,"argMin");var o=dL(i,a.shape),s=hG(o,a.shape.length),u=a,c=[];null!=s&&(u=v5({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=dG(o.length,u.shape.length)),lG("argMin",o=[o[0]],u.shape.length);for(var h=l(uG(u.shape,o),2),f=h[0],d=h[1],p=EL(oL(f),"int32"),v=oL(d),g=n.data.get(u.dataId).values,m=0;m<p.length;++m){for(var y=m*v,b=g[y],k=0,x=0;x<v;++x){var w=g[y+x];w<b&&(b=w,k=x)}p[m]=k}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",p)}},x5=w4(QL,(function(e){return Math.asin(e)})),w5={kernelName:QL,backendName:"cpu",kernelFunc:x5},I5=w4(JL,(function(e){return Math.asinh(e)})),S5={kernelName:JL,backendName:"cpu",kernelFunc:I5},C5=w4($L,(function(e){return Math.atan(e)})),_5={kernelName:$L,backendName:"cpu",kernelFunc:C5},T5=D4((function(e,t){return Math.atan2(e,t)})),E5=X4(tZ,T5),N5={kernelName:tZ,backendName:"cpu",kernelFunc:E5},D5=w4(eZ,(function(e){return Math.atanh(e)})),A5={kernelName:eZ,backendName:"cpu",kernelFunc:D5};function R5(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,h=a.effectiveFilterWidth,f=a.padInfo.top,d=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Rj(a.outShape,n),g=v.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],k=0;k<a.batchSize;++k)for(var x=k*m,w=k*r[0],I=0;I<a.inChannels;++I)for(var S=0;S<a.outHeight;++S)for(var C=S*o-f,_=Math.max(0,C),T=Math.min(a.inHeight,l+C),E=x+S*y,N=0;N<a.outWidth;++N){for(var D=N*s-d,A=Math.max(0,D),R=Math.min(a.inWidth,h+D),M=p,O=0,F=0,P=_;P<T;P+=u){for(var L=w+P*r[1],Z=A;Z<R;Z+=c){var z=e[L+Z*r[2]+I];"max"===i&&z>M?M=z:"avg"===i&&(O+=z,F++)}if(isNaN(M))break}g[E+N*b+I]="avg"===i?O/F:M}return v}function M5(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Rj(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,v=Rj(t,n,e),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.outHeight;++y){for(var b=y*s-d,k=b;k<0;)k+=c;for(var x=Math.min(r.inHeight,h+b),w=0;w<r.outWidth;++w){for(var I=w*u-p,S=I;S<0;)S+=l;for(var C=Math.min(r.inWidth,f+I),_=Number.NEGATIVE_INFINITY,T=-1,E=k;E<x;E+=c)for(var N=E-b,D=S;D<C;D+=l){var A=D-I,R=v.get(g,E,D,m);R>_&&(_=R,T=a?i?((g*r.inHeight+E)*r.inWidth+D)*r.inChannels+m:(E*r.inWidth+D)*r.inChannels+m:N*f+A)}o.set(T,g,y,w,m)}}return o}function O5(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,h=a.dilationWidth,f=a.effectiveFilterDepth,d=a.effectiveFilterHeight,p=a.effectiveFilterWidth,v=a.padInfo.front,g=a.padInfo.top,m=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Rj(a.outShape,n),k=b.values,x=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],I=a.outShape[3]*a.outShape[4],S=a.outShape[4],C=0;C<a.batchSize;++C)for(var _=C*x,T=C*r[0],E=0;E<a.inChannels;++E)for(var N=0;N<a.outDepth;++N){for(var D=N*o-v,A=D;A<0;)A+=c;for(var R=Math.min(a.inDepth,f+D),M=_+N*w,O=0;O<a.outHeight;++O){for(var F=O*s-g,P=F;P<0;)P+=l;for(var L=Math.min(a.inHeight,d+F),Z=M+O*I,z=0;z<a.outWidth;++z){for(var B=z*u-m,U=B;U<0;)U+=h;for(var V=Math.min(a.inWidth,p+B),j=Z+z*S,W=y,H=0,G=0,q=A;q<R;q+=c){for(var K=T+q*r[1],Y=P;Y<L;Y+=l){for(var X=K+Y*r[2],Q=U;Q<V;Q+=h){var J=e[X+Q*r[3]+E];if("max"===i&&J>W?W=J:"avg"===i&&(H+=J,G++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}k[j+E]="avg"===i?H/Math.max(G,1):W}}}return b}var F5={kernelName:nZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;y4(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rL(hH(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=tH(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&sL(l.inShape,l.outShape))c=_4({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,f=SL(a.shape),d=R5(h,a.shape,a.dtype,f,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,d.values)}return c}};var P5={kernelName:aZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;y4(a,"avgPool3d");var l=nH(a.shape,i,o,1,s,u,c),h=O5(n.data.get(a.dataId).values,a.shape,a.dtype,SL(a.shape),l,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}};var L5={kernelName:iZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;y4([a,i],"avgPool3DGrad");for(var l=nH(i.shape,o,s,1,u,c),h=l.strideDepth,f=l.strideHeight,d=l.strideWidth,p=l.filterDepth,v=l.filterHeight,g=l.filterWidth,m=l.dilationDepth,y=l.dilationHeight,b=l.dilationWidth,k=l.effectiveFilterDepth,x=l.effectiveFilterHeight,w=l.effectiveFilterWidth,I=k-1-l.padInfo.front,S=w-1-l.padInfo.left,C=x-1-l.padInfo.top,_=Rj(i.shape,"float32"),T=1/(p*v*g),E=n.bufferSync(a),N=0;N<l.batchSize;++N)for(var D=0;D<l.inChannels;++D)for(var A=0;A<l.inDepth;++A)for(var R=0;R<l.inHeight;++R)for(var M=0;M<l.inWidth;++M){for(var O=A-I,F=R-C,P=M-S,L=0,Z=0;Z<k;Z+=m){var z=(O+Z)/h;if(!(z<0||z>=l.outDepth||Math.floor(z)!==z))for(var B=0;B<x;B+=y){var U=(F+B)/f;if(!(U<0||U>=l.outHeight||Math.floor(U)!==U))for(var V=0;V<w;V+=b){var j=(P+V)/d;if(!(j<0||j>=l.outWidth||Math.floor(j)!==j))L+=E.get(N,z,U,j,D)}}}_.set(L*T,N,A,R,M,D)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};var Z5={kernelName:rZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;y4([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=tH(o.shape,s,u,1,c),h=l.strideHeight,f=l.strideWidth,d=l.filterHeight,p=l.filterWidth,v=l.dilationHeight,g=l.dilationWidth,m=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,k=m-1-l.padInfo.top,x=Rj(o.shape,"float32"),w=1/(d*p),I=n.data.get(a.dataId).values,S=Rj(a.shape,"float32",I),C=0;C<l.batchSize;++C)for(var _=0;_<l.inChannels;++_)for(var T=0;T<l.inHeight;++T)for(var E=0;E<l.inWidth;++E){for(var N=T-k,D=E-b,A=0,R=0;R<m;R+=v){var M=(N+R)/h;if(!(M<0||M>=l.outHeight||Math.floor(M)!==M))for(var O=0;O<y;O+=g){var F=(D+O)/f;if(!(F<0||F>=l.outWidth||Math.floor(F)!==F))A+=S.get(C,M,F,_)}}x.set(A*w,C,T,E,_)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var z5={kernelName:QZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;rL(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),rL(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),rL(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),y4([a,s,u,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,f=n.data.get(u.dataId).values,d=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(l.length),g=p.length,m=d.length,y=f.length,b=h.length,k=0,x=0,w=0,I=0,S=0;S<l.length;++S)v[S]=p[k++]+(l[S]-h[x++])*d[w++]/Math.sqrt(f[I++]+c),k>=g&&(k=0),x>=b&&(x=0),w>=m&&(w=0),I>=y&&(I=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function B5(e,t,n,r,a){var i=GW(r,t,n),o=oL(n),s=SL(r);if(i){var u=qW(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c=Rj(r,a,"string"===a?YK(e):e),l=Rj(n,a),h=0;h<l.size;++h){var f=l.indexToLoc(h),p=f.map((function(e,n){return e+t[n]}));l.set.apply(l,[c.get.apply(c,d(p))].concat(d(f)))}return"string"===a?l.values.map((function(e){return SU(e)})):l.values}function U5(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;y4(a,"slice");var s=l(KW(a,i,o),2),u=s[0],c=s[1];WW(a,u,c);var h=B5(n.data.get(a.dataId).values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,h)}var V5={kernelName:fB,backendName:"cpu",kernelFunc:U5};var j5={kernelName:sZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;y4([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=dK(a.shape,i,s),c=pK(u.length,i.length),l=vK(a.shape,i,s),h=gK(o,i.length),f=mK(l,o,i.length),d=n5({inputs:{x:a},backend:n,attrs:{shape:u}}),p=v5({inputs:{x:d},backend:n,attrs:{perm:c}}),v=n5({inputs:{x:p},backend:n,attrs:{shape:l}}),g=U5({inputs:{x:v},backend:n,attrs:{begin:h,size:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}};function W5(e,t,n,r,a){for(var i=oL(r),o=EL(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function H5(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=Rj([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,s,c):t.size>0?o.set(o.get(s,c)+t.get(s,u),s,c):o.set(o.get(s,c)+1,s,c))}return o}var G5={kernelName:uZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=W5(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}},q5=D4((function(e,t){return e&t})),K5={kernelName:cZ,backendName:"cpu",kernelFunc:X4(cZ,q5)};var Y5={kernelName:lZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=fW(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},X5=x4((function(e){return Math.ceil(e)})),Q5=I4(fZ,X5),J5={kernelName:fZ,backendName:"cpu",kernelFunc:Q5},$5=w4(dZ,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),e6={kernelName:dZ,backendName:"cpu",kernelFunc:$5},t6={kernelName:vZ,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(oL(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=0;c<s.length;c++){var l=s[c],h=u[c];r[c]=Math.hypot(l,h)}return n.makeOutput(r,t.shape,"float32")}};function n6(e,t,n,r){var a=gL(n,oL(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=oL(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?YK(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}function r6(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var a6={kernelName:az,backendName:"cpu",kernelFunc:r6};function i6(e){var t=e.inputs,n=e.backend,r=dL(e.attrs.axis,t[0].shape)[0];uK(t.map((function(e){return e.shape})),r);var a=cK(t.map((function(e){return e.shape})),r);if(0===oL(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return oL(e.shape)>0}));if(1===i.length)return _4({inputs:{x:i[0]},backend:n});if("complex64"===i[0].dtype){var o=i.map((function(e){return H4({inputs:{input:e},backend:n})})),s=i.map((function(e){return r6({inputs:{input:e},backend:n})})),u=i6({inputs:o,backend:n,attrs:{axis:r}}),c=i6({inputs:s,backend:n,attrs:{axis:r}}),l=V4({inputs:{real:u,imag:c},backend:n});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}var h=i.map((function(e){var t=oL(e.shape.slice(r));return n5({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),f=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));a=cK(h.map((function(e){return e.shape})),1);var d=1===h[0].shape[0],p=n6(f,a,t[0].dtype,d),v=cK(i.map((function(e){return e.shape})),r),g=n.makeTensorInfo(v,t[0].dtype,p);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}var o6={kernelName:gZ,backendName:"cpu",kernelFunc:i6};function s6(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;y4([a,i],"conv2d");for(var h=dH(u),f=rH(a.shape,i.shape,o,c,s,l,!1,h),d=f.filterHeight,p=f.filterWidth,v=f.dilationHeight,g=f.dilationWidth,m=f.padInfo.left,y=f.padInfo.top,b="channelsLast"===f.dataFormat,k=new ZU(f.outShape,a.dtype),x=SL(a.shape),w=SL(i.shape),I=x[0],S=b?x[1]:x[2],C=b?x[2]:1,_=b?1:x[1],T=k.strides[0],E=b?k.strides[1]:k.strides[2],N=b?k.strides[2]:1,D=b?1:k.strides[1],A=n.data.get(a.dataId).values,R=n.data.get(i.dataId).values,M=k.values,O=0;O<f.batchSize;++O)for(var F=O*I,P=O*T,L=0;L<f.outHeight;++L)for(var Z=P+L*E,z=L*f.strideHeight-y,B=0;B<d;++B){var U=z+B*v;if(!(U<0||U>=f.inHeight))for(var V=B*w[0],j=F+U*S,W=0;W<f.outWidth;++W)for(var H=Z+W*N,G=W*f.strideWidth-m,q=0;q<p;++q){var K=G+q*g;if(!(K<0||K>=f.inWidth))for(var Y=j+K*C,X=V+q*w[1],Q=0;Q<f.inChannels;++Q){for(var J=A[Y+Q*_],$=0;$<f.outChannels;++$)M[H+$*D]+=J*R[X+$];X+=f.outChannels}}}return n.makeTensorInfo(k.shape,k.dtype,M)}var u6={kernelName:mZ,backendName:"cpu",kernelFunc:s6};var c6={kernelName:yZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;y4([a,i],"conv2dBackpropFilter");for(var h=dH(u),f=rH(a.shape,l,o,1,s,c,!1,h),d=f.strideHeight,p=f.strideWidth,v=f.filterHeight,g=f.filterWidth,m="channelsLast"===f.dataFormat,y=new ZU(f.filterShape,"float32"),b=f.padInfo.left,k=f.padInfo.top,x=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,I=new ZU(a.shape,a.dtype,x),S=new ZU(i.shape,i.dtype,w),C=0;C<v;++C)for(var _=Math.max(0,Math.ceil((k-C)/d)),T=Math.min(f.outHeight,(f.inHeight+k-C)/d),E=0;E<g;++E)for(var N=Math.max(0,Math.ceil((b-E)/p)),D=Math.min(f.outWidth,(f.inWidth+b-E)/p),A=0;A<f.inChannels;++A)for(var R=0;R<f.outChannels;++R){for(var M=0,O=0;O<f.batchSize;++O)for(var F=_;F<T;++F)for(var P=C+F*d-k,L=N;L<D;++L){var Z=E+L*p-b;M+=m?I.get(O,P,Z,A)*S.get(O,F,L,R):I.get(O,A,P,Z)*S.get(O,R,F,L)}y.set(M,C,E,A,R)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var l6={kernelName:bZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,h=r.dimRoundingMode;y4([a,i],"conv2dBackpropInput");var f=SL(i.shape),d=SL(a.shape),p=dH(c),v=rH(o,i.shape,s,1,u,h,!1,p),g=new ZU(v.inShape,"float32"),m=g.values,y=n.data.get(a.dataId).values,b=n.data.get(i.dataId).values,k=l(f,3),x=k[0],w=k[1],I=k[2],S=v.batchSize,C=v.filterHeight,_=v.filterWidth,T=v.inChannels,E=v.inHeight,N=v.inWidth,D=v.outChannels,A=v.outHeight,R=v.outWidth,M=v.strideHeight,O=v.strideWidth;p=v.dataFormat;for(var F=C-1-v.padInfo.top,P=_-1-v.padInfo.left,L="channelsLast"===p,Z=g.strides[0],z=L?g.strides[1]:g.strides[2],B=L?g.strides[2]:1,U=L?1:g.strides[1],V=d[0],j=L?d[1]:d[2],W=L?d[2]:1,H=L?1:d[1],G=0;G<S;++G)for(var q=0;q<T;++q)for(var K=0;K<E;++K)for(var Y=K-F,X=Math.max(0,Math.ceil(Y/M)),Q=Math.min(A,(C+Y)/M),J=0;J<N;++J){for(var $=J-P,ee=Math.max(0,Math.ceil($/O)),te=Math.min(R,(_+$)/O),ne=0,re=X;re<Q;++re)for(var ae=re*M-Y,ie=ee;ie<te;++ie)for(var oe=V*G+j*re+W*ie,se=x*(C-1-ae)+w*(_-1-(ie*O-$))+I*q,ue=0;ue<D;++ue){ne+=y[oe+H*ue]*b[se+ue]}m[Z*G+z*K+B*J+U*q]=ne}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var h6={kernelName:kZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;y4([a,i],"conv3d");for(var c=aH(a.shape,i.shape,o,u,s),l=c.filterDepth,h=c.filterHeight,f=c.filterWidth,d=c.dilationDepth,p=c.dilationHeight,v=c.dilationWidth,g=c.padInfo,m=g.front,y=g.left,b=g.top,k=new ZU(c.outShape,a.dtype),x=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,I=k.values,S=SL(a.shape),C=SL(i.shape),_=0;_<c.batchSize;++_)for(var T=_*S[0],E=_*k.strides[0],N=0;N<c.outDepth;++N)for(var D=E+N*k.strides[1],A=N*c.strideDepth-m,R=0;R<l;++R){var M=A+R*d;if(!(M<0||M>=c.inDepth))for(var O=R*C[0],F=T+M*S[1],P=0;P<c.outHeight;++P)for(var L=D+P*k.strides[2],Z=P*c.strideHeight-b,z=0;z<h;++z){var B=Z+z*p;if(!(B<0||B>=c.inHeight))for(var U=O+z*C[1],V=F+B*S[2],j=0;j<c.outWidth;++j)for(var W=L+j*c.outChannels,H=j*c.strideWidth-y,G=0;G<f;++G){var q=H+G*v;if(!(q<0||q>=c.inWidth))for(var K=U+G*C[2],Y=V+q*c.inChannels,X=K,Q=0;Q<c.inChannels;++Q){for(var J=x[Y+Q],$=0;$<c.outChannels;++$)I[W+$]+=J*w[X+$];X+=c.outChannels}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var f6={kernelName:xZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;y4([a,i],"conv3dBackpropFilterV2");for(var c=SL(a.shape),h=SL(i.shape),f=aH(a.shape,u,o,1,s),d=f.strideDepth,p=f.strideHeight,v=f.strideWidth,g=f.filterDepth,m=f.filterHeight,y=f.filterWidth,b=new ZU(f.filterShape,"float32"),k=b.values,x=l(b.strides,4),w=x[0],I=x[1],S=x[2],C=x[3],_=n.data.get(i.dataId).values,T=l(h,4),E=T[0],N=T[1],D=T[2],A=T[3],R=n.data.get(a.dataId).values,M=l(c,4),O=M[0],F=M[1],P=M[2],L=M[3],Z=f.padInfo.front,z=f.padInfo.left,B=f.padInfo.top,U=0;U<g;++U)for(var V=Math.max(0,Math.ceil((Z-U)/d)),j=Math.min(f.outDepth,(f.inDepth+Z-U)/d),W=U*w,H=0;H<m;++H)for(var G=Math.max(0,Math.ceil((B-H)/p)),q=Math.min(f.outHeight,(f.inHeight+B-H)/p),K=H*I+W,Y=0;Y<y;++Y)for(var X=Math.max(0,Math.ceil((z-Y)/v)),Q=Math.min(f.outWidth,(f.inWidth+z-Y)/v),J=Y*S+K,$=0;$<f.inChannels;++$)for(var ee=$*C+J,te=0;te<f.outChannels;++te){for(var ne=0,re=0;re<f.batchSize;++re)for(var ae=re*O,ie=re*E,oe=V;oe<j;++oe)for(var se=(U+oe*d-Z)*F+ae,ue=oe*N+ie,ce=G;ce<q;++ce)for(var le=(H+ce*p-B)*P+se,he=ce*D+ue,fe=X;fe<Q;++fe){var de=fe*A+he;ne+=R[(Y+fe*v-z)*L+le+$]*_[de+te]}k[ee+te]=ne}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var d6={kernelName:wZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;y4([a],"conv3dBackpropInputV2");for(var c=SL(a.shape),h=SL(i.shape),f=aH(u,i.shape,s,1,o),d=new ZU(f.inShape,"float32"),p=d.values,v=l(d.strides,4),g=v[0],m=v[1],y=v[2],b=v[3],k=n.data.get(a.dataId).values,x=l(c,4),w=x[0],I=x[1],S=x[2],C=x[3],_=n.data.get(i.dataId).values,T=l(h,4),E=T[0],N=T[1],D=T[2],A=T[3],R=f.batchSize,M=f.filterDepth,O=f.filterHeight,F=f.filterWidth,P=f.inChannels,L=f.inDepth,Z=f.inHeight,z=f.inWidth,B=f.outChannels,U=f.outDepth,V=f.outHeight,j=f.outWidth,W=f.strideDepth,H=f.strideHeight,G=f.strideWidth,q=M-1-f.padInfo.front,K=O-1-f.padInfo.top,Y=F-1-f.padInfo.left,X=0;X<R;++X)for(var Q=0;Q<P;++Q)for(var J=0;J<L;++J)for(var $=J-q,ee=Math.max(0,Math.ceil($/W)),te=Math.min(U,(M+$)/W),ne=0;ne<Z;++ne)for(var re=ne-K,ae=Math.max(0,Math.ceil(re/H)),ie=Math.min(V,(O+re)/H),oe=0;oe<z;++oe){for(var se=oe-Y,ue=Math.max(0,Math.ceil(se/G)),ce=Math.min(j,(F+se)/G),le=0,he=ee;he<te;++he)for(var fe=he*W-$,de=ae;de<ie;++de)for(var pe=de*H-re,ve=ue;ve<ce;++ve)for(var ge=w*X+I*he+S*de+C*ve,me=E*(M-1-fe)+N*(O-1-pe)+D*(F-1-(ve*G-se))+A*Q,ye=0;ye<B;++ye){le+=k[ge+ye]*_[me+ye]}p[g*X+m*J+y*ne+b*oe+Q]=le}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},p6=w4(IZ,(function(e){return Math.cos(e)})),v6={kernelName:IZ,backendName:"cpu",kernelFunc:p6},g6=w4(SZ,(function(e){return Math.cosh(e)})),m6={kernelName:SZ,backendName:"cpu",kernelFunc:g6};var y6={kernelName:TZ,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,h=l(a.shape,4),f=h[0],d=h[1],p=h[2],v=h[3],g=i.shape[0],m=l(s,2),y=m[0],b=m[1],k=Rj([g,y,b,v],"float32"),x=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,I=n.data.get(a.dataId).values,S=SL(a.shape),C=SL(k.shape),_=0;_<g;_++){var T=4*_,E=x[T],N=x[T+1],D=x[T+2],A=x[T+3],R=w[_];if(!(R>=f))for(var M=y>1?(D-E)*(d-1)/(y-1):0,O=b>1?(A-N)*(p-1)/(b-1):0,F=0;F<y;F++){var P=y>1?E*(d-1)+F*M:.5*(E+D)*(d-1);if(P<0||P>d-1)for(var L=0;L<b;L++)for(var Z=0;Z<v;Z++){var z=Z+L*C[2]+F*C[1]+_*C[0];k.values[z]=c}else if("bilinear"===u)for(var B=Math.floor(P),U=Math.ceil(P),V=P-B,j=0;j<b;j++){var W=b>1?N*(p-1)+j*O:.5*(N+A)*(p-1);if(W<0||W>p-1)for(var H=0;H<v;H++){var G=H+j*C[2]+F*C[1]+_*C[0];k.values[G]=c}else for(var q=Math.floor(W),K=Math.ceil(W),Y=W-q,X=0;X<v;X++){var Q=X+q*S[2]+B*S[1]+R*S[0],J=I[Q],$=I[Q=X+K*S[2]+B*S[1]+R*S[0]],ee=I[Q=X+q*S[2]+U*S[1]+R*S[0]],te=J+($-J)*Y,ne=ee+(I[Q=X+K*S[2]+U*S[1]+R*S[0]]-ee)*Y;Q=X+j*C[2]+F*C[1]+_*C[0],k.values[Q]=te+(ne-te)*V}}else for(var re=0;re<b;++re){var ae=b>1?N*(p-1)+re*O:.5*(N+A)*(p-1);if(ae<0||ae>p-1)for(var ie=0;ie<v;ie++){var oe=ie+re*C[2]+F*C[1]+_*C[0];k.values[oe]=c}else for(var se=Math.round(ae),ue=Math.round(P),ce=0;ce<v;ce++){var le=ce+se*S[2]+ue*S[1]+R*S[0],he=ce+re*C[2]+F*C[1]+_*C[0];k.values[he]=I[le]}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var b6={kernelName:CZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;y4(a,"cumprod");var u=hG([i],a.shape.length),c=a;null!=u&&(c=v5({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=dG(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var h=XU(c.dtype,"int32"),f=TL(oL(c.shape),h),d=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=s?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<d.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)f[y]=o?1:d[y];else{var b=v(g,m-1);f[y]=o?d[b]*f[b]:d[y]*f[b]}}var k=n.makeTensorInfo(c.shape,h,f);if(null!=u){var x=v5({inputs:{x:k},backend:n,attrs:{perm:fG(u)}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(c),x}return k}};var k6={kernelName:_Z,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;y4(a,"cumsum");var u=hG([i],a.shape.length),c=a;null!=u&&(c=v5({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=dG(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var h=XU(c.dtype,"int32"),f=EL(oL(c.shape),h),d=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=s?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<d.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)f[y]=o?0:d[y];else{var b=v(g,m-1);f[y]=o?d[b]+f[b]:d[y]+f[b]}}var k=n.makeTensorInfo(c.shape,h,f);if(null!=u){var x=v5({inputs:{x:k},backend:n,attrs:{perm:fG(u)}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(c),x}return k}};var x6={kernelName:EZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=W5(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=H5(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var w6={kernelName:NZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;rL("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)}));for(var s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],h=u*i,f=c*i,d=l/(i*i),p=n.data.get(a.dataId).values,v=new Float32Array(s*h*f*d),g=0,m=0;m<s;++m)for(var y=0;y<h;++y)for(var b=Math.floor(y/i),k=y%i,x=0;x<f;++x)for(var w=Math.floor(x/i),I=(k*i+x%i)*d,S=0;S<d;++S){var C=S+I+l*(w+c*(b+u*m));v[g++]=p[C]}return n.makeTensorInfo([s,h,f,d],a.dtype,v)}};function I6(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode;y4([a,i],"depthwiseConv2DNative");var l=SL(a.shape),h=SL(i.shape),f=u;null==f&&(f=[1,1]),rL(hH(o,f),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(f,"'")}));for(var d=rH(a.shape,i.shape,o,f,s,c,!0),p=d.filterHeight,v=d.filterWidth,g=d.dilationHeight,m=d.dilationWidth,y=d.padInfo,b=y.left,k=y.top,x=d.outChannels/d.inChannels,w=new ZU(d.outShape,a.dtype),I=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=w.values,_=0;_<d.batchSize;++_)for(var T=_*l[0],E=_*w.strides[0],N=0;N<d.outHeight;++N)for(var D=E+N*w.strides[1],A=N*d.strideHeight-k,R=0;R<p;++R){var M=A+R*g;if(!(M<0||M>=d.inHeight))for(var O=R*h[0],F=T+M*l[1],P=0;P<d.outWidth;++P)for(var L=D+P*w.strides[2],Z=P*d.strideWidth-b,z=0;z<v;++z){var B=Z+z*m;if(!(B<0||B>=d.inWidth))for(var U=O+z*h[1],V=F+B*d.inChannels,j=L,W=U,H=0;H<d.inChannels;++H){for(var G=I[V+H],q=0;q<x;++q)C[j+q]+=G*S[W+q];j+=x,W+=x}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var S6={kernelName:DZ,backendName:"cpu",kernelFunc:I6};var C6={kernelName:AZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape;y4([a,i],"depthwiseConv2dNativeBackpropFilter");for(var h=rH(a.shape,l,o,s,u,c,!0),f=h.strideHeight,d=h.strideWidth,p=h.filterHeight,v=h.filterWidth,g=new ZU(h.filterShape,"float32"),m=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,k=n.data.get(a.dataId).values,x=new ZU(a.shape,a.dtype,k),w=n.data.get(i.dataId).values,I=new ZU(i.shape,i.dtype,w),S=0;S<p;++S)for(var C=Math.max(0,Math.ceil((y-S)/f)),_=Math.min(h.outHeight,(h.inHeight+y-S)/f),T=0;T<v;++T)for(var E=Math.max(0,Math.ceil((m-T)/d)),N=Math.min(h.outWidth,(h.inWidth+m-T)/d),D=0;D<h.outChannels;++D){for(var A=Math.trunc(D/b),R=D%b,M=0,O=0;O<h.batchSize;++O)for(var F=C;F<_;++F)for(var P=S+F*f-y,L=E;L<N;++L){var Z=T+L*d-m;M+=x.get(O,P,Z,A)*I.get(O,F,L,D)}g.set(M,S,T,A,R)}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var _6={kernelName:RZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,h=r.inputShape;y4([a,i],"depthwiseConv2DNativeBackpropInput");for(var f=SL(a.shape),d=SL(i.shape),p=rH(h,i.shape,o,s,u,c,!0),v=new ZU(p.inShape,"float32"),g=v.values,m=l(v.strides,3),y=m[0],b=m[1],k=m[2],x=n.data.get(a.dataId).values,w=l(f,3),I=w[0],S=w[1],C=w[2],_=n.data.get(i.dataId).values,T=l(d,3),E=T[0],N=T[1],D=T[2],A=p.batchSize,R=p.filterHeight,M=p.filterWidth,O=p.inChannels,F=p.inHeight,P=p.inWidth,L=p.outChannels,Z=p.outHeight,z=p.outWidth,B=p.strideHeight,U=p.strideWidth,V=R-1-p.padInfo.top,j=M-1-p.padInfo.left,W=L/O,H=0;H<A;++H)for(var G=0;G<O;++G)for(var q=0;q<F;++q)for(var K=q-V,Y=Math.max(0,Math.ceil(K/B)),X=Math.min(Z,(R+K)/B),Q=0;Q<P;++Q){for(var J=Q-j,$=Math.max(0,Math.ceil(J/U)),ee=Math.min(z,(M+J)/U),te=0,ne=Y;ne<X;++ne)for(var re=ne*B-K,ae=$;ae<ee;++ae)for(var ie=I*H+S*ne+C*ae,oe=E*(R-1-re)+N*(M-1-(ae*U-J))+D*G,se=0;se<W;++se){te+=x[ie+(G*W+se)]*_[oe+se]}g[y*H+b*q+k*Q+G]=te}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var T6={kernelName:MZ,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=oL(r.shape),i=n.data.get(r.dataId).values,o=Rj([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var c=[].concat(d(r.shape),d(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},E6={kernelName:OZ,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=n,l=c.data.get(a.dataId).values,h=a.shape.length,f=c.data.get(i.dataId).values,d=i.shape.length,p=eH(a.shape,i.shape,o,s,"NHWC",u),v=p.batchSize,g=p.inHeight,m=p.inWidth,y=p.inChannels,b=p.outHeight,k=p.outWidth,x=p.padInfo,w=p.strideHeight,I=p.strideWidth,S=p.filterHeight,C=p.filterWidth,_=p.dilationHeight,T=p.dilationWidth,E=p.outShape,N=oL(E),D=E.length,A=gL(a.dtype,N),R=0;R<v;++R)for(var M=0;M<b;++M)for(var O=M*w-x.top,F=0;F<k;++F)for(var P=F*I-x.left,L=0;L<y;++L){for(var Z=Number.MIN_SAFE_INTEGER,z=0;z<S;++z){var B=O+z*_;if(B>=0&&B<g)for(var U=0;U<C;++U){var V=P+U*T;if(V>=0&&V<m){var j=AL([R,B,V,L],h,SL(a.shape)),W=AL([z,U,L],d,SL(i.shape)),H=l[j]+f[W];H>Z&&(Z=H)}}}A[AL([R,M,F,L],D,SL(E))]=Z}return{dataId:c.write(wU(A,a.dtype),E,a.dtype),shape:E,dtype:a.dtype}}},N6={kernelName:PZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=_L(a.shape,l.data.get(a.dataId).values),f=_L(i.shape,l.data.get(i.dataId).values),d=eH(a.shape,i.shape,s,u,"NHWC",c),p=d.batchSize,v=d.inHeight,g=d.inWidth,m=d.inChannels,y=d.outHeight,b=d.outWidth,k=d.padInfo,x=d.strideHeight,w=d.strideWidth,I=d.filterHeight,S=d.filterWidth,C=d.dilationHeight,_=d.dilationWidth,T=d.outShape;rL(o.rank===T.length,(function(){return"Error in ".concat(PZ,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var E=_L(T,l.data.get(o.dataId).values),N=NL(i.shape,i.dtype),D=0;D<p;++D)for(var A=0;A<y;++A)for(var R=A*x-k.top,M=0;M<b;++M)for(var O=M*w-k.left,F=0;F<m;++F){for(var P=Number.MIN_SAFE_INTEGER,L=0,Z=0,z=0;z<I;++z){var B=R+z*C;if(B>=0&&B<v)for(var U=0;U<S;++U){var V=O+U*_;if(V>=0&&V<g){var j=h[D][B][V][F]+f[z][U][F];j>P&&(P=j,L=z,Z=U)}}}N[L][Z][F]+=E[D][A][M][F]}return{dataId:l.write(wU(N,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},D6={kernelName:FZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=_L(a.shape,l.data.get(a.dataId).values),f=_L(i.shape,l.data.get(i.dataId).values),d=eH(a.shape,i.shape,s,u,"NHWC",c),p=d.batchSize,v=d.inHeight,g=d.inWidth,m=d.inChannels,y=d.outHeight,b=d.outWidth,k=d.padInfo,x=d.strideHeight,w=d.strideWidth,I=d.filterHeight,S=d.filterWidth,C=d.dilationHeight,_=d.dilationWidth,T=d.outShape;rL(o.rank===T.length,(function(){return"Error in ".concat(FZ,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var E=_L(T,l.data.get(o.dataId).values),N=NL(a.shape,a.dtype),D=0;D<p;++D)for(var A=0;A<y;++A)for(var R=A*x-k.top,M=0;M<b;++M)for(var O=M*w-k.left,F=0;F<m;++F){for(var P=Number.MIN_SAFE_INTEGER,L=R<0?0:R,Z=O<0?0:O,z=0;z<I;++z){var B=R+z*C;if(B>=0&&B<v)for(var U=0;U<S;++U){var V=O+U*_;if(V>=0&&V<g){var j=h[D][B][V][F]+f[z][U][F];j>P&&(P=j,L=B,Z=V)}}}N[D][L][Z][F]+=E[D][A][M][F]}return{dataId:l.write(wU(N,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};var A6={kernelName:"Draw",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=r.canvas,o=r.options||{},s=o.contextOptions,u=o.imageOptions,c=(null===u||void 0===u?void 0:u.alpha)||1,h=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==h)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));var f=i.getContext(h,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==f)throw new Error("Could not get the context with ".concat(h," type."));for(var d=l(a.shape.slice(0,2),2),p=d[0],v=d[1],g=2===a.shape.length?1:a.shape[2],m=n.data.get(a.dataId).values,y="float32"===a.dtype?255:1,b=new Uint8ClampedArray(v*p*4),k=0;k<p*v;++k){for(var x=[0,0,0,255*c],w=0;w<g;w++){var I=m[k*g+w];if("float32"===a.dtype){if(I<0||I>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(I,"."))}else if("int32"===a.dtype&&(I<0||I>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(I,"."));1===g?(x[0]=I*y,x[1]=I*y,x[2]=I*y):x[w]=I*y}var S=4*k;b[S+0]=Math.round(x[0]),b[S+1]=Math.round(x[1]),b[S+2]=Math.round(x[2]),b[S+3]=Math.round(x[3])}i.width=v,i.height=p;var C=new ImageData(b,v,p);return f.putImageData(C,0,0),a}},R6=D4((function(e,t){return e*t})),M6=Q4((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),O6=X4(Rz,R6,M6),F6={kernelName:Rz,backendName:"cpu",kernelFunc:O6};function P6(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;y4(i,"sum");var u=(t="bool"===i.dtype?K4({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):_4({inputs:{x:i},backend:r})).shape.length,c=dL(o,t.shape),h=hG(c,u),f=c,d=t;null!=h&&(d=v5({inputs:{x:t},backend:r,attrs:{perm:h}}),f=dG(f.length,u)),lG("sum",f,d.shape.length);for(var p=l(uG(d.shape,f),2),v=p[0],g=p[1],m=W4(r,v,XU(d.dtype,"int32")),y=oL(g),b=r.data.get(m.dataId).values,k=r.data.get(d.dataId).values,x=0;x<b.length;++x){for(var w=x*y,I=0,S=0;S<y;++S)I+=k[w+S];b[x]=I}if(s){var C=m;m=n5({inputs:{x:m},backend:r,attrs:{shape:cG(m.shape,c)}}),r.disposeIntermediateTensorInfo(C)}return r.disposeIntermediateTensorInfo(t),null!=h&&r.disposeIntermediateTensorInfo(d),m}var L6={kernelName:bB,backendName:"cpu",kernelFunc:P6};var Z6={kernelName:ZZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=PK(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;ZK(i.length,s,r);for(var u=zK(o,s),c=u.path,l=u.steps,h=l.length,f=null,d=i.length,p=[],v=0;v<h;++v){var g,m=(0,C.Z)(l[v]);try{for(m.s();!(g=m.n()).done;){var y=g.value,b=LK(d,s[y]),k=b.permutationIndices,x=b.expandDims,w=void 0;BK(k)?w=r[y]:(w=v5({inputs:{x:r[y]},backend:n,attrs:{perm:k}}),p.push(w));for(var I=w.shape.slice(),S=0;S<x.length;++S)I.splice(x[S],0,1);sL(w.shape,I)||(w=n5({inputs:{x:w},backend:n,attrs:{shape:I}}),p.push(w)),null===f?f=w:(f=O6({inputs:{a:w,b:f},backend:n}),p.push(f))}}catch(kve){m.e(kve)}finally{m.f()}v<h-1&&(c[v]>=0&&(f=P6({inputs:{x:f},backend:n,attrs:{axis:c[v]-(i.length-d),keepDims:!1}}),p.push(f)),d--)}for(var _=0,T=p;_<T.length;_++){var E=T[_];E!==f&&n.disposeIntermediateTensorInfo(E)}return f}};var z6={kernelName:BZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;y4([r,a],"eluGrad");for(var i=new Float32Array(oL(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var c=o[u];i[u]=c>=0?s[u]:s[u]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},B6=D4((function(e,t){return e===t?1:0})),U6=X4(VZ,B6,null,"bool"),V6={kernelName:VZ,backendName:"cpu",kernelFunc:U6},j6=w4(UZ,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+.3275911*n);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-n*n))})),W6={kernelName:UZ,backendName:"cpu",kernelFunc:j6},H6=x4((function(e){return Math.exp(e)})),G6=I4(jZ,H6,"float32"),q6={kernelName:jZ,backendName:"cpu",kernelFunc:G6};function K6(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(rL(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),n5({inputs:{x:a},backend:n,attrs:{shape:s}})}var Y6={kernelName:WZ,backendName:"cpu",kernelFunc:K6},X6=x4((function(e){return Math.expm1(e)})),Q6=I4(HZ,X6),J6={kernelName:HZ,backendName:"cpu",kernelFunc:Q6},$6=D4((function(e,t){return e/t})),e9=X4(LZ,$6),t9={kernelName:LZ,backendName:"cpu",kernelFunc:e9},n9=D4((function(e,t){return e-t})),r9=Q4((function(e,t,n,r){return{real:e-n,imag:t-r}})),a9=X4(FB,n9,r9),i9={kernelName:FB,backendName:"cpu",kernelFunc:a9};function o9(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=oL(c),h=vL("float32",l),f=vL("float32",l),d=0;d<a;d++){for(var p=U5({inputs:{x:s},backend:n,attrs:{begin:[d,0],size:[1,i]}}),v=U5({inputs:{x:u},backend:n,attrs:{begin:[d,0],size:[1,i]}}),g=V4({inputs:{real:p,imag:v},backend:n}),m=s9(g,t,n),y=EK(m.real,m.imag),b=0;b<i;b++){var k=NK(y,b);h[d*i+b]=k.real,f[d*i+b]=k.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g)}var x=n.makeTensorInfo(c,"float32",h),w=n.makeTensorInfo(c,"float32",f),I=V4({inputs:{real:x,imag:w},backend:n});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),I}function s9(e,t,n){var r=oL(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((m=r)&m-1)){var s=u9(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(u,"float32",s.real),l=n.makeTensorInfo(u,"float32",s.imag),h=n.makeTensorInfo([],"float32",xU(r,"float32")),f=_4({inputs:{x:h},backend:n}),d=t9.kernelFunc({inputs:{a:c,b:h},backend:n}),p=t9.kernelFunc({inputs:{a:l,b:f},backend:n}),v=n.data.get(d.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),{real:v,imag:g}}return s}var m,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=AK(a*s,t,n),c=NK(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),DK(r,i,o,a)}return r}(EK(i,o),r,t);return function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(y)}function u9(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=EK(e,t),o=n/2,s=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),u=s.real,c=s.imag,l=[u.length],h=a.makeTensorInfo(l,"float32",u),f=a.makeTensorInfo(l,"float32",c),d=V4({inputs:{real:h,imag:f},backend:a}),p=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),v=p.real,g=p.imag,m=[v.length],y=a.makeTensorInfo(m,"float32",v),b=a.makeTensorInfo(m,"float32",g),k=V4({inputs:{real:y,imag:b},backend:a}),x=u9(u,c,o,r,a),w=x.real,I=x.imag,S=[w.length],C=a.makeTensorInfo(S,"float32",w),_=a.makeTensorInfo(S,"float32",I),T=V4({inputs:{real:C,imag:_},backend:a}),E=u9(v,g,o,r,a),N=E.real,D=E.imag,A=[N.length],R=a.makeTensorInfo(A,"float32",N),M=a.makeTensorInfo(A,"float32",D),O=V4({inputs:{real:R,imag:M},backend:a}),F=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(n,r),P=[F.real.length],L=a.makeTensorInfo(P,"float32",F.real),Z=a.makeTensorInfo(P,"float32",F.imag),z=V4({inputs:{real:L,imag:Z},backend:a}),B=O6({inputs:{a:z,b:O},backend:a}),U=e5({inputs:{a:T,b:B},backend:a}),V=a9({inputs:{a:T,b:B},backend:a}),j=H4({inputs:{input:U},backend:a}),W=H4({inputs:{input:V},backend:a}),H=r6({inputs:{input:U},backend:a}),G=r6({inputs:{input:V},backend:a}),q=i6({inputs:[j,W],backend:a,attrs:{axis:0}}),K=i6({inputs:[H,G],backend:a,attrs:{axis:0}}),Y=a.data.get(q.dataId).values,X=a.data.get(K.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(K),{real:Y,imag:X}}var c9={kernelName:GZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=oL(r.shape),i=r.shape[r.shape.length-1],o=n5({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=o9(o,!1,n),u=n5({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function l9(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||xL(a),o=gL(i,oL(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var h9={kernelName:qZ,backendName:"cpu",kernelFunc:l9};var f9={kernelName:KZ,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=vL(r.dtype,oL(r.shape)),o=l(r.shape,4),s=o[0],u=o[1],c=o[2],h=o[3],f=a.data.get(r.dataId).values,d=0;d<s;d++)for(var p=d*c*u*h,v=0;v<u;v++)for(var g=v*(c*h),m=0;m<c;m++)for(var y=m*h,b=0;b<h;b++){var k=Math.round(c-m-1),x=p+g+y+b,w=f[x];if(k>=0&&k<c)w=f[p+g+k*h+b];i[x]=w}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},d9=x4((function(e){return Math.floor(e)})),p9=I4(YZ,d9),v9={kernelName:YZ,backendName:"cpu",kernelFunc:p9},g9=D4((function(e,t){return Math.floor(e/t)})),m9=X4(XZ,g9,null,"int32"),y9={kernelName:XZ,backendName:"cpu",kernelFunc:m9};var b9={kernelName:YB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,f=r.dimRoundingMode,d=r.activation,p=r.leakyreluAlpha,v=s6({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:f}});if(o){var g=v;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var m=n5({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=e5({inputs:{a:v,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else v=e5({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(d){var y=v;if("NCHW"===l&&"prelu"===d&&1===s.shape.length&&1!==s.shape[0]){var b=n5({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});v=U4(n,v,d,b,p),n.disposeIntermediateTensorInfo(b)}else v=U4(n,v,d,s,p);n.disposeIntermediateTensorInfo(y)}return v}};var k9={kernelName:XB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,f=r.dimRoundingMode,d=r.activation,p=r.leakyreluAlpha,v=I6({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:f}});if(o){var g=v;v=e5({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(d){var m=v;v=U4(n,v,d,s,p),n.disposeIntermediateTensorInfo(m)}return v}};function x9(e,t,n,r,a,i,o,s,u){for(var c=Rj([r,i],n),l=0;l<r;l++){for(var h=[],f=0,p=0;p<a;p++){var v=e[l*a+p];f+=v*o[p],h.push(v)}if(f<0||f>=u/i)throw new Error("Invalid indices: ".concat(h," does not index into ").concat(s));for(var g=0;g<i;g++)c.values[l*i+g]=t.get.apply(t,d(t.indexToLoc(f*i+g)))}return c}var w9={kernelName:$Z,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=oL(r.shape),o=a.shape,s=o[o.length-1],u=l(yK(r,a),4),c=u[0],h=u[1],f=u[2],d=u[3];if(0===h)return n.makeTensorInfo(c,r.dtype,[]);var p=x9(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,h,s,f,d,r.shape,i);return n.makeTensorInfo(c,r.dtype,p.values)}};function I9(e,t,n){for(var r=Rj(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var S9={kernelName:JZ,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;y4([a,i],"gatherV2");for(var u=dL(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[u],h=function(){var e=c[f];rL(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},f=0;f<c.length;++f)h();var d=s;null==s&&(d=0);var p=oL(i.shape),v=KK(a,i,u,d),g=n5({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),m=n5({inputs:{x:i},backend:n,attrs:{shape:[v.batchSize,p/v.batchSize]}}),y=[v.batchSize,v.outerSize,p/v.batchSize,v.sliceSize],b=n.bufferSync(m),k=I9(n.bufferSync(g),b,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(v.outputShape,k.dtype,k.values)}},C9=D4((function(e,t){return e>t?1:0})),_9=X4(ez,C9,null,"bool"),T9={kernelName:ez,backendName:"cpu",kernelFunc:_9},E9=D4((function(e,t){return e>=t?1:0})),N9=X4(tz,E9,null,"bool"),D9={kernelName:tz,backendName:"cpu",kernelFunc:N9};var A9={kernelName:rz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=oL(r.shape),i=r.shape[r.shape.length-1],o=n5({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=o9(o,!0,n),u=n5({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},R9=w4(iz,(function(e){return Number.isFinite(e)?1:0}),"bool"),M9={kernelName:iz,backendName:"cpu",kernelFunc:R9},O9=w4(oz,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),F9={kernelName:oz,backendName:"cpu",kernelFunc:O9},P9=w4(sz,(function(e){return Number.isNaN(e)?1:0}),"bool"),L9={kernelName:sz,backendName:"cpu",kernelFunc:P9},Z9=D4((function(e,t){return e<t?1:0})),z9=X4(cz,Z9,null,"bool"),B9={kernelName:cz,backendName:"cpu",kernelFunc:z9},U9=D4((function(e,t){return e<=t?1:0})),V9=X4(lz,U9,null,"bool"),j9={kernelName:lz,backendName:"cpu",kernelFunc:V9};function W9(e,t,n){var r=(t-e)/(n-1),a=EL(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var H9={kernelName:hz,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=W9(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},G9=x4((function(e){return Math.log(e)})),q9=I4(fz,G9),K9={kernelName:fz,backendName:"cpu",kernelFunc:q9},Y9=w4(dz,(function(e){return Math.log1p(e)})),X9={kernelName:dz,backendName:"cpu",kernelFunc:Y9},Q9=D4((function(e,t){return e&&t})),J9=X4(pz,Q9,null,"bool"),$9={kernelName:pz,backendName:"cpu",kernelFunc:J9},e7=w4(vz,(function(e){return e?0:1}),"bool"),t7={kernelName:vz,backendName:"cpu",kernelFunc:e7},n7=D4((function(e,t){return e||t})),r7=X4(gz,n7,null,"bool"),a7={kernelName:gz,backendName:"cpu",kernelFunc:r7};var i7={kernelName:mz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;y4(a,"LRN");var c=a.shape[3],l=c-1,h=n.data.get(a.dataId).values,f=oL(a.shape),d=new Float32Array(f);function p(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=h[n];a+=o*o}return a}for(var v=0;v<f;v++){var g=p(v),m=h[v]*Math.pow(o+s*g,-u);d[v]=m}return n.makeTensorInfo(a.shape,a.dtype,d)}};var o7={kernelName:yz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta;y4(o,"LRNGrad");for(var h=oL(o.shape),f=o.shape[3],d=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,g=new Float32Array(h),m=h,y=0;y<m;y++){for(var b=y%f,k=y-b+Math.max(0,b-s),x=y-b+Math.min(f,b+s+1),w=0,I=k;I<x;I++)w+=Math.pow(p[I],2);w=c*w+u;for(var S=k;S<x;S++){var C=-2*c*l*p[S]*v[y]/w;y===S&&(C+=Math.pow(w,-l)),C*=d[y],g[S]+=C}}return n.makeTensorInfo(o.shape,a.dtype,g)}};function s7(e,t,n,r){for(var a=vL(r,oL(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];(Number.isNaN(c)||c>s)&&(s=c)}a[i]=s}return a}function u7(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,c=u.length,h=dL(i,u),f=h,d=hG(f,c),p=s.data.get(a.dataId).values;if(null!=d){for(var v=new Array(c),g=0;g<v.length;g++)v[g]=u[d[g]];p=p5(p,u,a.dtype,d,v),f=dG(f.length,c),u=v}y4(a,"max"),lG("max",f,c);var m=l(uG(u,f),2),y=m[0],b=s7(p,oL(m[1]),y,a.dtype),k=s.write(b,y,a.dtype),x=y;o&&(x=cG(y,h));return{dataId:k,shape:x,dtype:a.dtype}}var c7={kernelName:bz,backendName:"cpu",kernelFunc:u7},l7=D4((function(e,t){return Math.max(e,t)})),h7=X4(kz,l7),f7={kernelName:kz,backendName:"cpu",kernelFunc:h7};var d7={kernelName:xz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;y4(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rL(hH(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=tH(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&sL(l.inShape,l.outShape))c=_4({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,f=SL(a.shape),d=R5(h,a.shape,a.dtype,f,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,d.values)}return c}};var p7={kernelName:Iz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat;y4(a,"maxPool3d");var l=nH(a.shape,i,o,1,s,u,c),h=O5(n.data.get(a.dataId).values,a.shape,a.dtype,SL(a.shape),l,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}};var v7={kernelName:Sz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;y4([a,i],"maxPool3DGrad");for(var l=nH(i.shape,o,s,1,u,c),h=function(e,t){for(var n=Rj(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v=0;v<t.batchSize;++v)for(var g=0;g<t.inChannels;++g)for(var m=0;m<t.outDepth;++m){for(var y=m*r-f,b=y;b<0;)b+=o;for(var k=Math.min(t.inDepth,c+y),x=0;x<t.outHeight;++x){for(var w=x*a-d,I=w;I<0;)I+=s;for(var S=Math.min(t.inHeight,l+w),C=0;C<t.outWidth;++C){for(var _=C*i-p,T=_;T<0;)T+=u;for(var E=Math.min(t.inWidth,h+_),N=Number.NEGATIVE_INFINITY,D=-1,A=b;A<k;A+=o)for(var R=A-y,M=I;M<S;M+=s)for(var O=M-w,F=T;F<E;F+=u){var P=F-_,L=e.get(v,A,M,F,g);L>=N&&(N=L,D=R*l*h+O*l+P)}n.set(D,v,m,x,C,g)}}}return n}(n.bufferSync(i),l),f=l.strideDepth,d=l.strideHeight,p=l.strideWidth,v=l.dilationDepth,g=l.dilationHeight,m=l.dilationWidth,y=l.effectiveFilterDepth,b=l.effectiveFilterHeight,k=l.effectiveFilterWidth,x=y-1-l.padInfo.front,w=k-1-l.padInfo.left,I=b-1-l.padInfo.top,S=Rj(i.shape,"float32"),C=n.bufferSync(a),_=0;_<l.batchSize;++_)for(var T=0;T<l.inChannels;++T)for(var E=0;E<l.inDepth;++E)for(var N=0;N<l.inHeight;++N)for(var D=0;D<l.inWidth;++D){for(var A=E-x,R=N-I,M=D-w,O=0,F=0;F<y;F+=v){var P=(A+F)/f;if(!(P<0||P>=l.outDepth||Math.floor(P)!==P))for(var L=0;L<b;L+=g){var Z=(R+L)/d;if(!(Z<0||Z>=l.outHeight||Math.floor(Z)!==Z))for(var z=0;z<k;z+=m){var B=(M+z)/p;if(!(B<0||B>=l.outWidth||Math.floor(B)!==B)){var U=y*b*k-1-h.get(_,P,Z,B,T)===F*b*k+L*k+z?1:0;if(0!==U)O+=C.get(_,P,Z,B,T)*U}}}}S.set(O,_,E,N,D,T)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var g7={kernelName:wz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;y4([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=tH(o.shape,s,u,1,c,l),f=n.data.get(o.dataId).values,d=Rj(h.outShape,o.dtype,M5(f,o.shape,o.dtype,h).values),p=h.strideHeight,v=h.strideWidth,g=h.dilationHeight,m=h.dilationWidth,y=h.effectiveFilterHeight,b=h.effectiveFilterWidth,k=b-1-h.padInfo.left,x=y-1-h.padInfo.top,w=Rj(o.shape,"float32"),I=n.data.get(a.dataId).values,S=Rj(a.shape,"float32",I),C=0;C<h.batchSize;++C)for(var _=0;_<h.inChannels;++_)for(var T=0;T<h.inHeight;++T)for(var E=0;E<h.inWidth;++E){for(var N=T-x,D=E-k,A=0,R=0;R<y;R+=g){var M=(N+R)/p;if(!(M<0||M>=h.outHeight||Math.floor(M)!==M))for(var O=0;O<b;O+=m){var F=(D+O)/v;if(!(F<0||F>=h.outWidth||Math.floor(F)!==F)){var P=y*b-1-d.get(C,M,F,_)===R*b+O?1:0;if(0!==P)A+=S.get(C,M,F,_)*P}}}w.set(A,C,T,E,_)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var m7={kernelName:Cz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;y4(a,"MaxPoolWithArgmax");var h=c.data.get(a.dataId).values,f=tH(a.shape,i,o,[1,1],s),d=function(e,t,n,r,a){var i=R5(e,0,n,SL(t),a,"max"),o=M5(e,t,n,a,!0,r);return[i.values,o.values]}(h,a.shape,a.dtype,u,f),p=l(d,2),v=p[0],g=p[1],m=c.write(v,f.outShape,a.dtype),y=c.write(g,f.outShape,a.dtype);return[{dataId:m,shape:f.outShape,dtype:a.dtype},{dataId:y,shape:f.outShape,dtype:"int32"}]}};var y7={kernelName:_z,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=dL(i,a.shape),u=oL(uG(a.shape,s)[1]),c=[],l=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(l);var h=K4({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(h);var f=e9({inputs:{a:h,b:l},backend:n});c.push(f);var d=P6({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),d}};var b7={kernelName:Tz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;y4(a,"min");var s=dL(i,a.shape),u=s,c=hG(u,a.shape.length),h=a;null!=c&&(h=v5({inputs:{x:a},backend:n,attrs:{perm:c}}),u=dG(u.length,a.shape.length)),lG("min",u,h.shape.length);for(var f=l(uG(h.shape,u),2),d=f[0],p=oL(f[1]),v=EL(oL(d),h.dtype),g=n.data.get(h.dataId).values,m=0;m<v.length;++m){for(var y=m*p,b=g[y],k=0;k<p;++k){var x=g[y+k];(Number.isNaN(x)||x<b)&&(b=x)}v[m]=b}null!=c&&n.disposeIntermediateTensorInfo(h);var w=n.makeTensorInfo(d,h.dtype,v);if(o){var I=n5({inputs:{x:w},backend:n,attrs:{shape:cG(d,s)}});return n.disposeIntermediateTensorInfo(w),I}return w}},k7=D4((function(e,t){return Math.min(e,t)})),x7=X4(Ez,k7),w7={kernelName:Ez,backendName:"cpu",kernelFunc:x7};var I7={kernelName:Nz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;y4(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,h=n.data.get(a.dataId).values,f=a.shape.length,d=SL(a.shape),p=oL(s),v=s.length,g=SL(s),m=vL(a.dtype,p),y=0;y<p;y++){for(var b=RL(y,v,g),k=0;k<v;k++)b[k]<u[k]?b[k]=2*u[k]-b[k]-l:b[k]>=c[k]&&(b[k]=2*(c[k]-1)-b[k]+l);b=b.map((function(e,t){return e-u[t]}));var x=AL(b,f,d);m[y]=h[x]}return{dataId:n.write(m,s,a.dtype),shape:s,dtype:a.dtype}}},S7=D4((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),C7=X4(Dz,S7),_7={kernelName:Dz,backendName:"cpu",kernelFunc:C7};function T7(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));var u=dL([s],a.shape),c=u7({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=cG(c.shape,u),h=n5({inputs:{x:c},backend:n,attrs:{shape:l}}),f=a9({inputs:{a:a,b:h},backend:n}),d=G6({inputs:{x:f},backend:n}),p=P6({inputs:{x:d},backend:n,attrs:{axis:u,keepDims:!1}}),v=n5({inputs:{x:p},backend:n,attrs:{shape:l}}),g=e9({inputs:{a:d,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}var E7={kernelName:wB,backendName:"cpu",kernelFunc:T7};var N7={kernelName:Az,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;y4(a,"multinomial");for(var u=s?a:T7({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],h=n.data.get(u.dataId).values,f=[c,i],d=EL(oL(f),"int32"),p=0;p<c;++p){var v=p*l,g=new Float32Array(l-1);g[0]=h[v];for(var m=1;m<g.length;++m)g[m]=g[m-1]+h[v+m];for(var y=IG.alea(o.toString()),b=p*i,k=0;k<i;++k){var x=y();d[b+k]=g.length;for(var w=0;w<g.length;w++)if(x<g[w]){d[b+k]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(f,"int32",d)}};function D7(e,t,n){var r=xU(-1,n);return R6([],t,r,e,n)}var A7={kernelName:Mz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;y4(r,"neg");var a=l(D7(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},R7=Iq;var M7={kernelName:Fz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;y4(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,h=R7(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},O7=Sq;var F7={kernelName:Pz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;y4(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,f=O7(l,h,o,s,u,c),d=f.selectedIndices,p=f.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},P7=Cq;var L7={kernelName:Lz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;y4(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,f=P7(l,h,o,s,u,c),d=f.selectedIndices,p=f.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},Z7=D4((function(e,t){return e!==t?1:0})),z7=X4(Oz,Z7,null,"bool"),B7={kernelName:Oz,backendName:"cpu",kernelFunc:z7};var U7={kernelName:zz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue;y4(a,"oneHot");var c=oL(a.shape),l=new Float32Array(c*o);l.fill(u);for(var h=n.data.get(a.dataId).values,f=0;f<c;++f)h[f]>=0&&h[f]<o&&(l[f*o+h[f]]=s);return n.makeTensorInfo([].concat(d(a.shape),[o]),i,l)}};function V7(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=H4({inputs:{input:r},backend:n}),i=V7({inputs:{x:a},backend:n}),o=r6({inputs:{input:r},backend:n}),s=V7({inputs:{x:o},backend:n}),u=V4({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return l9({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var j7={kernelName:HB,backendName:"cpu",kernelFunc:V7};var W7={kernelName:Zz,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=H4({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=r6({inputs:{input:a},backend:r}),u=V7({inputs:{x:s},backend:r}),c=V4({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return l9({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function H7(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return K6({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){aL(a,e.shape,"All tensors passed to stack must have matching shapes"),rL(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=i6({inputs:t.map((function(e){var t=K6({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}var G7={kernelName:Bz,backendName:"cpu",kernelFunc:H7};var q7={kernelName:Uz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;y4(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=oL(a.shape),h=a.shape.length,f=SL(a.shape),d=oL(s),p=s.length,v=SL(s),g=vL(a.dtype,d);0!==o&&g.fill(o);for(var m=0;m<l;m++){g[AL(RL(m,h,f).map((function(e,t){return e+u[t]})),p,v)]=c[m]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},K7=D4((function(e,t){return Math.pow(e,t)})),Y7=X4(Vz,K7),X7={kernelName:Vz,backendName:"cpu",kernelFunc:Y7};function Q7(e,t,n,r){for(var a=l(uG(e,r),2),i=a[0],o=a[1],s=XU(t,"int32"),u=EL(oL(i),s),c=oL(o),h=0;h<u.length;++h){for(var f=h*c,d=1,p=0;p<c;++p)d*=n[f+p];u[h]=d}return{outVals:u,outShape:i,outDtype:s}}var J7={kernelName:Wz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;y4(a,"prod");var s=a.shape.length,u=dL(i,a.shape),c=hG(u,s),l=u,h=a,f=[];null!=c&&(h=v5({inputs:{x:a},backend:n,attrs:{perm:c}}),f.push(h),l=dG(l.length,s));var d=n.data.get(h.dataId).values,p=Q7(h.shape,h.dtype,d,l),v=p.outVals,g=p.outShape,m=p.outDtype,y=g;return o&&(y=cG(g,u)),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,m,v)}};function $7(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,s=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var u=1,c=0;c<t.length-1;++c){u*=t[c];for(var l=t[c+1],h=1;h<u+1;++h)s[c].push(h*l)}for(var f=0;f<e.length;++f){for(var d=e[f],p=e[f]+1,v=0;v<n.length;++v){var g=n[v],m=v+t.length-1;if(m>=0)for(var y=s[m],b=y[y.length-1]-g[d],k=d;k<p;++k)s[m].push(g[k+1]+b);d=g[d],p=g[p]}p!==d&&(a.push([d,p]),i+=p-d)}return{outSplits:s,valueSlices:a,numValues:i}}function e8(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function t8(e,t,n,r,a){var i=t.slice();i[0]=a;var o=gL(n,oL(i)),s=e.length;return function(e,t,n,r,a,i){var o,s=e8(t,2)[1],u=e8(i,2)[1],c=0,l=(0,C.Z)(n);try{for(l.s();!(o=l.n()).done;)for(var h=o.value,f=h[0];f<h[1];++f){for(var d=0;d<r;++d)a[c*u+d]=e[f*s+d];++c}}catch(kve){l.e(kve)}finally{l.f()}}(e,t,r,0===s?0:s/t[0],o,i),[o,i]}function n8(e,t,n,r,a,i,o,s){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=RL(r,t.length,SL(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var u=$7(i,o,e,r[0]),c=u.outSplits,l=u.valueSlices,h=u.numValues,f=function(e){for(var t=[],n=function(){var n=gL("int32",e[r].length);t.push(n),e[r].forEach((function(e,t){return n[t]=e}))},r=0;r<e.length;++r)n();return t}(c),d=t8(n,r,a,l,h);return[f,d[0],d[1]]}var r8={kernelName:Hz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=(r.outputRaggedRank,a.map((function(e){return n.data.get(e.dataId).values}))),u=a.map((function(e){return e.shape})),c=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,f=l(n8(s,u,c,i.shape,i.dtype,h,o.shape),3),d=f[0],p=f[1],v=f[2],g=d.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),m=n.makeTensorInfo(v,i.dtype,p);return g.concat([m])}},a8=2147483647;function i8(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var s=0===t.length,u=0===a.length,c=0===o.length,l=[];s||l.push(t[0]),u||l.push(a[0]),c||l.push(o[0]);for(var h=1;h<l.length;++h)if(l[h]!==l[h-1])throw new Error("starts, limits, and deltas must have the same shape");var f=0===l.length?1:l[0],d=gL("int32",f+1);d[0]=0;for(var p=0;p<f;++p){var v=s?e[0]:e[p],g=u?r[0]:r[p],m=c?i[0]:i[p];if(0===m)throw new Error("Requires delta != 0");var y=void 0;if(m>0&&g<v||m<0&&g>v)y=0;else if((y=Math.ceil(Math.abs((g-v)/m)))>a8)throw new Error("Requires ((limit - start) / delta) <= ".concat(a8));d[p+1]=d[p]+y}for(var b=gL(n,d[f]),k=0,x=0;x<f;++x)for(var w=d[x+1]-d[x],I=s?e[0]:e[x],S=c?i[0]:i[x],C=0;C<w;++C)b[k++]=I,I+=S;return[d,b]}var o8={kernelName:Gz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=l(i8(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),h=c[0],f=c[1];return[n.makeTensorInfo([h.length],"int32",h),n.makeTensorInfo([f.length],r.dtype,f)]}},s8=tK,u8=function(){function e(t,n,r,a,i,o,s,u,c,l){var h;(0,p.Z)(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=function(e){var t,n={FIRST_DIM_SIZE:tK.FIRST_DIM_SIZE,VALUE_ROWIDS:tK.VALUE_ROWIDS,ROW_LENGTHS:tK.ROW_LENGTHS,ROW_SPLITS:tK.ROW_SPLITS,ROW_LIMITS:tK.ROW_LIMITS,ROW_STARTS:tK.ROW_STARTS},r=[],a=(0,C.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(kve){a.e(kve)}finally{a.f()}return r}(l),this.raggedRank=0===(h=this.rowPartitionTypes).length?0:h[0]===tK.FIRST_DIM_SIZE?h.length-1:h.length}return(0,v.Z)(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===s8.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===s8.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case s8.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case s8.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(s8[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return l8(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape;!function(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}(this.defaultValueShape,t);var n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=function(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(s))}else r[o]=i}return r}(this.raggedRank,n,t),a=r;a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var s=r;s<e;++s)a.push(-1);return rL(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var s=e[o+1]-e[o],u=Math.min(r,s),c=t[o];-1===c&&(u=0);for(var l=0;l<u;++l)i.push(c),c+=n;for(var h=0;h<s-u;++h)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,s=e[0];if(s>=t.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(t.length));var u=t[s];i.push(u);for(var c=1;c<a;++c){var l=e[c];if(l===s)u>=0&&(++o<r?u+=n:u=-1);else{if(o=0,s=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));u=t[l]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case s8.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case s8.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(s8[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case s8.FIRST_DIM_SIZE:return e[0];case s8.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case s8.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(s8[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=l8(t,!1),i=gL(this.valuesDType,oL(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),s=1;s<=this.raggedRank;++s){o=this.calculateOutputIndex(s-1,o,n[s],t[s])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice(),s=oL(o=o.slice(e+1)),u=t.length,c=this.defaultValue;if(c.length!==s&&1!==c.length){var l=this.defaultValueShape;Zj((function(){var e=vH(c,l),t=wH(e,o);c=t.dataSync()}))}for(var h=0,f=0,d=0,p=0;p<=u;++p){var v=p<u?t[p]:-1;if(v!==d){if(f<d){var g=a.subarray(h*s);c8(i.subarray(f*s),g,(d-f)*s)}if(p>=u){var m=n.length;v=Math.floor(m/s)}if(v>d)if(1===this.defaultValue.length)i.subarray(d*s,v*s).fill(this.defaultValue[0]),d=v;else for(;v>d;){c8(i.slice(d*s),c,s),++d}v<0?(h=p+1,f=d):(h=p,d=(f=d)+1)}else++d}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function c8(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function l8(e,t){var n,r=[],a=(0,C.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(kve){a.e(kve)}finally{a.f()}return r}function h8(e,t,n,r,a,i,o,s,u,c){return new u8(e,t,n,r,a,i,o,s,u,c).compute()}var f8={kernelName:qz,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,f=n.data.get(o.dataId).values,d=s.map((function(e){return n.data.get(e.dataId).values})),p=s.map((function(e){return e.shape})),v=l(h8(c,a.shape,h,i.shape,i.dtype,f,o.shape,d,p,u),2),g=v[0],m=v[1];return n.makeTensorInfo(g,i.dtype,m)}};function d8(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return EL(0,r);var a=EL(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var p8={kernelName:Kz,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=d8(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},v8=w4(Xz,(function(e){return 1/e})),g8={kernelName:Xz,backendName:"cpu",kernelFunc:v8};var m8={kernelName:tB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;y4(a,"resizeBilinear");for(var u=SL(a.shape),c=l(s,2),h=c[0],f=c[1],d=l(a.shape,4),p=d[0],v=d[1],g=d[2],m=d[3],y=n.data.get(a.dataId).values,b=new Float32Array(oL([p,h,f,m])),k=[i&&h>1?v-1:v,i&&f>1?g-1:g],x=[i&&h>1?h-1:h,i&&f>1?f-1:f],w=0,I=k[0]/x[0],S=k[1]/x[1],C=0;C<p;C++)for(var _=0;_<h;_++){var T=void 0;T=o?I*(_+.5)-.5:I*_;for(var E=Math.max(0,Math.floor(T)),N=T-E,D=Math.min(v-1,Math.ceil(T)),A=C*u[0]+E*u[1],R=C*u[0]+D*u[1],M=0;M<f;M++){var O=void 0;O=o?S*(M+.5)-.5:S*M;for(var F=Math.max(0,Math.floor(O)),P=O-F,L=Math.min(g-1,Math.ceil(O)),Z=A+F*u[2],z=R+F*u[2],B=A+L*u[2],U=R+L*u[2],V=0;V<m;V++){var j=y[Z+V],W=y[z+V],H=j+(y[B+V]-j)*P,G=H+(W+(y[U+V]-W)*P-H)*N;b[w++]=G}}}return n.makeTensorInfo([p,h,f,m],"float32",b)}};var y8={kernelName:nB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;y4([i,a],"resizeBilinearGrad");for(var s=SL(a.shape),u=l(a.shape,4),c=u[0],h=u[1],f=u[2],d=u[3],p=l(i.shape,3),v=p[1],g=p[2],m=new Float32Array(c*h*f*d),y=[o&&v>1?h-1:h,o&&g>1?f-1:f],b=[o&&v>1?v-1:v,o&&g>1?g-1:g],k=y[0]/b[0],x=y[1]/b[1],w=n.data.get(i.dataId).values,I=0,S=0;S<c;S++)for(var C=S*s[0],_=0;_<v;_++)for(var T=_*k,E=Math.floor(T),N=Math.min(Math.ceil(T),h-1),D=C+E*s[1],A=C+N*s[1],R=T-E,M=1-R,O=0;O<g;O++)for(var F=O*x,P=Math.floor(F),L=Math.min(Math.ceil(F),f-1),Z=F-P,z=1-Z,B=D+P*s[2],U=D+L*s[2],V=A+P*s[2],j=A+L*s[2],W=M*z,H=M*Z,G=R*z,q=R*Z,K=0;K<d;K++){var Y=w[I++];m[B+K]+=Y*W,m[U+K]+=Y*H,m[V+K]+=Y*G,m[j+K]+=Y*q}return n.makeTensorInfo([c,f,h,d],"float32",m)}};var b8={kernelName:$z,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;y4(a,"resizeNearestNeighbor");for(var u=SL(a.shape),c=l(s,2),h=c[0],f=c[1],d=l(a.shape,4),p=d[0],v=d[1],g=d[2],m=d[3],y=n.data.get(a.dataId).values,b=new Float32Array(p*h*f*m),k=[i&&h>1?v-1:v,i&&f>1?g-1:g],x=[i&&h>1?h-1:h,i&&f>1?f-1:f],w=k[0]/x[0],I=k[1]/x[1],S=0,C=0;C<p;C++)for(var _=C*u[0],T=0;T<h;T++){var E=o?w*(T+.5):w*T,N=Math.min(v-1,i?Math.round(E):Math.floor(E));o&&(N=Math.max(0,N));for(var D=_+N*u[1],A=0;A<f;A++){var R=o?I*(A+.5):I*A,M=Math.min(g-1,i?Math.round(R):Math.floor(R));o&&(M=Math.max(0,M));for(var O=D+M*u[2],F=0;F<m;F++){var P=y[O+F];b[S++]=P}}}return n.makeTensorInfo([p,h,f,m],a.dtype,b)}};var k8={kernelName:eB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;y4([i,a],"resizeNearestNeighborGrad");for(var s=SL(a.shape),u=SL(i.shape),c=l(a.shape,4),h=c[0],f=c[1],d=c[2],p=c[3],v=l(i.shape,3),g=v[1],m=v[2],y=new Float32Array(h*f*d*p),b=n.data.get(i.dataId).values,k=[o&&g>1?f-1:f,o&&m>1?d-1:d],x=[o&&g>1?g-1:g,o&&m>1?m-1:m],w=k[0]/x[0],I=k[1]/x[1],S=1/w,C=1/I,_=2*Math.ceil(S)+2,T=2*Math.ceil(C)+2,E=0;E<h;E++)for(var N=E*s[0],D=0;D<f;D++)for(var A=N+D*s[1],R=Math.floor(D*S),M=Math.floor(R-_/2),O=0;O<d;O++)for(var F=A+O*s[2],P=Math.floor(O*C),L=Math.floor(P-T/2),Z=0;Z<p;Z++){for(var z=0,B=0;B<_;B++){var U=B+M;if(!(U<0||U>=g)){var V=N+U*u[1],j=U*w;if(D===Math.min(f-1,o?Math.round(j):Math.floor(j)))for(var W=0;W<T;W++){var H=W+L;if(!(H<0||H>=m)){var G=V+H*u[2],q=H*I;O===Math.min(d-1,o?Math.round(q):Math.floor(q))&&(z+=b[G+Z])}}}}y[F+Z]=z}return n.makeTensorInfo(a.shape,a.dtype,y)}};var x8={kernelName:aB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;y4(a,"reverse");var o=a.shape.length,s=dL(i,a.shape);if(0===o)return _4({inputs:{x:a},backend:n});for(var u=new ZU(a.shape,a.dtype),c=n.bufferSync(a),l=function(){var e=u.indexToLoc(h),t=e.slice();s.forEach((function(e){return t[e]=a.shape[e]-1-t[e]})),u.set.apply(u,[c.get.apply(c,d(t))].concat(d(e)))},h=0;h<u.size;h++)l();return n.makeTensorInfo(u.shape,u.dtype,u.values)}},w8={kernelName:qB,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=vL(a.dtype,oL(a.shape)),h=l(a.shape,4),f=h[0],d=h[1],p=h[2],v=h[3],g=l(fK(s,d,p),2),m=g[0],y=g[1],b=Math.sin(i),k=Math.cos(i),x=u.data.get(a.dataId).values,w=0;w<f;w++)for(var I=w*p*d*v,S=0;S<d;S++)for(var C=S*(p*v),_=0;_<p;_++)for(var T=_*v,E=0;E<v;E++){var N=[f,S,_,E],D=N[2],A=N[1],R=(D-m)*k-(A-y)*b,M=(D-m)*b+(A-y)*k;R=Math.round(R+m),M=Math.round(M+y);var O=o;if("number"!==typeof o&&(O=3===E?255:o[E]),R>=0&&R<p&&M>=0&&M<d)O=x[I+M*(p*v)+R*v+E];c[I+C+T+E]=O}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},I8=w4(iB,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),S8={kernelName:iB,backendName:"cpu",kernelFunc:I8},C8=x4((function(e){return 1/Math.sqrt(e)})),_8=I4(oB,C8),T8={kernelName:oB,backendName:"cpu",kernelFunc:_8};function E8(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],h=e.values,f=t.values;if(0===r)return Rj(n,t.dtype);var d=u instanceof ZU?u:Rj(l,t.dtype);"string"===typeof u||"number"===typeof u?d.values.fill(u):"boolean"===typeof u&&d.values.fill(+u);for(var p=0;p<i;p++){for(var v=[],g=0,m=0;m<o;m++){var y=h[p*o+m];v.push(y),g+=y*s[m]}if(g<0||g>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?d.values[g*a+b]+=f[p*a+b]:d.values[g*a+b]=0===t.rank?f[0]:f[p*a+b]}return d}var N8={kernelName:sB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=bK(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,f=s.outputSize,d=E8(n.bufferSync(a),n.bufferSync(i),o,f,l,c,u,h,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};function D8(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}function A8(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}var R8={kernelName:cB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=function(e,t,n,r,a,i){for(var o=gL("int32",n*a),s=0;s<n;++s)for(var u=e.slice(s*r,(s+1)*r),c=s*a,l=0;l<a;++l)o[c+l]="left"===i?D8(u,t[l+c]):A8(u,t[l+c]);return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};var M8={kernelName:lB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;y4([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=XU(a.dtype,i.dtype),h=EL(oL(a.shape),l),f=0,d=0===o||o>1||1===a.shape.length?1:oL(a.shape.slice(1)),p=0;p<s.length;p++)for(var v=0;v<d;v++)1===s[p]?h[f++]=u[p]:h[f++]=c[p];return n.makeTensorInfo(a.shape,l,h)}},O8=w4(hB,(function(e){return e>=0?1.0507009873554805*e:1.7580993408473768*(Math.exp(e)-1)})),F8={kernelName:hB,backendName:"cpu",kernelFunc:O8},P8=w4(vB,(function(e){return e<0?-1:e>0?1:0})),L8={kernelName:vB,backendName:"cpu",kernelFunc:P8},Z8=w4(dB,(function(e){return Math.sin(e)})),z8={kernelName:dB,backendName:"cpu",kernelFunc:Z8},B8=w4(pB,(function(e){return Math.sinh(e)})),U8={kernelName:pB,backendName:"cpu",kernelFunc:B8},V8=Math.log(1.1920928955078125e-7)+2,j8=w4(mB,(function(e){var t=e>-V8,n=e<V8,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),W8={kernelName:mB,backendName:"cpu",kernelFunc:j8};var H8={kernelName:kB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;y4([a],"spaceToBatchND");var s=oL(i),u=[[0,0]];u.push.apply(u,d(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=q7.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),h=dK(l.shape,i,s,!1),f=pK(h.length,i.length,!1),p=vK(l.shape,i,s,!1),v=n5({inputs:{x:l},backend:n,attrs:{shape:h}}),g=v5({inputs:{x:v},backend:n,attrs:{perm:f}}),m=n5({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),m}};function G8(e,t,n,r,a,i,o){var s=t[0],u=i[0],c=new Array(u),l=new Array(s),h=t[1];if(0===u){if(0!==s)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(s));return[gL(n,0),[0,h],gL(a,0),c,l]}for(var f=!0,d=0,p=new Array(u).fill(0),v=0;v<s;++v){var g=e[v*h];if(g<0)throw new Error(jK(v,g));if(g>=u)throw new Error(WK(v,g,u));++p[g],f=f&&g>=d,d=g}for(var m=!0,y=0;y<u;++y){var b=0===p[y];c[y]=b,m=m&&!b,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(m&&f){for(var k=e,x=r,w=0;w<s;++w)l[w]=w;return[k,[s,h],x,c,l]}for(var I=p[u-1],S=gL(n,I*h),C=gL(a,I),_=new Array(u).fill(0),T=0;T<s;++T){var E=e[T*h],N=_[E],D=(0===E?0:p[E-1])+N;_[E]++;for(var A=0;A<h;++A)S[D*h+A]=e[T*h+A];C[D]=r[T],l[T]=D}for(var R=0;R<u;++R){if(0===_[R]){var M=0===R?0:p[R-1];S[M*h+0]=R;for(var O=1;O<h;++O)S[M*h+O]=0;C[M]=o}}return[S,[I,h],C,c,l]}var q8={kernelName:IB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values[0],f=l(G8(s,r.shape,r.dtype,u,a.dtype,c,h),5),d=f[0],p=f[1],v=f[2],g=f[3],m=f[4];return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,v),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function K8(e,t,n,r,a){for(var i,o=oL(r),s=t[0],u=a.length,c=[],l=1,h=-1,f=0;f<u;++f){var d=a[f];if(-1===d){if(-1!==h)throw new Error((i=f,"only one output dimension may be -1, not both ".concat(h," and ").concat(i)));h=f,c.push(1)}else{if(d<0)throw new Error(HK(f,d));l*=d,c.push(d)}}if(-1!==h){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var p=Math.trunc(o/l);if(l*p!==o)throw new Error(function(e,t){var n=oL(e),r=oL(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}(r,c));c[h]=p}if(oL(c)!==o)throw new Error(function(e,t){var n=oL(e),r=oL(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}(r,c));var v=r.length,g=[];if(v>0){g[v-1]=1;for(var m=v-2;m>=0;--m)g[m]=g[m+1]*r[m+1]}var y=[];if(u>0){y[u-1]=1;for(var b=u-2;b>=0;--b)y[b]=y[b+1]*c[b+1]}for(var k=gL(n,s*u),x=0;x<s;++x){for(var w=0,I=0;I<v;++I)w+=e[x*v+I]*g[I];for(var S=0;S<u;++S)k[x*u+S]=Math.trunc(w/y[S]),w%=y[S]}return[k,[s,u],c]}var Y8={kernelName:SB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(i.dataId).values),c=l(K8(s,r.shape,r.dtype,o,u),3),h=c[0],f=c[1],d=c[2];return[n.makeTensorInfo(f,r.dtype,h),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}};function X8(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=r.length,u=[t[0],e.length/t[0]],c=u[1],l=s>0?a[s-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");var h=t.slice();h[0]=l;var f=h.reduce((function(e,t){return e*t}),1),d=gL(n,f);if(0===s)return l>0&&d.fill(o),[d,h];if(l<=0)throw new Error("segment ids must be >= 0");for(var p=0,v=1,g=0,m=a[p];;){var y=0;if(v<s){if(m===(y=a[v])){++v;continue}if(m>=y)throw new Error("segment ids are not increasing")}if(m<0||m>=l)throw new Error(GK(m,l));m>g&&d.fill(o,g*c,m*c);for(var b=p;b<v;++b){var k=r[b];if(k<0||k>=u[0])throw new Error(qK(b,r[b],u[0]));for(var x=0;x<c;x++)d[m*c+x]+=e[k*c+x]}if(i)for(var w=0;w<c;w++)d[m*c+w]/=v-p;if(p=v,g=m+1,m=y,++v>s)break}return g<l&&d.fill(o,g*c,l*c),[d,h]}var Q8={kernelName:CB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=l(X8(o,r.shape,r.dtype,s,u,!0),2),h=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,h)}};var J8={kernelName:_B,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");var o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=l(X8(o,r.shape,r.dtype,s,u),2),h=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,h)}};var $8={kernelName:TB,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.sparseIndices,o=n.sparseValues,s=n.defaultValue,u=a.outputShape,c=bK(0,i,u),l=c.sliceRank,h=c.numUpdates,f=c.sliceSize,d=c.strides,p=c.outputSize,v=!1,g=r.bufferSync(i);switch(o.dtype){case"bool":t=E8(g,r.bufferSync(o),u,p,f,h,l,d,Boolean(r.data.get(s.dataId).values[0]),v);break;case"float32":t=E8(g,r.bufferSync(o),u,p,f,h,l,d,r.data.get(s.dataId).values[0],v);break;case"int32":t=E8(g,r.bufferSync(o),u,p,f,h,l,d,r.data.get(s.dataId).values[0],v);break;case"string":t=E8(g,r.bufferSync(o),u,p,f,h,l,d,CU(r.data.get(s.dataId).values[0]),v);break;default:throw new Error("Unsupported type ".concat(o.dtype))}return r.makeTensorInfo(u,t.dtype,t.values)}};var eee={kernelName:xB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=dL(r.axis,a.shape)[0],s=VK(a,i,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return s.map((function(e){var t=d(c);t[o]=e;var r=U5({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},tee=x4((function(e){return Math.sqrt(e)})),nee=w4(yB,(function(e){return Math.sqrt(e)})),ree={kernelName:yB,backendName:"cpu",kernelFunc:nee},aee={kernelName:NB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;y4(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},iee=D4((function(e,t){var n=e-t;return n*n})),oee=X4(EB,iee),see={kernelName:EB,backendName:"cpu",kernelFunc:oee},uee=x4((function(e,t){var n=t.pattern,r=t.replaceGlobal,a=t.rewrite;return e.replace(new RegExp(n,r?"g":""),a)})),cee=I4(DB,uee),lee={kernelName:DB,backendName:"cpu",kernelFunc:cee},hee=w4(GB,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),fee={kernelName:GB,backendName:"cpu",kernelFunc:hee};function dee(e,t,n,r){for(var a=Rj(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(d(o)))}return a}var pee={kernelName:AB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,c=r.endMask,l=r.ellipsisMask,h=r.newAxisMask,f=r.shrinkAxisMask;y4(a,"stridedSlice");var d,p=YW(a.shape,i,o,s,u,c,l,h,f),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,k=p.begin,x=p.end,w=p.strides;if(m)d=n5({inputs:{x:a},backend:n,attrs:{shape:g}});else if(y||b){rL(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var I=HW(k,x,w),S=U5({inputs:{x:a},backend:n,attrs:{begin:k,size:I}});d=n5({inputs:{x:S},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(S)}else{var C=dee(v,n.bufferSync(a),w,k);d=n.makeTensorInfo(g,C.dtype,C.values)}return d}},vee=function(){function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.separator=SU(t),this.nGramWidths=n,this.leftPad=SU(r),this.rightPad=SU(a),this.padWidth=i,this.preserveShort=o}return(0,v.Z)(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,s=function(){var s=o.getPadWidth(i),c=Math.max(0,s-u),l=Math.max(0,s-(a-(u+1))),h=i-(c+l),f=t+(c>0?0:u-s),d=0;d+=c*o.leftPad.length;for(var p=0;p<h;++p)d+=e[f+p].length;d+=l*o.rightPad.length,d+=(c+l+h-1)*o.separator.length,n[r+u]=new Uint8Array(d);for(var v=n[r+u],g=0,m=function(e){return e.forEach((function(e){return v[g++]=e}))},y=0;y<c;++y)m(o.leftPad),m(o.separator);for(var b=0;b<h-1;++b)m(e[f+b]),m(o.separator);if(h>0){m(e[f+h-1]);for(var k=0;k<l;++k)m(o.separator),m(o.rightPad)}else{for(var x=0;x<l-1;++x)m(o.rightPad),m(o.separator);m(o.rightPad)}},u=0;u<a;++u)s()}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var s=t[o]>=i;if(!(s=s&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var u=a-1,c=gL("int32",a);if(0===r||0===a){for(var l=new Array(r),h=0;h<=u;++h)c[h]=0;return[l,c]}c[0]=0;for(var f=function(){var e=t[d]-t[d-1],r=0;n.nGramWidths.forEach((function(t){r+=n.getNumNGrams(e,t)})),n.preserveShort&&e>0&&0===r&&(r=1),c[d]=c[d-1]+r},d=1;d<=u;++d)f();for(var p=new Array(c[u]),v=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var s=t[r+1]-t[r],u=n.getNumNGrams(s,o);n.createNGrams(e,a,p,i,u,o),i+=u})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var s=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,s)}},g=0;g<u;++g)v(g);return[p,c]}}]),e}();function gee(e,t,n,r,a,i,o,s){return new vee(n,r,a,i,o,s).compute(e,t)}var mee={kernelName:RB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,h=t.data,f=t.dataSplits,d=l(gee(n.data.get(h.dataId).values,n.data.get(f.dataId).values,a,i,o,s,u,c),2),p=d[0],v=d[1];return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(f.shape,"int32",v)]}};function yee(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var s=t[0],u=e.indexOf(s);-1!==u;){var c=e.subarray(0,u);n&&0===c.length||r.push(c),u=(e=e.subarray(u+1)).indexOf(s)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}function bee(e,t,n){for(var r=e.length,a=[],i=0,o=0,s=new Array(r),u=0;u<r;++u){var c=a.length;yee(e[u],t,n,a);var l=a.length-c;s[u]=l,i+=l,o=Math.max(o,l)}for(var h=gL("int32",2*i),f=new Array(i),d=[r,o],p=0,v=0;v<r;++v)for(var g=0;g<s[v];++g)h[2*p]=v,h[2*p+1]=g,f[p]=a[p],++p;return[h,f,d]}var kee={kernelName:MB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=l(bee(n.data.get(a.dataId).values,n.data.get(i.dataId).values[0],r),3),s=o[0],u=o[1],c=o[2],h=u.length;return[n.makeTensorInfo([h,2],"int32",s),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(c))]}};function xee(e,t){for(var n=gL("int32",e.length),r=0;r<e.length;++r)n[r]=kU(e[r]).modulo(t).getLowBitsUnsigned();return n}var wee={kernelName:OB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=xee(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},Iee=w4(PB,(function(e){return Math.tan(e)})),See={kernelName:PB,backendName:"cpu",kernelFunc:Iee},Cee=w4(LB,(function(e){return Math.tanh(e)}));var _ee={kernelName:uB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.tensor,a=t.indices,i=t.updates,o=bK(0,a,r.shape),s=o.sliceRank,u=o.numUpdates,c=o.sliceSize,l=o.strides,h=o.outputSize,f=n.bufferSync(a),d=n.bufferSync(i),p=n.bufferSync(r),v=E8(f,d,r.shape,h,c,u,s,l,p,!1);return n.makeTensorInfo(r.shape,v.dtype,v.values)}};function Tee(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=Rj(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}var Eee={kernelName:ZB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;y4(a,"tile");var o=Tee(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},Nee=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function Dee(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),u=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);Dee(e,t,Math.max(n,Math.floor(t-i*s/a+u)),Math.min(r,Math.floor(t+(a-i)*s/a+u)))}var c=e[t],l=n,h=r;for(tL(e,n,t),Nee(e[r],c)>0&&tL(e,n,r);l<h;){for(tL(e,l,h),l++,h--;Nee(e[l],c)<0;)l+=1;for(;Nee(e[h],c)>0;)h-=1}0===Nee(e[n],c)?tL(e,n,h):tL(e,h+=1,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function Aee(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=vL(n,o*r),c=vL("int32",o*r),l=function(){var t=h*s,n=e.subarray(t,t+s),i=new Array(n.length);n.forEach((function(e,t){return i[t]={value:e,index:t}})),r<i.length&&(Dee(i,r),i=i.slice(0,r)),a&&i.sort(Nee);for(var o=h*r,l=u.subarray(o,o+r),f=c.subarray(o,o+r),d=0;d<r;d++)l[d]=i[d].value,f[d]=i[d].index},h=0;h<o;h++)l();var f=t.slice();return f[f.length-1]=r,[Rj(f,n,u),Rj(f,"int32",c)]}var Ree={kernelName:zB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted;y4(a,"topk");var s=l(Aee(n.data.get(a.dataId).values,a.shape,a.dtype,i,o),2),u=s[0],c=s[1];return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}};var Mee={kernelName:BB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=t.transforms,o=n.interpolation,s=n.fillMode,u=n.fillValue,c=n.outputShape,h=l(a.shape,4),f=h[0],d=h[1],p=h[2],v=h[3],g=l(null!=c?c:[d,p],2),m=g[0],y=g[1],b=[f,m,y,v],k=SL(a.shape),x=k[0],w=k[1],I=k[2],S=SL(b),C=S[0],_=S[1],T=S[2],E=vL(a.dtype,oL(b));E.fill(u);for(var N=r.data.get(a.dataId).values,D=r.data.get(i.dataId).values,A=0;A<f;++A){for(var R=1===i.shape[0]?D:D.subarray(8*A,8*A+8),M=0;M<m;++M)for(var O=0;O<y;++O)for(var F=0;F<v;++F){var P=void 0,L=R[6]*O+R[7]*M+1;if(0!==L){var Z=(R[0]*O+R[1]*M+R[2])/L,z=(R[3]*O+R[4]*M+R[5])/L,B=Oee(Z,p,s),U=Oee(z,d,s);switch(o){case"nearest":P=Pee(N,d,p,x,w,I,A,U,B,F,u);break;case"bilinear":P=Lee(N,d,p,x,w,I,A,U,B,F,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}E[A*C+M*_+O*T+F]=P}}return r.makeTensorInfo(b,a.dtype,E)}return{dataId:r.write(E,b,a.dtype),shape:a.shape,dtype:a.dtype}}};function Oee(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return $P(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return $P(0,n,t-1)}(e,t);case"nearest":return function(e,t){return $P(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function Fee(e,t,n,r,a,i,o,s,u,c,l){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+c]:l}function Pee(e,t,n,r,a,i,o,s,u,c,l){return Fee(e,t,n,r,a,i,o,Math.round(s),Math.round(u),c,l)}function Lee(e,t,n,r,a,i,o,s,u,c,l){var h=Math.floor(s),f=Math.floor(u),d=h+1,p=f+1;return(d-s)*((p-u)*Fee(e,t,n,r,a,i,o,h,f,c,l)+(u-f)*Fee(e,t,n,r,a,i,o,h,p,c,l))+(s-h)*((p-u)*Fee(e,t,n,r,a,i,o,d,f,c,l)+(u-f)*Fee(e,t,n,r,a,i,o,d,p,c,l))}function Zee(e,t,n,r){for(var a=dL(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u=new Map,c=new Int32Array(n[a]),l=new ZU(i,r,e),h=[],f=1===i[0]&&1===i[2],d=0;d<n[a];d++){var p=void 0;if(f)p=e[d].toString();else{for(var v=[],g=0;g<i[0];g++)for(var m=0;m<i[2];m++)v.push(l.get(g,d,m));p=v.join(",")}var y=u.get(p);if(null!=y)c[d]=y;else{var b=u.size;u.set(p,b),c[d]=b,h.push(d)}}var k=i.slice();k[1]=u.size;var x=new ZU(k,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)x.set(l.get(n,e,r),n,t,r)}));var w=n.slice();return w[a]=k[1],{outputValues:x.values,outputShape:w,indices:c}}var zee={kernelName:VB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;y4(i,"unique");var o=Zee(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};var Bee={kernelName:jB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var h=new Array(o).fill(0),f=a.shape.slice();f[i]=1;for(var d=new Array(s),p=0;p<d.length;p++){h[i]=p;var v=U5({inputs:{x:a},backend:n,attrs:{begin:h,size:f}});d[p]=n5({inputs:{x:v},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(v)}return d}};for(var Uee={kernelName:WB,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;y4(a,"unsortedSegmentSum");for(var s=[],u=[],c=a.shape.length-i.shape.length,l=i,h=0;h<c;++h){var f=K6({inputs:{input:l},backend:n,attrs:{dim:h+1}});l=f,u.push(f)}for(var d=0;d<o;++d){var p=xU(d,"int32"),v=n.makeTensorInfo([],"int32",p),g=U6({inputs:{a:v,b:l},backend:n}),m=K4({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),y=O6({inputs:{a:m,b:a},backend:n}),b=P6({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(v),u.push(g),u.push(m),u.push(y),u.push(b)}var k=H7({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),k}},Vee=0,jee=[o5,u5,l5,f5,t5,d5,m5,y5,b5,k5,w5,S5,_5,N5,A5,F5,P5,L5,Z5,i5,z5,j5,G5,K5,Y5,Y4,J5,e6,j4,t6,o6,u6,c6,l6,h6,f6,d6,v6,m6,y6,b6,k6,x6,w6,S6,C6,_6,T6,E6,N6,D6,A6,Z6,C4,z6,V6,W6,q6,Y6,J6,c9,h9,f9,v9,y9,b9,k9,w9,S9,T9,D9,T4,A9,a6,M9,F9,L9,N4,B9,j9,H9,K9,X9,$9,t7,a7,i7,o7,c7,f7,d7,p7,v7,g7,m7,y7,b7,w7,I7,_7,N7,F6,A7,M7,F7,L7,B7,U7,W7,G7,q7,X7,M4,J7,r8,o8,f8,p8,G4,t9,g8,F4,L4,r5,m8,y8,b8,k8,x8,w8,S8,T8,N8,R8,M8,F8,B4,L8,z8,U8,V5,E7,W8,H8,q8,Y8,Q8,J8,$8,eee,ree,aee,see,lee,fee,pee,mee,kee,wee,i9,L6,See,{kernelName:LB,backendName:"cpu",kernelFunc:Cee},_ee,Eee,Ree,Mee,g5,zee,Bee,Uee,j7];Vee<jee.length;Vee++){rU(jee[Vee])}var Wee,Hee,Gee,qee={},Kee={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Yee(e,t){if(!(e in qee)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if(LL().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==e){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete qee[e]}),!1),LL().getBool("SOFTWARE_WEBGL_ENABLED")&&(Kee.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",Kee)||n.getContext("experimental-webgl",Kee);return n.getContext("webgl2",Kee)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;qee[e]=n}var r=qee[e];return null==r||r.isContextLost()?(delete qee[e],Yee(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),qee[e])}function Xee(e,t){return[t,e]}function Qee(e){var t=oL(e);return cL(Math.ceil(t/4))}function Jee(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function $ee(e,t){var n,r,a,i,o,s,u,c,l,h,f=e;return 2===LL().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,i=f.RGBA32F,o=f.RED,u=4,c=1,l=f.HALF_FLOAT,h=f.FLOAT,s=f.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=f.RGBA,o=e.RGBA,u=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,s=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:s,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:h}}function ete(e,t){var n=t();return LL().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Wee||(Wee={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Hee||(Hee={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Gee||(Gee={}));function tte(e){return!!(LL().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function nte(e,t){return dte(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var rte,ate,ite=/ERROR: [0-9]+:([0-9]+):/g;function ote(e,t){var n=ite.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return lL((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(lL(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}function ste(e,t){if(ete(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function ute(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(ete(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),ete(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),ete(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function cte(e,t,n,r){ete(e,(function(){return function(e,t,n){pte(e,n),ete(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),ete(e,(function(){return e.uniform1i(n,r)}))}function lte(e,t,n){ete(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),ete(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function hte(e,t){ete(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),ete(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function fte(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function dte(e,t,n){var r=ete(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function pte(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function vte(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return oL(e.slice(0,e.length-t))}function gte(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function mte(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[vte(e)].concat(d(gte(e)))),t}function yte(e){return e%2===0}function bte(e,t){if(sL(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e[e.length-1],r=t[t.length-1];if(n===r)return!0;if(yte(n)&&yte(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&yte(e[0])&&yte(t[0])}function kte(e,t){return null!=e.getExtension(t)}function xte(e){try{if(null!=Yee(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function wte(e){if(0===e)return!1;var t=Yee(e);if(1!==e){if(kte(t,"EXT_color_buffer_float"))return Ite(t);var n="EXT_color_buffer_half_float";if(kte(t,n)){var r=t.getExtension(n);return function(e,t){var n=$ee(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!kte(t,"OES_texture_float")&&(!!kte(t,"WEBGL_color_buffer_float")&&Ite(t))}function Ite(e){var t=$ee(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Ste(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&rL("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var Cte=LL();function _te(){var e,t,n,r,a,i,o,s,u,c;return 2===LL().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=LL().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Tte(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=SL(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function Ete(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=SL(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function Nte(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=function(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(e.map((function(e,t){return t})),t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(r[a]),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(r[a]):"index -= ".concat(e[a]," * ").concat(r[a]);return"".concat(i,"; ").concat(o,";")})).join("")}function Dte(e){var t=SL(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}Cte.registerFlag("HAS_WEBGL",(function(){return Cte.getNumber("WEBGL_VERSION")>0})),Cte.registerFlag("WEBGL_VERSION",(function(){return xte(2)?2:xte(1)?1:0})),Cte.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Cte.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Cte.get("WEBGL_VERSION")})),Cte.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Cte.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Cte.registerFlag("WEBGL_PACK",(function(){return Cte.getBool("HAS_WEBGL")})),Cte.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_CLIP",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_PACK_REDUCE",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_CONV_IM2COL",(function(){return Cte.getBool("WEBGL_PACK")})),Cte.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==rte){var t=Yee(e);rte=t.getParameter(t.MAX_TEXTURE_SIZE)}return rte}(Cte.getNumber("WEBGL_VERSION"))})),Cte.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==ate){var t=Yee(e);ate=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ate)}(Cte.getNumber("WEBGL_VERSION"))})),Cte.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Cte.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=Yee(e);return kte(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:kte(t,"EXT_disjoint_timer_query")?1:0}(e)})),Cte.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Cte.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!hV()})),Cte.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=Yee(e);if(1===e){if(!kte(t,"OES_texture_float"))return!1}else if(!kte(t,"EXT_color_buffer_float"))return!1;return Ite(t)}(Cte.getNumber("WEBGL_VERSION"))})),Cte.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Cte.getBool("WEBGL_FORCE_F16_TEXTURES")&&Cte.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Cte.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return wte(Cte.getNumber("WEBGL_VERSION"))})),Cte.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Cte.getNumber("WEBGL_VERSION"))&&null!=Yee(e).fenceSync;var e})),Cte.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Cte.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Cte.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),Cte.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return hV()?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),Cte.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),Cte.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),Cte.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),Cte.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),Cte.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),Cte.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return Cte.getBool("IS_TEST")})),Cte.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),Cte.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),Cte.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),Cte.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var Ate="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",Rte=lW;function Mte(e,t,n){var r=[];if(e.forEach((function(e){var t=oL(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(jte(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?Fte(e,r):Ote(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=Rte(e.shapeInfo.logicalShape,t.logicalShape),c=Vte(s),l=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+l]," = 0;")})).join("\n");var f="";f=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+l])})).join(", ");var d="return outputValue;",p=1===oL(e.shapeInfo.logicalShape),v=oL(t.logicalShape),g=1===v;if(1!==o||p||g){if(p&&!g)d=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=o-2,y=o-1;u.indexOf(m)>-1&&u.indexOf(y)>-1?d="return vec4(outputValue.x);":u.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(f,");\n      ").concat(d,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&sL(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=Vte(u),h=Rte(e.shapeInfo.logicalShape,t.logicalShape),f=u-s,d=["x","y","z","w","u","v"];c=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map((function(e){return"coords.".concat(d[e+f]," = 0;")})).join("\n");var p="";p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+f])})).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),u=t.texShape,c=_te(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),h=function(e){var t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Pte,"\n    ").concat(Lte,"\n    ").concat(Zte,"\n  ");return t}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(sL(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,s="",u="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],s="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+s,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(sL(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=Ete(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=Tte(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=Ete(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=Tte(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=Tte(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=Tte(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,u,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(h+=zte),[h,l,i,o,a,s,n.userCode].join("\n")}function Ote(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=l(e.shapeInfo.texShape,2),i=a[0],o=a[1];if(1===i&&1===o)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=Bte(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var u=l(e.shapeInfo.texShape,2),c=u[0],h=u[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(h,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(Ute(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=Bte(n);if(1===o)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(t)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&sL(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],s=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var u=pL(n),c=u.newShape,l=u.keptDims,h=c;if(h.length<n.length){var f=Wte(e,h),d=["row","col"];return"\n      ".concat(Ote(f,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(Hte(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(Ute(e),"\n      }\n    ");var p=i[0],v=i[1],g=Bte(r);if(1===v)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===p)return t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(g,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(v,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(t)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(g,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],s=pL(n),u=s.newShape,c=s.keptDims,l=u;if(l.length<n.length){var h=Wte(e,l),f=["row","col","depth"];return"\n        ".concat(Ote(h,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(Hte(f,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(Ute(e),"\n      }\n    ");var d=e.shapeInfo.texShape,p=d[0],v=d[1],g=e.shapeInfo.flatOffset;if(v===i&&null==g)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(v,".0, ").concat(p,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(v===o&&null==g)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(v,".0, ").concat(p,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var m=Bte(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(e,t);case 4:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,u=pL(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=Wte(e,c),f=["row","col","depth","depth2"];return"\n      ".concat(Ote(h,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(Hte(f,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(Ute(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1],m="int stride2 = ".concat(r,"Shape[3];"),y="int stride1 = ".concat(r,"Shape[2] * stride2;"),b="int stride0 = ".concat(r,"Shape[1] * stride1;");if(g===s&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(m,"\n        ").concat(y,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(g===i&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var k=Bte(r);if(t)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(m,"\n      ").concat(y,"\n      ").concat(b,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(k,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index + ").concat(k,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(e,t);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=pL(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var h=Wte(e,c),f=["row","col","depth","depth2","depth3"];return"\n      ".concat(Ote(h),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Hte(f,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(Ute(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1];if(g===s&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=Bte(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=pL(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=Wte(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Ote(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Hte(u,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,h=t[3]*l,f=t[2]*h,d=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(f,", ").concat(h,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(Ute(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,g=v[0],m=v[1];if(m===d&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(h,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=Bte(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(f," + depth * ").concat(h," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function Fte(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=_te();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=_te();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=_te();if(null!=i&&sL(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=[1,2],u=Wte(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(Fte(u,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(Hte(c,s),");\n        }\n      ")}var l=_te();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var h=o[0],f=o[1],d=Math.ceil(n[2]/2),p=d*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(h,", ").concat(f,", ").concat(p,", ").concat(d,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=_te();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,s=e.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],h=Math.ceil(i[o-1]/2),f=h*Math.ceil(i[o-2]/2),d="int b, int row, int col",p="b * ".concat(f," + (row / 2) * ").concat(h," + (col / 2)"),v=2;v<o-1;v++)d="int b".concat(v,", ")+d,f*=i[o-v-1],p="b".concat(v," * ").concat(f," + ")+p;return"\n    vec4 ".concat(r,"(").concat(d,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var Pte="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Lte="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Zte="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",zte="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Bte(e){return"offset".concat(e)}function Ute(e){var t=e.name,n=oL(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function Vte(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function jte(e,t,n){var r=pL(t),a=r.newShape,i=r.keptDims,o=t.length,s=e&&3===o&&1===t[0],u=s?t.slice(1):a,c=!e&&o>1&&!sL(t,n)&&a.length<o||s;return{useSqueezeShape:c,uniformShape:c?u:t,keptDims:i}}function Wte(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Hte(e,t){return t.map((function(t){return e[t]})).join(", ")}function Gte(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=Mte(a,o,t),u=function(e,t){var n=dte(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(ete(e,(function(){return e.shaderSource(n,t)})),ete(e,(function(){return e.compileShader(n)})),LL().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw ote(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,s),c=e.createProgram(u);return LL().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(c),Object.assign({program:t,fragmentShader:u,source:s,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},qte(e,t,c)))}function qte(e,t,n){var r,a,i,o,s=[],u=[],c=null;o=e.getUniformLocation(n,"NAN",!1),1===LL().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(n,"INFINITY",!1));var l,h=!1,f=(0,C.Z)(t.variableNames);try{for(f.s();!(l=f.n()).done;){var d=l.value,p={name:d,uniform:e.getUniformLocation(n,d,h),offset:e.getUniformLocation(n,"offset".concat(d),h)};t.enableShapeUniforms&&(p.shape=e.getUniformLocation(n,"".concat(d,"Shape"),h),p.texShape=e.getUniformLocation(n,"".concat(d,"TexShape"),h)),s.push(p)}}catch(kve){f.e(kve)}finally{f.f()}if(t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",h),i=e.getUniformLocation(n,"outShapeStrides",h),a=e.getUniformLocation(n,"outTexShape",h)),t.customUniforms){var v,g=(0,C.Z)(t.customUniforms);try{for(g.s();!(v=g.n()).done;){var m=v.value;u.push(e.getUniformLocation(n,m.name,h))}}catch(kve){g.e(kve)}finally{g.f()}}return{variablesLocations:s,customUniformLocations:u,infLoc:c,nanLoc:o,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function Kte(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!sL(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!sL(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function Yte(e){return LL().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var Xte=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Wee.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=_te();this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Ete(["r","c","d"],t):Tte(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),Qte=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Wee.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=_te();this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?Ete(["r","c","d"],t):Tte(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),Jte=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.outTexUsage=Hee.DOWNLOAD;var n=_te();this.outputShape=t,this.userCode="\n      ".concat(Ate,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),$te=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Hee.DOWNLOAD;var n=_te();this.outputShape=t,this.userCode="\n      ".concat(Ate,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),ene={R:0,G:1,B:2,A:3},tne=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";(0,p.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=_te();this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",s=0;s<r.length;s++){var u=r[s];o+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(ene[u],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Dte(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),nne=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=_te();this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var s=0;s<=1;s++){var u=2*o+s;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(u,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(u,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(u,"] = values[2];\n            } else {\n              result[").concat(u,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Dte(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function rne(e){var t=_te();return function(e,t){var n=dte(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(ete(e,(function(){return e.shaderSource(n,t)})),ete(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ane(e){return function(e,t){var n=dte(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ete(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),ete(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ine(e){return function(e,t){var n=dte(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ete(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),ete(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function one(e,t,n,r,a,i){!function(e,t){var n=LL().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return dte(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return ete(e,(function(){return e.bindTexture(s,o)})),ete(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),ete(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),ete(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),ete(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===LL().getNumber("WEBGL_VERSION")?ete(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})):ete(e,(function(){return e.texStorage2D(s,1,r,t,n)})),ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function sne(e){return e.internalFormatFloat}function une(e){return e.internalFormatHalfFloat}function cne(e){return e.downloadTextureFormat}function lne(e){return e.internalFormatPackedFloat}function hne(e){return e.internalFormatPackedHalfFloat}function fne(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=l(Jee(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}var dne=function(){function e(t){(0,p.Z)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=LL().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){qee[e]=t}(n,t)):this.gl=Yee(n),t=this.gl,2===LL().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return ete(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return ete(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return ete(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return ete(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return ete(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return ete(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return ete(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return ete(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===LL().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=nte(this.gl,"OES_texture_float"),kte(this.gl,s))this.textureHalfFloatExtension=nte(this.gl,s);else if(LL().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),kte(this.gl,o))this.colorBufferHalfFloatExtension=nte(this.gl,o);else if(LL().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",kte(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!kte(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=ane(this.gl),this.indexBuffer=ine(this.gl),this.framebuffer=function(e){return dte(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=$ee(this.gl,this.textureHalfFloatExtension)}return(0,v.Z)(e,[{key:"debug",get:function(){return LL().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;ete(t,(function(){return t.finish()})),ete(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),ete(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),ete(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),ete(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),ete(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=l(Xee(t,n),2);return one(e,a[0],a[1],sne(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=l(Xee(t,n),2);return one(e,a[0],a[1],une(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=l(Xee(t,n),2);return one(e,a[0],a[1],cne(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===LL().getNumber("WEBGL_VERSION")?ete(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):ete(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===LL().getNumber("WEBGL_VERSION")?ete(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):ete(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),2===LL().getNumber("WEBGL_VERSION")?ete(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)})):ete(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),ete(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=l(Jee(t,n),2);return one(e,a[0],a[1],hne(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=l(Jee(t,n),2);return one(e,a[0],a[1],lne(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(hte(this.gl,this.framebuffer),this.outputTexture=null),ete(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=l(Xee(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return ete(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return fne(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();ete(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return ete(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),ete(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),ete(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(LL().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return ete(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=rne(n));var r=function(e){return dte(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);ete(n,(function(){return n.attachShader(r,t.vertexShader)})),ete(n,(function(){return n.attachShader(r,e)})),function(e,t){if(ete(e,(function(){return e.linkProgram(t)})),!LL().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,r);var a=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&ste(n,a),a}},{key:"buildVao",value:function(e){var t=this;this.setProgram(e),this.bindVertexArray(e.vao);var n=this.gl;ete(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),function(e,t,n){ete(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),ute(e,t,"clipSpacePos",n,3,20,0)&&ute(e,t,"uv",n,2,20,12)}(n,e,this.vertexBuffer)}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(ete(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&ste(this.gl,this.program),ete(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return dte(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),ete(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),cte(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=l(Jee(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&ste(this.gl,this.program),fte(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ete(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),ete(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=nte(this.gl,2===LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=Rt(Dt().mark((function e(t){var n=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hL((function(){return n.disposed||n.isQueryAvailable(t,LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in LL().platform&&(r=LL().platform.setTimeoutCustom.bind(LL().platform)),hL((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),lte(this.gl,e,this.framebuffer),this.debug&&fte(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(lte(this.gl,this.outputTexture,this.framebuffer),this.debug&&fte(this.gl)):hte(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;lte(r,e,this.framebuffer),this.debug&&fte(r),this.outputTexture=e,ete(r,(function(){return r.viewport(0,0,t,n)})),ete(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),ete(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var pne=J4,vne=W5,gne=H5,mne=q5,yne=q4,bne=X5,kne=n6,xne=B6,wne=H6,Ine=X6,Sne=d9,Cne=x9,_ne=I9,Tne=C9,Ene=E9,Nne=Z9,Dne=U9,Ane=W9,Rne=G9,Mne=s7,One=l7,Fne=k7,Pne=R6,Lne=D7,Zne=Z7,zne=Q7,Bne=n8,Une=i8,Vne=h8,jne=d8,Wne=C8,Hne=E8,Gne=Z4,qne=s5,Kne=B5,Yne=G8,Xne=K8,Qne=X8,Jne=tee,$ne=uee,ere=dee,tre=gee,nre=bee,rre=xee,are=n9,ire=Tee,ore=Aee,sre=p5,ure=Zee;function cre(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function lre(e,t){return 1===t?[e]:cre(e,t)}var hre=function(){function e(t){if((0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Yte(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=lre("rc",this.rank),r=Vte(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return(0,v.Z)(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),fre=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?Nte(["r","c","d"],"inputShape"):Tte(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Dte(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var dre=function(){function e(t){(0,p.Z)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}return(0,v.Z)(e,[{key:"acquireTexture",value:function(e,t,n){var r=vre(t,n),a=gre(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=pre(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].pop();return this.usedTextures[a].push(s),s}return r===Gee.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Gee.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Gee.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Gee.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Gee.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=vre(n,r),i=gre(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=pre(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=LL().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u&&u.indexOf(e);if(null==c||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function pre(e,t,n,r,a){var i,o=function(e,t){switch(e){case Gee.PACKED_2X2_FLOAT32:return lne(t);case Gee.PACKED_2X2_FLOAT16:return hne(t);case Gee.UNPACKED_FLOAT32:return sne(t);case Gee.UNPACKED_FLOAT16:return une(t);case Gee.PACKED_4X1_UNSIGNED_BYTE:return cne(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=l(Jee(e[0],e[1]),2);i=s[0]*s[1]}else{var u=l(Xee(e[0],e[1]),2);i=u[0]*u[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*c}function vre(e,t){if(e===Hee.UPLOAD)return Gee.PACKED_2X2_FLOAT32;if(e===Hee.RENDER||null==e)return function(e){return LL().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Gee.PACKED_2X2_FLOAT32:Gee.UNPACKED_FLOAT32:e?Gee.PACKED_2X2_FLOAT16:Gee.UNPACKED_FLOAT16}(t);if(e===Hee.DOWNLOAD||e===Hee.PIXELS)return Gee.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function gre(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var mre=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),yre="if (isnan(x)) return x;",bre="return x;",kre="return abs(x);";var xre="return (x >= 0.0) ? x : (exp(x) - 1.0);",wre=yre+"\n  return (x < 0.0) ? 0.0 : x;\n",Ire=yre+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Sre="return x;",Cre="return 1.0 / (1.0 + exp(-1.0 * x));",_re="return x;",Tre="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Ere="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Nre="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Dre="return 1.0 / (1.0 + exp(-1.0 * x));",Are=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),Rre=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length);var n=t.length,r=lre("rc",n),a=Vte(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),Mre=XK,Ore={};var Fre=LL().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var Pre=function(e){(0,g.Z)(n,e);var t=(0,m.Z)(n);function n(e){var r,a,i;if((0,p.Z)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!LL().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof dne)a=e;else{var o=Yee(LL().getNumber("WEBGL_VERSION"),e);a=new dne(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var s=Yee(LL().getNumber("WEBGL_VERSION"));a=new dne(s),r.binaryCache=((i=LL().getNumber("WEBGL_VERSION"))in Ore||(Ore[i]={}),Ore[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new dre(r.gpgpu),r.numMBBeforeWarning=null==LL().global.screen?1024:LL().global.screen.height*LL().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new YP((0,Je.Z)(r),Pj()),r}return(0,v.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,a]},s.texShape=[r,a];var u=mte(t),c=new tne(u,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if((LL().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||LL().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Hee.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(LL().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Hee.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new Are(o,Sre):new mre(o,Sre);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,f,d=null!=this.activeTimers;(d&&(h=IU()),"complex64"===r)?f=EK(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):f=this.getValuesFromTexture(e);return d&&(this.downloadWaitMs+=IU()-h),this.convertAndCacheOnCPU(e,f)}},{key:"read",value:function(){var e=Rt(Dt().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,f,p,v,g,m,y,b,k,x,w,I,S,C;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new Are(i,Sre):new mre(i,Sre),h=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),f=this.read(h.dataId),this.disposeIntermediateTensorInfo(h),e.abrupt("return",f);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!LL().getBool("DEBUG")){e.next=16;break}if(LL().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==LL().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(p=null,"complex64"!==s&&LL().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(t),m=this.texData.get(v.dataId),p=(g=this.gpgpu).createBufferFromTexture.apply(g,[m.texture.texture].concat(d(Qee(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==s){e.next=31;break}return e.next=25,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 25:b=e.sent,k=b[0],x=b[1],y=EK(k,x),e.next=32;break;case 31:null==p?y=this.getValuesFromTexture(t):(w=oL(i),y=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w));case 32:return null!=v&&this.disposeIntermediateTensorInfo(v),null!=p&&ete(I=this.gpgpu.gl,(function(){return I.deleteBuffer(p)})),S=this.convertAndCacheOnCPU(t,y),C=this.pendingRead.get(t),this.pendingRead.delete(t),C.forEach((function(e){return e(S)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Pj().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",S);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.isPacked,u=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=s?new Are(a,Sre):new mre(a,Sre);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),h=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),h}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var f=this.decode(e,t.customTexShape),d=Pj().makeTensorFromTensorInfo(f),p=this.texData.get(f.dataId);return Object.assign({tensorRef:d},p.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return CU(e)}));return Rj(e.shape,e.dtype,n)}catch(zm){throw new Error("Failed to decode encoded string bytes into utf-8")}return Rj(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!tte(n)){if(LL().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=oL(n);if(LL().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture.texture].concat(d(Qee(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=LL().getBool("WEBGL_PACK")&&!0===a,h=l?mte(n):n,f=l?new $te(h):new Jte(h),p=this.runWebGLProgram(f,[{shape:h,dtype:r,dataId:e}],"float32"),v=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture.texture,v.texShape[0],v.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(p),g}},{key:"timerAvailable",value:function(){return LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=TU(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=TU(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return Rt(Dt().mark((function e(){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,s.kernelMs=nL(n),s.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:IU(),endMs:null}}},{key:"endTimer",value:function(e){return LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=IU(),e)}},{key:"getQueryTime",value:function(){var e=Rt(Dt().mark((function e(t){var n;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(LL().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e).complexTensorInfos;return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fre;return LL().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&oL(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){QB("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Mre(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new Are(e.shape,t),a=this.compileAndRun(r,[e],n);return Pj().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=qne(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(LL().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,kre,e.dtype);var n=new mre(e.shape,kre),r=this.compileAndRun(n,[e]);return Pj().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&bL(n[0])){var a=n.map((function(e){return SU(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return Pj().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new Rre(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new hre(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[vte(e.shape)].concat(d(gte(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[vte(t)].concat(d(gte(t))),i=new fre(a,n),o=[n],s=this.runWebGLProgram(i,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;null!=t&&rL(oL(a)<=t[0]*t[1]*4,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}));var o,s=mte(a);o=r?new Qte(s):new Xte(s);var u=[null!=t?t:Qee(s)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(o,[{shape:s,dtype:i,dataId:e}],i,u,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Wee.DENSE){var c=null!=o?o:Qee(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===oL(s.shape))return u.values=vL(s.dtype,0),s;var l=[],h=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&oL(t.shape)<=LL().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!bte(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var f,d={shape:s.shape,texData:u,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=jte(e.packedInputs,t.shape,i),s=o.useSqueezeShape,u=o.uniformShape,c=o.keptDims,l="",h="",f="";if(1===u.length&&e.packedInputs){var d=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(d[0]>1,"_").concat(d[1]>1)}else if(2!==u.length||e.packedInputs){if(u.length>2&&!e.packedInputs){var p=SL(u);f="".concat(p[0]===i[1],"_").concat(p[p.length-1]===i[1])}}else h="".concat(u[0]>1,"_").concat(u[1]>1);var v=t.shape.length,g=2===u.length&&sL(t.shape,i),m=1===oL(t.shape),y=lW(t.shape,n.shape),b=!e.packedInputs&&v===n.shape.length&&sL(i,n.texData.texShape),k=e.packedInputs||u.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(v,"_").concat(b,"_").concat(s?c:"","_").concat(u.length,"_").concat(m,"_").concat(y,"_").concat(g,"_").concat(l,"_").concat(h,"_").concat(f,"_").concat(k,"_").concat(a)}else{var x=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(x,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+"_"+r+"_"+a+"".concat(LL().getNumber("WEBGL_VERSION"))}(e,h,d),v=this.getAndSaveBinary(p,(function(){return Gte(a.gpgpu,e,h,d)})),g=null!=this.activeTimers;g&&(f=this.startTimer()),LL().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,a){t.program.enableShapeUniforms||(Kte(t.inShapeInfos,n),Kte([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),1===LL().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN);for(var s=0;s<n.length;++s){var u=n[s],c=t.variablesLocations[s],l=c.uniform,h=c.offset,f=c.shape,d=c.texShape;if(f){var p=jte(t.program.packedInputs,u.shape,u.texData.texShape).uniformShape;switch(p.length){case 1:e.gl.uniform1iv(f,new Int32Array(p));break;case 2:e.gl.uniform2iv(f,new Int32Array(p));break;case 3:e.gl.uniform3iv(f,new Int32Array(p));break;case 4:e.gl.uniform4iv(f,new Int32Array(p))}}if(d&&e.gl.uniform2i(d,u.texData.texShape[0],u.texData.texShape[1]),null!=l)if(u.isUniform)if(oL(u.shape)<2)e.gl.uniform1f(l,u.uniformValues[0]);else{var v=u.uniformValues;v instanceof Float32Array||(v=new Float32Array(v)),e.gl.uniform1fv(l,v)}else null!=u.texData.slice&&null!=h&&e.gl.uniform1i(h,u.texData.slice.flatOffset),e.setInputMatrixTexture(u.texData.texture.texture,l,s)}var g=t.outShapeLocation;if(g)switch(r.shape.length){case 1:e.gl.uniform1iv(g,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(g,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(g,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(g,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var m=SL(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(m));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(m));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(m))}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a)for(var y=0;y<t.program.customUniforms.length;++y){var b=t.program.customUniforms[y],k=t.customUniformLocations[y],x=a[y];if("float"===b.type)e.gl.uniform1fv(k,x);else if("vec2"===b.type)e.gl.uniform2fv(k,x);else if("vec3"===b.type)e.gl.uniform3fv(k,x);else if("vec4"===b.type)e.gl.uniform4fv(k,x);else if("int"===b.type)e.gl.uniform1iv(k,x);else if("ivec2"===b.type)e.gl.uniform2iv(k,x);else if("ivec3"===b.type)e.gl.uniform3iv(k,x);else{if("ivec4"!==b.type)throw Error("uniform type ".concat(b.type," is not supported yet."));e.gl.uniform4iv(k,x)}}e.executeProgram()}(this.gpgpu,v,h,d,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),g&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));var m=LL().get("WEBGL_FLUSH_THRESHOLD");if(m>0){var y=IU();y-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!LL().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===i){var b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,a)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!LL().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Zj((function(){if(!LL().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=LL().getBool("DEBUG");LL().set("DEBUG",!1);var n=e.abs(Xj(1e-8)).dataSync()[0];if(LL().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=IU());var h=t.texShape;if(null==h&&(h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=LL().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=LL().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&LL().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?eL(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=pL(e);e=a.newShape}var i=oL(e),o=null;e.length<=1&&i<=n?o=[1,i]:2===e.length&&e[0]<=n&&e[1]<=n?o=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?o=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?o=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?o=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(o=[e[0],e[1]*e[2]*e[3]]);var s=null!=o&&Math.max.apply(Math,d(o))>r&&Math.min.apply(Math,d(o))<=(t?2:1)&&Math.min.apply(Math,d(o))>0;if(null==o||s)if(t){var u=vte(e),c=2,h=2;if(e.length){var f=l(gte(e),2);c=f[0],h=f[1]}o=cL(i=u*(c/2)*(h/2)).map((function(e){return 2*e}))}else o=cL(i);return o}(n,s),t.texShape=h),null!=a){var f,p=mte(n),v=h[1],g=h[0],m=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(s||!m){var y=l(Jee(h[0],h[1]),2);v=y[0],g=y[1]}f=s?new nne(p,m):new tne(p,m);var b=m?[g,v]:h,k=this.makeTensorInfo(b,r),x=this.texData.get(k.dataId);x.usage=m?Hee.PIXELS:Hee.UPLOAD,x.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(k.dataId),v,g,a);var w=[[g,v]],I=this.runWebGLProgram(f,[k],r,w,!0),S=this.texData.get(I.dataId);t.texShape=S.texShape,t.isPacked=S.isPacked,t.usage=S.usage,LL().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(t.texture=S.texture,t.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(k),c&&(this.uploadWaitMs+=IU()-u)}else{var C=this.acquireTexture(h,o,r,s);t.texture=C}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*yL(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=l(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=Rt(Dt().mark((function e(){var t,n,r,a,i,o,s,u,c=this;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=l(r[n],2),i=a[1],t.push(this.checkCompletionAsync_(i));return e.abrupt("return",Promise.all(t));case 6:o=Dt().mark((function e(){var n,r,a;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=l(u[s],2),r=n[1],a=new Promise((function(e){try{c.checkCompletion_(r),e(!0)}catch(t){throw t}})),t.push(a);case 3:case"end":return e.stop()}}),e)})),s=0,u=Object.entries(this.binaryCache);case 8:if(!(s<u.length)){e.next=13;break}return e.delegateYield(o(),"t0",10);case 10:s++,e.next=8;break;case 13:return e.abrupt("return",Promise.all(t));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=Rt(Dt().mark((function e(t){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,sK();case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw ote(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.values(this.binaryCache);e<t.length;e++){var n=t[e];this.gpgpu.buildVao(n.webGLProgram);var r=qte(this.gpgpu,n.program,n.webGLProgram),a=r.variablesLocations,i=r.customUniformLocations,o=r.infLoc,s=r.nanLoc,u=r.outShapeLocation,c=r.outShapeStridesLocation,l=r.outTexShapeLocation;n.variablesLocations=a,n.customUniformLocations=i,n.infLoc=o,n.nanLoc=s,n.outShapeLocation=u,n.outShapeStridesLocation=c,n.outTexShapeLocation=l}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,s=Pj().backend;if(!s.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var u=s.writeTexture(r,t,n,a,i,o);return Pj().makeTensorFromDataId(u,t,n,s)}}]),n}(XP);Pre.nextDataId=0;fV()&&Uj("webgl",(function(){return new Pre}),2);var Lre="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",Zre=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["A","B"],this.outputShape=fW(n,r),this.enableShapeUniforms=Yte(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),zre="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",Bre=(0,v.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,p.Z)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=fW(n,r);var i=this.outputShape.length;this.enableShapeUniforms=Yte(i);var o="";if(a)if(0===i||1===oL(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=Vte(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=lre("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function Ure(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Vre={kernelName:nz,backendName:"webgl",kernelFunc:Ure};function jre(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Ure({inputs:{x:r},backend:n}),u=Ure({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var Wre={kernelName:pZ,backendName:"webgl",kernelFunc:jre},Hre="return (a < 0.) ? b * a : a;",Gre="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var qre={kernelName:uz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",xU(i,"float32")),s=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bre(Gre,a.shape,o.shape):new Zre(Hre,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),u}},Kre="return (a < 0.) ? b * a : a;",Yre="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Xre={kernelName:jz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bre(Yre,r.shape,a.shape):new Zre(Kre,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},Qre="if (isnan(x)) return x;";function Jre(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var h=c.texData.get(u.dataId),f=r(h.values,l);return c.makeTensorInfo(u.shape,l,f)}return i=LL().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Are(u.shape,n):new mre(u.shape,t),c.runWebGLProgram(i,[u],l)}}function $re(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,h=r.b,f=i;if(o&&"complex64"===c.dtype){var d=f.texData.get(c.dataId),p=f.texData.get(h.dataId),v=[[d.complexTensorInfos.real,p.complexTensorInfos.real],[d.complexTensorInfos.imag,p.complexTensorInfos.imag]].map((function(e){var n=l(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:h.shape},s=new Zre(t,c.shape,h.shape);return f.runWebGLProgram(s,[i,o],XU(r.dtype,a.dtype))})),g=l(v,2),m=g[0],y=g[1],b=jre({inputs:{real:m,imag:y},backend:f});return f.disposeIntermediateTensorInfo(m),f.disposeIntermediateTensorInfo(y),b}var k,x=u||XU(c.dtype,h.dtype);if(("string"===c.dtype||"string"===h.dtype||f.shouldExecuteOnCPU([c,h]))&&null!=s){var w=f.texData.get(c.dataId).values,I=f.texData.get(h.dataId).values,S="string"===c.dtype?YK(w):w,C="string"===c.dtype?YK(I):I,_=l(s(c.shape,h.shape,S,C,x),2),T=_[0],E=_[1],N=f.makeTensorInfo(E,x);return f.texData.get(N.dataId).values=T,N}return k=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new Bre(n,c.shape,h.shape,a):new Zre(t,c.shape,h.shape),f.runWebGLProgram(k,[c,h],x)}}function eae(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?_re:bre;if("relu"===e)return t?Ere:wre;if("elu"===e)return t?Tre:xre;if("relu6"===e)return t?Nre:Ire;if("prelu"===e)return t?Yre:Kre;if("leakyrelu"===e)return t?Gre:Hre;if("sigmoid"===e)return t?Dre:Cre;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var tae=(0,v.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];(0,p.Z)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Yte(this.outputShape.length);var l=a?t[1]:t[2],h=Math.ceil(l/2),f=a?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",v=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",y="";s&&(m=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),y="result = activation(result);");var b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var k="rc.x",x="rc.x";t[0]<n[0]?k="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(x="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(h,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(k,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(h,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(f,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(v[0]," * ").concat(g[0],");\n          result += (").concat(v[1]," * ").concat(g[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(b,"\n\n        ").concat(y,"\n\n        setOutput(result);\n      }\n    ")})),nae={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},rae=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=fW(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),aae="return a * b;";function iae(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=XU(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new rae(nae.REAL,a.shape,i.shape),h=new rae(nae.IMAG,a.shape,i.shape),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],d=r.runWebGLProgram(c,f,"float32"),p=r.runWebGLProgram(h,f,"float32"),v=jre({inputs:{real:d,imag:p},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(p),v}if(r.shouldExecuteOnCPU([a,i])){var g=r.texData.get(a.dataId),m=r.texData.get(i.dataId),y=l(Pne(a.shape,i.shape,g.values,m.values,o),2),b=y[0],k=y[1],x=r.makeTensorInfo(k,o);return r.texData.get(x.dataId).values=b,x}return t=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bre(aae,a.shape,i.shape):new Zre(aae,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var oae={kernelName:Rz,backendName:"webgl",kernelFunc:iae};function sae(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=oL(a.shape),u=fL(i,s),c=oL(u);rL(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||bte(a.shape,u)||null!==l.texture&&bte(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[vte(e.shape)].concat(d(gte(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[vte(t)].concat(d(gte(t))),o=new fre(i,r),s=[r],u=n.runWebGLProgram(o,[a],e.dtype,s,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(a,u,o)}var uae={kernelName:Jz,backendName:"webgl",kernelFunc:sae},cae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(uL(l)?l.toPrecision(2):l,", ones);")}var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),lae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),h=r%4,f="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===n?(s="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(s="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var v="";i%r>0&&(v="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(v,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}));function hae(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=hK(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],c=u.inSize,l=u.windowSize,h=u.outSize,f=void 0;f="mean"===n?0===o?new cae({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},c):new cae({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h}):new lae({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},n),s=i,i=r.runWebGLProgram(f,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var fae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=Vte(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var dae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=Vte(this.rank),o=cre("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(l,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(l,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function pae(e,t,n){var r=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dae(e.shape,t):new fae(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function vae(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=dL(a,e.shape),s=o,u=hG(s,i),c=null!=u,h=e;c&&(h=pae(e,u,r),s=dG(s.length,i)),lG("sum",s,i);var f=l(uG(h.shape,s),2),d=f[0],p=f[1],v=d;n&&(v=cG(d,o));var g=oL(p),m=sae({inputs:{x:h},attrs:{shape:[oL(e.shape)/g,g]},backend:r}),y=hae(m,QU(e.dtype),"sum",r),b=sae({inputs:{x:y},attrs:{shape:v},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),c&&r.disposeIntermediateTensorInfo(h),b}(t.x,r.axis,r.keepDims,n)}var gae={kernelName:bB,backendName:"webgl",kernelFunc:vae};function mae(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var h=s.texData.get(i.dataId).values,f=sre(h,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=f}else t=pae(i,o,s);return t}var yae={kernelName:UB,backendName:"webgl",kernelFunc:mae},bae=1e3;function kae(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,f=e.activation,d=void 0===f?null:f,p=t.shape.length,v=n.shape.length,g=r?t.shape[p-2]:t.shape[p-1],m=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[v-2]:n.shape[v-1],k=t.shape.slice(0,-2),x=n.shape.slice(0,-2),w=oL(k),I=oL(x),S=fW(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);rL(g===m,(function(){return"Error in matMul: inner shapes (".concat(g,") and (")+"".concat(m,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var C,_=r?[w,g,y]:[w,y,g],T=a?[I,b,m]:[I,m,b],E=sae({inputs:{x:t},backend:i,attrs:{shape:_}}),N=sae({inputs:{x:n},backend:i,attrs:{shape:T}}),D=[E,N],A=Math.max(w,I),R=r?E.shape[1]:E.shape[2],M=null!=s,O=null!=c,F="leakyrelu"===d,P=null!=d?eae(d,!0):null;if((1===y||1===b)&&R>bae&&!1===(M||O||F||null!=P)){var L=E,Z=N;r&&(L=mae({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),D.push(L)),a&&(Z=mae({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),D.push(Z));var z=1===b,B=L;1!==b&&(B=sae({inputs:{x:L},backend:i,attrs:{shape:[A,R,1]}}),D.push(B));var U=1===b?2:1,V=Z;z&&(V=sae({inputs:{x:Z},backend:i,attrs:{shape:[A,1,R]}}),D.push(V));var j=iae({inputs:{a:B,b:V},backend:i});C=vae({inputs:{x:j},backend:i,attrs:{axis:U,keepDims:!0}}),D.push(j)}else{var W=XU(t.dtype,n.dtype),H=new tae(_,T,[A,y,b],r,a,M,P,O,F),G=[E,N];if(null!=s&&G.push(s),O&&G.push(c),F){var q=i.makeTensorInfo([],"float32",xU(h,"float32"));G.push(q),D.push(q)}C=i.runWebGLProgram(H,G,W)}var K=sae({inputs:{x:C},backend:i,attrs:{shape:S}});D.push(C);for(var Y=0,X=D;Y<X.length;Y++){var Q=X[Y];i.disposeIntermediateTensorInfo(Q)}return K}var xae={kernelName:KB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return kae({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},wae="return abs(x);";var Iae={kernelName:VL,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=qne(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=LL().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Are(a.shape,wae):new mre(a.shape,wae),r.runWebGLProgram(t,[a],a.dtype)}},Sae=Jre({opSnippet:yre+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Cae={kernelName:jL,backendName:"webgl",kernelFunc:Sae},_ae=Jre({opSnippet:yre+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Tae={kernelName:WL,backendName:"webgl",kernelFunc:_ae},Eae="return a + b;",Nae=$re({opSnippet:Eae,packedOpSnippet:Eae,supportsComplex:!0,cpuKernelImpl:pne}),Dae={kernelName:HL,backendName:"webgl",kernelFunc:Nae},Aae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),Rae=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var Mae={kernelName:GL,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return Ure({inputs:{x:a[0]},backend:r});if(a.length>LL().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return XU(e,t)})),c=a.map((function(e){return e.shape})),l=LL().getBool("WEBGL_PACK")?new Rae(a[0].shape,c):new Aae(a[0].shape,c);return r.runWebGLProgram(l,a,u)}};var Oae={kernelName:qL,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=dL(i,a.shape),c=u,h=hG(c,s),f=a;null!=h&&(f=mae({inputs:{x:a},backend:n,attrs:{perm:h}}),c=dG(c.length,s)),lG("all",c,s);var d,p=l(uG(f.shape,c),2),v=p[0],g=sae({inputs:{x:f},backend:n,attrs:{shape:[-1,oL(p[1])]}}),m=hae(g,g.dtype,"all",n);return d=sae(o?{inputs:{x:m},backend:n,attrs:{shape:cG(v,u)}}:{inputs:{x:m},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(f),d}};var Fae={kernelName:KL,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=dL(i,a.shape),c=u,h=hG(c,s),f=a;null!=h&&(f=mae({inputs:{x:a},backend:n,attrs:{perm:h}}),c=dG(c.length,s)),lG("any",c,s);var d,p=l(uG(f.shape,c),2),v=p[0],g=sae({inputs:{x:f},backend:n,attrs:{shape:[-1,oL(p[1])]}}),m=hae(g,g.dtype,"any",n);return d=sae(o?{inputs:{x:m},backend:n,attrs:{shape:cG(v,u)}}:{inputs:{x:m},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(f),d}},Pae=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),Lae=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,rL(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,h=Vte(l),f=lre("coords",l);if(1===o){var d=Vte(u=l+1);s="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[l-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[l-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[l-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[l-2],";")}else u=l,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(f[l-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(f[l-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(f[l-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(f[l-2],";");var v=["x","y","z","w","u","v"].slice(0,u),g="."+v[u-1],m=v.map((function(e){return"int "+e})),y=lre("sourceLocR",u-1).concat("inIdx.r"),b=lre("sourceLocG",u-1).concat("inIdx.g"),k=lre("sourceLocB",u-1).concat("inIdx.b"),x=lre("sourceLocA",u-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",I=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(k.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),S="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(k.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),C=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(v.join(),"),\n                                          vec2(").concat(v.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(v.join(),"),\n                               vec2(").concat(v.slice(-2).join(),"));\n      }\n      ").concat(C,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(f[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(f[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(g,", sourceLocG").concat(g,",\n          sourceLocB").concat(g,", sourceLocA").concat(g,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(S,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(I,"\n          vec4 candidate = ").concat(S,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function Zae(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=hK(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new Pae(s,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;var h=Zae(e,t,n,l);return e.disposeIntermediateTensorInfo(l),h}function zae(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=hK(a[a.length-1]),o=new Lae(a,i,n,null==r),s=null==r?[t]:[t,r],u=e.runWebGLProgram(o,s,"int32");if(u.shape.length===t.shape.length){var c=zae(e,t,n,u);return e.disposeIntermediateTensorInfo(u),c}return u}function Bae(e,t,n,r){var a=[n];if(lG("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!LL().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=e.texData.get(t.dataId),s=t;null!==o&&o.isPacked&&(s=e.unpackTensor(t),i.push(s));var u=l(uG(s.shape,a),2),c=u[0],h=oL(u[1]),f=sae({inputs:{x:s},backend:e,attrs:{shape:[-1,h]}});i.push(f);var d=Zae(e,f,r);i.push(d);var p=sae({inputs:{x:d},backend:e,attrs:{shape:c}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),p}return zae(e,t,r)}var Uae={kernelName:YL,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=dL(r.axis,a.shape),o=hG(i,a.shape.length),s=a,u=[];null!=o&&(s=mae({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=dG(i.length,s.shape.length)),lG("argMax",[i[0]],s.shape.length);var c=Bae(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}};var Vae={kernelName:XL,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=dL(r.axis,a.shape),o=hG(i,a.shape.length),s=a,u=[];null!=o&&(s=mae({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=dG(i.length,s.shape.length)),lG("argMin",[i[0]],s.shape.length);var c=Bae(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},jae=Jre({opSnippet:yre+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Wae={kernelName:QL,backendName:"webgl",kernelFunc:jae},Hae=Jre({opSnippet:yre+"return log(x + sqrt(x * x + 1.0));"}),Gae={kernelName:JL,backendName:"webgl",kernelFunc:Hae},qae=Jre({opSnippet:yre+"\n  return atan(x);\n"}),Kae={kernelName:$L,backendName:"webgl",kernelFunc:qae},Yae=$re({opSnippet:Lre+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+zre+"\n  return result;\n"}),Xae={kernelName:tZ,backendName:"webgl",kernelFunc:Yae},Qae=Jre({opSnippet:yre+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Jae={kernelName:eZ,backendName:"webgl",kernelFunc:Qae},$ae=(0,v.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,p.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var g="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),b="0.0";if(g||(b="-1.0 / 1e-20"),r){this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(v,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(">="," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:y:"wR * ".concat(f," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(k="avgValue / max(count, 1.0)");var x=4*Math.floor(o/4),w=o%4,I="\n      if (".concat(g,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(v,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(I,"\n          }\n\n          int xC = xCCorner + ").concat(x,";\n          if (").concat(1===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(I,"\n          } else if (").concat(2===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(I,"\n          } else if (").concat(3===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(I,"\n          }\n        }\n        setOutput(").concat(k,");\n      }\n    ")}})),eie=(0,v.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,p.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,h=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterDepth,v=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,y=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;var k="avg"===n,x="0.0";if(k||(x="-1.0 / 1e-20"),r){this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(b,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(v,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(g,";\n                  wC += ").concat(f,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(">="," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(v," * ").concat(g," +\n                      wR * ").concat(g," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / max(count, 1.0)");var I=4*Math.floor(o/4),S=o%4,C="\n      if (".concat(k,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(b,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(v,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(I,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(f,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(I,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}}));var tie={kernelName:nZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Ste(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rL(hH(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=tH(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&sL(c.inShape,c.outShape))return Ure({inputs:{x:a},backend:n});var l=new $ae(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var nie={kernelName:aZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=nH(a.shape,i,o,[1,1,1],s,u,c),h=new eie(l,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},rie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=u-1-t.padInfo.top,h=c-1-t.padInfo.left,f=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(h,");\n      const float avgMultiplier = float(").concat(f,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),aie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterDepth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,v=h-1-t.padInfo.front,g=f-1-t.padInfo.top,m=d-1-t.padInfo.left,y=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(v,", ").concat(g,", ").concat(m,");\n      const float avgMultiplier = float(").concat(y,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var iie={kernelName:iZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=nH(i.shape,o,s,[1,1,1],u,c),h=new aie(l);return n.runWebGLProgram(h,[a],i.dtype)}};var oie={kernelName:rZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;Ste([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=tH(o.shape,s,u,1,c),h=new rie(l);return n.runWebGLProgram(h,[a],o.dtype)}};var sie={kernelName:oZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return kae({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},uie=(0,v.Z)((function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],fW(t,n),fW(t,r);var s="0.0";null!=a&&(fW(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(fW(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),cie=(0,v.Z)((function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],fW(t,n),fW(t,r);var s="vec4(0.0)";null!=a&&(fW(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(fW(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),lie={kernelName:QZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;rL(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),rL(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),rL(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],h=null;null!=s&&(h=s.shape,l.push(s));var f=null;null!=u&&(f=u.shape,l.push(u));var d=LL().getBool("WEBGL_PACK_NORMALIZATION")?new cie(a.shape,i.shape,o.shape,h,f,c):new uie(a.shape,i.shape,o.shape,h,f,c);return n.runWebGLProgram(d,l,l[0].dtype)}},hie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=Vte(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return fie.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(fie[t]," = start[").concat(t,"] + coords.").concat(fie[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),fie=["x","y","z","w","u","v"];var die=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=Vte(this.rank),r=lre("coords",this.rank),a=lre("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}));function pie(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=l(KW(a,r.begin,r.size),2),o=i[0],s=i[1];if(WW(a,o,s),0===oL(s))return n.makeTensorInfo(s,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var u=n.texData.get(a.dataId),c=Kne(u.values,o,s,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,c)}var h=n.texData.get(a.dataId).isPacked,f=GW(a.shape,o,s);if(h||!f){var d=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new die(s):new hie(s),p=[o];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=qW(t,SL(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,o,s,n)}var vie={kernelName:fB,backendName:"webgl",kernelFunc:pie},gie={kernelName:sZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;rL(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=dK(a.shape,i,s),c=pK(u.length,i.length),l=vK(a.shape,i,s),h=gK(o,i.length),f=mK(l,o,i.length),d=[],p=sae({inputs:{x:a},backend:n,attrs:{shape:u}}),v=mae({inputs:{x:p},backend:n,attrs:{perm:c}}),g=sae({inputs:{x:v},backend:n,attrs:{shape:l}}),m=pie({inputs:{x:g},backend:n,attrs:{begin:h,size:f}});return d.push(p),d.push(v),d.push(g),d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var mie={kernelName:uZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=vne(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var yie={kernelName:cZ,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=LL().getNumber("WEBGL_VERSION");if(r.shouldExecuteOnCPU([a,i])||1===s){var u=r.texData.get(a.dataId).values,c=r.texData.get(i.dataId).values,h=l(mne(a.shape,i.shape,u,c,a.dtype),2),f=h[0],d=h[1],p=r.makeTensorInfo(d,a.dtype);return r.texData.get(p.dataId).values=f,p}return t=o?new Bre("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",a.shape,i.shape,!1):new Zre("\n  return float(int(a.r) & int(b.r));\n",a.shape,i.shape),r.runWebGLProgram(t,[a,i],a.dtype)}};var bie={kernelName:lZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=fW(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},kie=$re({opSnippet:"return float(a != b);",cpuKernelImpl:Zne,dtype:"bool"}),xie={kernelName:Oz,backendName:"webgl",kernelFunc:kie};function wie(e){var t=e.inputs,n=e.backend,r=t.input;return Ure({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var Iie={kernelName:Yz,backendName:"webgl",kernelFunc:wie},Sie="return float(int(x));";var Cie={kernelName:hZ,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return Ure({inputs:{x:i},backend:r});var s=yG(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=jre({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var h=wie({inputs:{input:i},backend:r}),f=e({inputs:{x:h},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(h),f}if(!mL(i.dtype,o)){var d=Ure({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){var p=r.texData.get(i.dataId).values,v=l(yne(p,i.shape,i.dtype,o),3),g=v[0],m=v[1],y=v[2];return r.makeTensorInfo(g,m,y)}if("int32"===o)return function(e,t){var n=new mre(e.shape,Sie),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var b=r.makeTensorInfo([],"bool",vL("bool",1)),k=kie({inputs:{a:i,b:b},backend:r});return r.disposeIntermediateTensorInfo(b),k}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},_ie="return ceil(x);",Tie=Jre({opSnippet:_ie,packedOpSnippet:_ie,cpuKernelImpl:bne}),Eie={kernelName:fZ,backendName:"webgl",kernelFunc:Tie},Nie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),Die=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var Aie={kernelName:dZ,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax;t=LL().getBool("WEBGL_PACK_CLIP")?new Die(i.shape):new Nie(i.shape);var u=[[o],[s]];return r.runWebGLProgram(t,[i],i.dtype,u)}},Rie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function Mie(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var Oie={kernelName:vZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new Rie(r.shape),o=[Mie(r,a.complexTensorInfos.real),Mie(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},Fie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.outputShape=[],this.outputShape=cK(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),Pie=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=cK(t,n);var r=this.outputShape,a=r.length,i=Vte(a),o=lre("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],h=s.slice(-2),f=s.join(),d="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(f,"), vec2(").concat(h.join(),"));\n        }"),v=1;v<u.length;v++){var g=u[v-1];d+="\n        if (".concat(l," < ").concat(u[v],"  && ").concat(l," >= ").concat(u[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(Lie(s,l,g),"),\n            vec2(").concat(Lie(h,l,g),"));\n        }")}var m=u.length,y=u[u.length-1];d+="\n        return getChannel(\n          getT".concat(m,"(").concat(Lie(s,l,y),"),\n          vec2(").concat(Lie(h,l,y),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function Lie(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function Zie(e){var t=e.inputs,n=e.backend,r=t.input;return Ure({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var zie={kernelName:az,backendName:"webgl",kernelFunc:Zie};function Bie(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return wie({inputs:{input:e},backend:n})})),i=e.map((function(e){return Zie({inputs:{input:e},backend:n})})),o=Bie(a,t,n),s=Bie(i,t,n),u=jre({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=oL(e.shape.slice(t));return sae({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),h=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),f=cK(l.map((function(e){return e.shape})),1),d=1===l[0].shape[0],p=kne(h,f,r,d),v=cK(e.map((function(e){return e.shape})),t),g=n.makeTensorInfo(v,r,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}var m=e.filter((function(e){return oL(e.shape)>0})),y=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&m[0].shape.length>1;if(1===m.length){var b=y?new mre(e[0].shape,Sre):new Are(e[0].shape,Sre);return n.runWebGLProgram(b,e,r)}var k=LL().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(m.length>k){for(var x=[],w=0;w<m.length;w+=k){var I=m.slice(w,w+k);x.push(Bie(I,t,n))}for(var S=Bie(x,t,n),C=0,_=x;C<_.length;C++){var T=_[C];n.disposeIntermediateTensorInfo(T)}return S}if(y){var E=new Pie(m.map((function(e){return e.shape})),t);return n.runWebGLProgram(E,m,r)}var N=function(e,t,n){var r=cK(e.map((function(e){return e.shape})),t),a=e.map((function(e){return sae({inputs:{x:e},attrs:{shape:[-1,oL(e.shape.slice(t))]},backend:n})}));return{tensors2D:a,outShape:r}}(m,t,n),D=N.tensors2D,A=N.outShape,R=new Fie(D.map((function(e){return e.shape}))),M=n.runWebGLProgram(R,D,r);D.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var O=sae({inputs:{x:M},attrs:{shape:A},backend:n});return n.disposeIntermediateTensorInfo(M),O}function Uie(e){var t=e.inputs,n=e.backend,r=dL(e.attrs.axis,t[0].shape)[0];uK(t.map((function(e){return e.shape})),r);var a=cK(t.map((function(e){return e.shape})),r);if(0===oL(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return oL(e.shape)>0}));return 1===i.length?Ure({inputs:{x:i[0]},backend:n}):Bie(i,r,n)}var Vie={kernelName:gZ,backendName:"webgl",kernelFunc:Uie},jie=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,p.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4,m="channelsLast"===t.dataFormat,y=m?1:2,b=m?2:3,k=m?3:1,x="",w="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(k,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(y,"], coords[").concat(b,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(f,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(v,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===g,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(v,") *\n                    getW(wR, wC, ").concat(v,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(v,", xR, xC) *\n                    getW(wR, wC, ").concat(v,", d2);\n              }\n\n            } else if (").concat(2===g,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(v,", d2),\n                getW(wR, wC, ").concat(v," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(v,"),\n                  getX(batch, xR, xC, ").concat(v," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(v,", xR, xC),\n                  getX(batch, ").concat(v," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===g,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(v,", d2),\n                getW(wR, wC, ").concat(v," + 1, d2),\n                getW(wR, wC, ").concat(v," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(v,"),\n                  getX(batch, xR, xC, ").concat(v," + 1),\n                  getX(batch, xR, xC, ").concat(v," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(v,", xR, xC),\n                  getX(batch, ").concat(v," + 1, xR, xC),\n                  getX(batch, ").concat(v," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(I,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")})),Wie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterDepth,f=t.filterHeight,d=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(v,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===g,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(v,") *\n                  getW(wF, wR, wC, ").concat(v,", d2);\n              } else if (").concat(2===g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1),\n                  getX(batch, xF, xR, xC, ").concat(v," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2),\n                  getW(wF, wR, wC, ").concat(v," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Hie=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,p.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Yte(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,h=l,f="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",d=0;d<l;d++)f+="\n           vec4 xTexelC".concat(2*d,";\n           int xTexelC").concat(2*d,"Ready;\n           vec4 xTexelC").concat(2*d+1,";\n           int xTexelC").concat(2*d+1,"Ready;\n           vec4 xC").concat(d,";");f+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var v=0;v<l;v++)f+="\n           xTexelC".concat(2*v," = vec4(0.0);\n           xTexelC").concat(2*v,"Ready = 0;\n           xTexelC").concat(2*v+1," = vec4(0.0);\n           xTexelC").concat(2*v+1,"Ready = 0;\n           xC").concat(v," = vec4(0.0);");f+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var g=0;g<(h+1)/2;g++){var m=2*g;if(f+="\n           xC = xCCorner + ".concat(m*u,";\n           "),1===s){if(m<l&&(o%2===1?(f+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n               "),f+=1===u&&m>0?"\n                 xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                   } else {\n                     xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                   }\n                   ")):f+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xC").concat(m," = xTexelC").concat(m,";\n                 "),m+1<l)){var y=o%2===0?eL(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(f+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                     xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(m+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(m+1,"Ready = 1;\n                   }\n                   "),f+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                     } else {\n                      xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                     }\n                     "):"\n                     xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                     ")):f+=1===y?"\n                     xC".concat(m+1," = xTexelC").concat(m,";\n                     "):"\n                     xCOffset = xC + ".concat(y,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                       xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(m+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(m+1,"Ready = 1;\n                     }\n\n                     xC").concat(m+1," = xTexelC").concat(m+1,";\n                     ")}}else m<l&&(o%2===1?(f+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n               "),m+1<l&&(f+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                 "))):(f+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(\n                   xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n               "),m+1<l&&(f+="\n                   xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                 "))));m<l&&(f+="\n             wTexel = getW(r, ".concat(m,", d1, d2);\n             dotProd += xC").concat(m,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(m,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),m+1<l&&(f+="\n               wTexel = getW(r, ".concat(m+1,", d1, d2);\n               dotProd += xC").concat(m+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(m+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}f+="\n     }\n   ",f+="\n     }\n   ",f+="\n     }\n   ";var b="",k="";r&&(b=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),k="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(b,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(f,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(x,"\n         ").concat(k,"\n         setOutput(result);\n       }\n     ")})),Gie=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Yte(this.outputShape.length);for(var r=n.dataFormat,a=_te(),i="channelsLast"===r,o=i?1:2,s=i?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),c="",l=0;l<=1;l++)for(var h=0;h<=1;h++)c+="\n          blockIndex = rc.z + ".concat(h,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+h,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+h,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function qie(e,t){var n=e.length;return n>=3?[].concat(d(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function Kie(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,f=e.activation,d=void 0===f?null:f,p=n.shape,v=i.texData.get(n.dataId),g=a.inChannels,m=p[0]*p[1]*p[2],y=a.outChannels,b="channelsLast"===a.dataFormat,k=[];if(null!=c){var x=qie(c.shape,b);null!=x&&(c=sae({inputs:{x:c},backend:i,attrs:{shape:x}}),k.push(c))}if(null!=s){var w=qie(s.shape,b);null!=w&&(s=sae({inputs:{x:s},backend:i,attrs:{shape:w}}),k.push(s))}if(!((1===m||1===y)&&g>bae)&&v.isPacked&&b&&null!=v.texture&&p[2]%2!==0&&sL(v.shape.slice(-3),p.slice(-3))){var I=p[0]*p[1]*(p[2]+1),S={dataId:n.dataId,shape:[1,I,a.inChannels],dtype:n.dtype},C=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,rL(bte(v.shape,S.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(S.shape," isn't free")}));var _=sae({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});k.push(_);var T=kae({a:S,b:_,backend:i,transposeA:!1,transposeB:false,bias:s,activation:d,preluActivationWeights:c,leakyreluAlpha:h}),E=i.texData.get(T.dataId);rL(E.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=C,E.shape=a.outShape,(t=Ure({inputs:{x:T},backend:i})).shape=a.outShape,k.push(T)}else{var N=a.outHeight*a.outWidth,D=sae({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,N,a.inChannels]:[a.batchSize,a.inChannels,N]}}),A=sae({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),R=kae({a:b?D:A,b:b?A:D,transposeA:!b,transposeB:false,backend:i,bias:s,activation:d,preluActivationWeights:c,leakyreluAlpha:h});t=sae({inputs:{x:R},backend:i,attrs:{shape:a.outShape}}),k.push(D),k.push(A),k.push(R)}for(var M=0,O=k;M<O.length;M++){var F=O[M];i.disposeIntermediateTensorInfo(F)}return t}function Yie(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,f=void 0===h?null:h,d=r.filterWidth,p=r.filterHeight,v=r.inChannels,g=r.outWidth,m=r.outHeight,y="channelsLast"===r.dataFormat,b=d*p*v,k=m*g,x=[r.batchSize,b,k],w=[];if(null!=u){var I=qie(u.shape,y);null!=I&&(u=sae({inputs:{x:u},backend:a,attrs:{shape:I}}),w.push(u))}if(null!=o){var S=qie(o.shape,y);null!=S&&(o=sae({inputs:{x:o},backend:a,attrs:{shape:S}}),w.push(o))}var C=sae({inputs:{x:n},backend:a,attrs:{shape:[1,b,oL(n.shape)/b]}});w.push(C);var _=new Gie(x,r),T=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],E=a.runWebGLProgram(_,[t],"float32",T),N=sae({inputs:{x:E},backend:a,attrs:{shape:x}});w.push(E),w.push(N);var D=null!=o,A=null!=u,R="leakyrelu"===f,M=f?eae(f,!0):null,O=new tae(y?N.shape:C.shape,y?C.shape:N.shape,y?[r.batchSize,k,r.outChannels]:[r.batchSize,r.outChannels,k],!0,!1,D,M,A,R),F=y?[N,C]:[C,N];if(o&&F.push(o),A&&F.push(u),R){var P=a.makeTensorInfo([],"float32",xU(l,"float32"));F.push(P),w.push(P)}var L=a.runWebGLProgram(O,F,"float32"),Z=sae({inputs:{x:L},backend:a,attrs:{shape:r.outShape}});w.push(L);for(var z=0,B=w;z<B.length;z++){var U=B[z];a.disposeIntermediateTensorInfo(U)}return Z}var Xie={kernelName:mZ,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,h=a.dimRoundingMode,f=dH(c),d=rH(i.shape,o.shape,s,l,u,h,!1,f);if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===f&&LL().getBool("WEBGL_EXP_CONV")){var p=new Hie(d),v=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];t=r.runWebGLProgram(p,[i,o],"float32",v)}else if(LL().getBool("WEBGL_CONV_IM2COL"))t=Yie({x:i,filter:o,convInfo:d,backend:r});else{var g=new jie(d);t=r.runWebGLProgram(g,[i,o],"float32")}else t=Kie({x:i,filter:o,convInfo:d,backend:r});var m=sae({inputs:{x:t},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(t),m}},Qie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(o?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Jie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,h=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(h,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),$ie=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),eoe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var toe={kernelName:yZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,h=dH(u),f=rH(a.shape,l,o,1,s,c,!1,h),d=new Qie(f);return n.runWebGLProgram(d,[a,i],"float32")}},noe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Yte(this.outputShape.length);var n=t.filterHeight,r=t.filterWidth,a=n-1-t.padInfo.top,i=r-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}));var roe={kernelName:bZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,h=dH(c),f=rH(o,i.shape,s,1,u,l,!1,h);if(LL().getBool("WEBGL_PACK")&&"channelsLast"===h){var d=[[f.strideHeight,f.strideWidth]],p=new noe(f);return n.runWebGLProgram(p,[a,i],"float32",d)}var v=new Jie(f);return n.runWebGLProgram(v,[a,i],"float32")}};var aoe={kernelName:kZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=aH(a.shape,i.shape,o,u,s),l=new Wie(c);return n.runWebGLProgram(l,[a,i],"float32")}};var ioe={kernelName:xZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=aH(a.shape,u,o,1,s),l=new $ie(c);return n.runWebGLProgram(l,[a,i],"float32")}};var ooe,soe={kernelName:wZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=aH(r.inputShape,i.shape,s,1,o),c=new eoe(u);return n.runWebGLProgram(c,[a,i],"float32")}},uoe=Jre({opSnippet:Qre+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(zre,"\n  return result;\n")}),coe={kernelName:IZ,backendName:"webgl",kernelFunc:uoe},loe=Jre({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),hoe={kernelName:SZ,backendName:"webgl",kernelFunc:loe},foe=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=l(t,4),s=o[0],u=o[1],c=o[2],h=o[3],f=l(n,1)[0],d=l(r,2),v=d[0],g=d[1];this.outputShape=[f,v,g,h];var m="bilinear"===a?1:0,y="".concat(u-1,".0"),b="".concat(c-1,".0"),k=l(v>1?["".concat((u-1)/(v-1)),"(y2-y1) * height_ratio","y1*".concat(y," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(y)],3),x=k[0],w=k[1],I=k[2],S=l(g>1?["".concat((c-1)/(g-1)),"(x2-x1) * width_ratio","x1*".concat(b," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(b)],3),C=S[0],_=S[1],T=S[2];this.userCode="\n      const float height_ratio = float(".concat(x,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(w,";\n        float width_scale = ").concat(_,";\n\n        float in_y = ").concat(I,";\n        if( in_y < 0.0 || in_y > ").concat(y," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(T,";\n        if( in_x < 0.0 || in_x > ").concat(b," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),doe={kernelName:TZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new foe(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(ooe||(ooe={}));var poe=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===ooe.Prod?"1.0":"0.0",s=r?o:"getX(".concat(voe(i,"coords",this.op),")"),u=this.outputShape[this.outputShape.length-1],c="",l="";r?(c=a?"end != ".concat(u-1):"end != 0",l=a?"end + 1":"end - 1"):(c=a?"end + pow2 < ".concat(u):"end >= pow2",l=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(Vte(i)," coords = getOutputCoords();\n        int end = ").concat(goe(i,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(goe(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(voe(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function voe(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function goe(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function moe(e,t,n,r,a,i){var o=t.shape.length,s=hG([r],o),u=t;null!=s&&(u=mae({inputs:{x:t},backend:n,attrs:{perm:s}}));var c=dG(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=u.shape[c],h=Ure({inputs:{x:u},backend:n}),f=0;f<=Math.ceil(Math.log2(l))-1;f++){var d=new poe(e,u.shape,!1,i),p=[[f]],v=h;h=n.runWebGLProgram(d,[h],h.dtype,p),n.disposeIntermediateTensorInfo(v)}if(a){var g=new poe(e,u.shape,a,i),m=h;h=n.runWebGLProgram(g,[h],h.dtype),n.disposeIntermediateTensorInfo(m)}if(null!=s){var y=mae({inputs:{x:h},backend:n,attrs:{perm:fG(s)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(u),y}return h}var yoe={kernelName:CZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return moe(ooe.Prod,a,n,i,o,s)}};var boe={kernelName:_Z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;return moe(ooe.Sum,a,n,i,o,s)}};var koe={kernelName:EZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=vne(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var h=n.bufferSync(a),f=n.bufferSync(i),d=gne(h,f,o,s);return n.makeTensorInfo(d.shape,i.dtype,d.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},xoe=function(){function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return(0,v.Z)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var woe={kernelName:NZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=new xoe("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(h,[a],a.dtype)}},Ioe=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,p.Z)(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Yte(this.outputShape.length);var o=t.filterHeight,s=t.filterWidth,u=t.outChannels/t.inChannels,c="",l="";r&&(c=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),l="result = activation(result);");var h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(h,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")})),Soe=(0,v.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,p.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Yte(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,f=h,d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",v=0;v<h;v++)d+="\n          vec4 xTexelC".concat(2*v,";\n          int xTexelC").concat(2*v,"Ready;\n          vec4 xTexelC").concat(2*v+1,";\n          int xTexelC").concat(2*v+1,"Ready;\n          vec4 xC").concat(v,";");d+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(var g=0;g<h;g++)d+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var m=0;m<(f+1)/2;m++){var y=2*m;if(d+="\n          xC = xCCorner + ".concat(y*c,";\n          "),1===u){if(y<h&&(s%2===1?(d+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n              "),d+=1===c&&y>0?"\n                xC".concat(y," = vec4(xTexelC").concat(y-2,".zw, xTexelC").concat(y,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(y," = vec4(previous.zw, xTexelC").concat(y,".xy);\n                  } else {\n                    xC").concat(y," = vec4(0.0, 0.0, xTexelC").concat(y,".xy);\n                  }\n                  ")):d+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xC").concat(y," = xTexelC").concat(y,";\n                "),y+1<h)){var b=s%2===0?eL(c):c;c%2===0&&s%2===1||c%2!==0&&s%2!==1?(d+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(b,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                    xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(y+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(y+1,"Ready = 1;\n                  }\n                  "),d+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(y+1," = vec4(previous.zw, xTexelC").concat(y+1,".xy);\n                    } else {\n                     xC").concat(y+1," = vec4(0.0, 0.0, xTexelC").concat(y+1,".xy);\n                    }\n                    "):"\n                    xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".xy);\n                    ")):d+=1===b?"\n                    xC".concat(y+1," = xTexelC").concat(y,";\n                    "):"\n                    xCOffset = xC + ".concat(b,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                      xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(y+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(y+1,"Ready = 1;\n                    }\n\n                    xC").concat(y+1," = xTexelC").concat(y+1,";\n                    ")}}else y<h&&(s%2===1?(d+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n              "),y+1<h&&(d+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(y+1," = vec4(xTexelC").concat(y+1,".xy, final.xy);\n                "))):(d+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(\n                  xTexelC").concat(y,".xy, xTexelC").concat(y+1,".xy);\n              "),y+1<h&&(d+="\n                  xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n                "))));y<h&&(d+="\n            wTexel = getW(r, ".concat(y,", d1, q);\n            dotProd += xC").concat(y," * vec4(wTexel.xz, wTexel.xz);\n          "),y+1<h&&(d+="\n              wTexel = getW(r, ".concat(y+1,", d1, q);\n              dotProd += xC").concat(y+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}d+="\n    }\n  ",d+="\n      }\n    ";var k="",x="";r&&(k=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),x="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(k,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(d,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}));var Coe={kernelName:DZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),rL(hH(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var h,f=rH(a.shape,i.shape,o,l,s,c,!0);h=LL().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?new Soe(f):new Ioe(f);var d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(h,[a,i],"float32",d)}},_oe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Toe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var Eoe={kernelName:AZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,h=rH(a.shape,l,o,s,u,c,!0),f=new _oe(h);return n.runWebGLProgram(f,[a,i],"float32")}};var Noe={kernelName:RZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=rH(r.inputShape,i.shape,o,s,u,c,!0),h=new Toe(l);return n.runWebGLProgram(h,[a,i],"float32")}},Doe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var Aoe={kernelName:MZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(d(r.shape),d(r.shape)),i=oL(r.shape),o=sae({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new Doe(i),u=n.runWebGLProgram(s,[o],o.dtype),c=sae({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},Roe=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,h=a.top,f=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(f,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var Moe={kernelName:OZ,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=eH(i.shape,o.shape,s,u,"NHWC",c),h=new Roe(l),f=sae({inputs:{x:t=r.runWebGLProgram(h,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),f}};var Ooe={kernelName:ZZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=PK(e.attrs.equation,r.length),i=a.allDims,o=a.summedDims,s=a.idDims;ZK(i.length,s,r);for(var u=zK(o,s),c=u.path,l=u.steps,h=l.length,f=null,d=i.length,p=[],v=0;v<h;++v){var g,m=(0,C.Z)(l[v]);try{for(m.s();!(g=m.n()).done;){var y=g.value,b=LK(d,s[y]),k=b.permutationIndices,x=b.expandDims,w=void 0;BK(k)?w=r[y]:(w=mae({inputs:{x:r[y]},backend:n,attrs:{perm:k}}),p.push(w));for(var I=w.shape.slice(),S=0;S<x.length;++S)I.splice(x[S],0,1);sL(w.shape,I)||(w=sae({inputs:{x:w},backend:n,attrs:{shape:I}}),p.push(w)),null===f?f=w:(f=iae({inputs:{a:w,b:f},backend:n}),p.push(f))}}catch(kve){m.e(kve)}finally{m.f()}v<h-1&&(c[v]>=0&&(f=vae({inputs:{x:f},backend:n,attrs:{axis:c[v]-(i.length-d),keepDims:!1}}),p.push(f)),d--)}for(var _=0,T=p;_<T.length;_++){var E=T[_];E!==f&&n.disposeIntermediateTensorInfo(E)}return f}},Foe=Jre({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Poe={kernelName:zZ,backendName:"webgl",kernelFunc:Foe},Loe={kernelName:BZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=LL().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bre("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new Zre("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},Zoe=$re({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:xne}),zoe={kernelName:VZ,backendName:"webgl",kernelFunc:Zoe},Boe=Jre({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(wK,";\n  float a1 = ").concat(IK,";\n  float a2 = ").concat(SK,";\n  float a3 = ").concat(CK,";\n  float a4 = ").concat(_K,";\n  float a5 = ").concat(TK,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),Uoe={kernelName:UZ,backendName:"webgl",kernelFunc:Boe},Voe=Jre({opSnippet:Qre+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:wne,dtype:"float32"}),joe={kernelName:jZ,backendName:"webgl",kernelFunc:Voe};function Woe(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(rL(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),sae({inputs:{x:i},backend:r,attrs:{shape:s}})}var Hoe={kernelName:WZ,backendName:"webgl",kernelFunc:Woe},Goe="return exp(x) - 1.0;",qoe=Jre({opSnippet:Goe,packedOpSnippet:Goe,cpuKernelImpl:Ine}),Koe={kernelName:HZ,backendName:"webgl",kernelFunc:qoe},Yoe=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function Xoe(e,t,n){var r=n.texData.get(e.dataId),a=oL(e.shape),i=e.shape[e.shape.length-1],o=sae({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new Yoe("real",s,t),c=new Yoe("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(u,l,"float32"),f=n.runWebGLProgram(c,l,"float32"),d=jre({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);var p=sae({inputs:{x:d},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(d),p}var Qoe={kernelName:GZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return Xoe(t.input,!1,n)}},Joe=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function $oe(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||xL(a))){var o=gL(i,oL(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new Joe(r,a),u=[[a]];return t.runWebGLProgram(s,[],i,u)}var ese,tse={kernelName:qZ,backendName:"webgl",kernelFunc:$oe},nse=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),rse={kernelName:KZ,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new nse(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},ase="return floor(x);",ise=Jre({opSnippet:ase,packedOpSnippet:ase,cpuKernelImpl:Sne}),ose={kernelName:YZ,backendName:"webgl",kernelFunc:ise},sse=$re({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),use={kernelName:XZ,backendName:"webgl",kernelFunc:sse},cse=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"];var n=_te(),r=l(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),lse=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=_te(),r=l(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),hse={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u=l(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=u[0],h=u[1],f=[h,c],d=[h,c,i];if(s||o){var p=LL().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=ese&&p===fse||(fse=p,ese=document.createElement("canvas").getContext("2d",{willReadFrequently:fse})),ese.canvas.width=c,ese.canvas.height=h,ese.drawImage(a,0,0,c,h),a=ese.canvas}var v=n.makeTensorInfo(f,"int32");n.texData.get(v.dataId).usage=Hee.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(v.dataId),a);var g=LL().getBool("WEBGL_PACK")?new lse(d):new cse(d),m=n.runWebGLProgram(g,[v],"int32");return n.disposeData(v.dataId),m}},fse=LL().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var dse={kernelName:YB,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,h=a.dataFormat,f=a.dilations,d=a.dimRoundingMode,p=a.activation,v=a.leakyreluAlpha,g=dH(h),m=rH(i.shape,o.shape,c,f,l,d,!1,g),y=[],b=null!=s,k=null!=u,x="leakyrelu"===p,w=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=sae({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(s,h)),k&&e.push(t(u,h)),x){var n=r.makeTensorInfo([],"float32",xU(v,"float32"));e.push(n),y.push(n)}return e};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&LL().getBool("WEBGL_EXP_CONV")){var I=p?eae(p,!0):null,S=new Hie(m,b,I,k,x),C=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],_=w();t=r.runWebGLProgram(S,_,"float32",C)}else if(LL().getBool("WEBGL_CONV_IM2COL"))t=Yie({x:i,filter:o,convInfo:m,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:v});else{var T=p?eae(p,!1):null,E=new jie(m,b,T,k,x),N=w();t=r.runWebGLProgram(E,N,"float32")}else t=Kie({x:i,filter:o,convInfo:m,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:v});var D=sae({inputs:{x:t},backend:r,attrs:{shape:m.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),D}};var pse={kernelName:XB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,h=r.dimRoundingMode,f=r.activation,d=r.leakyreluAlpha,p=[],v=l;null==v&&(v=[1,1]),rL(hH(u,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'")}));var g,m=rH(a.shape,i.shape,u,v,c,h,!0),y=LL().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,b=f?eae(f,y):null,k=[a,i],x=null!=o,w=null!=s,I="leakyrelu"===f;if(x&&k.push(o),w&&k.push(s),I){var S=n.makeTensorInfo([],"float32",xU(d,"float32"));k.push(S),p.push(S)}g=y?new Soe(m,x,b,w,I):new Ioe(m,x,b,w,I);var C=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],_=n.runWebGLProgram(g,k,"float32",C);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),_}},vse=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=Vte(r.length),o="\n    int index;",s=0;s<this.sliceDim;s++)o+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var gse={kernelName:$Z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=oL(r.shape),u=l(yK(r,a),4),c=u[0],h=u[1],f=u[2],d=u[3],p=sae({inputs:{x:a},backend:n,attrs:{shape:[h,o]}}),v=sae({inputs:{x:r},backend:n,attrs:{shape:[oL(r.shape)/f,f]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var g=n.readSync(a.dataId),m=n.bufferSync(r),y=Cne(g,m,r.dtype,h,o,f,d,r.shape,s);return n.makeTensorInfo(c,r.dtype,y.values)}var b=new vse(o,d,[h,f],r.shape),k=n.runWebGLProgram(b,[v,p],v.dtype),x=sae({inputs:{x:k},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(k),x}},mse=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=Vte(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function yse(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=dL(o,a.shape)[0];if(LL().get("DEBUG"))for(var c=n.readSync(i.dataId),l=a.shape[u],h=function(){var e=c[f];rL(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},f=0;f<c.length;++f)h();var d=KK(a,i,u,s),p=oL(i.shape),v=[],g=sae({inputs:{x:a},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),m=sae({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,p/d.batchSize]}});v.push(g),v.push(m);var y=[d.batchSize,d.outerSize,p/d.batchSize,d.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var b=n.bufferSync(m),k=n.bufferSync(g),x=_ne(k,b,y);return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(d.outputShape,x.dtype,x.values)}var w=new mse(g.shape,y),I=n.runWebGLProgram(w,[g,m],g.dtype);v.push(I);var S=sae({inputs:{x:I},backend:n,attrs:{shape:d.outputShape}});return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),S}var bse={kernelName:JZ,backendName:"webgl",kernelFunc:yse},kse=$re({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Tne,dtype:"bool"}),xse={kernelName:ez,backendName:"webgl",kernelFunc:kse},wse=$re({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Ene}),Ise={kernelName:tz,backendName:"webgl",kernelFunc:wse};var Sse={kernelName:rz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return Xoe(t.input,!0,n)}},Cse=Jre({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),_se={kernelName:iz,backendName:"webgl",kernelFunc:Cse},Tse=Jre({opSnippet:"return float(isinf(x));",dtype:"bool"}),Ese={kernelName:oz,backendName:"webgl",kernelFunc:Tse},Nse=Jre({opSnippet:"return float(isnan(x));",dtype:"bool"}),Dse={kernelName:sz,backendName:"webgl",kernelFunc:Nse},Ase=$re({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Nne,dtype:"bool"}),Rse={kernelName:cz,backendName:"webgl",kernelFunc:Ase},Mse=$re({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Dne,dtype:"bool"}),Ose={kernelName:lz,backendName:"webgl",kernelFunc:Mse};var Fse={kernelName:hz,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=Ane(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},Pse=Jre({opSnippet:Qre+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Rne}),Lse={kernelName:fz,backendName:"webgl",kernelFunc:Pse},Zse=Jre({opSnippet:Qre+"\n  return log(1.0 + x);\n"}),zse={kernelName:dz,backendName:"webgl",kernelFunc:Zse},Bse=$re({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Use={kernelName:pz,backendName:"webgl",kernelFunc:Bse},Vse=Jre({opSnippet:"return float(!(x >= 1.0));"}),jse={kernelName:vz,backendName:"webgl",kernelFunc:Vse},Wse=$re({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Hse={kernelName:gz,backendName:"webgl",kernelFunc:Wse},Gse=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),qse=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),Kse={kernelName:mz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=LL().getBool("WEBGL_PACK_NORMALIZATION")?new qse(a.shape,i,o,s,u):new Gse(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},Yse=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),Xse={kernelName:yz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new Yse(a.shape,s,u,c,l);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function Qse(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=dL(i,a.shape),c=u,h=hG(c,s),f=null!=h,d=n.shouldExecuteOnCPU([a]),p=a;if(f){if(d){for(var v=n.texData.get(p.dataId).values,g=new Array(s),m=0;m<g.length;m++)g[m]=a.shape[h[m]];var y=sre(v,a.shape,a.dtype,h,g);p=n.makeTensorInfo(g,a.dtype),n.texData.get(p.dataId).values=y}else p=pae(a,h,n);c=dG(c.length,s)}lG("max",c,s);var b,k=l(uG(p.shape,c),2),x=k[0],w=k[1],I=x;if(o&&(I=cG(x,u)),d){var S=n.texData.get(p.dataId).values,C=Mne(S,oL(w),I,a.dtype);b=n.makeTensorInfo(I,a.dtype),n.texData.get(b.dataId).values=C}else b=function(e,t,n,r){var a=oL(t),i=sae({inputs:{x:e},attrs:{shape:[oL(e.shape)/a,a]},backend:r}),o=hae(i,e.dtype,"max",r),s=sae({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(p,w,I,n);return f&&n.disposeIntermediateTensorInfo(p),b}var Jse={kernelName:bz,backendName:"webgl",kernelFunc:Qse},$se=$re({opSnippet:Lre+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+zre+"\n  return result;\n",cpuKernelImpl:One}),eue={kernelName:kz,backendName:"webgl",kernelFunc:$se};var tue={kernelName:xz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Ste(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rL(hH(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=tH(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&sL(c.inShape,c.outShape))return Ure({inputs:{x:a},backend:n});var l=new $ae(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var nue={kernelName:Iz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=nH(a.shape,i,o,[1,1,1],s,c,u),h=new eie(l,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},rue=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),aue=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,h=u-1-t.padInfo.front,f=c-1-t.padInfo.top,d=l-1-t.padInfo.left,v=u*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(f,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(v," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var iue={kernelName:Sz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=nH(i.shape,o,s,[1,1,1],u,c),h=new eie(l,"max",!0),f=n.runWebGLProgram(h,[i],i.dtype),d=new aue(l),p=n.runWebGLProgram(d,[a,f],i.dtype);return n.disposeIntermediateTensorInfo(f),p}};var oue={kernelName:wz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;Ste([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=tH(o.shape,s,u,1,c,l),f=new $ae(h,"max",!0),d=n.runWebGLProgram(f,[o],o.dtype),p=new rue(h),v=n.runWebGLProgram(p,[a,d],o.dtype);return n.disposeIntermediateTensorInfo(d),v}};var sue={kernelName:Cz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;rL(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var h=[1,1];rL(hH(o,h),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(h,"'")}));var f=tH(a.shape,i,o,h,s),d=function(e,t,n,r){var a=new $ae(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new $ae(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,f,c),p=l(d,2);return[p[0],p[1]]}};var uue={kernelName:_z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=dL(o,a.shape),h=c,f=hG(h,u),d=null!=f,p=s.shouldExecuteOnCPU([a]),v=[],g=a;if(d){if(p){for(var m=s.texData.get(g.dataId).values,y=new Array(u),b=0;b<y.length;b++)y[b]=a.shape[f[b]];var k=sre(m,a.shape,a.dtype,f,y);g=s.makeTensorInfo(y,a.dtype),s.texData.get(g.dataId).values=k}else g=pae(a,f,s);v.push(g),h=dG(h.length,u)}lG("sum",h,u);var x=l(uG(g.shape,h),2),w=x[0],I=x[1],S=w;i&&(S=cG(w,c));for(var C=function(e,t,n,r){var a=oL(t),i=sae({inputs:{x:e},attrs:{shape:[oL(e.shape)/a,a]},backend:r}),o=hae(i,"float32","mean",r),s=sae({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(g,I,S,s),_=0,T=v;_<T.length;_++){var E=T[_];s.disposeIntermediateTensorInfo(E)}return C}};var cue={kernelName:Tz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=dL(i,a.shape),c=u,h=hG(c,s),f=a;null!=h&&(f=mae({inputs:{x:a},backend:n,attrs:{perm:h}}),c=dG(c.length,a.shape.length)),lG("min",c,s);var d,p=l(uG(f.shape,c),2),v=p[0],g=sae({inputs:{x:f},backend:n,attrs:{shape:[-1,oL(p[1])]}}),m=hae(g,g.dtype,"min",n);return d=sae(o?{inputs:{x:m},backend:n,attrs:{shape:cG(v,u)}}:{inputs:{x:m},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(f),d}},lue=$re({opSnippet:Lre+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+zre+"\n  return result;\n",cpuKernelImpl:Fne}),hue={kernelName:Ez,backendName:"webgl",kernelFunc:lue},fue=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Vte(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),due=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Vte(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=lre("rc",a),c=lre("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),f="reflect"===r?0:1,d="";if(1===a){var v="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(f,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(f,";\n        }\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ")}else{var g="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(f,") +\n                gte * ((end - 1) * 2 - source + ").concat(f,");\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(g,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(g,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(g,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(g,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")})),pue={kernelName:Nz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new due(a.shape,i,o):new fue(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},vue=$re({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+zre+"\n  return result;\n"}),gue={kernelName:Dz,backendName:"webgl",kernelFunc:vue},mue=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),yue=$re({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),bue={kernelName:LZ,backendName:"webgl",kernelFunc:yue},kue="return a - b;",xue=$re({opSnippet:kue,packedOpSnippet:kue,supportsComplex:!0,cpuKernelImpl:are}),wue={kernelName:FB,backendName:"webgl",kernelFunc:xue};function Iue(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=dL([r.dim],a.shape),o=Qse({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=cG(o.shape,i),u=sae({inputs:{x:o},backend:n,attrs:{shape:s}}),c=xue({inputs:{a:a,b:u},backend:n}),l=Voe({inputs:{x:c},backend:n}),h=vae({inputs:{x:l},backend:n,attrs:{axis:i,keepDims:!1}}),f=sae({inputs:{x:h},backend:n,attrs:{shape:s}}),d=yue({inputs:{a:l,b:f},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),d}var Sue={kernelName:wB,backendName:"webgl",kernelFunc:Iue};var Cue={kernelName:Az,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:Iue({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new mue(c,l,i),f=[[o]],d=n.runWebGLProgram(h,[u],"int32",f);return s||n.disposeIntermediateTensorInfo(u),d}},_ue=yre+"\n  return -x;\n";var Tue={kernelName:Mz,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=l(Lne(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=LL().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Are(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new mre(a.shape,_ue),r.runWebGLProgram(t,[a],a.dtype)}},Eue=Iq;var Nue={kernelName:Fz,backendName:"webgl",kernelFunc:function(e){QB("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),h=Eue(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},Due=Sq;var Aue={kernelName:Pz,backendName:"webgl",kernelFunc:function(e){QB("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),h=n.readSync(i.dataId),f=Due(l,h,o,s,u,c),d=f.selectedIndices,p=f.validOutputs;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Rue=Cq;var Mue={kernelName:Lz,backendName:"webgl",kernelFunc:function(e){QB("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),h=n.readSync(i.dataId),f=Rue(l,h,o,s,u,c),d=f.selectedIndices,p=f.selectedScores;return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},Oue=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),Fue={kernelName:zz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,o=r.depth,s=r.onValue,u=r.offValue,c=oL(a.shape),l=new Oue(c,o,s,u),h=sae({inputs:{x:a},backend:n,attrs:{shape:[c]}}),f=n.runWebGLProgram(l,[h],i);n.disposeIntermediateTensorInfo(h);var p=sae({inputs:{x:f},backend:n,attrs:{shape:[].concat(d(a.shape),[o])}});return n.disposeIntermediateTensorInfo(f),p}};function Pue(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=wie({inputs:{input:r},backend:n}),i=Pue({inputs:{x:a},backend:n}),o=Zie({inputs:{input:r},backend:n}),s=Pue({inputs:{x:o},backend:n}),u=jre({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return $oe({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var Lue={kernelName:HB,backendName:"webgl",kernelFunc:Pue};var Zue={kernelName:Zz,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=wie({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=Zie({inputs:{input:a},backend:r}),u=Pue({inputs:{x:s},backend:r}),c=jre({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return $oe({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var zue={kernelName:Bz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return Woe({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){aL(a,e.shape,"All tensors passed to stack must have matching shapes"),rL(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=Uie({inputs:t.map((function(e){var t=Woe({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}},Bue=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Vte(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),Uue=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=Vte(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=lre("rc",a),c=lre("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),f=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",v="",g=0,m=1===a?2:4;g<m;g++)v+="\n        ".concat(f[g],"\n        if (").concat(d,") {\n          result[").concat(g,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(g,"] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ");v+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")})),Vue=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===oL(a.shape)){var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return $oe({backend:n,attrs:{shape:s,value:o,dtype:a.dtype}})}var u=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Uue(a.shape,i,o):new Bue(a.shape,i,o),c=[[o]];return n.runWebGLProgram(u,[a],a.dtype,c)},jue={kernelName:Uz,backendName:"webgl",kernelFunc:Vue},Wue=$re({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+zre+"\n  return result;\n"}),Hue={kernelName:Vz,backendName:"webgl",kernelFunc:Wue};var Gue={kernelName:Wz,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],h=dL(o,i.shape),f=h,d=hG(f,u),p=i;if(null!=d&&(p=mae({inputs:{x:i},backend:r,attrs:{perm:d}}),f=dG(f.length,u),c.push(p)),lG("prod",f,u),r.shouldExecuteOnCPU([p])){var v=r.texData.get(p.dataId).values,g=zne(p.shape,p.dtype,v,f),m=g.outVals,y=g.outShape,b=g.outDtype;t=r.makeTensorInfo(y,b,m)}else{var k=l(uG(p.shape,f),2),x=k[0],w=oL(k[1]),I=sae({inputs:{x:p},backend:r,attrs:{shape:[-1,w]}}),S=hae(I,QU(i.dtype),"prod",r);t=sae({inputs:{x:S},backend:r,attrs:{shape:x}}),c.push(I),c.push(S)}if(s){c.push(t);var C=cG(t.shape,h);t=sae({inputs:{x:t},backend:r,attrs:{shape:C}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var que={kernelName:Hz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,i=t.paramsDenseValues,o=t.indices,s=r.outputRaggedRank,u=a.map((function(e){return n.readSync(e.dataId)})),c=a.map((function(e){return e.shape})),h=n.readSync(i.dataId),f=n.readSync(o.dataId),d=l(Bne(u,c,h,i.shape,i.dtype,f,o.shape,s),3),p=d[0],v=d[1],g=d[2],m=p.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),y=n.makeTensorInfo(g,i.dtype,v);return m.concat([y])}};var Kue={kernelName:Gz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,i=t.deltas,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=l(Une(o,r.shape,r.dtype,s,a.shape,u,i.shape),2),h=c[0],f=c[1];return[n.makeTensorInfo([h.length],"int32",h),n.makeTensorInfo([f.length],r.dtype,f)]}};var Yue={kernelName:qz,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,i=t.values,o=t.defaultValue,s=t.rowPartitionTensors,u=r.rowPartitionTypes,c=n.readSync(a.dataId),h=n.readSync(i.dataId),f=n.readSync(o.dataId),d=s.map((function(e){return n.readSync(e.dataId)})),p=s.map((function(e){return e.shape})),v=l(Vne(c,a.shape,h,i.shape,i.dtype,f,o.shape,d,p,u),2),g=v[0],m=v[1];return n.makeTensorInfo(g,i.dtype,m)}},Xue=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=jne(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},Que={kernelName:Kz,backendName:"webgl",kernelFunc:Xue},Jue=Jre({opSnippet:"return 1.0 / x;"}),$ue={kernelName:Xz,backendName:"webgl",kernelFunc:Jue},ece=Jre({opSnippet:yre+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),tce={kernelName:Qz,backendName:"webgl",kernelFunc:ece},nce=Jre({opSnippet:yre+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),rce={kernelName:rB,backendName:"webgl",kernelFunc:nce},ace=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var o=l(t,4),s=o[0],u=o[1],c=o[2],h=o[3];this.outputShape=[s,n,r,h];var f,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],v=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/v[0],",\n          ").concat(d[1]/v[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),ice=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=l(t,4),s=o[0],u=o[1],c=o[2],h=o[3];this.outputShape=[s,n,r,h];var f,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],v=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/v[0],",\n          ").concat(d[1]/v[1],",\n          ").concat(d[1]/v[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var oce={kernelName:tB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=l(r.size,2),u=s[0],c=s[1],h=LL().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ice(a.shape,u,c,i,o):new ace(a.shape,u,c,i,o);return n.runWebGLProgram(h,[a],"float32")}},sce=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=l(n,3),i=a[1],o=a[2],s=l(t,3),u=s[1],c=s[2],h=[r&&u>1?i-1:i,r&&c>1?o-1:o],f=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=h[0]/f[0],v=h[1]/f[1],g=1/d,m=1/v,y=2*Math.ceil(g)+2,b=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(b,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var uce={kernelName:nB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new sce(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},cce=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var o=l(t,4),s=o[0],u=o[1],c=o[2],h=o[3];this.outputShape=[s,n,r,h];var f,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],v=[a&&n>1?n-1:n,a&&r>1?r-1:r],g=a?"0.5":"0.0";f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/v[0],",\n          ").concat(d[1]/v[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),lce=(0,v.Z)((function e(t,n,r,a,i){(0,p.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=l(t,4),s=o[0],u=o[1],c=o[2],h=o[3];this.outputShape=[s,n,r,h];var f,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],v=[a&&n>1?n-1:n,a&&r>1?r-1:r],g=a?"0.5":"0.0";f=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/v[0],",\n          ").concat(d[1]/v[1],",\n          ").concat(d[1]/v[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var hce={kernelName:$z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=l(r.size,2),u=s[0],c=s[1],h=LL().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new lce(a.shape,u,c,i,o):new cce(a.shape,u,c,i,o);return n.runWebGLProgram(h,[a],a.dtype)}},fce=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=l(n,3),i=a[1],o=a[2],s=l(t,3),u=s[1],c=s[2],h=[r&&u>1?i-1:i,r&&c>1?o-1:o],f=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=h[0]/f[0],v=h[1]/f[1],g=1/d,m=1/v,y=2*Math.ceil(g)+2,b=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(b,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(h[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(h[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var dce={kernelName:eB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new fce(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},pce=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=Vte(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),vce=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=lre("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=Vte(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var gce={kernelName:aB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=dL(i,a.shape);if(0===o)return Ure({inputs:{x:a},backend:n});var u=LL().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vce(a.shape,s):new pce(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},mce=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),yce={kernelName:qB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new mce(a.shape,o),h=l(fK(s,a.shape[1],a.shape[2]),2),f=[[h[0],h[1],Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(c,[a],a.dtype,f)}},bce=Jre({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),kce={kernelName:iB,backendName:"webgl",kernelFunc:bce},xce=Jre({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Wne}),wce={kernelName:oB,backendName:"webgl",kernelFunc:xce},Ice=(0,v.Z)((function e(t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];(0,p.Z)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var u=Vte(i.length),c=Vte(o.length),l="";1===r?l="i":2===r&&(l="i, j");var h="getIndices(".concat(l,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var d="getUpdates(".concat(f,")"),v="";s&&(v="coords[0], coords[1]");var g="getDefaultValue(".concat(v,")"),m=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(g,", sum, float(found)));\n        }\n      ")})),Sce=(0,v.Z)((function e(t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];(0,p.Z)(this,e),this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;var u=Vte(i.length),c=Vte(o.length),l="";1===r?l="i":2===r&&(l="i, j");var h="getIndices(".concat(l,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var d="getUpdates(".concat(f,")"),v="";s&&(v="coords[0], coords[1]");var g="getDefaultValue(".concat(v,")"),m=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(n,"; j+=2) {\n              ivec4 index = round(").concat(h,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(n,") {\n                flattenedIndex += index.yw * ").concat(y,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(d,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(g,", sum, found));\n        }\n      ")}));var Cce={kernelName:sB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=bK(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,f=s.outputSize,d=[f/l,l];if(0===f)return n.makeTensorInfo(o,a.dtype);var p,v=sae({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),g=sae({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));p=LL().getBool("WEBGL_PACK")?new Sce(c,u,v.shape.length,g.shape.length,h,d):new Ice(c,u,v.shape.length,g.shape.length,h,d);var y=n.runWebGLProgram(p,[g,v,m],g.dtype),b=sae({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}},_ce=(0,v.Z)((function e(t,n,r,a){(0,p.Z)(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===LL().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var Tce={kernelName:cB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,s=new _ce(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}},Ece=(0,v.Z)((function e(t,n,r){var a,i;if((0,p.Z)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=Vte(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var Nce={kernelName:lB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new Ece(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],XU(a.dtype,i.dtype))}},Dce=Jre({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(kK,";\n  float scale = ").concat(xK,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),Ace={kernelName:hB,backendName:"webgl",kernelFunc:Dce},Rce=Jre({opSnippet:Qre+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Gne}),Mce={kernelName:gB,backendName:"webgl",kernelFunc:Rce},Oce=Jre({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),Fce={kernelName:vB,backendName:"webgl",kernelFunc:Oce},Pce=Jre({opSnippet:Qre+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(zre,"\n  return result;\n")}),Lce={kernelName:dB,backendName:"webgl",kernelFunc:Pce},Zce=Jre({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),zce={kernelName:pB,backendName:"webgl",kernelFunc:Zce},Bce=Jre({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),Uce={kernelName:mB,backendName:"webgl",kernelFunc:Bce},Vce={kernelName:kB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;rL(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,d(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],h=Vue({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),f=dK(h.shape,i,s,!1),p=pK(f.length,i.length,!1),v=vK(h.shape,i,s,!1),g=sae({inputs:{x:h},backend:n,attrs:{shape:f}}),m=mae({inputs:{x:g},backend:n,attrs:{perm:p}}),y=sae({inputs:{x:m},backend:n,attrs:{shape:v}});return l.push(h),l.push(g),l.push(m),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}};var jce={kernelName:IB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,o=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),h=n.readSync(o.dataId)[0],f=l(Yne(s,r.shape,r.dtype,u,a.dtype,c,h),5),d=f[0],p=f[1],v=f[2],g=f[3],m=f[4];return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,v),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};var Wce={kernelName:SB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),c=l(Xne(s,r.shape,r.dtype,o,u),3),h=c[0],f=c[1],d=c[2];return[n.makeTensorInfo(f,r.dtype,h),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}};var Hce={kernelName:CB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=l(Qne(o,r.shape,r.dtype,s,u,!0),2),h=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,h)}};var Gce={kernelName:_B,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=l(Qne(o,r.shape,r.dtype,s,u),2),h=c[0],f=c[1];return n.makeTensorInfo(f,r.dtype,h)}};var qce={kernelName:TB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=bK(0,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,f=u.strides,d=u.outputSize;if("string"===i.dtype){var p=n.bufferSync(a),v=n.bufferSync(i),g=CU(n.readSync(o.dataId)[0]),m=Hne(p,v,s,d,h,l,c,f,g,false);return n.makeTensorInfo(s,m.dtype,m.values)}var y=new Ice(l,c,a.shape.length,i.shape.length,f,[d,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),k=sae({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(b),k}};var Kce={kernelName:xB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=dL(r.axis,a.shape)[0],s=VK(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=d(l);t[o]=e;var r=pie({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},Yce="return sqrt(x);",Xce=Jre({opSnippet:Yce,packedOpSnippet:Yce,cpuKernelImpl:Jne}),Qce={kernelName:yB,backendName:"webgl",kernelFunc:Xce},Jce={kernelName:NB,backendName:"webgl",kernelFunc:Jre({opSnippet:"return x * x;"})},$ce="return (a - b) * (a - b);",ele=$re({opSnippet:$ce,packedOpSnippet:$ce}),tle={kernelName:EB,backendName:"webgl",kernelFunc:ele};var nle={kernelName:DB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;if("string"!==a.dtype)throw new Error("Input must be of datatype string");var i=YK(n.readSync(a.dataId)),o=$ne(i,"string",r);return n.makeTensorInfo(a.shape,"string",o)}};var rle={kernelName:GB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=yre+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new mre(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},ale=(0,v.Z)((function e(t,n,r){(0,p.Z)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=Vte(r.length),o=Vte(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var ile={kernelName:AB,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,h=a.ellipsisMask,f=a.newAxisMask,d=a.shrinkAxisMask,p=YW(i.shape,o,s,u,c,l,h,f,d),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,k=p.begin,x=p.end,w=p.strides;if(m)t=sae({inputs:{x:i},backend:r,attrs:{shape:g}});else if(y||b){rL(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var I=HW(k,x,w),S=pie({inputs:{x:i},backend:r,attrs:{begin:k,size:I}});t=sae({inputs:{x:S},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(S)}else{if(r.shouldExecuteOnCPU([i])){var C=r.readSync(i.dataId),_=Rj(i.shape,i.dtype,C),T=ere(v,_,w,k);t=r.makeTensorInfo(g,i.dtype,T.values)}else{var E=new ale(k,w,v);t=r.runWebGLProgram(E,[i],i.dtype)}}var N=sae({inputs:{x:t},backend:r,attrs:{shape:g}});return r.disposeIntermediateTensorInfo(t),N}};var ole={kernelName:RB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,o=r.leftPad,s=r.rightPad,u=r.padWidth,c=r.preserveShortSequences,h=t.data,f=t.dataSplits,d=n.readSync(h.dataId),p=n.readSync(f.dataId),v=l(tre(d,p,a,i,o,s,u,c),2),g=v[0],m=v[1];return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(f.shape,"int32",m)]}};var sle={kernelName:MB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var o=n.readSync(a.dataId),s=n.readSync(i.dataId)[0],u=l(nre(o,s,r),3),c=u[0],h=u[1],f=u[2],d=h.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(f))]}};var ule={kernelName:OB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=rre(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},cle=Jre({opSnippet:"return tan(x);"}),lle={kernelName:PB,backendName:"webgl",kernelFunc:cle},hle=Jre({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),fle={kernelName:LB,backendName:"webgl",kernelFunc:hle};var dle={kernelName:uB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.tensor,i=t.indices,o=t.updates;!function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(r);var s=bK(0,i,a.shape),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,f=s.outputSize,d=[f/l,l];if(0===f)return n.makeTensorInfo(a.shape,i.dtype);var p=sae({inputs:{x:i},backend:n,attrs:{shape:[c,u]}}),v=sae({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),g=sae({inputs:{x:a},backend:n,attrs:{shape:d}}),m=new Ice(c,u,p.shape.length,v.shape.length,h,d,!1,!0),y=n.runWebGLProgram(m,[v,p,g],g.dtype),b=sae({inputs:{x:y},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}},ple=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=Vte(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function vle(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),s="string"===a.dtype?o.map((function(e){return CU(e)})):o,u=Rj(a.shape,a.dtype,s),c=ire(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new ple(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var gle={kernelName:ZB,backendName:"webgl",kernelFunc:vle},mle=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),yle=(0,v.Z)((function e(t){(0,p.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function ble(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function kle(e){for(var t=1;t<e;)t*=2;return t}var xle={kernelName:zB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=LL().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=LL().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=a.shape,h=c[c.length-1];if(n.shouldExecuteOnCPU([a])||h<s||i>u){var f=n.readSync(a.dataId),d=l(ore(f,c,a.dtype,i,o),2),p=d[0],v=d[1];return[n.makeTensorInfo(p.shape,p.dtype,p.values),n.makeTensorInfo(v.shape,v.dtype,v.values)]}if(0===i)return c[c.length-1]=0,[n.makeTensorInfo(c,a.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(1===h)return[a,$oe({attrs:{shape:c,dtype:"int32",value:0},backend:n})];var g=n.texData.get(a.dataId),m=null!==g&&g.isPacked,y=m?n.unpackTensor(a):a,b=oL(c)/h,k=sae({inputs:{x:y},attrs:{shape:[b,h]},backend:n});m&&ble(n,y);for(var x=kle(i),w=kle(h),I=null,S=function(){return null===I?[k,k]:[k,I]},C=function(e,t,r){var a=S(),i=new mle(r),o=[[h],[null===I?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],s=I;I=n.runWebGLProgram(i,a,"int32",o),ble(n,s)},_=1;_<x;_*=2)for(var T=2*_,E=_;E>=1;E/=2)C(T,E,[b,w]);for(var N=w;N>x;N/=2){var D=S(),A=new yle([b,N/2]),R=[[h],[null===I?1:0],[x]],M=I;I=n.runWebGLProgram(A,D,"int32",R),ble(n,M);for(var O=x/2,F=2*O,P=O;P>=1;P/=2)C(F,P,I.shape)}var L=I;I=pie({inputs:{x:I},backend:n,attrs:{begin:0,size:[b,i]}}),ble(n,L);var Z=yse({inputs:{x:k,indices:I},backend:n,attrs:{axis:1,batchDims:1}});ble(n,k);var z=c.slice(0,-1);z.push(i),L=I,I=sae({inputs:{x:I},attrs:{shape:z},backend:n}),ble(n,L);var B=Z;return Z=sae({inputs:{x:Z},attrs:{shape:z},backend:n}),ble(n,B),[Z,I]}},wle=(0,v.Z)((function e(t,n,r,a,i,o){(0,p.Z)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var Ile={kernelName:BB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,s=r.fillMode,u=r.fillValue,c=r.outputShape,h=l(a.shape,4),f=h[0],d=h[1],p=h[2],v=h[3],g=l(null!=c?c:[d,p],2),m=g[0],y=g[1],b=new wle(d,p,o,s,u,[f,m,y,v]);return n.runWebGLProgram(b,[a,i],"float32")}};var Sle={kernelName:VB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;Ste(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=ure(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var Cle={kernelName:jB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,h=0;h<s;h++)h!==i&&(c[l++]=o.shape[h]);var f=[],d=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var v=new Array(u),g=0;g<v.length;g++){d[i]=g;var m=pie({inputs:{x:o},backend:n,attrs:{begin:d,size:p}}),y=sae({inputs:{x:m},backend:n,attrs:{shape:c}});v[g]=y,f.push(m)}return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},_le=(0,v.Z)((function e(t,n){(0,p.Z)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(f,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var Tle={kernelName:WB,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=hG([c],s),h=a;null!=l&&(h=mae({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(h),c=dG(1,s)[0]);var f=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(h.shape,c,o),d=oL([h.shape[c]]),p=sae({inputs:{x:h},backend:n,attrs:{shape:[-1,d]}});u.push(p);var v=function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=function(e,t){var n,r=!1;for(e<=lK?(n=e,r=!0):n=IL(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=IL(e,n+1);return n}(c,o),h=new _le({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),f=n.compileAndRun(h,[t,a],i);if(u.push(f),f.shape[1]===o)return f;var d=Xue({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=vle({inputs:{x:d},backend:n,attrs:{reps:[c/l]}});return u.push(d),u.push(p),e(f,r,p,i,o)}(p,"unsortedSegmentSum",i,QU(a.dtype),o),g=sae({inputs:{x:v},backend:n,attrs:{shape:f}}),m=g;if(null!=l){u.push(g);var y=fG(l);m=mae({inputs:{x:m},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},Ele=0,Nle=[xae,Iae,Cae,Tae,Dae,Mae,Oae,Fae,Uae,Vae,Wae,Gae,Kae,Xae,Jae,tie,nie,iie,oie,sie,lie,gie,mie,yie,bie,Cie,Eie,Aie,Wre,Oie,Vie,Xie,toe,roe,aoe,ioe,soe,coe,hoe,doe,yoe,boe,koe,woe,Coe,Eoe,Noe,Aoe,Moe,Ooe,Poe,Loe,zoe,Uoe,joe,Hoe,Koe,Qoe,tse,rse,ose,use,hse,dse,pse,gse,bse,xse,Ise,Vre,Sse,zie,_se,Ese,Dse,qre,Rse,Ose,Fse,Lse,zse,Use,jse,Hse,Kse,Xse,Jse,eue,tue,nue,iue,oue,sue,uue,cue,hue,pue,gue,Cue,oae,Tue,Nue,Aue,Mue,xie,Fue,Zue,zue,jue,Hue,Xre,Gue,que,Kue,Yue,Que,Iie,bue,$ue,tce,rce,uae,oce,uce,hce,dce,gce,yce,kce,wce,Cce,Tce,Nce,Ace,Mce,Fce,Lce,zce,vie,Sue,Uce,Vce,jce,Wce,Hce,Gce,qce,Kce,Qce,Jce,tle,nle,rle,ile,ole,sle,ule,wue,gae,lle,fle,dle,gle,xle,Ile,yae,Sle,Cle,Tle,Lue];Ele<Nle.length;Ele++){rU(Nle[Ele])}function Dle(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ale(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Rle(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=Dle,n=function(t,n){return Dle(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===Dle||e===Ale?e:Mle,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=a(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return i>n&&r(e[i-1],t)>-r(e[i],t)?i-1:i},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}function Mle(){return 0}var Ole=Math.sqrt(50),Fle=Math.sqrt(10),Ple=Math.sqrt(2);function Lle(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(o)),u=o/Math.pow(10,s),c=u>=Ole?10:u>=Fle?5:u>=Ple?2:1;return s<0?(i=Math.pow(10,-s)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,s)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?Lle(e,t,2*n):[r,a,i]}function Zle(e,t,n){return Lle(e=+e,t=+t,n=+n)[2]}function zle(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?Zle(t,e,n):Zle(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}var Ble=1e3,Ule=6e4,Vle=36e5,jle=864e5,Wle=6048e5,Hle=2592e6,Gle=31536e6,qle=new Date,Kle=new Date;function Yle(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return s;do{s.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return s},a.filter=function(n){return Yle((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return qle.setTime(+t),Kle.setTime(+r),e(qle),e(Kle),Math.floor(n(qle,Kle))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var Xle=Yle((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));Xle.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Yle((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Xle:null};Xle.range;var Qle=Yle((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Ble)}),(function(e,t){return(t-e)/Ble}),(function(e){return e.getUTCSeconds()})),Jle=(Qle.range,Yle((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ble)}),(function(e,t){e.setTime(+e+t*Ule)}),(function(e,t){return(t-e)/Ule}),(function(e){return e.getMinutes()}))),$le=(Jle.range,Yle((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Ule)}),(function(e,t){return(t-e)/Ule}),(function(e){return e.getUTCMinutes()}))),ehe=($le.range,Yle((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ble-e.getMinutes()*Ule)}),(function(e,t){e.setTime(+e+t*Vle)}),(function(e,t){return(t-e)/Vle}),(function(e){return e.getHours()}))),the=(ehe.range,Yle((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Vle)}),(function(e,t){return(t-e)/Vle}),(function(e){return e.getUTCHours()}))),nhe=(the.range,Yle((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ule)/jle}),(function(e){return e.getDate()-1}))),rhe=(nhe.range,Yle((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/jle}),(function(e){return e.getUTCDate()-1}))),ahe=(rhe.range,Yle((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/jle}),(function(e){return Math.floor(e/jle)})));ahe.range;function ihe(e){return Yle((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ule)/Wle}))}var ohe=ihe(0),she=ihe(1),uhe=ihe(2),che=ihe(3),lhe=ihe(4),hhe=ihe(5),fhe=ihe(6);ohe.range,she.range,uhe.range,che.range,lhe.range,hhe.range,fhe.range;function dhe(e){return Yle((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/Wle}))}var phe=dhe(0),vhe=dhe(1),ghe=dhe(2),mhe=dhe(3),yhe=dhe(4),bhe=dhe(5),khe=dhe(6),xhe=(phe.range,vhe.range,ghe.range,mhe.range,yhe.range,bhe.range,khe.range,Yle((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),whe=(xhe.range,Yle((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Ihe=(whe.range,Yle((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Ihe.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Yle((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};Ihe.range;var She=Yle((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));She.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Yle((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};She.range;function Che(e,t,n,r,a,i){var o=[[Qle,1,Ble],[Qle,5,5e3],[Qle,15,15e3],[Qle,30,3e4],[i,1,Ule],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,Vle],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,jle],[r,2,1728e5],[n,1,Wle],[t,1,Hle],[t,3,7776e6],[e,1,Gle]];function s(t,n,r){var a=Math.abs(n-t)/r,i=Rle((function(e){return l(e,3)[2]})).right(o,a);if(i===o.length)return e.every(zle(t/Gle,n/Gle,r));if(0===i)return Xle.every(Math.max(zle(t,n,r),1));var s=l(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),u=s[0],c=s[1];return u.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:s(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},s]}var _he=l(Che(She,whe,phe,ahe,the,$le),2),The=(_he[0],_he[1],l(Che(Ihe,xhe,ohe,nhe,ehe,Jle),2)),Ehe=The[0],Nhe=The[1];function Dhe(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ahe(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Rhe(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Mhe,Ohe,Fhe={"-":"",_:" ",0:"0"},Phe=/^\s*\d+/,Lhe=/^%/,Zhe=/[\\^$*+?|[\]().{}]/g;function zhe(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Bhe(e){return e.replace(Zhe,"\\$&")}function Uhe(e){return new RegExp("^(?:"+e.map(Bhe).join("|")+")","i")}function Vhe(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function jhe(e,t,n){var r=Phe.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Whe(e,t,n){var r=Phe.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Hhe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ghe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function qhe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Khe(e,t,n){var r=Phe.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Yhe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Xhe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Qhe(e,t,n){var r=Phe.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Jhe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function $he(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function efe(e,t,n){var r=Phe.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function tfe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function nfe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function rfe(e,t,n){var r=Phe.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function afe(e,t,n){var r=Phe.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function ife(e,t,n){var r=Phe.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ofe(e,t,n){var r=Lhe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function sfe(e,t,n){var r=Phe.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function ufe(e,t,n){var r=Phe.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function cfe(e,t){return zhe(e.getDate(),t,2)}function lfe(e,t){return zhe(e.getHours(),t,2)}function hfe(e,t){return zhe(e.getHours()%12||12,t,2)}function ffe(e,t){return zhe(1+nhe.count(Ihe(e),e),t,3)}function dfe(e,t){return zhe(e.getMilliseconds(),t,3)}function pfe(e,t){return dfe(e,t)+"000"}function vfe(e,t){return zhe(e.getMonth()+1,t,2)}function gfe(e,t){return zhe(e.getMinutes(),t,2)}function mfe(e,t){return zhe(e.getSeconds(),t,2)}function yfe(e){var t=e.getDay();return 0===t?7:t}function bfe(e,t){return zhe(ohe.count(Ihe(e)-1,e),t,2)}function kfe(e){var t=e.getDay();return t>=4||0===t?lhe(e):lhe.ceil(e)}function xfe(e,t){return e=kfe(e),zhe(lhe.count(Ihe(e),e)+(4===Ihe(e).getDay()),t,2)}function wfe(e){return e.getDay()}function Ife(e,t){return zhe(she.count(Ihe(e)-1,e),t,2)}function Sfe(e,t){return zhe(e.getFullYear()%100,t,2)}function Cfe(e,t){return zhe((e=kfe(e)).getFullYear()%100,t,2)}function _fe(e,t){return zhe(e.getFullYear()%1e4,t,4)}function Tfe(e,t){var n=e.getDay();return zhe((e=n>=4||0===n?lhe(e):lhe.ceil(e)).getFullYear()%1e4,t,4)}function Efe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+zhe(t/60|0,"0",2)+zhe(t%60,"0",2)}function Nfe(e,t){return zhe(e.getUTCDate(),t,2)}function Dfe(e,t){return zhe(e.getUTCHours(),t,2)}function Afe(e,t){return zhe(e.getUTCHours()%12||12,t,2)}function Rfe(e,t){return zhe(1+rhe.count(She(e),e),t,3)}function Mfe(e,t){return zhe(e.getUTCMilliseconds(),t,3)}function Ofe(e,t){return Mfe(e,t)+"000"}function Ffe(e,t){return zhe(e.getUTCMonth()+1,t,2)}function Pfe(e,t){return zhe(e.getUTCMinutes(),t,2)}function Lfe(e,t){return zhe(e.getUTCSeconds(),t,2)}function Zfe(e){var t=e.getUTCDay();return 0===t?7:t}function zfe(e,t){return zhe(phe.count(She(e)-1,e),t,2)}function Bfe(e){var t=e.getUTCDay();return t>=4||0===t?yhe(e):yhe.ceil(e)}function Ufe(e,t){return e=Bfe(e),zhe(yhe.count(She(e),e)+(4===She(e).getUTCDay()),t,2)}function Vfe(e){return e.getUTCDay()}function jfe(e,t){return zhe(vhe.count(She(e)-1,e),t,2)}function Wfe(e,t){return zhe(e.getUTCFullYear()%100,t,2)}function Hfe(e,t){return zhe((e=Bfe(e)).getUTCFullYear()%100,t,2)}function Gfe(e,t){return zhe(e.getUTCFullYear()%1e4,t,4)}function qfe(e,t){var n=e.getUTCDay();return zhe((e=n>=4||0===n?yhe(e):yhe.ceil(e)).getUTCFullYear()%1e4,t,4)}function Kfe(){return"+0000"}function Yfe(){return"%"}function Xfe(e){return+e}function Qfe(e){return Math.floor(+e/1e3)}Mhe=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,c=Uhe(a),l=Vhe(a),h=Uhe(i),f=Vhe(i),d=Uhe(o),p=Vhe(o),v=Uhe(s),g=Vhe(s),m=Uhe(u),y=Vhe(u),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:cfe,e:cfe,f:pfe,g:Cfe,G:Tfe,H:lfe,I:hfe,j:ffe,L:dfe,m:vfe,M:gfe,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Xfe,s:Qfe,S:mfe,u:yfe,U:bfe,V:xfe,w:wfe,W:Ife,x:null,X:null,y:Sfe,Y:_fe,Z:Efe,"%":Yfe},k={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Nfe,e:Nfe,f:Ofe,g:Hfe,G:qfe,H:Dfe,I:Afe,j:Rfe,L:Mfe,m:Ffe,M:Pfe,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Xfe,s:Qfe,S:Lfe,u:Zfe,U:zfe,V:Ufe,w:Vfe,W:jfe,x:null,X:null,y:Wfe,Y:Gfe,Z:Kfe,"%":Yfe},x={a:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:$he,e:$he,f:ife,g:Yhe,G:Khe,H:tfe,I:tfe,j:efe,L:afe,m:Jhe,M:nfe,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:Qhe,Q:sfe,s:ufe,S:rfe,u:Whe,U:Hhe,V:Ghe,w:jhe,W:qhe,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:Yhe,Y:Khe,Z:Xhe,"%":ofe};function w(e,t){return function(n){var r,a,i,o=[],s=-1,u=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(u,s)),null!=(a=Fhe[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),u=s+1);return o.push(e.slice(u,s)),o.join("")}}function I(e,t){return function(n){var r,a,i=Rhe(1900,void 0,1);if(S(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=Ahe(Rhe(i.y,0,1))).getUTCDay(),r=a>4||0===a?vhe.ceil(r):vhe(r),r=rhe.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=Dhe(Rhe(i.y,0,1))).getDay(),r=a>4||0===a?she.ceil(r):she(r),r=nhe.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Ahe(Rhe(i.y,0,1)).getUTCDay():Dhe(Rhe(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Ahe(i)):Dhe(i)}}function S(e,t,n,r){for(var a,i,o=0,s=t.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=x[a in Fhe?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),k.x=w(n,k),k.X=w(r,k),k.c=w(t,k),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=I(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",k);return t.toString=function(){return e},t},utcParse:function(e){var t=I(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Ohe=Mhe.format,Mhe.parse,Mhe.utcFormat,Mhe.utcParse;var Jfe=Rle(Dle),$fe=Jfe.right,ede=(Jfe.left,Rle((function(e){return null===e?NaN:+e})).center,$fe);function tde(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function nde(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function rde(){}var ade=.7,ide=1/ade,ode="\\s*([+-]?\\d+)\\s*",sde="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ude="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cde=/^#([0-9a-f]{3,8})$/,lde=new RegExp("^rgb\\(".concat(ode,",").concat(ode,",").concat(ode,"\\)$")),hde=new RegExp("^rgb\\(".concat(ude,",").concat(ude,",").concat(ude,"\\)$")),fde=new RegExp("^rgba\\(".concat(ode,",").concat(ode,",").concat(ode,",").concat(sde,"\\)$")),dde=new RegExp("^rgba\\(".concat(ude,",").concat(ude,",").concat(ude,",").concat(sde,"\\)$")),pde=new RegExp("^hsl\\(".concat(sde,",").concat(ude,",").concat(ude,"\\)$")),vde=new RegExp("^hsla\\(".concat(sde,",").concat(ude,",").concat(ude,",").concat(sde,"\\)$")),gde={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function mde(){return this.rgb().formatHex()}function yde(){return this.rgb().formatRgb()}function bde(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cde.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?kde(t):3===n?new Ide(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?xde(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?xde(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=lde.exec(e))?new Ide(t[1],t[2],t[3],1):(t=hde.exec(e))?new Ide(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=fde.exec(e))?xde(t[1],t[2],t[3],t[4]):(t=dde.exec(e))?xde(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=pde.exec(e))?Nde(t[1],t[2]/100,t[3]/100,1):(t=vde.exec(e))?Nde(t[1],t[2]/100,t[3]/100,t[4]):gde.hasOwnProperty(e)?kde(gde[e]):"transparent"===e?new Ide(NaN,NaN,NaN,0):null}function kde(e){return new Ide(e>>16&255,e>>8&255,255&e,1)}function xde(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ide(e,t,n,r)}function wde(e,t,n,r){return 1===arguments.length?((a=e)instanceof rde||(a=bde(a)),a?new Ide((a=a.rgb()).r,a.g,a.b,a.opacity):new Ide):new Ide(e,t,n,null==r?1:r);var a}function Ide(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Sde(){return"#".concat(Ede(this.r)).concat(Ede(this.g)).concat(Ede(this.b))}function Cde(){var e=_de(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Tde(this.r),", ").concat(Tde(this.g),", ").concat(Tde(this.b)).concat(1===e?")":", ".concat(e,")"))}function _de(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tde(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ede(e){return((e=Tde(e))<16?"0":"")+e.toString(16)}function Nde(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ade(e,t,n,r)}function Dde(e){if(e instanceof Ade)return new Ade(e.h,e.s,e.l,e.opacity);if(e instanceof rde||(e=bde(e)),!e)return new Ade;if(e instanceof Ade)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,s=i-a,u=(i+a)/2;return s?(o=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=u<.5?i+a:2-i-a,o*=60):s=u>0&&u<1?0:o,new Ade(o,s,u,e.opacity)}function Ade(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Rde(e){return(e=(e||0)%360)<0?e+360:e}function Mde(e){return Math.max(0,Math.min(1,e||0))}function Ode(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Fde(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}tde(rde,bde,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:mde,formatHex:mde,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Dde(this).formatHsl()},formatRgb:yde,toString:yde}),tde(Ide,wde,nde(rde,{brighter:function(e){return e=null==e?ide:Math.pow(ide,e),new Ide(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?ade:Math.pow(ade,e),new Ide(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new Ide(Tde(this.r),Tde(this.g),Tde(this.b),_de(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sde,formatHex:Sde,formatHex8:function(){return"#".concat(Ede(this.r)).concat(Ede(this.g)).concat(Ede(this.b)).concat(Ede(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Cde,toString:Cde})),tde(Ade,(function(e,t,n,r){return 1===arguments.length?Dde(e):new Ade(e,t,n,null==r?1:r)}),nde(rde,{brighter:function(e){return e=null==e?ide:Math.pow(ide,e),new Ade(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?ade:Math.pow(ade,e),new Ade(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Ide(Ode(e>=240?e-240:e+120,a,r),Ode(e,a,r),Ode(e<120?e+240:e-120,a,r),this.opacity)},clamp:function(){return new Ade(Rde(this.h),Mde(this.s),Mde(this.l),_de(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=_de(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Rde(this.h),", ").concat(100*Mde(this.s),"%, ").concat(100*Mde(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));var Pde=function(e){return function(){return e}};function Lde(e,t){return function(n){return e+n*t}}function Zde(e){return 1===(e=+e)?zde:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Pde(isNaN(t)?n:t)}}function zde(e,t){var n=t-e;return n?Lde(e,n):Pde(isNaN(e)?t:e)}var Bde=function e(t){var n=Zde(t);function r(e,t){var r=n((e=wde(e)).r,(t=wde(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=zde(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Ude(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=wde(t[n]),i[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return i=e(i),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=s(e),r+""}}}Ude((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,s=r<t-1?e[r+2]:2*i-a;return Fde((n-r/t)*t,o,a,i,s)}})),Ude((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Fde((n-r/t)*t,a,i,o,s)}}));function Vde(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Xde(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function jde(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Wde(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Hde(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Xde(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var Gde=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qde=new RegExp(Gde.source,"g");function Kde(e,t){var n,r,a,i=Gde.lastIndex=qde.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=Gde.exec(e))&&(r=qde.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Wde(n,r)})),i=qde.lastIndex;return i<t.length&&(a=t.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function Yde(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function Xde(e,t){var n,r=typeof t;return null==t||"boolean"===r?Pde(t):("number"===r?Wde:"string"===r?(n=bde(t))?(t=n,Bde):Kde:t instanceof bde?Bde:t instanceof Date?jde:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?Yde:Array.isArray(t)?Vde:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Hde:Wde)(e,t)}function Qde(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Jde(e){return+e}var $de=[0,1];function epe(e){return e}function tpe(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function npe(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=tpe(a,r),i=n(o,i)):(r=tpe(r,a),i=n(i,o)),function(e){return i(r(e))}}function rpe(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=tpe(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=ede(e,t,1,r)-1;return i[n](a[n](t))}}function ape(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ipe(){var e,t,n,r,a,i,o=$de,s=$de,u=Xde,c=epe;function l(){var e=Math.min(o.length,s.length);return c!==epe&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?rpe:npe,a=i=null,h}function h(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),s,u)))(e(c(t)))}return h.invert=function(n){return c(t((i||(i=r(s,o.map(e),Wde)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,Jde),l()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),l()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),u=Qde,l()},h.clamp=function(e){return arguments.length?(c=!!e||epe,l()):c!==epe},h.interpolate=function(e){return arguments.length?(u=e,l()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,l()}}function ope(){return ipe()(epe,epe)}function spe(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function upe(e){return new Date(e)}function cpe(e){return e instanceof Date?+e:+new Date(+e)}function lpe(e,t,n,r,a,i,o,s,u,c){var l=ope(),h=l.invert,f=l.domain,d=c(".%L"),p=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),b=c("%B"),k=c("%Y");function x(e){return(u(e)<e?d:s(e)<e?p:o(e)<e?v:i(e)<e?g:r(e)<e?a(e)<e?m:y:n(e)<e?b:k)(e)}return l.invert=function(e){return new Date(h(e))},l.domain=function(e){return arguments.length?f(Array.from(e,cpe)):f().map(upe)},l.ticks=function(t){var n=f();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?x:c(t)},l.nice=function(e){var n=f();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?f(function(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}(n,e)):l},l.copy=function(){return ape(l,lpe(e,t,n,r,a,i,o,s,u,c))},l}function hpe(){return spe.apply(lpe(Ehe,Nhe,Ihe,xhe,ohe,nhe,ehe,Jle,Qle,Ohe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var fpe,dpe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ppe(e){if(!(t=dpe.exec(e)))throw new Error("invalid format: "+e);var t;return new vpe({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function vpe(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function gpe(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function mpe(e){return(e=gpe(Math.abs(e)))?e[1]:NaN}function ype(e,t){var n=gpe(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}ppe.prototype=vpe.prototype,vpe.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var bpe={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return ype(100*e,t)},r:ype,s:function(e,t){var n=gpe(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(fpe=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+gpe(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function kpe(e){return e}var xpe,wpe,Ipe,Spe=Array.prototype.map,Cpe=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function _pe(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?kpe:(t=Spe.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,s=t[0],u=0;a>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),i.push(e.substring(a-=s,a+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?kpe:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Spe.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=ppe(e)).fill,n=e.align,h=e.sign,f=e.symbol,d=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):bpe[y]||(void 0===g&&(g=12),m=!0,y="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var b="$"===f?a:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",k="$"===f?i:/[%p]/.test(y)?u:"",x=bpe[y],w=/[defgprs%]/.test(y);function I(e){var a,i,u,f=b,I=k;if("c"===y)I=x(e)+I,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:x(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),S&&0===+e&&"+"!==h&&(S=!1),f=(S?"("===h?h:c:"-"===h||"("===h?"":h)+f,I=("s"===y?Cpe[8+fpe/3]:"")+I+(S&&"("===h?")":""),w)for(a=-1,i=e.length;++a<i;)if(48>(u=e.charCodeAt(a))||u>57){I=(46===u?o+e.slice(a+1):e.slice(a))+I,e=e.slice(0,a);break}}v&&!d&&(e=r(e,1/0));var C=f.length+e.length+I.length,_=C<p?new Array(p-C+1).join(t):"";switch(v&&d&&(e=r(_+e,_.length?p-I.length:1/0),_=""),n){case"<":e=f+e+I+_;break;case"=":e=f+_+e+I;break;case"^":e=_.slice(0,C=_.length>>1)+f+e+I+_.slice(C);break;default:e=_+f+e+I}return s(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),I.toString=function(){return e+""},I}return{format:h,formatPrefix:function(e,t){var n=h(((e=ppe(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(mpe(t)/3))),a=Math.pow(10,-r),i=Cpe[8+r/3];return function(e){return n(a*e)+i}}}}function Tpe(e,t,n,r){var a,i=zle(e,t,n);switch((r=ppe(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mpe(t)/3)))-mpe(Math.abs(e)))}(i,o))||(r.precision=a),Ipe(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mpe(t)-mpe(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-mpe(Math.abs(e)))}(i))||(r.precision=a-2*("%"===r.type))}return wpe(r)}function Epe(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,a=l(r?Lle(t,e,n):Lle(e,t,n),3),i=a[0],o=a[1],s=a[2];if(!(o>=i))return[];var u=o-i+1,c=new Array(u);if(r)if(s<0)for(var h=0;h<u;++h)c[h]=(o-h)/-s;else for(var f=0;f<u;++f)c[f]=(o-f)*s;else if(s<0)for(var d=0;d<u;++d)c[d]=(i+d)/-s;else for(var p=0;p<u;++p)c[p]=(i+p)*s;return c}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Tpe(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,s=i.length-1,u=i[o],c=i[s],l=10;for(c<u&&(a=u,u=c,c=a,a=o,o=s,s=a);l-- >0;){if((a=Zle(u,c,n))===r)return i[o]=u,i[s]=c,t(i);if(a>0)u=Math.floor(u/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;u=Math.ceil(u*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function Npe(){var e=ope();return e.copy=function(){return ape(e,Npe())},spe.apply(e,arguments),Epe(e)}function Dpe(){var e=l((0,r.useState)([]),2),t=e[0],n=e[1],a=CE().user,i=KE("users/".concat(null===a||void 0===a?void 0:a.uid,"/sales")),o=i.documents,s=i.error,u=(0,r.useMemo)((function(){if(s)return[];var e,t=(0,qP.default)(new Date),r=Array.from({length:3},(function(e,n){return(0,KP.default)(t,n+1)}));if(o&&o.length>0){var a=o.map((function(e){return[e.dateTime.toDate().getTime(),parseFloat(e.transactionAmount)||0]})),i=hpe().domain([a[0][0],a[a.length-1][0]]).range([0,1]),u=Npe().domain([0,Math.max.apply(Math,d(a.map((function(e){return l(e,2)[1]}))))]).range([0,1]),c=a.map((function(e){var t=l(e,2),n=t[0],r=t[1];return[i(n),u(r)]})),h=GG(c.map((function(e){return l(e,1)[0]})),[c.length,1]),f=GG(c.map((function(e){return l(e,2)[1]})),[c.length,1]),p=new x1(e);p.add(new L2({units:1,inputShape:[1]})),p.compile({loss:"meanSquaredError",optimizer:"adam"}),p.fit(h,f,{epochs:100}).then((function(){var e=r.map((function(e){var t;return{date:e,amount:u.invert((null===(t=p.predict(GG([i(new Date(e).getTime())],[1,1])))||void 0===t?void 0:t.dataSync()[0])||0)}}));n(e)}))}else n([]);return[]}),[o,s]);(0,r.useEffect)((function(){n(u)}),[u]);var c={labels:t.map((function(e){return e.date.toLocaleDateString()})),datasets:[{label:"Revenue",data:t.map((function(e){return e.amount})),fill:!1,borderColor:"#888888",tension:.1}]};return(0,xE.jsxs)("div",{className:YE.metricsContainer,children:[(0,xE.jsx)("h3",{children:"Sales Prediction For The Next 3 Months"}),(0,xE.jsx)("div",{className:YE.chartContainer,children:(0,xE.jsx)("div",{className:YE.centered,children:(0,xE.jsx)(jP,{data:c})})})]})}!function(e){xpe=_pe(e),wpe=xpe.format,Ipe=xpe.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]}),RO.register.apply(RO,d(MP));function Ape(){var e,t,n=CE().user,a=KE("users/".concat(n.uid,"/salesitems")),i=a.documents,o=a.error,s=l((0,r.useState)([]),2),u=s[0],c=s[1],h=l((0,r.useState)(!0),2),f=h[0],d=h[1];if((0,r.useEffect)((function(){if(i){var e=i.reduce((function(e,t){var n=t.productId,r=t.productName,a=t.quantity;return e[n]||(e[n]={productId:n,productName:r,totalQuantity:0}),e[n].totalQuantity+=parseInt(a),e}),{}),t=Object.values(e).sort((function(e,t){return t.totalQuantity-e.totalQuantity})),n=t.slice(0,5);c(n),d(!1)}}),[i]),f)return(0,xE.jsx)("p",{children:"Loading..."});if(o)return(0,xE.jsxs)("p",{children:["Error occurred: ",o.message]});var p={labels:null!==(e=null===u||void 0===u?void 0:u.map((function(e){return e.productName})))&&void 0!==e?e:[],datasets:[{data:null!==(t=null===u||void 0===u?void 0:u.map((function(e){return e.totalQuantity})))&&void 0!==t?t:[],backgroundColor:["#000000","#444444","#777777","#aaaaaa","#dddddd"],hoverBackgroundColor:["#000000","#444444","#777777","#aaaaaa","#dddddd"]}]};return(0,xE.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,xE.jsxs)("div",{style:{width:"25%"},children:[(0,xE.jsx)("h3",{style:{textAlign:"center"},children:"Top 5 All-Time Best Selling Products"}),u.length>0?(0,xE.jsx)(WP,{data:p,options:{plugins:{legend:{display:!0,position:"bottom"}},responsive:!0,animation:{animateRotate:!0,animateScale:!0}}}):(0,xE.jsx)("p",{children:"No data available."})]})})}function Rpe(){var e=l((0,r.useState)([]),2),t=e[0],n=e[1],a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)(0),2),u=s[0],c=s[1],h=l((0,r.useState)(0),2),f=h[0],d=h[1],p=l((0,r.useState)(0),2),v=p[0],g=p[1],m=CE().user,y=KE("users/".concat(null===m||void 0===m?void 0:m.uid,"/restocks")),b=y.documents,k=y.error,x=KE("users/".concat(null===m||void 0===m?void 0:m.uid,"/sales")),w=x.documents,I=x.error;return(0,r.useEffect)((function(){if(k||I)console.log("Error retrieving data");else if(b&&w){var e={};w.forEach((function(t){try{var n=(0,HP.default)(new Date(t.dateTime.toDate()),"yyyy-MM");e[n]||(e[n]={revenue:0,costs:0,profit:0}),e[n].revenue+=parseFloat(t.transactionAmount)||0}catch(r){console.log("Error formatting date in sale:",t),console.log("Error formatting date:",r)}})),b.forEach((function(t){try{var n=(0,HP.default)(new Date(t.dateTime.toDate()),"yyyy-MM");e[n]&&(e[n].costs+=parseFloat(t.transactionAmount)||0)}catch(r){console.log("Error formatting date in restock:",t),console.log("Error formatting date:",r)}})),Object.keys(e).forEach((function(t){var n=e[t],r=n.revenue,a=n.costs;e[t].profit=parseFloat(r)-parseFloat(a)})),n(Object.entries(e)),n((function(e){return e.sort((function(e,t){var n=l(e,1)[0],r=l(t,1)[0];return new Date(n)-new Date(r)}))}));var t=function(e){return e.reduce((function(e,t){return e+(parseFloat(t.transactionAmount)||0)}),0)},r=function(e){return e.reduce((function(e,t){return e+(parseFloat(t.transactionAmount)||0)}),0)},a=t(w),i=function(e,n){return t(e)-r(n)}(w,b),o=r(b);c(a),d(i),g(o)}}),[b,w,k,I]),(0,r.useEffect)((function(){if(t.length>0){var e=t.map((function(e){return l(e,1)[0]})),n=t.map((function(e){var t=l(e,2);t[0];return t[1].revenue})),r=t.map((function(e){var t=l(e,2);t[0];return t[1].profit})),a=t.map((function(e){var t=l(e,2);t[0];return t[1].costs}));o({labels:e,datasets:[{label:"Revenue",data:n,borderColor:"#"},{label:"Profit",data:r,borderColor:"#858585"},{label:"Costs",data:a,borderColor:"#CCCCCC"}]})}}),[t]),(0,xE.jsxs)("div",{className:YE.metricsContainer,children:[(0,xE.jsx)("h3",{children:"Overall Sales Metrics"}),(0,xE.jsxs)("div",{className:YE.metrics,children:[(0,xE.jsxs)("p",{children:["Lifetime Revenue: $",u.toFixed(2)]}),(0,xE.jsxs)("p",{children:["Lifetime Costs: $",parseFloat(v).toFixed(2)]}),(0,xE.jsxs)("p",{children:["Lifetime Profit: $",f.toFixed(2)]}),(0,xE.jsxs)("p",{children:["Inventory Turnover: ",(0,xE.jsx)(GP,{})]})]}),(0,xE.jsx)("br",{}),(0,xE.jsx)("h3",{children:"Revenue, Profit and Costs across Months"}),(0,xE.jsx)("div",{className:YE.chartContainer,children:(0,xE.jsx)("div",{className:YE.centered,children:i?(0,xE.jsx)("div",{children:(0,xE.jsx)(jP,{data:i})}):(0,xE.jsx)("p",{children:"No data available for chart."})})}),(0,xE.jsx)("div",{children:(0,xE.jsx)(Dpe,{})}),(0,xE.jsx)("div",{children:(0,xE.jsx)(Ape,{})})]})}var Mpe=n(4888),Ope=n(9420),Fpe=n(8527),Ppe=n(4522);var Lpe=n(4690),Zpe=n(9513),zpe=n.n(Zpe);function Bpe(e){var t=e.startDate,n=e.endDate,a=CE().user,i=KE("users/".concat(a.uid,"/products")),o=i.documents,s=i.error,u=KE("users/".concat(a.uid,"/restockitems")),c=u.documents,h=u.error,f=KE("users/".concat(a.uid,"/salesitems")),d=f.documents,p=f.error,v=KE("users/".concat(a.uid,"/sales")),g=v.documents,m=v.error,y=l((0,r.useState)(0),2),b=y[0],k=y[1],x=l((0,r.useState)(!0),2),w=x[0],I=x[1];return(0,r.useEffect)((function(){if(o&&c&&d&&g){var e=function(e,t,n,r){var a=t.filter((function(e){var t=new Date(e.date);return t>=n&&t<=r}));return e.filter((function(e){return a.some((function(t){return t.transactionID===e.transactionID}))}))}(d,g,t,n),r=function(e,t){var n=t.reduce((function(t,n){var r=e.find((function(e){return e.productId===n.productId}));return r?t+r.quantity*r.costPrice:t}),0);return n}(c,e),a=function(e){var t=e.reduce((function(e,t){var n=t.totalQuantity,r=t.batchDetails;if(r&&r.length>0){var a=r[r.length-1];if(a&&a.costPrice)return e+n*a.costPrice}return e}),0),n=t/e.length;return n}(o);if(a>0)k(r/a);else k(0);I(!1)}}),[o,c,d,g,t,n]),w?"Loading...":s||h||p||m?(0,xE.jsxs)("p",{children:["Error occurred:"," ",s||h||p||m]}):b.toFixed(2)}function Upe(e){var t,n,a=e.startDate,i=e.endDate,o=CE().user,s=KE("users/".concat(o.uid,"/salesitems")),u=s.documents,c=s.error,h=KE("users/".concat(o.uid,"/sales")),f=h.documents,d=h.error,p=l((0,r.useState)([]),2),v=p[0],g=p[1],m=l((0,r.useState)(!0),2),y=m[0],b=m[1];if((0,r.useEffect)((function(){if(u&&f){var e=u.reduce((function(e,t){var n=t.productId,r=t.productName,o=t.quantity,s=t.transactionID,u=f.find((function(e){return e.transactionID===s}));if(u){var c=new Date(u.dateTime.toDate());c>=a&&c<=i&&(e[n]||(e[n]={productId:n,productName:r,totalQuantity:0}),e[n].totalQuantity+=parseInt(o))}return e}),{}),t=Object.values(e).sort((function(e,t){return t.totalQuantity-e.totalQuantity})),n=t.slice(0,5);g(n),b(!1)}}),[u,f,a,i]),y)return(0,xE.jsx)("p",{children:"Loading..."});if(c||d)return(0,xE.jsxs)("p",{children:["Error occurred: ",(null===c||void 0===c?void 0:c.message)||(null===d||void 0===d?void 0:d.message)]});var k={labels:null!==(t=null===v||void 0===v?void 0:v.map((function(e){return e.productName})))&&void 0!==t?t:[],datasets:[{data:null!==(n=null===v||void 0===v?void 0:v.map((function(e){return e.totalQuantity})))&&void 0!==n?n:[],backgroundColor:["#000000","#444444","#777777","#aaaaaa","#dddddd"],hoverBackgroundColor:["#000000","#444444","#777777","#aaaaaa","#dddddd"]}]};return(0,xE.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,xE.jsxs)("div",{style:{width:"25%"},children:[(0,xE.jsxs)("h3",{style:{textAlign:"center"},children:["Top 5 Best Selling Products Between"," ",a.toISOString().split("T")[0]," and"," ",i.toISOString().split("T")[0]]}),(0,xE.jsx)("br",{}),v.length>0?(0,xE.jsx)(WP,{data:k,options:{plugins:{legend:{display:!0,position:"bottom"}},responsive:!0,animation:{animateRotate:!0,animateScale:!0}}}):(0,xE.jsx)("p",{children:"No data available."})]})})}var Vpe=function(e){var t=e.chartData,n={labels:t.map((function(e){return e.date})),datasets:[{label:"Daily Revenue",data:t.map((function(e){return e.revenue})),fill:!1,borderColor:"#333333",tension:.1},{label:"Daily Costs",data:t.map((function(e){return e.costs})),fill:!1,borderColor:"#ffffff",tension:.1},{label:"Daily Profit",data:t.map((function(e){return e.profit})),fill:!1,borderColor:"#858585",tension:.1}]};return(0,xE.jsx)(jP,{data:n})};function jpe(){var e=l((0,r.useState)(0),2),t=e[0],n=e[1],a=l((0,r.useState)(0),2),i=a[0],o=a[1],s=l((0,r.useState)(0),2),u=s[0],c=s[1],h=l((0,r.useState)((0,qP.default)(new Date)),2),f=h[0],d=h[1],p=l((0,r.useState)((0,Mpe.default)(new Date)),2),v=p[0],g=p[1],m=l((0,r.useState)([]),2),y=m[0],b=m[1],k=CE().user,x=KE("users/".concat(null===k||void 0===k?void 0:k.uid,"/restocks")),w=x.documents,I=x.error,S=KE("users/".concat(null===k||void 0===k?void 0:k.uid,"/sales")),C=S.documents,_=S.error;return(0,r.useEffect)((function(){if(I||_)console.log("Error retrieving data");else if(w&&C){var e=C.filter((function(e){return e.dateTime&&(0,Ope.default)(e.dateTime.toDate(),f)&&(0,Ope.default)(v,e.dateTime.toDate())})),t=w.filter((function(e){return e.dateTime&&(0,Ope.default)(e.dateTime.toDate(),f)&&(0,Ope.default)(v,e.dateTime.toDate())})),r=function(e,t){var n;(0,Ppe.Z)(1,arguments);var r=e||{},a=(0,Fpe.default)(r.start),i=(0,Fpe.default)(r.end).getTime();if(!(a.getTime()<=i))throw new RangeError("Invalid interval");var o=[],s=a;s.setHours(0,0,0,0);var u=Number(null!==(n=null===t||void 0===t?void 0:t.step)&&void 0!==n?n:1);if(u<1||isNaN(u))throw new RangeError("`options.step` must be a number greater than 1");for(;s.getTime()<=i;)o.push((0,Fpe.default)(s)),s.setDate(s.getDate()+u),s.setHours(0,0,0,0);return o}({start:f,end:v}),a=r.map((function(n){var r=e.filter((function(e){return(0,Lpe.default)(e.dateTime.toDate(),n)})),a=t.filter((function(e){return(0,Lpe.default)(e.dateTime.toDate(),n)})),i=function(e){return parseFloat(e.reduce((function(e,t){return e+(t.transactionAmount||0)}),0)).toFixed(2)}(r),o=function(e){return parseFloat(e.reduce((function(e,t){return e+(t.transactionAmount||0)}),0)).toFixed(2)}(a),s=parseFloat(i)-parseFloat(o);return{date:n.toLocaleDateString(),revenue:parseFloat(i).toFixed(2),costs:parseFloat(o).toFixed(2),profit:parseFloat(s).toFixed(2)}}));b(a);var i=0,s=0,u=0;a.forEach((function(e){i+=parseFloat(e.revenue),s+=parseFloat(e.profit),u+=parseFloat(e.costs)})),n(i),o(s),c(u)}}),[w,C,I,_,f,v]),(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsxs)("div",{className:YE.metricsContainer,children:[(0,xE.jsx)("h2",{children:"Custom Sales Metrics"}),(0,xE.jsx)("br",{}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"20px"},children:[(0,xE.jsx)("div",{style:{display:"flex",alignItems:"center",marginRight:"10px"},children:(0,xE.jsxs)("div",{className:YE.datePicker,children:[(0,xE.jsx)("label",{style:{marginRight:"10px"},children:"Start Date:"}),(0,xE.jsx)(zpe(),{selected:f,onChange:function(e){return d(e)},selectsStart:!0,startDate:f,endDate:v,dateFormat:"yyyy-MM-dd",style:{padding:"8px",border:"1px solid #ccc",borderRadius:"5px",fontSize:"14px"}})]})}),(0,xE.jsx)("div",{className:YE.datePicker,children:(0,xE.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,xE.jsx)("label",{style:{marginRight:"10px"},children:"End Date:"}),(0,xE.jsx)(zpe(),{selected:v,onChange:function(e){return g(e)},selectsEnd:!0,startDate:f,endDate:v,minDate:f,dateFormat:"yyyy-MM-dd",style:{padding:"8px",border:"1px solid #ccc",borderRadius:"5px",fontSize:"14px"}})]})})]}),(0,xE.jsxs)("div",{className:YE.metrics,children:[(0,xE.jsxs)("p",{children:["Total Revenue: $",t.toFixed(2)]}),(0,xE.jsxs)("p",{children:["Total Costs: $",u.toFixed(2)]}),(0,xE.jsxs)("p",{children:["Total Profit: $",i.toFixed(2)]}),(0,xE.jsxs)("p",{children:["Inventory Turnover:"," ",(0,xE.jsx)(Bpe,{startDate:f,endDate:v})]})]})]}),(0,xE.jsx)("div",{className:YE.chartContainer,children:(0,xE.jsx)("div",{className:YE.centered,children:(0,xE.jsx)(Vpe,{chartData:y})})}),(0,xE.jsx)("div",{className:YE.metricsContainer,children:(0,xE.jsx)(Upe,{startDate:f,endDate:v})})]})}function Wpe(){var e=CE().user,t=function(){var e=l((0,r.useState)(!0),2),t=e[0],n=e[1];return(0,xE.jsxs)("div",{className:YE.container,children:[(0,xE.jsx)("div",{className:YE.buttonContainer,children:(0,xE.jsxs)("div",{className:YE.toggleButton,children:[(0,xE.jsx)("div",{className:"".concat(YE.toggleOption," ").concat(t?YE.active:""),onClick:function(){n(!0)},children:"Overall Dashboard"}),(0,xE.jsx)("div",{className:"".concat(YE.toggleOption," ").concat(t?"":YE.active),onClick:function(){n(!1)},children:"Custom Dashboard"})]})}),(0,xE.jsx)("br",{}),(0,xE.jsx)("div",{className:YE.sidebar,children:t?(0,xE.jsx)(Rpe,{}):(0,xE.jsx)(jpe,{})})]})};return(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("div",{className:YE.home,children:(0,xE.jsxs)("h1",{children:["Welcome back, ",e.displayName]})}),(0,xE.jsx)("div",{className:YE.listContainer,children:(0,xE.jsx)(XE,{})}),(0,xE.jsxs)("div",{className:YE.listContainer,children:[(0,xE.jsx)(QE,{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{})]}),(0,xE.jsx)("div",{className:YE.metricsContainer,children:(0,xE.jsx)(t,{})}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{})]})}var Hpe=n(9831),Gpe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},qpe=r.createContext&&r.createContext(Gpe),Kpe=function(){return Kpe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Kpe.apply(this,arguments)},Ype=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function Xpe(e){return e&&e.map((function(e,t){return r.createElement(e.tag,Kpe({key:t},e.attr),Xpe(e.child))}))}function Qpe(e){return function(t){return r.createElement(Jpe,Kpe({attr:Kpe({},e.attr)},t),Xpe(e.child))}}function Jpe(e){var t=function(t){var n,a=e.attr,i=e.size,o=e.title,s=Ype(e,["attr","size","title"]),u=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",Kpe({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,s,{className:n,style:Kpe(Kpe({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&r.createElement("title",null,o),e.children)};return void 0!==qpe?r.createElement(qpe.Consumer,null,(function(e){return t(e)})):t(Gpe)}function $pe(e){return Qpe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}}]})(e)}function eve(e){return Qpe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function tve(){var e=CE().user,t=l((0,r.useState)({date:"",time:"",transactionID:"",transactionAmount:0}),2),n=t[0],a=t[1],i=l((0,r.useState)([{productId:"",productName:"",batchId:"",quantity:"",expiryDate:"",costPrice:""}]),2),o=i[0],s=i[1],u=l((0,r.useState)([]),2),c=u[0],h=u[1],f=l((0,r.useState)([]),2),p=f[0],v=f[1],g=l((0,r.useState)(!1),2),m=g[0],y=g[1];(0,r.useEffect)((function(){var t=function(){var t=Rt(Dt().mark((function t(){var n,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yE.collection("users/".concat(e.uid,"/restockitems")).orderBy("productId").get();case 2:n=t.sent,r=n.docs.reduce((function(e,t){var n=t.data().productId;return e.includes(n)||e.push(n),e}),[]),h(r);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e.uid]);var b=function(e,t){a(Qe(Qe({},n),{},(0,Ye.Z)({},e,t)))},k=function(){var t=Rt(Dt().mark((function t(n,r,a){var i,u,c,l,f,p,v,g,m,y,b,k,x,w;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=d(o))[n]=Qe(Qe({},i[n]),{},(0,Ye.Z)({},r,a)),"productId"!==r){t.next=23;break}return"__new__"===a&&((u=prompt("Enter the new Product ID:"))?(i[n].productId=u,i[n].productName="",h((function(e){return[].concat(d(e),[u])}))):i[n]={productId:"",productName:""}),c=a,t.next=7,yE.collection("users/".concat(e.uid,"/restockitems")).where("productId","==",c).orderBy("transactionID","desc").limit(1).get();case 7:if((l=t.sent).empty){t.next=23;break}return f=l.docs[0].data(),p=f.costPrice,v=f.productName,g=f.transactionID,t.next=13,yE.collection("users/".concat(e.uid,"/restocks")).where("transactionID","==",g).limit(1).get();case 13:if((m=t.sent).empty){t.next=21;break}return y=m.docs[0].data(),b=y.transactionID,t.next=19,yE.collection("users/".concat(e.uid,"/restockitems")).where("transactionID","==",b).where("productId","==",c).limit(1).get();case 19:(k=t.sent).empty||(x=k.docs[0].data(),w=x.costPrice||"",i[n].costPrice=w);case 21:i[n].costPrice=p||"",i[n].productName=v||"";case 23:s(i);case 24:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),x=function(e){var t=new Date(e);return isNaN(t)?null:kE.fromDate(t)};(0,r.useEffect)((function(){var e=o.reduce((function(e,t){return e+t.quantity*t.costPrice}),0);a((function(t){return Qe(Qe({},t),{},{transactionAmount:e})}))}),[o]);var w=function(){var e=[];return""===n.date&&e.push("Date field cannot be empty"),""===n.time&&e.push("Time field cannot be empty"),""===n.transactionID&&e.push("Restock ID field cannot be empty"),o&&0!==o.length?(o.forEach((function(t,r){""===t.productId&&e.push("Product ".concat(r+1,"'s Product ID field cannot be empty")),""===t.productName&&e.push("Product ".concat(r+1,"'s Product Name field cannot be empty")),(""===t.quantity||isNaN(t.quantity)||t.quantity<=0)&&e.push("Valid quantity is required for product ".concat(r+1)),""===t.batchId&&e.push("Product ".concat(r+1,"'s Batch ID field cannot be empty")),(""===t.costPrice||isNaN(t.costPrice)||t.costPrice<=0)&&e.push("Valid cost price is required for product ".concat(r+1)),(""===t.expiryDate||isNaN((0,Hpe.default)(t.expiryDate)))&&e.push("Product ".concat(r+1,"'s Expiry Date field is invalid")),function(e){var t=new Date("".concat(n.date,"T").concat(n.time)),r=(0,Hpe.default)(e);return r&&(r.getFullYear()===t.getFullYear()&&r.getMonth()===t.getMonth()&&r.getDate()===t.getDate()||(0,Ope.default)(r,t))}(t.expiryDate)||e.push("Product ".concat(r+1,"'s Expiry Date must be after transaction date"))})),e):e},I=function(){var t=Rt(Dt().mark((function t(){var r,i,u,c,l,h,f,d,p,g;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v([]),!((r=w())&&r.length>0)){t.next=5;break}return v(r),t.abrupt("return");case 5:return y(!0),i=n.transactionID,t.next=9,yE.collection("users/".concat(e.uid,"/restockitems")).where("transactionID","==",i).limit(1).get();case 9:if(t.sent.empty){t.next=14;break}return v(["Restock ID must be unique"]),y(!1),t.abrupt("return");case 14:u=new Set,c=(0,C.Z)(o),t.prev=16,c.s();case 18:if((l=c.n()).done){t.next=28;break}if(h=l.value,f=h.productId,d=h.batchId,!u.has("".concat(f,"-").concat(d))){t.next=25;break}return v(["Batch ID must be unique for ".concat(f)]),y(!1),t.abrupt("return");case 25:u.add("".concat(f,"-").concat(d));case 26:t.next=18;break;case 28:t.next=33;break;case 30:t.prev=30,t.t0=t.catch(16),c.e(t.t0);case 33:return t.prev=33,c.f(),t.finish(33);case 36:return p=new Date("".concat(n.date,"T").concat(n.time)),delete(g=Qe(Qe({},n),{},{dateTime:kE.fromDate(p),transactionAmount:parseFloat(n.transactionAmount).toFixed(2)})).date,delete g.time,t.next=42,yE.collection("users/".concat(e.uid,"/restocks")).doc(i).set(g);case 42:return console.log(n),t.next=45,Promise.all(o.map(function(){var t=Rt(Dt().mark((function t(n){var r,a,o,s,u,c,l,h,f,d,v,g,m,y,b;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.productId,a=n.productName,o=n.quantity,s=n.batchId,u=n.expiryDate,c=n.costPrice,l=Qe({transactionID:i,productId:r,productName:a,quantity:parseInt(o,10),expiryDate:kE.fromDate(new Date(u)),costPrice:parseFloat(c).toFixed(2)},s&&{batchId:s}),!(h=x(u))){t.next=7;break}l.expiryDate=h,t.next=9;break;case 7:return console.error("Invalid expiry date:",u),t.abrupt("return");case 9:return t.next=11,yE.collection("users/".concat(e.uid,"/restockitems")).doc("".concat(i," -- ").concat(l.productId)).set(l);case 11:return console.log(l),f=yE.collection("users/".concat(e.uid,"/products")).doc(r),t.next=15,f.get();case 15:if(!(d=t.sent).exists){t.next=27;break}return v=d.data(),g=v.totalQuantity||0,m=parseInt(g,10)+parseInt(o,10),y=v.batchDetails||[],b=Qe({quantity:parseInt(o,10),expiryDate:kE.fromDate(new Date(u)),costPrice:parseFloat(c).toFixed(2),restockDateTime:kE.fromDate(p)},s&&{batchId:s}),y.push(b),t.next=25,f.update({totalQuantity:parseInt(m,10),batchDetails:y});case 25:t.next=29;break;case 27:return t.next=29,yE.collection("users/".concat(e.uid,"/products")).doc(r).set({productId:r,productName:a,batchDetails:[{quantity:parseInt(o,10),expiryDate:kE.fromDate(new Date(u)),costPrice:parseFloat(c),restockDateTime:kE.fromDate(p)}],totalQuantity:parseInt(o,10)});case 29:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 45:v(null),a({date:"",time:"",transactionID:"",transactionAmount:0}),s([{productId:"",productName:"",batchId:"",quantity:"",expiryDate:"",costPrice:""}]),alert("Successfully recorded!\nRestock Transaction ID: ".concat(i,"\nTotal Amount: $").concat(n.transactionAmount)),y(!1);case 50:case"end":return t.stop()}}),t,null,[[16,30,33,36]])})));return function(){return t.apply(this,arguments)}}();return(0,xE.jsxs)("div",{children:[p&&p.length>0&&(0,xE.jsx)("div",{style:{color:"red"},children:p.map((function(e,t){return(0,xE.jsx)("p",{children:e},t)}))}),(0,xE.jsx)("br",{}),(0,xE.jsxs)("h3",{style:{display:"flex",alignItems:"center"},children:[" ","Restock Transaction Details"]}),(0,xE.jsx)("div",{style:{paddingBottom:"20px"},children:(0,xE.jsxs)("form",{onSubmit:I,style:{display:"flex",flexDirection:"column"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"date",children:"Date:"}),(0,xE.jsx)("input",{type:"date",id:"date",value:n.date,onChange:function(e){return b("date",e.target.value)}})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"time",children:"Time:"}),(0,xE.jsx)("input",{type:"time",id:"time",value:n.time,onChange:function(e){return b("time",e.target.value)}})]})]}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"transactionID",children:"Restock ID:"}),(0,xE.jsx)("input",{type:"text",id:"transactionID",value:n.transactionID,onChange:function(e){return b("transactionID",e.target.value)}})]}),(0,xE.jsx)("div",{style:{width:"45%"},children:(0,xE.jsxs)("label",{htmlFor:"transactionAmount",children:["Total Transaction Amount: $",parseFloat(n.transactionAmount).toFixed(2)]})})]})]})}),o.map((function(e,t){return(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsxs)("h3",{style:{display:"flex",alignItems:"center"},children:[" ","Restock Product ",t+1," Details",t>0&&(0,xE.jsx)("button",{type:"button",onClick:function(){return function(e){var t=d(o);t.splice(e,1),s(t)}(t)},style:{background:"none",color:"#777",border:"2px solid black",padding:"2px",marginLeft:"10px",textAlign:"center",lineHeight:"1",fontSize:"0.9em",cursor:"pointer",width:"30px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,xE.jsx)(eve,{style:{margin:"0",color:"black",fontSize:"1.2em"}})})]}),(0,xE.jsx)("div",{style:{paddingBottom:"20px"},children:(0,xE.jsxs)("form",{onSubmit:I,style:{display:"flex",flexDirection:"column"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"productId".concat(t),children:"Product ID:"}),(0,xE.jsxs)("select",{id:"productId".concat(t),value:e.productId,onChange:function(e){return k(t,"productId",e.target.value)},children:[(0,xE.jsx)("option",{value:"",children:"Select an existing Product ID"}),c.map((function(e){return(0,xE.jsx)("option",{value:e,children:e},e)})),(0,xE.jsx)("option",{value:"__new__",children:"Enter a New Product ID"})]})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"productName".concat(t),children:"Product Name:"}),(0,xE.jsx)("input",{type:"text",id:"productName".concat(t),value:e.productName,onChange:function(e){return k(t,"productName",e.target.value)}})]})]}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"batchId".concat(t),children:"Batch ID:"}),(0,xE.jsx)("input",{type:"text",id:"batchId".concat(t),value:e.batchId,onChange:function(e){return k(t,"batchId",e.target.value)}})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"quantity".concat(t),children:"Quantity:"}),(0,xE.jsx)("input",{type:"number",id:"quantity".concat(t),value:e.quantity,onChange:function(e){return k(t,"quantity",e.target.value)}})]})]}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"costPrice".concat(t),children:"Cost Price:"}),(0,xE.jsx)("input",{type:"number",id:"costPrice".concat(t),value:e.costPrice,onChange:function(e){return k(t,"costPrice",e.target.value)}})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"expiryDate".concat(t),children:"Expiry Date:"}),(0,xE.jsx)("input",{type:"date",id:"expiryDate".concat(t),value:e.expiryDate,onChange:function(e){return k(t,"expiryDate",e.target.value)}})]})]})]})})]},t)})),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px",color:"black",border:"none",borderRadius:"5px",fontSize:"100%"},type:"button",onClick:function(){s((function(e){return[].concat(d(e),[{productId:"",productName:"",batchId:"",quantity:"",expiryDate:"",costPrice:""}])}))},children:(0,xE.jsx)("u",{children:"+ Add Another Product"})}),(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px",backgroundColor:"#000000",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},type:"button",onClick:I,disabled:m,children:"Submit"})]})]})}function nve(){var e=CE().user,t=l((0,r.useState)({date:"",time:"",transactionID:"",transactionAmount:0}),2),n=t[0],a=t[1],i=l((0,r.useState)([{productId:"",productName:"",sellingPrice:"",quantity:""}]),2),o=i[0],s=i[1],u=l((0,r.useState)([]),2),c=u[0],h=u[1],f=l((0,r.useState)(null),2),p=f[0],v=f[1],g=l((0,r.useState)(!1),2),m=g[0],y=g[1];(0,r.useEffect)((function(){var t=function(){var t=Rt(Dt().mark((function t(){var n,r;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yE.collection("users/".concat(e.uid,"/products")).orderBy("productId").get();case 2:n=t.sent,r=n.docs.reduce((function(e,t){var n=t.data().productId;return e.includes(n)||e.push(n),e}),[]),h(r);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e.uid]);var b=function(e,t){a((function(n){return Qe(Qe({},n),{},(0,Ye.Z)({},e,t))}))},k=function(){var t=Rt(Dt().mark((function t(n,r,a){var i,u,c,l,h,f,p,v,g,m,y,b,k,x,w,I;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=d(o))[n]=Qe(Qe({},i[n]),{},(0,Ye.Z)({},r,a)),"productId"!==r){t.next=29;break}return u=a,t.next=6,yE.collection("users/".concat(e.uid,"/products")).where("productId","==",u).limit(1).get();case 6:return(c=t.sent).empty||(l=c.docs[0].data(),h=l.productName||"",i[n].productName=h),i[n].sellingPrice="",t.next=11,yE.collection("users/".concat(e.uid,"/salesitems")).where("productId","==",u).orderBy("transactionID","desc").limit(1).get();case 11:if((f=t.sent).empty){t.next=29;break}return p=f.docs[0].data(),v=(null===p||void 0===p?void 0:p.sellingPrice)||"",g=(null===p||void 0===p?void 0:p.productName)||"",m=p.transactionID,t.next=19,yE.collection("users/".concat(e.uid,"/sales")).where("transactionID","==",m).limit(1).get();case 19:if((y=t.sent).empty){t.next=27;break}return b=y.docs[0].data(),k=b.transactionID,t.next=25,yE.collection("users/".concat(e.uid,"/salesitems")).where("transactionID","==",k).where("productId","==",u).limit(1).get();case 25:(x=t.sent).empty||(w=x.docs[0].data(),I=w.sellingPrice||"",i[n].sellingPrice=I);case 27:i[n].sellingPrice=v,i[n].productName=g;case 29:s(i);case 30:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();(0,r.useEffect)((function(){!function(){var e=0;o.forEach((function(t){var n=parseFloat(t.quantity),r=parseFloat(t.sellingPrice);isNaN(n)||isNaN(r)||(e+=n*r)})),a((function(t){return Qe(Qe({},t),{},{transactionAmount:e.toFixed(2)})}))}();var e=0;o.forEach((function(t){var n=parseFloat(t.quantity),r=parseFloat(t.sellingPrice);isNaN(n)||isNaN(r)||(e+=n*r)})),a((function(t){return Qe(Qe({},t),{},{transactionAmount:parseFloat(e).toFixed(2)})}))}),[o]);var x=function(){var t=Rt(Dt().mark((function t(){var r,a,i,s,u,c,l,h,f,d,p,v;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,console.log("Validating Form"),r=[],a=new Date("".concat(n.date,"T").concat(n.time)),""===n.date&&r.push("Transaction Date field cannot be empty"),""===n.time&&r.push("Transaction Time field cannot be empty"),isNaN(a)&&r.push("Transaction Date and Time cannot be invalid"),""===n.transactionID&&r.push("Transaction ID field cannot be empty"),i=0;case 9:if(!(i<o.length)){t.next=22;break}return""===(s=o[i]).productId&&r.push("Product ".concat(i+1," ID field cannot be empty")),""===s.productName&&r.push("Product ".concat(i+1," Name field cannot be empty")),(""===s.quantity||isNaN(s.quantity)||parseFloat(s.quantity)<=0)&&r.push("Valid quantity is required for product ".concat(i+1)),(""===s.sellingPrice||isNaN(s.sellingPrice)||parseFloat(s.sellingPrice)<0)&&r.push("Valid selling price is required for product ".concat(i+1)),t.next=17,yE.collection("users/".concat(e.uid,"/products")).where("productId","==","".concat(s.productId)).get();case 17:if((u=t.sent).empty)r.push("Product ".concat(i+1," does not exist"));else{console.log("Checking Product Quantity"),c=u.docs[0].data(),l=c.batchDetails||[],console.log(l),h=0,f=(0,C.Z)(l);try{for(f.s();!(d=f.n()).done;)p=d.value,v=p.restockDateTime.toDate(),(0,Ope.default)(a,v)&&(h+=p.quantity,console.log(h))}catch(kve){f.e(kve)}finally{f.f()}parseInt(h)<parseInt(s.quantity,10)&&r.push("Product ".concat(i+1," does not have sufficient quantity"))}case 19:i++,t.next=9;break;case 22:return t.abrupt("return",r);case 25:return t.prev=25,t.t0=t.catch(0),console.error("Error while validating form:",t.t0),t.abrupt("return",["An error occurred while validating the form. Please try again later."]);case 29:case"end":return t.stop()}}),t,null,[[0,25]])})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=Rt(Dt().mark((function t(){var r,i,u,c,l,h,f,d,p,g,m,b,k,w,I,S,_,T,E;return Dt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(n),t.next=4,x();case 4:if(!((r=t.sent).length>0)){t.next=10;break}console.log(r),v(r),t.next=87;break;case 10:return y(!0),i=n.transactionID,t.next=14,yE.collection("users/".concat(e.uid,"/salesitems")).where("transactionID","==",i).limit(1).get();case 14:if(t.sent.empty){t.next=19;break}return v(["Sales ID must be unique"]),y(!1),t.abrupt("return");case 19:return console.log("Submitting"),u=new Date("".concat(n.date,"T").concat(n.time)),delete(c=Qe(Qe({},n),{},{dateTime:u,transactionAmount:parseFloat(n.transactionAmount).toFixed(2)})).date,delete c.time,t.next=26,yE.collection("users/".concat(e.uid,"/sales")).doc(i).set(c);case 26:console.log(c),l=(0,C.Z)(o),t.prev=28,l.s();case 30:if((h=l.n()).done){t.next=72;break}return f=h.value,d=f.productId,p=f.quantity,t.next=35,yE.collection("users/".concat(e.uid,"/products")).where("productId","==","".concat(d)).get();case 35:g=t.sent,m=g.docs[0].ref,b=g.docs[0].data(),(k=b.batchDetails||[]).sort((function(e,t){return new Date(t.expiryDate)-new Date(e.expiryDate)})),w=p,I=(0,C.Z)(k),t.prev=42,I.s();case 44:if((S=I.n()).done){t.next=54;break}if(_=S.value,console.log((0,Ope.default)(u,_.restockDateTime.toDate())),!(w<=0)){t.next=51;break}return t.abrupt("break",54);case 51:(0,Ope.default)(u,_.restockDateTime.toDate())&&(_.quantity<=w?(w-=_.quantity,_.quantity=0):(_.quantity-=w,w=0));case 52:t.next=44;break;case 54:t.next=59;break;case 56:t.prev=56,t.t0=t.catch(42),I.e(t.t0);case 59:return t.prev=59,I.f(),t.finish(59);case 62:return T=k.filter((function(e){return e.quantity>0})),t.next=65,m.update({batchDetails:T,totalQuantity:T.reduce((function(e,t){return parseInt(e)+parseInt(t.quantity)}),0)});case 65:return f.transactionID=i,f.quantity=parseInt(f.quantity,10),f.sellingPrice=parseFloat(f.sellingPrice).toFixed(2),t.next=70,yE.collection("users/".concat(e.uid,"/salesitems")).doc("".concat(i," -- ").concat(f.productId)).set(f);case 70:t.next=30;break;case 72:t.next=77;break;case 74:t.prev=74,t.t1=t.catch(28),l.e(t.t1);case 77:return t.prev=77,l.f(),t.finish(77);case 80:console.log("done"),v(null),a({date:"",time:"",transactionID:"",transactionAmount:0}),s([{productId:"",productName:"",sellingPrice:"",quantity:""}]),E=parseFloat(n.transactionAmount),isNaN(E)||alert("Successfully recorded!\nSales Transaction ID: ".concat(i,"\nTotal Amount: ").concat(E)),y(!1);case 87:t.next=94;break;case 89:t.prev=89,t.t2=t.catch(0),console.error("Error while handling form submission:",t.t2),v(["An error occurred while submitting the form. Please try again later."]),y(!1);case 94:case"end":return t.stop()}}),t,null,[[0,89],[28,74,77,80],[42,56,59,62]])})));return function(){return t.apply(this,arguments)}}();return(0,xE.jsxs)("div",{children:[p&&p.length>0&&(0,xE.jsx)("div",{style:{color:"red"},children:p.map((function(e,t){return(0,xE.jsx)("p",{children:e},t)}))}),(0,xE.jsx)("br",{}),(0,xE.jsx)("h3",{style:{display:"flex",alignItems:"center"},children:"Sales Transaction Details"}),(0,xE.jsx)("div",{style:{paddingBottom:"20px"},children:(0,xE.jsxs)("form",{onSubmit:w,style:{display:"flex",flexDirection:"column"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"date",children:"Date:"}),(0,xE.jsx)("input",{type:"date",id:"date",value:n.date,onChange:function(e){return b("date",e.target.value)}})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"time",children:"Time:"}),(0,xE.jsx)("input",{type:"time",id:"time",value:n.time,onChange:function(e){return b("time",e.target.value)}})]})]}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"transactionId",children:"Transaction ID:"}),(0,xE.jsx)("input",{type:"text",id:"transactionId",value:n.transactionID,onChange:function(e){return b("transactionID",e.target.value)}})]}),(0,xE.jsx)("div",{style:{width:"45%"},children:(0,xE.jsxs)("label",{htmlFor:"transactionAmount",children:["Total Transaction Amount: $",n.transactionAmount]})})]})]})}),o.map((function(e,t){return(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsxs)("h3",{style:{display:"flex",alignItems:"center"},children:["Sales Product ",t+1," Details",t>0&&(0,xE.jsx)("button",{type:"button",onClick:function(){return function(e){var t=d(o);t.splice(e,1),s(t)}(t)},style:{background:"none",color:"#777",border:"2px solid black",padding:"2px",marginLeft:"10px",textAlign:"center",lineHeight:"1",fontSize:"0.9em",cursor:"pointer",width:"30px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,xE.jsx)(eve,{style:{margin:"0",color:"black",fontSize:"1.2em"}})})]}),(0,xE.jsx)("div",{style:{paddingBottom:"20px"},children:(0,xE.jsxs)("form",{onSubmit:w,style:{display:"flex",flexDirection:"column"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"productId".concat(t),children:"Product ID:"}),(0,xE.jsxs)("select",{id:"productId".concat(t),value:e.productId,onChange:function(e){return k(t,"productId",e.target.value)},children:[(0,xE.jsx)("option",{value:"",children:"Select Product ID"}),c.map((function(e){return(0,xE.jsx)("option",{value:e,children:e},e)}))]})]}),(0,xE.jsx)("div",{style:{width:"45%"},children:(0,xE.jsxs)("label",{htmlFor:"productName".concat(t),children:["Product Name: ",e.productName]})})]}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"sellingPrice".concat(t),children:"Selling Price:"}),(0,xE.jsx)("input",{type:"number",id:"sellingPrice".concat(t),value:e.sellingPrice,onChange:function(e){return k(t,"sellingPrice",e.target.value)}})]}),(0,xE.jsxs)("div",{style:{width:"45%"},children:[(0,xE.jsx)("label",{htmlFor:"quantity".concat(t),children:"Quantity:"}),(0,xE.jsx)("input",{type:"number",id:"quantity".concat(t),value:e.quantity,onChange:function(e){return k(t,"quantity",e.target.value)}})]})]})]})})]},t)})),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px",color:"black",border:"none",borderRadius:"5px",fontSize:"100%"},type:"button",onClick:function(){s([].concat(d(o),[{productId:"",productName:"",sellingPrice:"",quantity:""}]))},children:(0,xE.jsx)("u",{children:"+ Add Another Product"})}),(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px",backgroundColor:"#000000",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},type:"button",onClick:w,disabled:m,children:"Submit"})]})]})}var rve={container:"Forms_container__3AgIr",toggleButton:"Forms_toggleButton__Q6CuS",toggleOption:"Forms_toggleOption__wTAAk",active:"Forms_active__p9KYQ",sidebar:"Forms_sidebar__h1jcZ"};function ave(){var e=function(){var e=l((0,r.useState)(!0),2),t=e[0],n=e[1];return(0,xE.jsxs)("div",{className:rve.container,children:[(0,xE.jsxs)("div",{className:rve.toggleButton,children:[(0,xE.jsx)("div",{className:"".concat(rve.toggleOption," ").concat(t?rve.active:""),onClick:function(){n(!0)},children:"Restock"}),(0,xE.jsx)("div",{className:"".concat(rve.toggleOption," ").concat(t?"":rve.active),onClick:function(){n(!1)},children:"Sales"})]}),(0,xE.jsx)("br",{}),(0,xE.jsx)("div",{className:rve.sidebar,children:t?(0,xE.jsx)(tve,{}):(0,xE.jsx)(nve,{})})]})};return(0,xE.jsxs)("div",{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)(e,{})]})}var ive={container:"History_container__FqpUU",toggleButton:"History_toggleButton__4usy-",toggleOption:"History_toggleOption__ppQvJ",active:"History_active__U8em5",sidebar:"History_sidebar__xClpQ",transactions:"History_transactions__rzKnF",name:"History_name__JEaAF",datetime:"History_datetime__nai8j",amount:"History_amount__--W9I",productListItem:"History_productListItem__+zSUW"};function ove(){var e=CE().user,t=KE("users/".concat(e.uid,"/restocks")),n=t.documents,a=t.error,i=KE("users/".concat(e.uid,"/restockitems")),o=i.documents,s=i.error,u=l((0,r.useState)([]),2),c=u[0],h=u[1],f=l((0,r.useState)(""),2),d=f[0],p=f[1];(0,r.useEffect)((function(){if(a||s)console.log("Error retrieving restock data:",a),console.log("Error retrieving restock items data:",s);else{var e=null===n||void 0===n?void 0:n.map((function(e){return Qe(Qe({},e),{},{restockItems:o.filter((function(t){return t.transactionID===e.transactionID}))})})).sort((function(e,t){var n=new Date(e.date+" "+e.time);return new Date(t.date+" "+t.time)-n}));h(e||[])}}),[n,o,a,s]);var v=l((0,r.useState)(null),2),g=v[0],m=v[1];if(!c)return(0,xE.jsx)("p",{children:"Loading..."});var y=c.filter((function(e){if(""===d.trim())return!0;var t=d.toLowerCase(),n=e.dateTime.toDate().toLocaleDateString(),r=e.dateTime.toDate().toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return e.transactionID.toLowerCase().includes(t)||n.toLowerCase().includes(t)||r.toLowerCase().includes(t)}));return(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("h3",{children:"Past Restock Transactions"}),(0,xE.jsx)("input",{type:"text",placeholder:"Search by transaction ID, date, or time",value:d,onChange:function(e){return p(e.target.value)},style:{display:"flex",flexDirection:"column",alignItems:"center",width:"50%",colour:"black",border:"1px solid black",borderRadius:"5px"}}),(0,xE.jsx)("ul",{className:ive.transactions,children:y.length>0?y.map((function(e,t){var n=e.transactionID,r=e.dateTime,a=e.transactionAmount;return(0,xE.jsx)("li",{className:ive.productListItem,children:(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,xE.jsxs)("p",{children:["Transaction ID: ",n]}),(0,xE.jsxs)("p",{children:["Date: ",r.toDate().toLocaleDateString()]}),(0,xE.jsxs)("p",{children:["Time:"," ",r.toDate().toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})]}),(0,xE.jsxs)("p",{children:["Transaction Amount: $",a]})]}),(0,xE.jsx)("div",{style:{width:"100%"},children:g===t&&(0,xE.jsx)("div",{className:ive.details,children:e.restockItems.map((function(e,t){return(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",margin:"20px 0"},children:[(0,xE.jsxs)("p",{style:{flex:"1"},children:["Product ID: ",e.productId]}),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"1"},children:[(0,xE.jsxs)("p",{children:["Batch ID: ",e.batchId]}),(0,xE.jsxs)("p",{children:["Expiry Date:"," ",e.expiryDate.toDate().toLocaleDateString()]})]}),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"1"},children:[(0,xE.jsxs)("p",{style:{textAlign:"right"},children:["Quantity: ",e.quantity]}),(0,xE.jsxs)("p",{style:{textAlign:"right"},children:["Cost Price: $",parseFloat(e.costPrice).toFixed(2)]})]})]},t)}))})}),(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px 10px 0",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},onClick:function(){return function(e){m(g===e?null:e)}(t)},children:g===t?(0,xE.jsx)("u",{children:"Hide Details"}):(0,xE.jsx)("u",{children:"+ Show More"})})]})},n)})):(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{style:{color:"black"},children:"There are no transactions recorded."})]})})]})}function sve(){var e=CE().user,t=KE("users/".concat(e.uid,"/sales")),n=t.documents,a=t.error,i=KE("users/".concat(e.uid,"/salesitems")),o=i.documents,s=i.error,u=l((0,r.useState)([]),2),c=u[0],h=u[1],f=l((0,r.useState)(""),2),d=f[0],p=f[1];(0,r.useEffect)((function(){if(a||s)console.log("Error retrieving sales data:",a),console.log("Error retrieving sales items data:",s);else{var e=null===n||void 0===n?void 0:n.map((function(e){return Qe(Qe({},e),{},{salesItems:o.filter((function(t){return t.transactionID===e.transactionID}))})})).sort((function(e,t){var n=new Date(e.date+" "+e.time);return new Date(t.date+" "+t.time)-n}));h(e||[])}}),[n,a,o,s]);var v=l((0,r.useState)(null),2),g=v[0],m=v[1],y=c.filter((function(e){if(""===d.trim())return!0;var t=d.toLowerCase(),n=e.dateTime.toDate().toLocaleDateString(),r=e.dateTime.toDate().toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0});return e.transactionID.toLowerCase().includes(t)||n.toLowerCase().includes(t)||r.toLowerCase().includes(t)}));return(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("h3",{children:"Past Sales Transactions"}),(0,xE.jsx)("input",{type:"text",placeholder:"Search by transaction ID, date, or time",value:d,onChange:function(e){return p(e.target.value)},style:{display:"flex",flexDirection:"column",alignItems:"center",width:"50%",colour:"black",border:"1px solid black",borderRadius:"5px"}}),(0,xE.jsx)("ul",{className:ive.transactions,children:y.length>0?y.map((function(e,t){var n=e.transactionID,r=e.dateTime,a=e.transactionAmount;return(0,xE.jsx)("li",{className:ive.productListItem,children:(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,xE.jsxs)("p",{children:["Transaction ID: ",n]}),(0,xE.jsxs)("p",{children:["Date: ",r.toDate().toLocaleDateString()]}),(0,xE.jsxs)("p",{children:["Time:"," ",r.toDate().toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})]}),(0,xE.jsxs)("p",{children:["Transaction Amount: $",a]})]}),(0,xE.jsx)("div",{style:{width:"100%"},children:g===t&&(0,xE.jsx)("div",{className:ive.details,children:e.salesItems.map((function(e,t){return(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",margin:"20px 0"},children:[(0,xE.jsxs)("p",{children:["Product ID: ",e.productId]}),(0,xE.jsxs)("p",{children:["Product Name: ",e.productName]}),(0,xE.jsxs)("p",{children:["Selling Price: $",e.sellingPrice]}),(0,xE.jsxs)("p",{children:["Quantity: ",e.quantity]})]},t)}))})}),(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px 10px 0",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},onClick:function(){return function(e){m(g===e?null:e)}(t)},children:g===t?(0,xE.jsx)("u",{children:"Hide Details"}):(0,xE.jsx)("u",{children:"+ Show More"})})]})},n)})):(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{style:{color:"black"},children:"There are no transactions recorded."})]})})]})}function uve(){var e=function(){var e=l((0,r.useState)(!0),2),t=e[0],n=e[1];return(0,xE.jsxs)("div",{className:ive.container,children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsxs)("div",{className:ive.toggleButton,children:[(0,xE.jsx)("div",{className:"".concat(ive.toggleOption," ").concat(t?ive.active:""),onClick:function(){n(!0)},children:"Restock"}),(0,xE.jsx)("div",{className:"".concat(ive.toggleOption," ").concat(t?"":ive.active),onClick:function(){n(!1)},children:"Sales"})]}),(0,xE.jsx)("br",{}),(0,xE.jsx)("div",{className:ive.sidebar,children:t?(0,xE.jsx)(ove,{}):(0,xE.jsx)(sve,{})})]})};return(0,xE.jsx)("div",{children:(0,xE.jsx)(e,{})})}function cve(e){var t=e.products,n=e.onClose,a=CE().user,i=l((0,r.useState)([]),2),o=i[0],s=i[1],u=function(){var e=Rt(Dt().mark((function e(){var t,r,i;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=(0,C.Z)(o),e.prev=2,i=Dt().mark((function e(){var t,n,i,o,s,u,c,l,h,f;return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.value,n=t.productId,i=t.batchId,o=t.expiryDate,s=t.quantity,u=yE.collection("users/".concat(a.uid,"/products")).doc(n),e.next=8,u.get();case 8:return c=e.sent,l=c.data(),h=l.batchDetails.findIndex((function(e){return e.batchId===i})),l.batchDetails.splice(h,1),e.next=14,u.update({batchDetails:l.batchDetails,totalQuantity:l.batchDetails.reduce((function(e,t){return e+t.quantity}),0)});case 14:return f=new Date,e.next=17,yE.collection("users/".concat(a.uid,"/expiredclearance")).doc("".concat(n," -- ").concat(i)).set({productId:n,productName:l.productName,batchId:i,expiryDate:o,quantity:s,dateOfDeletion:f});case 17:case"end":return e.stop()}}),e)})),t.s();case 5:if((r=t.n()).done){e.next=9;break}return e.delegateYield(i(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),t.e(e.t1);case 14:return e.prev=14,t.f(),e.finish(14);case 17:n(),e.next=23;break;case 20:e.prev=20,e.t2=e.catch(0),console.error("Error removing selected batches:",e.t2);case 23:case"end":return e.stop()}}),e,null,[[0,20],[2,11,14,17]])})));return function(){return e.apply(this,arguments)}}();return(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"fixed",justifyContent:"center",alignItems:"center",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"30px",background:"#fff",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)",borderRadius:"8px",width:"50%",maxHeight:"80%",overflowY:"auto"},children:[(0,xE.jsx)("h2",{children:"Expired Products"}),(0,xE.jsx)("br",{}),(0,xE.jsx)("ul",{children:t.map((function(e){return(0,xE.jsxs)("li",{children:[(0,xE.jsxs)("h3",{children:["Product ID: ",e.productId," | Product Name:"," ",e.productName]}),(0,xE.jsx)("ul",{children:e.batchDetails.map((function(t){return(0,xE.jsxs)("li",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,xE.jsx)("input",{type:"checkbox",checked:o.some((function(n){return n.productId===e.productId&&n.batchId===t.batchId})),onChange:function(n){return function(e,t,n){var r=n.selected,a=n.expiryDate,i=n.quantity;s(r?function(n){return[].concat(d(n),[{productId:e,batchId:t,expiryDate:a,quantity:i}])}:function(n){return n.filter((function(n){return!(n.productId===e&&n.batchId===t)}))})}(e.productId,t.batchId,{selected:n.target.checked,expiryDate:t.expiryDate,quantity:t.quantity})}}),(0,xE.jsxs)("div",{style:{marginLeft:"10px"},children:[(0,xE.jsxs)("p",{children:["Batch ".concat(t.batchId)," "]}),t.expiryDate&&(0,xE.jsxs)("p",{children:["Expiry Date:"," ",t.expiryDate.toDate().toLocaleDateString()]}),(0,xE.jsxs)("p",{children:["Quantity: ",t.quantity," "]}),(0,xE.jsxs)("p",{children:["Cost Price: $",t.costPrice]})]})]},t.batchId)}))})]},e.productId)}))}),(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"},children:[(0,xE.jsx)("button",{style:{display:"block",width:"100%",padding:"10px",marginRight:"10px",backgroundColor:"#000000",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},onClick:u,children:"Confirm"}),(0,xE.jsx)("button",{style:{display:"block",width:"100%",padding:"10px",backgroundColor:"#000000",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},onClick:n,children:"Cancel"})]})]})}var lve={container:"Inventory_container__3utYR",toggleButton:"Inventory_toggleButton__g101h",toggleOption:"Inventory_toggleOption__BfIoQ",active:"Inventory_active__q7MTB",sidebar:"Inventory_sidebar__23gzA",transactions:"Inventory_transactions__lVF1S",name:"Inventory_name__rfegb",datetime:"Inventory_datetime__HKYld",amount:"Inventory_amount__QXXXp",productListItem:"Inventory_productListItem__8ZrAi"};function hve(){var e=l((0,r.useState)([]),2),t=e[0],n=e[1],a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)(null),2),u=s[0],c=s[1],h=l((0,r.useState)(""),2),f=h[0],d=h[1],p=l((0,r.useState)(!1),2),v=p[0],g=p[1],m=l((0,r.useState)([]),2),y=m[0],b=m[1],k=CE().user,x=KE("users/".concat(k.uid,"/products")),w=x.documents,I=x.error;(0,r.useEffect)((function(){I?o(I):n(w||[])}),[w,I]);if(i)return(0,xE.jsxs)("p",{children:["Error: ",i]});var S=t.filter((function(e){if(""===f.trim())return!0;var t=f.toLowerCase();return e.productName.toLowerCase().includes(t)||e.productId.toLowerCase().includes(t)}));return(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsx)("br",{}),(0,xE.jsxs)("div",{className:lve.container,children:[(0,xE.jsx)("h3",{children:"Products List"}),(0,xE.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,xE.jsx)("input",{type:"text",placeholder:"Search by product ID or name",value:f,onChange:function(e){return d(e.target.value)},style:{flex:"3 0 70%",color:"black",border:"1px solid black",borderRadius:"5px",padding:"10px",marginRight:"20px"}}),(0,xE.jsx)("button",{style:{flex:"1 0 25%",padding:"10px",backgroundColor:"#000000",color:"white",border:"none",borderRadius:"5px",fontSize:"100%"},onClick:function(){var e=Date.now(),n=[];t.forEach((function(t){var r=t.batchDetails.filter((function(t,n){return t.expiryDate&&new Date(t.expiryDate.toDate().toLocaleDateString())<e}));r.length>0&&n.push(Qe(Qe({},t),{},{batchDetails:r}))})),console.log(n),b(n),g(!0)},children:"Clear Expired Products"})]}),(0,xE.jsx)("ul",{className:lve.transactions,children:S.length>0?S.map((function(e,t){return(0,xE.jsx)("li",{className:lve.productListItem,children:(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:[(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,xE.jsxs)("p",{children:["Product ID: ",e.productId]}),(0,xE.jsxs)("p",{children:["Product Name: ",e.productName]}),(0,xE.jsxs)("p",{children:["Total Quantity: ",e.totalQuantity]})]}),u===t&&e.batchDetails.map((function(e,t){return(0,xE.jsx)("div",{style:{width:"100%",margin:"20px 0"},children:(0,xE.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,xE.jsx)("p",{style:{flex:"1"},children:"Batch ".concat(t+1)}),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"1"},children:[(0,xE.jsx)("p",{children:e.batchId?"Batch ID: ".concat(e.batchId):""}),(0,xE.jsxs)("p",{children:["Expiry Date:"," ",e.expiryDate.toDate().toLocaleDateString()]})]}),(0,xE.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"1"},children:[(0,xE.jsxs)("p",{style:{textAlign:"right"},children:["Quantity: ",e.quantity]}),(0,xE.jsxs)("p",{style:{textAlign:"right"},children:["Cost Price: $",e.costPrice]})]})]},t)})})),(0,xE.jsx)("button",{style:{display:"block",width:"315px",padding:"10px 10px 0",color:e.totalQuantity>0?"white":"red",border:"none",borderRadius:"5px",fontSize:"100%",backgroundColor:"#000000"},className:lve.showMoreButton,onClick:function(){return function(e){S[e].totalQuantity>0&&c(u===e?null:e)}(t)},children:e.totalQuantity>0?u===t?(0,xE.jsx)("u",{children:"Hide Details"}):(0,xE.jsx)("u",{children:"+ Show More"}):"Out of Stock"})]})},e.productId)})):(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("br",{}),(0,xE.jsx)("p",{style:{color:"black"},children:"There are no products in your inventory."})]})})]}),v&&(0,xE.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,xE.jsx)(cve,{products:y,onClose:function(){g(!1)}})})]})}var fve=function(){var e=l((0,r.useState)(!1),2),t=e[0],n=e[1],a=l((0,r.useState)(null),2),i=a[0],o=a[1],s=l((0,r.useState)(!1),2),u=s[0],c=s[1],h=CE().dispatch,f=function(){var e=Rt(Dt().mark((function e(){return Dt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(null),c(!0),e.prev=2,e.next=5,bE.signOut();case 5:h({type:"LOGOUT"}),t||(c(!1),o(null)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t||(o(e.t0.message),c(!1));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return(0,r.useEffect)((function(){return function(){return n(!0)}}),[]),{logout:f,error:i,isPending:u}},dve=n.p+"static/media/NavbarLogo.bf203e2f7157f4027c1d.png",pve={navbar:"Navbar_navbar__8xf6k",title:"Navbar_title__7AJPa",logo:"Navbar_logo__rf1XS",navbarContainer:"Navbar_navbarContainer__gaMyo",links:"Navbar_links__toP8R","scroll-link":"Navbar_scroll-link__CH-l5","nav-btn":"Navbar_nav-btn__AfBdk",responsiveNav:"Navbar_responsiveNav__rB127",iconClicked:"Navbar_iconClicked__Zd9JZ","nav-close-btn":"Navbar_nav-close-btn__pGKSU"};function vve(){var e=fve().logout,t=CE().user,n=ye(),a=l((0,r.useState)(!1),2),i=a[0],o=a[1],s=l((0,r.useState)(!0),2),u=s[0],c=s[1],h=l((0,r.useState)(!0),2),f=h[0],d=h[1],p=(0,r.useRef)(null),v=0,g=function(){o(!i)},m=function(){g(),c(!u),d(!1)},y=function(e){document.getElementById(e).scrollIntoView({behavior:"smooth"}),window.innerWidth<=768&&g()},b="/introduction"===n.pathname,k=function(){window.innerWidth<=768&&(o(!1),c(!0),d(!0))};return(0,r.useEffect)((function(){var e=function(){window.innerWidth>768&&(o(!1),c(!0),d(!0))};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((function(){var e=function(){var e=window.pageYOffset;e<=0?(p.current.style.transform="translateY(0)",p.current.style.filter=""):e>v?(p.current.style.transform="translateY(-100%)",p.current.style.filter=""):(p.current.style.transform="translateY(0)",p.current.style.filter="drop-shadow(0 -10px 20px rgb(170, 170, 170))"),v=e};return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}),[]),(0,xE.jsx)("nav",{ref:p,className:pve.navbar,children:(0,xE.jsxs)("div",{className:pve.navbarContainer,children:[(0,xE.jsx)("div",{className:pve.title,children:(0,xE.jsx)(Ge,{to:"/",children:(0,xE.jsx)("img",{src:dve,alt:"Logo",className:pve.logo})})}),(0,xE.jsxs)("div",{className:"".concat(pve.links," ").concat(i?pve.responsiveNav:""," ").concat(u&&!f?pve.iconClicked:""),children:[b&&(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)("button",{className:pve["scroll-link"],onClick:function(){return y("home")},children:(0,xE.jsx)(Ge,{to:"/",onClick:k,children:"Home"})}),(0,xE.jsx)("button",{className:pve["scroll-link"],onClick:function(){return y("about")},children:(0,xE.jsx)(Ge,{to:"/",onClick:k,children:"About Us"})}),(0,xE.jsx)("button",{className:pve["scroll-link"],onClick:function(){return y("features")},children:(0,xE.jsx)(Ge,{to:"/",onClick:k,children:"Features"})})]}),!t&&(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)(Ge,{to:"/login",onClick:k,children:"Login"}),(0,xE.jsx)(Ge,{to:"/signup",onClick:k,children:"Sign Up"})]}),t&&(0,xE.jsxs)(xE.Fragment,{children:[(0,xE.jsx)(Ge,{to:"/inventory",onClick:k,children:"Inventory"}),(0,xE.jsx)(Ge,{to:"/history",onClick:k,children:"History"}),(0,xE.jsx)(Ge,{to:"/forms",onClick:k,children:"Forms"}),(0,xE.jsx)("button",{className:"btn",onClick:e,children:"Logout"})]}),(0,xE.jsx)("button",{className:"".concat(pve["nav-btn"]," ").concat(pve["nav-close-btn"]),onClick:m,children:(0,xE.jsx)(eve,{})})]}),(0,xE.jsx)("button",{className:pve["nav-btn"],onClick:m,children:(0,xE.jsx)($pe,{})})]})})}var gve={footer:"Footer_footer__QzIeZ"};function mve(){return document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("footer");window.addEventListener("scroll",(function(){document.querySelector(".content").offsetHeight-window.innerHeight<=window.pageYOffset?e.classList.add("show"):e.classList.remove("show")}))})),(0,xE.jsxs)("footer",{className:gve.footer,children:["\xa9 ",(new Date).getFullYear()," YuHu. All rights reserved."]})}var yve=function(){var e=CE(),t=e.authIsReady,n=e.user;return(0,xE.jsx)("div",{className:o,children:t&&(0,xE.jsxs)(je,{children:[(0,xE.jsx)(vve,{}),(0,xE.jsxs)(Le,{children:[(0,xE.jsx)(Fe,{path:"/",element:n?(0,xE.jsx)(Wpe,{}):(0,xE.jsx)(Oe,{to:"/introduction",replace:!0})}),(0,xE.jsx)(Fe,{path:"/introduction",element:(0,xE.jsx)(UE,{})}),(0,xE.jsx)(Fe,{path:"/login",element:n?(0,xE.jsx)(Oe,{to:"/",replace:!0}):(0,xE.jsx)(WE,{})}),(0,xE.jsx)(Fe,{path:"/signup",element:n&&n.displayName?(0,xE.jsx)(Oe,{to:"/",replace:!0}):(0,xE.jsx)(qE,{})}),(0,xE.jsx)(Fe,{path:"/forms",element:n&&n.displayName?(0,xE.jsx)(ave,{}):(0,xE.jsx)(Oe,{to:"/login",replace:!0})}),(0,xE.jsx)(Fe,{path:"/history",element:n&&n.displayName?(0,xE.jsx)(uve,{}):(0,xE.jsx)(Oe,{to:"/login",replace:!0})}),(0,xE.jsx)(Fe,{path:"/inventory",element:n&&n.displayName?(0,xE.jsx)(hve,{}):(0,xE.jsx)(Oe,{to:"/login",replace:!0})}),(0,xE.jsx)(Fe,{path:"*",element:(0,xE.jsx)(Oe,{to:"/",replace:!0})})]}),(0,xE.jsx)(mve,{})]})})},bve=document.getElementById("root");(0,i.s)(bve).render((0,xE.jsx)(r.StrictMode,{children:(0,xE.jsx)(SE,{children:(0,xE.jsx)(yve,{})})}))}()}();
//# sourceMappingURL=main.f19dd89e.js.map